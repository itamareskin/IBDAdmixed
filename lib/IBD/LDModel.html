<!-- Generated by Cython 0.17.4 on Sun Jan  5 13:48:45 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.17.4 on Sun Jan  5 13:48:45 2014
<p>Raw output: <a href="LDModel.cpp">LDModel.cpp</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #cython: profile=True</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "LDModel.pyx":1
 * #cython: profile=True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * from __future__ import division
 */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_1)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: </pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: from __future__ import division</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line4")'> 4: import random</pre>
<pre id='line4' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":4
 * 
 * from __future__ import division
 * import random             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import numpy as np
 * cimport numpy as np
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__random), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__random, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line5")'> 5: import numpy as np</pre>
<pre id='line5' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":5
 * from __future__ import division
 * import random
 * import numpy as np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport numpy as np
 * import os
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__np, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: cimport numpy as np</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line7")'> 7: import os</pre>
<pre id='line7' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":7
 * import numpy as np
 * cimport numpy as np
 * import os             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import math
 * from libc.stdlib cimport malloc, free
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__os), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__os, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line8")'> 8: import math</pre>
<pre id='line8' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":8
 * cimport numpy as np
 * import os
 * import math             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from libc.stdlib cimport malloc, free
 * from itertools import islice, combinations_with_replacement
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__math, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: from libc.stdlib cimport malloc, free</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line10")'> 10: from itertools import islice, combinations_with_replacement</pre>
<pre id='line10' class='code' style='background-color: #FFFF2b'>
  /* "LDModel.pyx":10
 * import math
 * from libc.stdlib cimport malloc, free
 * from itertools import islice, combinations_with_replacement             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from libc.math cimport exp, log
 * from libc.float cimport DBL_MIN, DBL_MAX
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__islice));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__islice));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__islice));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_106));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s_106));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_106));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__itertools), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__islice);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__islice);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__islice, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s_106);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s_106);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_106, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: from libc.math cimport exp, log</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: from libc.float cimport DBL_MIN, DBL_MAX</pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: from libc.limits cimport ULONG_MAX,LONG_MIN</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: from libcpp cimport bool</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line15")'> 15: from IBD.cIBD import cPairIBD</pre>
<pre id='line15' class='code' style='background-color: #FFFF41'>
  /* "LDModel.pyx":15
 * from libc.limits cimport ULONG_MAX,LONG_MIN
 * from libcpp cimport bool
 * from IBD.cIBD import cPairIBD             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from intersection import Interval, IntervalTree
 * from sys import stdout
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__cPairIBD));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__cPairIBD));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__cPairIBD));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_107), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__cPairIBD);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__cPairIBD);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__cPairIBD, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line16")'> 16: from intersection import Interval, IntervalTree</pre>
<pre id='line16' class='code' style='background-color: #FFFF2b'>
  /* "LDModel.pyx":16
 * from libcpp cimport bool
 * from IBD.cIBD import cPairIBD
 * from intersection import Interval, IntervalTree             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from sys import stdout
 * import scipy.misc
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Interval));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__Interval));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Interval));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__IntervalTree));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s__IntervalTree));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__IntervalTree));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__intersection), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__Interval);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Interval);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__Interval, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__IntervalTree);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__IntervalTree);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__IntervalTree, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line17")'> 17: from sys import stdout</pre>
<pre id='line17' class='code' style='background-color: #FFFF41'>
  /* "LDModel.pyx":17
 * from IBD.cIBD import cPairIBD
 * from intersection import Interval, IntervalTree
 * from sys import stdout             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import scipy.misc
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__stdout));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__stdout));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__stdout));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__sys), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__stdout);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__stdout);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__stdout, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line18")'> 18: import scipy.misc</pre>
<pre id='line18' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":18
 * from intersection import Interval, IntervalTree
 * from sys import stdout
 * import scipy.misc             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef extern from "string.h":
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_108), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__scipy, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: </pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: cdef extern from "string.h":</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21:     char *strncpy(char *dest, char *src, size_t n)</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22:     int strlen(char *s)</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: </pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: cdef extern from "structs.h":</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     int c_isfinite(double x)</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26: </pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27:     cdef struct struct_state:</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:         double prob_em[2]</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29:         int out_trans_num</pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30:         int in_trans_num</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:         bool likely_allele</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32: </pre>
<pre id='line32' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33:     ctypedef struct_state state</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: </pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:     state create_state(double allele_0_prob, double allele_1_prob, int out_trans_num, int in_trans_num)</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36: </pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37:     cdef struct struct_transition:</pre>
<pre id='line37' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:         double prob</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39:         int next_node</pre>
<pre id='line39' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40: </pre>
<pre id='line40' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:     ctypedef struct_transition transition</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42: </pre>
<pre id='line42' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:     transition create_transition(double prob, int next_node)</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44: </pre>
<pre id='line44' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:     cdef struct struct_gen_map_entry:</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46:         double recomb_rate</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:         double genetic_dist</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48: </pre>
<pre id='line48' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49:     ctypedef struct_gen_map_entry gen_map_entry</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50: </pre>
<pre id='line50' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51:     gen_map_entry create_gen_map_entry(int position, double recomb_rate, double genetic_dist)</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: </pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:     bool get_likely_allele(state s)</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: </pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:     double logsumexp(double first, double second)</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56: </pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line57")'> 57: cdef read_until_blank_line(file_name, first_line = None):</pre>
<pre id='line57' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":57
 *     double logsumexp(double first, double second)
 * 
 * cdef read_until_blank_line(file_name, first_line = None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         buffer_size = 100
 *         blank_line = '\n'
 */

static PyObject *__pyx_f_7LDModel_read_until_blank_line(PyObject *__pyx_v_file_name, struct __pyx_opt_args_7LDModel_read_until_blank_line *__pyx_optional_args) {
  PyObject *__pyx_v_first_line = ((PyObject *)Py_None);
  long __pyx_v_buffer_size;
  PyObject *__pyx_v_blank_line = NULL;
  PyObject *__pyx_v_lines = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_until_blank_line", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("read_until_blank_line", __pyx_f[0], 57);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_first_line = __pyx_optional_args->first_line;
    }
  }

/* "LDModel.pyx":57
 *     double logsumexp(double first, double second)
 * 
 * cdef read_until_blank_line(file_name, first_line = None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         buffer_size = 100
 *         blank_line = '\n'
 */
struct __pyx_opt_args_7LDModel_read_until_blank_line {
  int __pyx_n;
  PyObject *first_line;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58:         buffer_size = 100</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":58
 * 
 * cdef read_until_blank_line(file_name, first_line = None):
 *         buffer_size = 100             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         blank_line = '\n'
 *         # read a buffer_size of lines from the file
 */
  __pyx_v_buffer_size = 100;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line59")'> 59:         blank_line = '\n'</pre>
<pre id='line59' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":59
 * cdef read_until_blank_line(file_name, first_line = None):
 *         buffer_size = 100
 *         blank_line = '\n'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # read a buffer_size of lines from the file
 *         if first_line == None:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
  __pyx_v_blank_line = ((PyObject *)__pyx_kp_s_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60:         # read a buffer_size of lines from the file</pre>
<pre id='line60' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line61")'> 61:         if first_line == None:</pre>
<pre id='line61' class='code' style='background-color: #FFFF79'>
  /* "LDModel.pyx":61
 *         blank_line = '\n'
 *         # read a buffer_size of lines from the file
 *         if first_line == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             lines = list(islice(file_name, buffer_size))
 *         else:
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_first_line, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line62")'> 62:             lines = list(islice(file_name, buffer_size))</pre>
<pre id='line62' class='code' style='background-color: #FFFF39'>
    /* "LDModel.pyx":62
 *         # read a buffer_size of lines from the file
 *         if first_line == None:
 *             lines = list(islice(file_name, buffer_size))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             lines = list(islice(file_name, first_line, buffer_size))
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__islice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_v_lines = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:         else:</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line64")'> 64:             lines = list(islice(file_name, first_line, buffer_size))</pre>
<pre id='line64' class='code' style='background-color: #FFFF37'>
    /* "LDModel.pyx":64
 *             lines = list(islice(file_name, buffer_size))
 *         else:
 *             lines = list(islice(file_name, first_line, buffer_size))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # read some more lines until a blank line is reached
 *         while True:
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__islice);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_first_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_first_line);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_first_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_v_lines = ((PyObject*)__pyx_t_4);
    __pyx_t_4 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65:         # read some more lines until a blank line is reached</pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66:         while True:</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":66
 *             lines = list(islice(file_name, first_line, buffer_size))
 *         # read some more lines until a blank line is reached
 *         while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             line = list(islice(file_name, 1))
 *             if not line:
 */
  while (1) {
    if (!1) break;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line67")'> 67:             line = list(islice(file_name, 1))</pre>
<pre id='line67' class='code' style='background-color: #FFFF3e'>
    /* "LDModel.pyx":67
 *         # read some more lines until a blank line is reached
 *         while True:
 *             line = list(islice(file_name, 1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if not line:
 *                 lines += [blank_line]
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__islice);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_line));
    __pyx_v_line = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line68")'> 68:             if not line:</pre>
<pre id='line68' class='code' style='background-color: #FFFFe7'>
    /* "LDModel.pyx":68
 *         while True:
 *             line = list(islice(file_name, 1))
 *             if not line:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 lines += [blank_line]
 *                 break
 */
    __pyx_t_2 = (((PyObject *)__pyx_v_line) != Py_None) && (<span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_line)) != 0);
    __pyx_t_5 = (!__pyx_t_2);
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line69")'> 69:                 lines += [blank_line]</pre>
<pre id='line69' class='code' style='background-color: #FFFF6a'>
      /* "LDModel.pyx":69
 *             line = list(islice(file_name, 1))
 *             if not line:
 *                 lines += [blank_line]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 *             lines += line
 */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_blank_line);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_blank_line);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_lines), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_lines));
      __pyx_v_lines = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:                 break</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":70
 *             if not line:
 *                 lines += [blank_line]
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             lines += line
 *             if line == [blank_line]:
 */
      goto __pyx_L5_break;
      goto __pyx_L6;
    }
    __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line71")'> 71:             lines += line</pre>
<pre id='line71' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":71
 *                 lines += [blank_line]
 *                 break
 *             lines += line             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if line == [blank_line]:
 *                 break
 */
    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_lines), ((PyObject *)__pyx_v_line));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_lines));
    __pyx_v_lines = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line72")'> 72:             if line == [blank_line]:</pre>
<pre id='line72' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":72
 *                 break
 *             lines += line
 *             if line == [blank_line]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 *         return lines
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_blank_line);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_blank_line);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_line), ((PyObject *)__pyx_t_1), Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73:                 break</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":73
 *             lines += line
 *             if line == [blank_line]:
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return lines
 * 
 */
      goto __pyx_L5_break;
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  __pyx_L5_break:;
</pre><pre class='line' style='background-color: #FFFF0d' onclick='toggleDiv("line74")'> 74:         return lines</pre>
<pre id='line74' class='code' style='background-color: #FFFF0d'>
  /* "LDModel.pyx":74
 *             if line == [blank_line]:
 *                 break
 *         return lines             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class LDModel(object):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_lines));
  __pyx_r = ((PyObject *)__pyx_v_lines);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.read_until_blank_line", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blank_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_7LDModel_7LDModel_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7LDModel_7LDModel_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_map_file_name = 0;
  char *__pyx_v_log_dir;
  char *__pyx_v_log_prefix;
  int __pyx_v_k;
  int __pyx_v_g;
  int __pyx_v_win_size;
  int __pyx_v_max_snp_num;
  double __pyx_v_eps;
  double __pyx_v_min_score;
  PyObject *__pyx_v_phased = 0;
  bool __pyx_v_debug;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__map_file_name,&__pyx_n_s__log_dir,&__pyx_n_s__log_prefix,&__pyx_n_s__k,&__pyx_n_s__g,&__pyx_n_s__win_size,&__pyx_n_s__max_snp_num,&__pyx_n_s__eps,&__pyx_n_s__min_score,&__pyx_n_s__phased,&__pyx_n_s__debug,0};
    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    values[9] = __pyx_k_2;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__map_file_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__log_dir)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 3, 11, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__log_prefix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 3, 11, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__k);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__g);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_size);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__max_snp_num);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__eps);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__min_score);
          if (value) { values[8] = value; kw_args--; }
        }
        case  9:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__phased);
          if (value) { values[9] = value; kw_args--; }
        }
        case 10:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__debug);
          if (value) { values[10] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_map_file_name = values[0];
    __pyx_v_log_dir = <span class='py_c_api'>PyBytes_AsString</span>(values[1]);<span class='error_goto'> if (unlikely((!__pyx_v_log_dir) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_log_prefix = <span class='py_c_api'>PyBytes_AsString</span>(values[2]);<span class='error_goto'> if (unlikely((!__pyx_v_log_prefix) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[3]) {
      __pyx_v_k = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_k == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_k = ((int)1);
    }
    if (values[4]) {
      __pyx_v_g = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_g == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_g = ((int)8);
    }
    if (values[5]) {
      __pyx_v_win_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_win_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_win_size = ((int)25);
    }
    if (values[6]) {
      __pyx_v_max_snp_num = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_max_snp_num == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_max_snp_num = ((int)1000000000);
    }
    if (values[7]) {
      __pyx_v_eps = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_eps == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75: </pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76: cdef class LDModel(object):</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'>
/* "LDModel.pyx":76
 *         return lines
 * 
 * cdef class LDModel(object):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     '''
 *     Hidden Markov Model for a single ancestral population
 */

struct __pyx_vtabstruct_7LDModel_LDModel {
  PyObject *(*set_ibd_trans_rate)(struct __pyx_obj_7LDModel_LDModel *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch);
  PyObject *(*set_alphas)(struct __pyx_obj_7LDModel_LDModel *, PyObject *, int __pyx_skip_dispatch);
  PyObject *(*set_chrs)(struct __pyx_obj_7LDModel_LDModel *, char *, char *, char *, char *, int __pyx_skip_dispatch);
  PyObject *(*generate_random_hap)(struct __pyx_obj_7LDModel_LDModel *, int, int __pyx_skip_dispatch);
  PyObject *(*calc_ibd_prior)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*calc_anc_trans)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*emission_prob_ibd_admx_mem_alloc)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*emission_prob_ibd_admx_mem_free)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*calc_emission_probs_ibd_admx)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*forward_probs_mem_alloc)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*forward_probs_mem_free)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*forward_probs_init)(struct __pyx_obj_7LDModel_LDModel *, int, bool);
  PyObject *(*calc_forward_probs_ibd_admx)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*scale_factors_mem_alloc)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*scale_factors_mem_free)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*scale_factors_init)(struct __pyx_obj_7LDModel_LDModel *, int, bool);
  PyObject *(*backward_probs_mem_alloc)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*backward_probs_init)(struct __pyx_obj_7LDModel_LDModel *, int, bool);
  PyObject *(*calc_backward_probs_ibd_admx)(struct __pyx_obj_7LDModel_LDModel *, int, bool, int __pyx_skip_dispatch);
  PyObject *(*top_level_alloc_mem)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*top_level_init)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*top_level_print)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*calc_top_level_forward_probs)(struct __pyx_obj_7LDModel_LDModel *, int, int, int __pyx_skip_dispatch);
  PyObject *(*calc_top_level_backward_probs)(struct __pyx_obj_7LDModel_LDModel *, int, int, int __pyx_skip_dispatch);
  PyObject *(*print_inner_probs)(struct __pyx_obj_7LDModel_LDModel *, PyObject *, bool, int __pyx_skip_dispatch);
  PyObject *(*calc_top_level_ems_probs_inner)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*calc_top_level_ems_probs)(struct __pyx_obj_7LDModel_LDModel *, int, int, int, int, int __pyx_skip_dispatch);
  PyObject *(*calc_post_probs)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*calc_top_level_viterbi)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*posterior_top_level_decoding)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  int (*start_snp)(struct __pyx_obj_7LDModel_LDModel *, int);
  int (*end_snp)(struct __pyx_obj_7LDModel_LDModel *, int);
  int (*start_position)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  int (*end_position)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  int (*get_position)(struct __pyx_obj_7LDModel_LDModel *, int, int __pyx_skip_dispatch);
  int (*get_num_windows)(struct __pyx_obj_7LDModel_LDModel *, int __pyx_skip_dispatch);
  PyObject *(*generate_composite_individuals)(struct __pyx_obj_7LDModel_LDModel *, PyObject *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_7LDModel_LDModel *__pyx_vtabptr_7LDModel_LDModel;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:     '''</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:     Hidden Markov Model for a single ancestral population</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79:     '''</pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80: </pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line81")'> 81:     def __cinit__(self, map_file_name, char* log_dir, char* log_prefix, int k=1, int g=8, int win_size=25, int max_snp_num=1000000000, double eps = 1e-4, double min_score = 0, phased=True, bool debug=False):</pre>
<pre id='line81' class='code' style='background-color: #FFFF39'>
      /* "LDModel.pyx":81
 *     '''
 * 
 *     def __cinit__(self, map_file_name, char* log_dir, char* log_prefix, int k=1, int g=8, int win_size=25, int max_snp_num=1000000000, double eps = 1e-4, double min_score = 0, phased=True, bool debug=False):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # total number of SNPs to be analyzed
 */
      __pyx_v_eps = ((double)1e-4);
    }
    if (values[8]) {
      __pyx_v_min_score = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_min_score == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_min_score = ((double)0.0);
    }
    __pyx_v_phased = values[9];
    if (values[10]) {
      __pyx_v_debug = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[10]);<span class='error_goto'> if (unlikely((__pyx_v_debug == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_debug = ((bool)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 3, 11, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel___cinit__(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_map_file_name, __pyx_v_log_dir, __pyx_v_log_prefix, __pyx_v_k, __pyx_v_g, __pyx_v_win_size, __pyx_v_max_snp_num, __pyx_v_eps, __pyx_v_min_score, __pyx_v_phased, __pyx_v_debug);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_7LDModel_7LDModel___cinit__(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_map_file_name, char *__pyx_v_log_dir, char *__pyx_v_log_prefix, int __pyx_v_k, int __pyx_v_g, int __pyx_v_win_size, int __pyx_v_max_snp_num, double __pyx_v_eps, double __pyx_v_min_score, PyObject *__pyx_v_phased, bool __pyx_v_debug) {
  PyObject *__pyx_v_map_file = NULL;
  PyObject *__pyx_v_data = NULL;
  int __pyx_v_i;
  int __pyx_v_win_idx;
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__cinit__", __pyx_f[0], 81);

  /* "LDModel.pyx":81
 *     '''
 * 
 *     def __cinit__(self, map_file_name, char* log_dir, char* log_prefix, int k=1, int g=8, int win_size=25, int max_snp_num=1000000000, double eps = 1e-4, double min_score = 0, phased=True, bool debug=False):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # total number of SNPs to be analyzed
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_2 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: </pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:         # total number of SNPs to be analyzed</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line84")'> 84:         with open(map_file_name) as map_file:</pre>
<pre id='line84' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":84
 * 
 *         # total number of SNPs to be analyzed
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             data = map_file.readlines()
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num
 */
  /*with:*/ {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_map_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_map_file_name);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          __pyx_v_map_file = __pyx_t_4;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;

        /* "LDModel.pyx":84
 * 
 *         # total number of SNPs to be analyzed
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             data = map_file.readlines()
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_2, &__pyx_t_4, &__pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_4);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, __pyx_t_11, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_12 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(__pyx_t_12 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          __pyx_t_14 = (!__pyx_t_12);
          if (__pyx_t_14) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);
            __pyx_t_2 = 0; __pyx_t_4 = 0; __pyx_t_1 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
            goto __pyx_L18;
          }
          __pyx_L18:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        __pyx_L14_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_3) {
        __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, __pyx_k_tuple_3, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_7))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_14 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(__pyx_t_14 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L19;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L1_error;
    __pyx_L19:;
  }

  /* "LDModel.pyx":84
 * 
 *         # total number of SNPs to be analyzed
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             data = map_file.readlines()
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num
 */
  __pyx_k_tuple_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_3, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_3, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_3, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_3));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line85")'> 85:             data = map_file.readlines()</pre>
<pre id='line85' class='code' style='background-color: #FFFF79'>
          /* "LDModel.pyx":85
 *         # total number of SNPs to be analyzed
 *         with open(map_file_name) as map_file:
 *             data = map_file.readlines()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num
 * 
 */
          __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_map_file, __pyx_n_s__readlines);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_v_data = __pyx_t_2;
          __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line86")'> 86:             self._snp_num = len(data) if len(data) &lt;= max_snp_num else max_snp_num</pre>
<pre id='line86' class='code' style='background-color: #FFFF62'>
          /* "LDModel.pyx":86
 *         with open(map_file_name) as map_file:
 *             data = map_file.readlines()
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self.eps = eps
 */
          __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          if ((__pyx_t_9 <code><</code>= __pyx_v_max_snp_num)) {
            __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
            __pyx_t_8 = __pyx_t_10;
          } else {
            __pyx_t_8 = __pyx_v_max_snp_num;
          }
          __pyx_v_self->_snp_num = __pyx_t_8;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L14_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87: </pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:         self.eps = eps</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":88
 *             self._snp_num = len(data) if len(data) <code><</code>= max_snp_num else max_snp_num
 * 
 *         self.eps = eps             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._min_score = min_score
 */
  __pyx_v_self->eps = __pyx_v_eps;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:         self._min_score = min_score</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":90
 *         self.eps = eps
 * 
 *         self._min_score = min_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # number of haplotypes to analyze
 */
  __pyx_v_self->_min_score = __pyx_v_min_score;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91: </pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:         # number of haplotypes to analyze</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:         self._nr_haplos = 0</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":93
 * 
 *         # number of haplotypes to analyze
 *         self._nr_haplos = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # number of ancestral populations
 */
  __pyx_v_self->_nr_haplos = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94: </pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:         # number of ancestral populations</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:         self.K = k</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":96
 * 
 *         # number of ancestral populations
 *         self.K = k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # number of generations since admixture began
 */
  __pyx_v_self->K = __pyx_v_k;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97: </pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:         # number of generations since admixture began</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:         self.g = g</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":99
 * 
 *         # number of generations since admixture began
 *         self.g = g             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # window size (in number of consecutive SNPs).
 */
  __pyx_v_self->g = __pyx_v_g;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100: </pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101:         # window size (in number of consecutive SNPs).</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102:         # Inside each window, the ancestral origin of each haplotype is assumed to be unique,</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:         # that is - transitions from one ancestry to the other are only allowd between consecutive windows</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:         self._win_size = win_size</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":104
 *         # Inside each window, the ancestral origin of each haplotype is assumed to be unique,
 *         # that is - transitions from one ancestry to the other are only allowd between consecutive windows
 *         self._win_size = win_size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._log_dir = log_dir
 */
  __pyx_v_self->_win_size = __pyx_v_win_size;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105: </pre>
<pre id='line105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106:         self._log_dir = log_dir</pre>
<pre id='line106' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":106
 *         self._win_size = win_size
 * 
 *         self._log_dir = log_dir             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._log_prefix = log_prefix
 */
  __pyx_v_self->_log_dir = __pyx_v_log_dir;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107: </pre>
<pre id='line107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:         self._log_prefix = log_prefix</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":108
 *         self._log_dir = log_dir
 * 
 *         self._log_prefix = log_prefix             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._debug = debug
 */
  __pyx_v_self->_log_prefix = __pyx_v_log_prefix;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109: </pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110:         self._debug = debug</pre>
<pre id='line110' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":110
 *         self._log_prefix = log_prefix
 * 
 *         self._debug = debug             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._phased = phased
 */
  __pyx_v_self->_debug = __pyx_v_debug;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111: </pre>
<pre id='line111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line112")'> 112:         self._phased = phased</pre>
<pre id='line112' class='code' style='background-color: #FFFF7f'>
  /* "LDModel.pyx":112
 *         self._debug = debug
 * 
 *         self._phased = phased             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # rate of transition from IBD to No-IBD and vice-versa (notation from the Browning paper)
 */
  __pyx_t_15 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_phased);<span class='error_goto'> if (unlikely((__pyx_t_15 == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_phased = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113: </pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114:         # rate of transition from IBD to No-IBD and vice-versa (notation from the Browning paper)</pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115:         self._t_0_1 = &lt;double *&gt; malloc(self.K * sizeof(double))</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":115
 * 
 *         # rate of transition from IBD to No-IBD and vice-versa (notation from the Browning paper)
 *         self._t_0_1 = <code><</code>double *> malloc(self.K * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._t_1_0 = <code><</code>double *> malloc(self.K * sizeof(double))
 *         for i in range(self.K):
 */
  __pyx_v_self->_t_0_1 = ((double *)malloc((__pyx_v_self->K * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:         self._t_1_0 = &lt;double *&gt; malloc(self.K * sizeof(double))</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":116
 *         # rate of transition from IBD to No-IBD and vice-versa (notation from the Browning paper)
 *         self._t_0_1 = <code><</code>double *> malloc(self.K * sizeof(double))
 *         self._t_1_0 = <code><</code>double *> malloc(self.K * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.K):
 *             self._t_0_1[i] = 1e-5
 */
  __pyx_v_self->_t_1_0 = ((double *)malloc((__pyx_v_self->K * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:         for i in range(self.K):</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":117
 *         self._t_0_1 = <code><</code>double *> malloc(self.K * sizeof(double))
 *         self._t_1_0 = <code><</code>double *> malloc(self.K * sizeof(double))
 *         for i in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._t_0_1[i] = 1e-5
 *             self._t_1_0[i] = 1
 */
  __pyx_t_16 = __pyx_v_self->K;
  for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118:             self._t_0_1[i] = 1e-5</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":118
 *         self._t_1_0 = <code><</code>double *> malloc(self.K * sizeof(double))
 *         for i in range(self.K):
 *             self._t_0_1[i] = 1e-5             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._t_1_0[i] = 1
 * 
 */
    (__pyx_v_self->_t_0_1[__pyx_v_i]) = 1e-5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:             self._t_1_0[i] = 1</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":119
 *         for i in range(self.K):
 *             self._t_0_1[i] = 1e-5
 *             self._t_1_0[i] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # prior probability of IBD
 */
    (__pyx_v_self->_t_1_0[__pyx_v_i]) = 1.0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120: </pre>
<pre id='line120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121:         # prior probability of IBD</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:         self._ibd_prior = &lt;double **&gt; malloc(self.K * sizeof(double*))</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":122
 * 
 *         # prior probability of IBD
 *         self._ibd_prior = <code><</code>double **> malloc(self.K * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.K):
 *             self._ibd_prior[i] = <code><</code>double *> malloc(2 * sizeof(double))
 */
  __pyx_v_self->_ibd_prior = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:         for i in range(self.K):</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":123
 *         # prior probability of IBD
 *         self._ibd_prior = <code><</code>double **> malloc(self.K * sizeof(double*))
 *         for i in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibd_prior[i] = <code><</code>double *> malloc(2 * sizeof(double))
 *             self._ibd_prior[i][1] = self._t_0_1[i] / (self._t_0_1[i] + self._t_1_0[i])
 */
  __pyx_t_16 = __pyx_v_self->K;
  for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124:             self._ibd_prior[i] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line124' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":124
 *         self._ibd_prior = <code><</code>double **> malloc(self.K * sizeof(double*))
 *         for i in range(self.K):
 *             self._ibd_prior[i] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibd_prior[i][1] = self._t_0_1[i] / (self._t_0_1[i] + self._t_1_0[i])
 *             self._ibd_prior[i][0] = 1-self._ibd_prior[i][1]
 */
    (__pyx_v_self->_ibd_prior[__pyx_v_i]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line125")'> 125:             self._ibd_prior[i][1] = self._t_0_1[i] / (self._t_0_1[i] + self._t_1_0[i])</pre>
<pre id='line125' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":125
 *         for i in range(self.K):
 *             self._ibd_prior[i] = <code><</code>double *> malloc(2 * sizeof(double))
 *             self._ibd_prior[i][1] = self._t_0_1[i] / (self._t_0_1[i] + self._t_1_0[i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibd_prior[i][0] = 1-self._ibd_prior[i][1]
 * 
 */
    __pyx_t_18 = ((__pyx_v_self->_t_0_1[__pyx_v_i]) + (__pyx_v_self->_t_1_0[__pyx_v_i]));
    if (unlikely(__pyx_t_18 == 0)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    ((__pyx_v_self->_ibd_prior[__pyx_v_i])[1]) = ((__pyx_v_self->_t_0_1[__pyx_v_i]) / __pyx_t_18);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126:             self._ibd_prior[i][0] = 1-self._ibd_prior[i][1]</pre>
<pre id='line126' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":126
 *             self._ibd_prior[i] = <code><</code>double *> malloc(2 * sizeof(double))
 *             self._ibd_prior[i][1] = self._t_0_1[i] / (self._t_0_1[i] + self._t_1_0[i])
 *             self._ibd_prior[i][0] = 1-self._ibd_prior[i][1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # proportions of ancestry from each ancestral populations
 */
    ((__pyx_v_self->_ibd_prior[__pyx_v_i])[0]) = (1.0 - ((__pyx_v_self->_ibd_prior[__pyx_v_i])[1]));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127: </pre>
<pre id='line127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128:         # proportions of ancestry from each ancestral populations</pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:         self._alphas = &lt;double *&gt; malloc(self.K * sizeof(double))</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":129
 * 
 *         # proportions of ancestry from each ancestral populations
 *         self._alphas = <code><</code>double *> malloc(self.K * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.K):
 *             self._alphas[i] = (1.0/self.K)
 */
  __pyx_v_self->_alphas = ((double *)malloc((__pyx_v_self->K * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:         for i in range(self.K):</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":130
 *         # proportions of ancestry from each ancestral populations
 *         self._alphas = <code><</code>double *> malloc(self.K * sizeof(double))
 *         for i in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._alphas[i] = (1.0/self.K)
 * 
 */
  __pyx_t_16 = __pyx_v_self->K;
  for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line131")'> 131:             self._alphas[i] = (1.0/self.K)</pre>
<pre id='line131' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":131
 *         self._alphas = <code><</code>double *> malloc(self.K * sizeof(double))
 *         for i in range(self.K):
 *             self._alphas[i] = (1.0/self.K)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # allocate memory
 */
    if (unlikely(__pyx_v_self->K == 0)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    (__pyx_v_self->_alphas[__pyx_v_i]) = (1.0 / ((double)__pyx_v_self->K));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132: </pre>
<pre id='line132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133:         # allocate memory</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:         self._snp_ids = &lt;char **&gt; malloc(self._snp_num * sizeof(char *))</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":134
 * 
 *         # allocate memory
 *         self._snp_ids = <code><</code>char **> malloc(self._snp_num * sizeof(char *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._position = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *         self._genetic_dist = <code><</code>double *> malloc(self._snp_num * sizeof(double))
 */
  __pyx_v_self->_snp_ids = ((char **)malloc((__pyx_v_self->_snp_num * (sizeof(char *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135:         self._position = &lt;int *&gt; malloc(self._snp_num * sizeof(int))</pre>
<pre id='line135' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":135
 *         # allocate memory
 *         self._snp_ids = <code><</code>char **> malloc(self._snp_num * sizeof(char *))
 *         self._position = <code><</code>int *> malloc(self._snp_num * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._genetic_dist = <code><</code>double *> malloc(self._snp_num * sizeof(double))
 *         self._states = <code><</code>state ***> malloc(self.K * sizeof(state **))
 */
  __pyx_v_self->_position = ((int *)malloc((__pyx_v_self->_snp_num * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:         self._genetic_dist = &lt;double *&gt; malloc(self._snp_num * sizeof(double))</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":136
 *         self._snp_ids = <code><</code>char **> malloc(self._snp_num * sizeof(char *))
 *         self._position = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *         self._genetic_dist = <code><</code>double *> malloc(self._snp_num * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._states = <code><</code>state ***> malloc(self.K * sizeof(state **))
 *         self._pi = <code><</code>double ***> malloc(self.K * sizeof(double **))
 */
  __pyx_v_self->_genetic_dist = ((double *)malloc((__pyx_v_self->_snp_num * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137:         self._states = &lt;state ***&gt; malloc(self.K * sizeof(state **))</pre>
<pre id='line137' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":137
 *         self._position = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *         self._genetic_dist = <code><</code>double *> malloc(self._snp_num * sizeof(double))
 *         self._states = <code><</code>state ***> malloc(self.K * sizeof(state **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._pi = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *         self._layer_state_nums = <code><</code>int **> malloc(self.K * sizeof(int*))
 */
  __pyx_v_self->_states = ((state ***)malloc((__pyx_v_self->K * (sizeof(state **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138:         self._pi = &lt;double ***&gt; malloc(self.K * sizeof(double **))</pre>
<pre id='line138' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":138
 *         self._genetic_dist = <code><</code>double *> malloc(self._snp_num * sizeof(double))
 *         self._states = <code><</code>state ***> malloc(self.K * sizeof(state **))
 *         self._pi = <code><</code>double ***> malloc(self.K * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._layer_state_nums = <code><</code>int **> malloc(self.K * sizeof(int*))
 *         self._trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
  __pyx_v_self->_pi = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139:         self._layer_state_nums = &lt;int **&gt; malloc(self.K * sizeof(int*))</pre>
<pre id='line139' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":139
 *         self._states = <code><</code>state ***> malloc(self.K * sizeof(state **))
 *         self._pi = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *         self._layer_state_nums = <code><</code>int **> malloc(self.K * sizeof(int*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 */
  __pyx_v_self->_layer_state_nums = ((int **)malloc((__pyx_v_self->K * (sizeof(int *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:         self._trans = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":140
 *         self._pi = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *         self._layer_state_nums = <code><</code>int **> malloc(self.K * sizeof(int*))
 *         self._trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         self._back_trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
  __pyx_v_self->_trans = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141:         self._trans_idx = &lt;int ****&gt; malloc(self.K * sizeof(int ***))</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":141
 *         self._layer_state_nums = <code><</code>int **> malloc(self.K * sizeof(int*))
 *         self._trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._back_trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._back_trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 */
  __pyx_v_self->_trans_idx = ((int ****)malloc((__pyx_v_self->K * (sizeof(int ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142:         self._back_trans = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line142' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":142
 *         self._trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         self._back_trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._back_trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         for i in range(self.K):
 */
  __pyx_v_self->_back_trans = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:         self._back_trans_idx = &lt;int ****&gt; malloc(self.K * sizeof(int ***))</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":143
 *         self._trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         self._back_trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._back_trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.K):
 *             self._states[i] = <code><</code>state **> malloc(self._snp_num * sizeof(state **))
 */
  __pyx_v_self->_back_trans_idx = ((int ****)malloc((__pyx_v_self->K * (sizeof(int ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144:         for i in range(self.K):</pre>
<pre id='line144' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":144
 *         self._back_trans = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         self._back_trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         for i in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._states[i] = <code><</code>state **> malloc(self._snp_num * sizeof(state **))
 *             self._layer_state_nums[i] = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 */
  __pyx_t_16 = __pyx_v_self->K;
  for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145:             self._states[i] = &lt;state **&gt; malloc(self._snp_num * sizeof(state **))</pre>
<pre id='line145' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":145
 *         self._back_trans_idx = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *         for i in range(self.K):
 *             self._states[i] = <code><</code>state **> malloc(self._snp_num * sizeof(state **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._layer_state_nums[i] = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *             self._trans[i] = <code><</code>double ***> malloc((self._snp_num-1) * sizeof(double **))
 */
    (__pyx_v_self->_states[__pyx_v_i]) = ((state **)malloc((__pyx_v_self->_snp_num * (sizeof(state **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:             self._layer_state_nums[i] = &lt;int *&gt; malloc(self._snp_num * sizeof(int))</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":146
 *         for i in range(self.K):
 *             self._states[i] = <code><</code>state **> malloc(self._snp_num * sizeof(state **))
 *             self._layer_state_nums[i] = <code><</code>int *> malloc(self._snp_num * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._trans[i] = <code><</code>double ***> malloc((self._snp_num-1) * sizeof(double **))
 *             self._trans_idx[i] = <code><</code>int ***> malloc((self._snp_num-1) * sizeof(int **))
 */
    (__pyx_v_self->_layer_state_nums[__pyx_v_i]) = ((int *)malloc((__pyx_v_self->_snp_num * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:             self._trans[i] = &lt;double ***&gt; malloc((self._snp_num-1) * sizeof(double **))</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":147
 *             self._states[i] = <code><</code>state **> malloc(self._snp_num * sizeof(state **))
 *             self._layer_state_nums[i] = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *             self._trans[i] = <code><</code>double ***> malloc((self._snp_num-1) * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._trans_idx[i] = <code><</code>int ***> malloc((self._snp_num-1) * sizeof(int **))
 *             self._back_trans[i] = <code><</code>double ***> malloc((self._snp_num) * sizeof(double **))
 */
    (__pyx_v_self->_trans[__pyx_v_i]) = ((double ***)malloc(((__pyx_v_self->_snp_num - 1) * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:             self._trans_idx[i] = &lt;int ***&gt; malloc((self._snp_num-1) * sizeof(int **))</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":148
 *             self._layer_state_nums[i] = <code><</code>int *> malloc(self._snp_num * sizeof(int))
 *             self._trans[i] = <code><</code>double ***> malloc((self._snp_num-1) * sizeof(double **))
 *             self._trans_idx[i] = <code><</code>int ***> malloc((self._snp_num-1) * sizeof(int **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._back_trans[i] = <code><</code>double ***> malloc((self._snp_num) * sizeof(double **))
 *             self._back_trans_idx[i] = <code><</code>int ***> malloc((self._snp_num) * sizeof(int **))
 */
    (__pyx_v_self->_trans_idx[__pyx_v_i]) = ((int ***)malloc(((__pyx_v_self->_snp_num - 1) * (sizeof(int **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:             self._back_trans[i] = &lt;double ***&gt; malloc((self._snp_num) * sizeof(double **))</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":149
 *             self._trans[i] = <code><</code>double ***> malloc((self._snp_num-1) * sizeof(double **))
 *             self._trans_idx[i] = <code><</code>int ***> malloc((self._snp_num-1) * sizeof(int **))
 *             self._back_trans[i] = <code><</code>double ***> malloc((self._snp_num) * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._back_trans_idx[i] = <code><</code>int ***> malloc((self._snp_num) * sizeof(int **))
 *             self._pi[i] = <code><</code>double **> malloc(self.get_num_windows() * sizeof(double *))
 */
    (__pyx_v_self->_back_trans[__pyx_v_i]) = ((double ***)malloc((__pyx_v_self->_snp_num * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150:             self._back_trans_idx[i] = &lt;int ***&gt; malloc((self._snp_num) * sizeof(int **))</pre>
<pre id='line150' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":150
 *             self._trans_idx[i] = <code><</code>int ***> malloc((self._snp_num-1) * sizeof(int **))
 *             self._back_trans[i] = <code><</code>double ***> malloc((self._snp_num) * sizeof(double **))
 *             self._back_trans_idx[i] = <code><</code>int ***> malloc((self._snp_num) * sizeof(int **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._pi[i] = <code><</code>double **> malloc(self.get_num_windows() * sizeof(double *))
 * 
 */
    (__pyx_v_self->_back_trans_idx[__pyx_v_i]) = ((int ***)malloc((__pyx_v_self->_snp_num * (sizeof(int **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:             self._pi[i] = &lt;double **&gt; malloc(self.get_num_windows() * sizeof(double *))</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":151
 *             self._back_trans[i] = <code><</code>double ***> malloc((self._snp_num) * sizeof(double **))
 *             self._back_trans_idx[i] = <code><</code>int ***> malloc((self._snp_num) * sizeof(int **))
 *             self._pi[i] = <code><</code>double **> malloc(self.get_num_windows() * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #self._genetic_map = <code><</code>gen_map_entry *> malloc(self._snp_num * sizeof(gen_map_entry))
 */
    (__pyx_v_self->_pi[__pyx_v_i]) = ((double **)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double *)))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152: </pre>
<pre id='line152' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153:         #self._genetic_map = &lt;gen_map_entry *&gt; malloc(self._snp_num * sizeof(gen_map_entry))</pre>
<pre id='line153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:         #print "allocated mem"</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155:         #for snp_idx in range(self._snp_num):</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156:         #    self._genetic_map[snp_idx] = create_gen_map_entry(snp_idx,1.63936,0.0010840)</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157: </pre>
<pre id='line157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158:         if self._debug:</pre>
<pre id='line158' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":158
 *         #    self._genetic_map[snp_idx] = create_gen_map_entry(snp_idx,1.63936,0.0010840)
 * 
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "DEBUG!"
 *             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line159")'> 159:             print "DEBUG!"</pre>
<pre id='line159' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":159
 * 
 *         if self._debug:
 *             print "DEBUG!"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")
 *             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_4)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line160")'> 160:             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")</pre>
<pre id='line160' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":160
 *         if self._debug:
 *             print "DEBUG!"
 *             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")
 *             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_6));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_inner_probs_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_inner_probs_file);
    __pyx_v_self->_inner_probs_file = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line161")'> 161:             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")</pre>
<pre id='line161' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":161
 *             print "DEBUG!"
 *             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")
 *             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")
 *             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_kp_s_7));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_probs_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_probs_file);
    __pyx_v_self->_probs_file = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line162")'> 162:             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")</pre>
<pre id='line162' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":162
 *             self._inner_probs_file = open(self._log_dir+"/"+self._log_prefix+".inner.probs.txt","w")
 *             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")
 *             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")
 *             self._ibs_file = open(self._log_dir+"/"+self._log_prefix+".ibs.txt","w")
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_8));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_trans_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_trans_file);
    __pyx_v_self->_trans_file = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line163")'> 163:             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")</pre>
<pre id='line163' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":163
 *             self._probs_file = open(self._log_dir+"/"+self._log_prefix+".probs.txt","w")
 *             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")
 *             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file = open(self._log_dir+"/"+self._log_prefix+".ibs.txt","w")
 *             self._breakpoints_file = open(self._log_dir+"/"+self._log_prefix+".breakpoints.txt","w")
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_kp_s_9));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_ems_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_ems_file);
    __pyx_v_self->_ems_file = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line164")'> 164:             self._ibs_file = open(self._log_dir+"/"+self._log_prefix+".ibs.txt","w")</pre>
<pre id='line164' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":164
 *             self._trans_file = open(self._log_dir+"/"+self._log_prefix+".trans.txt","w")
 *             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")
 *             self._ibs_file = open(self._log_dir+"/"+self._log_prefix+".ibs.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._breakpoints_file = open(self._log_dir+"/"+self._log_prefix+".breakpoints.txt","w")
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_ibs_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_ibs_file);
    __pyx_v_self->_ibs_file = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line165")'> 165:             self._breakpoints_file = open(self._log_dir+"/"+self._log_prefix+".breakpoints.txt","w")</pre>
<pre id='line165' class='code' style='background-color: #FFFF2f'>
    /* "LDModel.pyx":165
 *             self._ems_file = open(self._log_dir+"/"+self._log_prefix+".ems.txt","w")
 *             self._ibs_file = open(self._log_dir+"/"+self._log_prefix+".ibs.txt","w")
 *             self._breakpoints_file = open(self._log_dir+"/"+self._log_prefix+".breakpoints.txt","w")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 */
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_dir);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_log_prefix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, ((PyObject *)__pyx_kp_s_11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_breakpoints_file);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_breakpoints_file);
    __pyx_v_self->_breakpoints_file = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L28;
  }
  __pyx_L28:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166: </pre>
<pre id='line166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:         self._ibs = &lt;bool *&gt; malloc(self.get_num_windows() * sizeof(bool))</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":167
 *             self._breakpoints_file = open(self._log_dir+"/"+self._log_prefix+".breakpoints.txt","w")
 * 
 *         self._ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ibd_segment_start = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         self._ibd_segment_end = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 */
  __pyx_v_self->_ibs = ((bool *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line168")'> 168:         self._ibd_segment_start = &lt;bool *&gt; malloc(self.get_num_windows() * sizeof(bool))</pre>
<pre id='line168' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":168
 * 
 *         self._ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         self._ibd_segment_start = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ibd_segment_end = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):
 */
  __pyx_v_self->_ibd_segment_start = ((bool *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169:         self._ibd_segment_end = &lt;bool *&gt; malloc(self.get_num_windows() * sizeof(bool))</pre>
<pre id='line169' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":169
 *         self._ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         self._ibd_segment_start = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         self._ibd_segment_end = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             self._ibs[win_idx] = True
 */
  __pyx_v_self->_ibd_segment_end = ((bool *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line170' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":170
 *         self._ibd_segment_start = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         self._ibd_segment_end = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs[win_idx] = True
 *             self._ibd_segment_start[win_idx] = False
 */
  __pyx_t_16 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
    __pyx_v_win_idx = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171:             self._ibs[win_idx] = True</pre>
<pre id='line171' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":171
 *         self._ibd_segment_end = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):
 *             self._ibs[win_idx] = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibd_segment_start[win_idx] = False
 *             self._ibd_segment_end[win_idx] = False
 */
    (__pyx_v_self->_ibs[__pyx_v_win_idx]) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172:             self._ibd_segment_start[win_idx] = False</pre>
<pre id='line172' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":172
 *         for win_idx in range(self.get_num_windows()):
 *             self._ibs[win_idx] = True
 *             self._ibd_segment_start[win_idx] = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibd_segment_end[win_idx] = False
 * 
 */
    (__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx]) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173:             self._ibd_segment_end[win_idx] = False</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":173
 *             self._ibs[win_idx] = True
 *             self._ibd_segment_start[win_idx] = False
 *             self._ibd_segment_end[win_idx] = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._exact_ibd_starts = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))
 */
    (__pyx_v_self->_ibd_segment_end[__pyx_v_win_idx]) = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174: </pre>
<pre id='line174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:         self._exact_ibd_starts = &lt;int *&gt; malloc(self.get_num_windows() * sizeof(int))</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":175
 *             self._ibd_segment_end[win_idx] = False
 * 
 *         self._exact_ibd_starts = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._exact_ibd_ends = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))
 * 
 */
  __pyx_v_self->_exact_ibd_starts = ((int *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176:         self._exact_ibd_ends = &lt;int *&gt; malloc(self.get_num_windows() * sizeof(int))</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":176
 * 
 *         self._exact_ibd_starts = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))
 *         self._exact_ibd_ends = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 */
  __pyx_v_self->_exact_ibd_ends = ((int *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177: </pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178:         self._ibd_probs = &lt;double *&gt; malloc(self.get_num_windows() * sizeof(double))</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":178
 *         self._exact_ibd_ends = <code><</code>int *> malloc(self.get_num_windows() * sizeof(int))
 * 
 *         self._ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._no_ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 *         self._lod_scores = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 */
  __pyx_v_self->_ibd_probs = ((double *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179:         self._no_ibd_probs = &lt;double *&gt; malloc(self.get_num_windows() * sizeof(double))</pre>
<pre id='line179' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":179
 * 
 *         self._ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 *         self._no_ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._lod_scores = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 * 
 */
  __pyx_v_self->_no_ibd_probs = ((double *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:         self._lod_scores = &lt;double *&gt; malloc(self.get_num_windows() * sizeof(double))</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":180
 *         self._ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 *         self._no_ibd_probs = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 *         self._lod_scores = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._chr1 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 */
  __pyx_v_self->_lod_scores = ((double *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181: </pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:         self._chr1 = &lt;bool *&gt; malloc(self._snp_num * sizeof(bool))</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":182
 *         self._lod_scores = <code><</code>double *> malloc(self.get_num_windows() * sizeof(double))
 * 
 *         self._chr1 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._chr2 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr3 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 */
  __pyx_v_self->_chr1 = ((bool *)malloc((__pyx_v_self->_snp_num * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183:         self._chr2 = &lt;bool *&gt; malloc(self._snp_num * sizeof(bool))</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":183
 * 
 *         self._chr1 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr2 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._chr3 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr4 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 */
  __pyx_v_self->_chr2 = ((bool *)malloc((__pyx_v_self->_snp_num * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:         self._chr3 = &lt;bool *&gt; malloc(self._snp_num * sizeof(bool))</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":184
 *         self._chr1 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr2 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr3 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._chr4 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 * 
 */
  __pyx_v_self->_chr3 = ((bool *)malloc((__pyx_v_self->_snp_num * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185:         self._chr4 = &lt;bool *&gt; malloc(self._snp_num * sizeof(bool))</pre>
<pre id='line185' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":185
 *         self._chr2 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr3 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 *         self._chr4 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self.read_map(map_file_name)
 */
  __pyx_v_self->_chr4 = ((bool *)malloc((__pyx_v_self->_snp_num * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186: </pre>
<pre id='line186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line187")'> 187:         self.read_map(map_file_name)</pre>
<pre id='line187' class='code' style='background-color: #FFFF3c'>
  /* "LDModel.pyx":187
 *         self._chr4 = <code><</code>bool *> malloc(self._snp_num * sizeof(bool))
 * 
 *         self.read_map(map_file_name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__read_map);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_map_file_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_map_file_name);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_map_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_7LDModel_7LDModel_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_7LDModel_7LDModel_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_7LDModel_7LDModel_2__dealloc__(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188: </pre>
<pre id='line188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line189")'> 189:     def __dealloc__(self):</pre>
<pre id='line189' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":189
 *         self.read_map(map_file_name)
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._debug:
 *             self._inner_probs_file.close()
 */

static void __pyx_pf_7LDModel_7LDModel_2__dealloc__(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__dealloc__", __pyx_f[0], 189);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190:         if self._debug:</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":190
 * 
 *     def __dealloc__(self):
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file.close()
 *             self._probs_file.close()
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line191")'> 191:             self._inner_probs_file.close()</pre>
<pre id='line191' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":191
 *     def __dealloc__(self):
 *         if self._debug:
 *             self._inner_probs_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._probs_file.close()
 *             self._trans_file.close()
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line192")'> 192:             self._probs_file.close()</pre>
<pre id='line192' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":192
 *         if self._debug:
 *             self._inner_probs_file.close()
 *             self._probs_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._trans_file.close()
 *             self._ems_file.close()
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_probs_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line193")'> 193:             self._trans_file.close()</pre>
<pre id='line193' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":193
 *             self._inner_probs_file.close()
 *             self._probs_file.close()
 *             self._trans_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ems_file.close()
 *             self._ibs_file.close()
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_trans_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line194")'> 194:             self._ems_file.close()</pre>
<pre id='line194' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":194
 *             self._probs_file.close()
 *             self._trans_file.close()
 *             self._ems_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.close()
 *             self._breakpoints_file.close()
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ems_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line195")'> 195:             self._ibs_file.close()</pre>
<pre id='line195' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":195
 *             self._trans_file.close()
 *             self._ems_file.close()
 *             self._ibs_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._breakpoints_file.close()
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line196")'> 196:             self._breakpoints_file.close()</pre>
<pre id='line196' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":196
 *             self._ems_file.close()
 *             self._ibs_file.close()
 *             self._breakpoints_file.close()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_breakpoints_file, __pyx_n_s__close);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197: </pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line198")'> 198:     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):</pre>
<pre id='line198' class='code' style='background-color: #FFFF36'>
/* "LDModel.pyx":198
 *             self._breakpoints_file.close()
 * 
 *     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._t_0_1[anc] = t_0_1
 *         self._t_1_0[anc] = t_1_0
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_5set_ibd_trans_rate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_set_ibd_trans_rate(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc, PyObject *__pyx_v_t_0_1, PyObject *__pyx_v_t_1_0, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibd_trans_rate", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_ibd_trans_rate", __pyx_f[0], 198);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__set_ibd_trans_rate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_5set_ibd_trans_rate)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_anc);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_anc);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_anc);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t_0_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_t_0_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_t_0_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t_1_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_t_1_0);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_t_1_0);
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":198
 *             self._breakpoints_file.close()
 * 
 *     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._t_0_1[anc] = t_0_1
 *         self._t_1_0[anc] = t_1_0
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_4set_ibd_trans_rate(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc, PyObject *__pyx_v_t_0_1, PyObject *__pyx_v_t_1_0) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibd_trans_rate", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_ibd_trans_rate", __pyx_f[0], 198);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->set_ibd_trans_rate(__pyx_v_self, __pyx_v_anc, __pyx_v_t_0_1, __pyx_v_t_1_0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibd_trans_rate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line199")'> 199:         self._t_0_1[anc] = t_0_1</pre>
<pre id='line199' class='code' style='background-color: #FFFF55'>
  /* "LDModel.pyx":199
 * 
 *     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):
 *         self._t_0_1[anc] = t_0_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._t_1_0[anc] = t_1_0
 * 
 */
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_t_0_1);<span class='error_goto'> if (unlikely((__pyx_t_4 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  (__pyx_v_self->_t_0_1[__pyx_t_5]) = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line200")'> 200:         self._t_1_0[anc] = t_1_0</pre>
<pre id='line200' class='code' style='background-color: #FFFF55'>
  /* "LDModel.pyx":200
 *     cpdef set_ibd_trans_rate(self, anc, t_0_1, t_1_0):
 *         self._t_0_1[anc] = t_0_1
 *         self._t_1_0[anc] = t_1_0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._ibd_prior[anc][1] = self._t_0_1[anc] / (self._t_0_1[anc] + self._t_1_0[anc])
 */
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_t_1_0);<span class='error_goto'> if (unlikely((__pyx_t_4 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  (__pyx_v_self->_t_1_0[__pyx_t_5]) = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201: </pre>
<pre id='line201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line202")'> 202:         self._ibd_prior[anc][1] = self._t_0_1[anc] / (self._t_0_1[anc] + self._t_1_0[anc])</pre>
<pre id='line202' class='code' style='background-color: #FFFF2e'>
  /* "LDModel.pyx":202
 *         self._t_1_0[anc] = t_1_0
 * 
 *         self._ibd_prior[anc][1] = self._t_0_1[anc] / (self._t_0_1[anc] + self._t_1_0[anc])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ibd_prior[anc][0] = 1-self._ibd_prior[anc][1]
 * 
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = ((__pyx_v_self->_t_0_1[__pyx_t_6]) + (__pyx_v_self->_t_1_0[__pyx_t_7]));
  if (unlikely(__pyx_t_4 == 0)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  ((__pyx_v_self->_ibd_prior[__pyx_t_7])[1]) = ((__pyx_v_self->_t_0_1[__pyx_t_5]) / __pyx_t_4);
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line203")'> 203:         self._ibd_prior[anc][0] = 1-self._ibd_prior[anc][1]</pre>
<pre id='line203' class='code' style='background-color: #FFFF1f'>
  /* "LDModel.pyx":203
 * 
 *         self._ibd_prior[anc][1] = self._t_0_1[anc] / (self._t_0_1[anc] + self._t_1_0[anc])
 *         self._ibd_prior[anc][0] = 1-self._ibd_prior[anc][1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef set_alphas(self, alphas):
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  ((__pyx_v_self->_ibd_prior[__pyx_t_7])[0]) = (1.0 - ((__pyx_v_self->_ibd_prior[__pyx_t_5])[1]));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibd_trans_rate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_5set_ibd_trans_rate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_5set_ibd_trans_rate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_anc = 0;
  PyObject *__pyx_v_t_0_1 = 0;
  PyObject *__pyx_v_t_1_0 = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibd_trans_rate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__anc,&__pyx_n_s__t_0_1,&__pyx_n_s__t_1_0,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__anc)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__t_0_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_ibd_trans_rate", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__t_1_0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_ibd_trans_rate", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_ibd_trans_rate") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_anc = values[0];
    __pyx_v_t_0_1 = values[1];
    __pyx_v_t_1_0 = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_ibd_trans_rate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibd_trans_rate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_4set_ibd_trans_rate(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_anc, __pyx_v_t_0_1, __pyx_v_t_1_0);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204: </pre>
<pre id='line204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line205")'> 205:     cpdef set_alphas(self, alphas):</pre>
<pre id='line205' class='code' style='background-color: #FFFF3b'>
/* "LDModel.pyx":205
 *         self._ibd_prior[anc][0] = 1-self._ibd_prior[anc][1]
 * 
 *     cpdef set_alphas(self, alphas):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if len(alphas) != self.K:
 *             print "wrong number of alphas"
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_7set_alphas(PyObject *__pyx_v_self, PyObject *__pyx_v_alphas); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_set_alphas(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_alphas, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_alphas", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_alphas", __pyx_f[0], 205);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__set_alphas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_7set_alphas)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alphas);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_alphas);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_alphas);
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":205
 *         self._ibd_prior[anc][0] = 1-self._ibd_prior[anc][1]
 * 
 *     cpdef set_alphas(self, alphas):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if len(alphas) != self.K:
 *             print "wrong number of alphas"
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_6set_alphas(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_alphas) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_alphas", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_alphas", __pyx_f[0], 205);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->set_alphas(__pyx_v_self, __pyx_v_alphas, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_alphas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line206")'> 206:         if len(alphas) != self.K:</pre>
<pre id='line206' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":206
 * 
 *     cpdef set_alphas(self, alphas):
 *         if len(alphas) != self.K:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "wrong number of alphas"
 *             return
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_alphas);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = (__pyx_t_4 != __pyx_v_self->K);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line207")'> 207:             print "wrong number of alphas"</pre>
<pre id='line207' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":207
 *     cpdef set_alphas(self, alphas):
 *         if len(alphas) != self.K:
 *             print "wrong number of alphas"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return
 *         for i in range(self.K):
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_12)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line208")'> 208:             return</pre>
<pre id='line208' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":208
 *         if len(alphas) != self.K:
 *             print "wrong number of alphas"
 *             return             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.K):
 *             self._alphas[i] = alphas[i]
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209:         for i in range(self.K):</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":209
 *             print "wrong number of alphas"
 *             return
 *         for i in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._alphas[i] = alphas[i]
 * 
 */
  __pyx_t_6 = __pyx_v_self->K;
  for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line210")'> 210:             self._alphas[i] = alphas[i]</pre>
<pre id='line210' class='code' style='background-color: #FFFF4d'>
    /* "LDModel.pyx":210
 *             return
 *         for i in range(self.K):
 *             self._alphas[i] = alphas[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef set_chrs(self, char* chr1, char* chr2, char* chr3, char* chr4):
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_alphas, __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    (__pyx_v_self->_alphas[__pyx_v_i]) = __pyx_t_8;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_alphas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_7set_alphas(PyObject *__pyx_v_self, PyObject *__pyx_v_alphas); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_7set_alphas(PyObject *__pyx_v_self, PyObject *__pyx_v_alphas) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_alphas (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_6set_alphas(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_alphas));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211: </pre>
<pre id='line211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line212")'> 212:     cpdef set_chrs(self, char* chr1, char* chr2, char* chr3, char* chr4):</pre>
<pre id='line212' class='code' style='background-color: #FFFF20'>
/* "LDModel.pyx":212
 *             self._alphas[i] = alphas[i]
 * 
 *     cpdef set_chrs(self, char* chr1, char* chr2, char* chr3, char* chr4):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for snp_idx in range(self._snp_num):
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_9set_chrs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_set_chrs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, char *__pyx_v_chr1, char *__pyx_v_chr2, char *__pyx_v_chr3, char *__pyx_v_chr4, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_chrs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_chrs", __pyx_f[0], 212);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__set_chrs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_9set_chrs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_chr1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      __pyx_t_3 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_chr2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      __pyx_t_4 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_chr3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
      __pyx_t_5 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_chr4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, ((PyObject *)__pyx_t_3));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, ((PyObject *)__pyx_t_4));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, ((PyObject *)__pyx_t_5));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_5));
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":212
 *             self._alphas[i] = alphas[i]
 * 
 *     cpdef set_chrs(self, char* chr1, char* chr2, char* chr3, char* chr4):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for snp_idx in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_8set_chrs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, char *__pyx_v_chr1, char *__pyx_v_chr2, char *__pyx_v_chr3, char *__pyx_v_chr4) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_chrs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_chrs", __pyx_f[0], 212);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->set_chrs(__pyx_v_self, __pyx_v_chr1, __pyx_v_chr2, __pyx_v_chr3, __pyx_v_chr4, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_chrs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_11set_prefix_string(PyObject *__pyx_v_self, PyObject *__pyx_arg_new_prefix_string); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_11set_prefix_string(PyObject *__pyx_v_self, PyObject *__pyx_arg_new_prefix_string) {
  char *__pyx_v_new_prefix_string;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_prefix_string (wrapper)", 0);
  assert(__pyx_arg_new_prefix_string); {
    __pyx_v_new_prefix_string = <span class='py_c_api'>PyBytes_AsString</span>(__pyx_arg_new_prefix_string);<span class='error_goto'> if (unlikely((!__pyx_v_new_prefix_string) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_prefix_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_10set_prefix_string(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((char *)__pyx_v_new_prefix_string));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213: </pre>
<pre id='line213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214:         for snp_idx in range(self._snp_num):</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":214
 *     cpdef set_chrs(self, char* chr1, char* chr2, char* chr3, char* chr4):
 * 
 *         for snp_idx in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr1[snp_idx])) == 0:
 *                 self._chr1[snp_idx] = 0
 */
  __pyx_t_7 = __pyx_v_self->_snp_num;
  for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_snp_idx = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line215")'> 215:             if int(chr(chr1[snp_idx])) == 0:</pre>
<pre id='line215' class='code' style='background-color: #FFFF32'>
    /* "LDModel.pyx":215
 * 
 *         for snp_idx in range(self._snp_num):
 *             if int(chr(chr1[snp_idx])) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._chr1[snp_idx] = 0
 *             else:
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr1[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216:                 self._chr1[snp_idx] = 0</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":216
 *         for snp_idx in range(self._snp_num):
 *             if int(chr(chr1[snp_idx])) == 0:
 *                 self._chr1[snp_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 if int(chr(chr1[snp_idx])) == 1:
 */
      (__pyx_v_self->_chr1[__pyx_v_snp_idx]) = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:             else:</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line218")'> 218:                 if int(chr(chr1[snp_idx])) == 1:</pre>
<pre id='line218' class='code' style='background-color: #FFFF32'>
      /* "LDModel.pyx":218
 *                 self._chr1[snp_idx] = 0
 *             else:
 *                 if int(chr(chr1[snp_idx])) == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._chr1[snp_idx] = 1
 *                 else:
 */
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr1[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219:                     self._chr1[snp_idx] = 1</pre>
<pre id='line219' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":219
 *             else:
 *                 if int(chr(chr1[snp_idx])) == 1:
 *                     self._chr1[snp_idx] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))
 */
        (__pyx_v_self->_chr1[__pyx_v_snp_idx]) = 1;
        goto __pyx_L6;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220:                 else:</pre>
<pre id='line220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line221")'> 221:                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))</pre>
<pre id='line221' class='code' style='background-color: #FFFF2a'>
        /* "LDModel.pyx":221
 *                     self._chr1[snp_idx] = 1
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     exit(-1)
 *             if int(chr(chr2[snp_idx])) == 0:
 */
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr1[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_13), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line222")'> 222:                     exit(-1)</pre>
<pre id='line222' class='code' style='background-color: #FFFF6e'>
        /* "LDModel.pyx":222
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr2[snp_idx])) == 0:
 *                 self._chr2[snp_idx] = 0
 */
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_L6:;
    }
    __pyx_L5:;

  /* "LDModel.pyx":222
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr2[snp_idx])) == 0:
 *                 self._chr2[snp_idx] = 0
 */
  __pyx_k_tuple_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_14, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_14));
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line223")'> 223:             if int(chr(chr2[snp_idx])) == 0:</pre>
<pre id='line223' class='code' style='background-color: #FFFF32'>
    /* "LDModel.pyx":223
 *                     print "unidentified allele: " + str(int(chr(chr1[snp_idx])))
 *                     exit(-1)
 *             if int(chr(chr2[snp_idx])) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._chr2[snp_idx] = 0
 *             else:
 */
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr2[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224:                 self._chr2[snp_idx] = 0</pre>
<pre id='line224' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":224
 *                     exit(-1)
 *             if int(chr(chr2[snp_idx])) == 0:
 *                 self._chr2[snp_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 if int(chr(chr2[snp_idx])) == 1:
 */
      (__pyx_v_self->_chr2[__pyx_v_snp_idx]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225:             else:</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line226")'> 226:                 if int(chr(chr2[snp_idx])) == 1:</pre>
<pre id='line226' class='code' style='background-color: #FFFF32'>
      /* "LDModel.pyx":226
 *                 self._chr2[snp_idx] = 0
 *             else:
 *                 if int(chr(chr2[snp_idx])) == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._chr2[snp_idx] = 1
 *                 else:
 */
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr2[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:                     self._chr2[snp_idx] = 1</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":227
 *             else:
 *                 if int(chr(chr2[snp_idx])) == 1:
 *                     self._chr2[snp_idx] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))
 */
        (__pyx_v_self->_chr2[__pyx_v_snp_idx]) = 1;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:                 else:</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line229")'> 229:                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))</pre>
<pre id='line229' class='code' style='background-color: #FFFF2a'>
        /* "LDModel.pyx":229
 *                     self._chr2[snp_idx] = 1
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     exit(-1)
 *             if int(chr(chr3[snp_idx])) == 0:
 */
        __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr2[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_13), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line230")'> 230:                     exit(-1)</pre>
<pre id='line230' class='code' style='background-color: #FFFF6e'>
        /* "LDModel.pyx":230
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr3[snp_idx])) == 0:
 *                 self._chr3[snp_idx] = 0
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L8:;
    }
    __pyx_L7:;

  /* "LDModel.pyx":230
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr3[snp_idx])) == 0:
 *                 self._chr3[snp_idx] = 0
 */
  __pyx_k_tuple_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_15, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_15));
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line231")'> 231:             if int(chr(chr3[snp_idx])) == 0:</pre>
<pre id='line231' class='code' style='background-color: #FFFF32'>
    /* "LDModel.pyx":231
 *                     print "unidentified allele: " + str(int(chr(chr2[snp_idx])))
 *                     exit(-1)
 *             if int(chr(chr3[snp_idx])) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._chr3[snp_idx] = 0
 *             else:
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr3[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:                 self._chr3[snp_idx] = 0</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":232
 *                     exit(-1)
 *             if int(chr(chr3[snp_idx])) == 0:
 *                 self._chr3[snp_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 if int(chr(chr3[snp_idx])) == 1:
 */
      (__pyx_v_self->_chr3[__pyx_v_snp_idx]) = 0;
      goto __pyx_L9;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line233")'> 233:             else:</pre>
<pre id='line233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line234")'> 234:                 if int(chr(chr3[snp_idx])) == 1:</pre>
<pre id='line234' class='code' style='background-color: #FFFF32'>
      /* "LDModel.pyx":234
 *                 self._chr3[snp_idx] = 0
 *             else:
 *                 if int(chr(chr3[snp_idx])) == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._chr3[snp_idx] = 1
 *                 else:
 */
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr3[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235:                     self._chr3[snp_idx] = 1</pre>
<pre id='line235' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":235
 *             else:
 *                 if int(chr(chr3[snp_idx])) == 1:
 *                     self._chr3[snp_idx] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))
 */
        (__pyx_v_self->_chr3[__pyx_v_snp_idx]) = 1;
        goto __pyx_L10;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line236")'> 236:                 else:</pre>
<pre id='line236' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line237")'> 237:                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))</pre>
<pre id='line237' class='code' style='background-color: #FFFF2a'>
        /* "LDModel.pyx":237
 *                     self._chr3[snp_idx] = 1
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     exit(-1)
 *             if int(chr(chr4[snp_idx])) == 0:
 */
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr3[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_13), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line238")'> 238:                     exit(-1)</pre>
<pre id='line238' class='code' style='background-color: #FFFF6e'>
        /* "LDModel.pyx":238
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr4[snp_idx])) == 0:
 *                 self._chr4[snp_idx] = 0
 */
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_16), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_L10:;
    }
    __pyx_L9:;

  /* "LDModel.pyx":238
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if int(chr(chr4[snp_idx])) == 0:
 *                 self._chr4[snp_idx] = 0
 */
  __pyx_k_tuple_16 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_16, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_16));
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line239")'> 239:             if int(chr(chr4[snp_idx])) == 0:</pre>
<pre id='line239' class='code' style='background-color: #FFFF32'>
    /* "LDModel.pyx":239
 *                     print "unidentified allele: " + str(int(chr(chr3[snp_idx])))
 *                     exit(-1)
 *             if int(chr(chr4[snp_idx])) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._chr4[snp_idx] = 0
 *             else:
 */
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr4[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line240")'> 240:                 self._chr4[snp_idx] = 0</pre>
<pre id='line240' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":240
 *                     exit(-1)
 *             if int(chr(chr4[snp_idx])) == 0:
 *                 self._chr4[snp_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 if int(chr(chr4[snp_idx])) == 1:
 */
      (__pyx_v_self->_chr4[__pyx_v_snp_idx]) = 0;
      goto __pyx_L11;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:             else:</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line242")'> 242:                 if int(chr(chr4[snp_idx])) == 1:</pre>
<pre id='line242' class='code' style='background-color: #FFFF32'>
      /* "LDModel.pyx":242
 *                 self._chr4[snp_idx] = 0
 *             else:
 *                 if int(chr(chr4[snp_idx])) == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._chr4[snp_idx] = 1
 *                 else:
 */
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr4[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243:                     self._chr4[snp_idx] = 1</pre>
<pre id='line243' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":243
 *             else:
 *                 if int(chr(chr4[snp_idx])) == 1:
 *                     self._chr4[snp_idx] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr4[snp_idx])))
 */
        (__pyx_v_self->_chr4[__pyx_v_snp_idx]) = 1;
        goto __pyx_L12;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line244")'> 244:                 else:</pre>
<pre id='line244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line245")'> 245:                     print "unidentified allele: " + str(int(chr(chr4[snp_idx])))</pre>
<pre id='line245' class='code' style='background-color: #FFFF2a'>
        /* "LDModel.pyx":245
 *                     self._chr4[snp_idx] = 1
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr4[snp_idx])))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     exit(-1)
 * 
 */
        __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_chr4[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_chr, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_13), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line246")'> 246:                     exit(-1)</pre>
<pre id='line246' class='code' style='background-color: #FFFF14'>
        /* "LDModel.pyx":246
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr4[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L12:;
    }
    __pyx_L11:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_chrs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_9set_chrs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_9set_chrs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  char *__pyx_v_chr1;
  char *__pyx_v_chr2;
  char *__pyx_v_chr3;
  char *__pyx_v_chr4;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_chrs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__chr1,&__pyx_n_s__chr2,&__pyx_n_s__chr3,&__pyx_n_s__chr4,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__chr1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__chr2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_chrs", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__chr3)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_chrs", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__chr4)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_chrs", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_chrs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_chr1 = <span class='py_c_api'>PyBytes_AsString</span>(values[0]);<span class='error_goto'> if (unlikely((!__pyx_v_chr1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_chr2 = <span class='py_c_api'>PyBytes_AsString</span>(values[1]);<span class='error_goto'> if (unlikely((!__pyx_v_chr2) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_chr3 = <span class='py_c_api'>PyBytes_AsString</span>(values[2]);<span class='error_goto'> if (unlikely((!__pyx_v_chr3) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_chr4 = <span class='py_c_api'>PyBytes_AsString</span>(values[3]);<span class='error_goto'> if (unlikely((!__pyx_v_chr4) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_chrs", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_chrs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_8set_chrs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_chr1, __pyx_v_chr2, __pyx_v_chr3, __pyx_v_chr4);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "LDModel.pyx":246
 *                 else:
 *                     print "unidentified allele: " + str(int(chr(chr4[snp_idx])))
 *                     exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_k_tuple_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_17, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_17));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line247")'> 247: </pre>
<pre id='line247' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line248")'> 248: </pre>
<pre id='line248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line249")'> 249:     def set_prefix_string(self, char* new_prefix_string):</pre>
<pre id='line249' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":249
 * 
 * 
 *     def set_prefix_string(self, char* new_prefix_string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._prefix_string = <code><</code>char *> malloc((strlen(new_prefix_string) + 1) * sizeof(char))
 *         strncpy(self._prefix_string, new_prefix_string, strlen(new_prefix_string))
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_10set_prefix_string(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, char *__pyx_v_new_prefix_string) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_prefix_string", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_prefix_string", __pyx_f[0], 249);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250:         self._prefix_string = &lt;char *&gt; malloc((strlen(new_prefix_string) + 1) * sizeof(char))</pre>
<pre id='line250' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":250
 * 
 *     def set_prefix_string(self, char* new_prefix_string):
 *         self._prefix_string = <code><</code>char *> malloc((strlen(new_prefix_string) + 1) * sizeof(char))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         strncpy(self._prefix_string, new_prefix_string, strlen(new_prefix_string))
 *         self._prefix_string[strlen(new_prefix_string)] = '\0'
 */
  __pyx_v_self->_prefix_string = ((char *)malloc(((strlen(__pyx_v_new_prefix_string) + 1) * (sizeof(char)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line251")'> 251:         strncpy(self._prefix_string, new_prefix_string, strlen(new_prefix_string))</pre>
<pre id='line251' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":251
 *     def set_prefix_string(self, char* new_prefix_string):
 *         self._prefix_string = <code><</code>char *> malloc((strlen(new_prefix_string) + 1) * sizeof(char))
 *         strncpy(self._prefix_string, new_prefix_string, strlen(new_prefix_string))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._prefix_string[strlen(new_prefix_string)] = '\0'
 * 
 */
  strncpy(__pyx_v_self->_prefix_string, __pyx_v_new_prefix_string, strlen(__pyx_v_new_prefix_string));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line252")'> 252:         self._prefix_string[strlen(new_prefix_string)] = '\0'</pre>
<pre id='line252' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":252
 *         self._prefix_string = <code><</code>char *> malloc((strlen(new_prefix_string) + 1) * sizeof(char))
 *         strncpy(self._prefix_string, new_prefix_string, strlen(new_prefix_string))
 *         self._prefix_string[strlen(new_prefix_string)] = '\0'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  (__pyx_v_self->_prefix_string[strlen(__pyx_v_new_prefix_string)]) = '\x00';

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_13read_map(PyObject *__pyx_v_self, PyObject *__pyx_v_map_file_name); /*proto*/
static char __pyx_doc_7LDModel_7LDModel_12read_map[] = "\n        read the (PLINK) map file\n        ";
static PyObject *__pyx_pw_7LDModel_7LDModel_13read_map(PyObject *__pyx_v_self, PyObject *__pyx_v_map_file_name) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_map (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_12read_map(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_map_file_name));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253: </pre>
<pre id='line253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254: </pre>
<pre id='line254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line255")'> 255:     def read_map(self, map_file_name):</pre>
<pre id='line255' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":255
 * 
 * 
 *     def read_map(self, map_file_name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         '''
 *         read the (PLINK) map file
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_12read_map(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_map_file_name) {
  PyObject *__pyx_v_map_file = NULL;
  int __pyx_v_done;
  long __pyx_v_buffer_size;
  PyObject *__pyx_v_snp_idx = NULL;
  PyObject *__pyx_v_lines = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_map", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("read_map", __pyx_f[0], 255);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256:         '''</pre>
<pre id='line256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:         read the (PLINK) map file</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258:         '''</pre>
<pre id='line258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line259")'> 259:         if not os.path.exists(map_file_name):</pre>
<pre id='line259' class='code' style='background-color: #FFFF39'>
  /* "LDModel.pyx":259
 *         read the (PLINK) map file
 *         '''
 *         if not os.path.exists(map_file_name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "the file: " + map_file_name + " does not exist!"
 *             exit(-1)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exists);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_map_file_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_map_file_name);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line260")'> 260:             print "the file: " + map_file_name + " does not exist!"</pre>
<pre id='line260' class='code' style='background-color: #FFFF6a'>
    /* "LDModel.pyx":260
 *         '''
 *         if not os.path.exists(map_file_name):
 *             print "the file: " + map_file_name + " does not exist!"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             exit(-1)
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_18), __pyx_v_map_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_19));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line261")'> 261:             exit(-1)</pre>
<pre id='line261' class='code' style='background-color: #FFFF6e'>
    /* "LDModel.pyx":261
 *         if not os.path.exists(map_file_name):
 *             print "the file: " + map_file_name + " does not exist!"
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print "reading from map file: " + map_file_name
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_20), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "LDModel.pyx":261
 *         if not os.path.exists(map_file_name):
 *             print "the file: " + map_file_name + " does not exist!"
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print "reading from map file: " + map_file_name
 */
  __pyx_k_tuple_20 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_20);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_20, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_20));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262: </pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line263")'> 263:         print "reading from map file: " + map_file_name</pre>
<pre id='line263' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":263
 *             exit(-1)
 * 
 *         print "reading from map file: " + map_file_name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with open(map_file_name) as map_file:
 */
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_21), __pyx_v_map_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264: </pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF0e' onclick='toggleDiv("line265")'> 265:         with open(map_file_name) as map_file:</pre>
<pre id='line265' class='code' style='background-color: #FFFF0e'>
  /* "LDModel.pyx":265
 *         print "reading from map file: " + map_file_name
 * 
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             done = False
 */
  /*with:*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_map_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_map_file_name);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          __pyx_v_map_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

        /* "LDModel.pyx":265
 *         print "reading from map file: " + map_file_name
 * 
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             done = False
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_map", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_3, &__pyx_t_2, &__pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_t_14, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_15))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
          __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          if (unlikely(__pyx_t_5 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          __pyx_t_4 = (!__pyx_t_5);
          if (__pyx_t_4) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_3, __pyx_t_2, __pyx_t_1);
            __pyx_t_3 = 0; __pyx_t_2 = 0; __pyx_t_1 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
            goto __pyx_L26;
          }
          __pyx_L26:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L9_exception_handled;
        }
        __pyx_L10_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L9_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L15_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_6) {
        __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_k_tuple_24, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_9))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__pyx_t_4 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L27;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L27:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_map", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_map_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_15generate_random_haps_inplace(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_15generate_random_haps_inplace(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_anc;
  int __pyx_v_count;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_random_haps_inplace (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__anc,&__pyx_n_s__count,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__anc)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_random_haps_inplace", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_random_haps_inplace") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_anc = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_anc == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_count = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_count == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_random_haps_inplace", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_random_haps_inplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_14generate_random_haps_inplace(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_anc, __pyx_v_count);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "LDModel.pyx":265
 *         print "reading from map file: " + map_file_name
 * 
 *         with open(map_file_name) as map_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             done = False
 */
  __pyx_k_tuple_24 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_24);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_24, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_24, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_24, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_24));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266: </pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267:             done = False</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":267
 *         with open(map_file_name) as map_file:
 * 
 *             done = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             buffer_size = 100
 *             snp_idx = 0
 */
          __pyx_v_done = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:             buffer_size = 100</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":268
 * 
 *             done = False
 *             buffer_size = 100             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx = 0
 * 
 */
          __pyx_v_buffer_size = 100;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line269")'> 269:             snp_idx = 0</pre>
<pre id='line269' class='code' style='background-color: #FFFFe7'>
          /* "LDModel.pyx":269
 *             done = False
 *             buffer_size = 100
 *             snp_idx = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             while True:
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          __pyx_v_snp_idx = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270: </pre>
<pre id='line270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271:             while True:</pre>
<pre id='line271' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":271
 *             snp_idx = 0
 * 
 *             while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if done:
 */
          while (1) {
            if (!1) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272: </pre>
<pre id='line272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:                 if done:</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":273
 *             while True:
 * 
 *                 if done:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     break
 *                 # read next buffer_size lines from the file
 */
            if (__pyx_v_done) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274:                     break</pre>
<pre id='line274' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":274
 * 
 *                 if done:
 *                     break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # read next buffer_size lines from the file
 *                 lines = list(islice(map_file, buffer_size))
 */
              goto __pyx_L18_break;
              goto __pyx_L19;
            }
            __pyx_L19:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line275")'> 275:                 # read next buffer_size lines from the file</pre>
<pre id='line275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line276")'> 276:                 lines = list(islice(map_file, buffer_size))</pre>
<pre id='line276' class='code' style='background-color: #FFFF38'>
            /* "LDModel.pyx":276
 *                     break
 *                 # read next buffer_size lines from the file
 *                 lines = list(islice(map_file, buffer_size))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if len(lines) == 0:
 */
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__islice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_map_file);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_map_file);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_lines));
            __pyx_v_lines = ((PyObject*)__pyx_t_3);
            __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277: </pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line278")'> 278:                 if len(lines) == 0:</pre>
<pre id='line278' class='code' style='background-color: #FFFFe7'>
            /* "LDModel.pyx":278
 *                 lines = list(islice(map_file, buffer_size))
 * 
 *                 if len(lines) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     done = True
 * 
 */
            __pyx_t_10 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_lines));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            __pyx_t_5 = (__pyx_t_10 == 0);
            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279:                     done = True</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":279
 * 
 *                 if len(lines) == 0:
 *                     done = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 for line in lines:
 */
              __pyx_v_done = 1;
              goto __pyx_L20;
            }
            __pyx_L20:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280: </pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line281")'> 281:                 for line in lines:</pre>
<pre id='line281' class='code' style='background-color: #FFFF9f'>
            /* "LDModel.pyx":281
 *                     done = True
 * 
 *                 for line in lines:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     #print "line: " + line
 *                     line = line.split(" ")
 */
            __pyx_t_3 = ((PyObject *)__pyx_v_lines); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10 = 0;
            for (;;) {
              if (__pyx_t_10 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #else
              __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #endif
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
              __pyx_v_line = __pyx_t_2;
              __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282:                     #print "line: " + line</pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line283")'> 283:                     line = line.split(" ")</pre>
<pre id='line283' class='code' style='background-color: #FFFF57'>
              /* "LDModel.pyx":283
 *                 for line in lines:
 *                     #print "line: " + line
 *                     line = line.split(" ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     #print "pos: " + line[0]
 *                     self._genetic_dist[snp_idx] = float(line[2])
 */
              __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
              __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_line);
              __pyx_v_line = __pyx_t_1;
              __pyx_t_1 = 0;

  /* "LDModel.pyx":283
 *                 for line in lines:
 *                     #print "line: " + line
 *                     line = line.split(" ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     #print "pos: " + line[0]
 *                     self._genetic_dist[snp_idx] = float(line[2])
 */
  __pyx_k_tuple_23 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_23);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_22));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_23, 0, ((PyObject *)__pyx_kp_s_22));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_22));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_23));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:                     #print "pos: " + line[0]</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line285")'> 285:                     self._genetic_dist[snp_idx] = float(line[2])</pre>
<pre id='line285' class='code' style='background-color: #FFFF4d'>
              /* "LDModel.pyx":285
 *                     line = line.split(" ")
 *                     #print "pos: " + line[0]
 *                     self._genetic_dist[snp_idx] = float(line[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._position[snp_idx] = int(line[3])
 *                     snp_idx += 1
 */
              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_line, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              (__pyx_v_self->_genetic_dist[__pyx_t_12]) = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line286")'> 286:                     self._position[snp_idx] = int(line[3])</pre>
<pre id='line286' class='code' style='background-color: #FFFF38'>
              /* "LDModel.pyx":286
 *                     #print "pos: " + line[0]
 *                     self._genetic_dist[snp_idx] = float(line[2])
 *                     self._position[snp_idx] = int(line[3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     snp_idx += 1
 *                     if snp_idx >= self._snp_num:
 */
              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_line, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
              __pyx_t_1 = 0;
              __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              (__pyx_v_self->_position[__pyx_t_12]) = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line287")'> 287:                     snp_idx += 1</pre>
<pre id='line287' class='code' style='background-color: #FFFF9f'>
              /* "LDModel.pyx":287
 *                     self._genetic_dist[snp_idx] = float(line[2])
 *                     self._position[snp_idx] = int(line[3])
 *                     snp_idx += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if snp_idx >= self._snp_num:
 *                         done = True;
 */
              __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_snp_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_snp_idx);
              __pyx_v_snp_idx = __pyx_t_1;
              __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line288")'> 288:                     if snp_idx &gt;= self._snp_num:</pre>
<pre id='line288' class='code' style='background-color: #FFFF5e'>
              /* "LDModel.pyx":288
 *                     self._position[snp_idx] = int(line[3])
 *                     snp_idx += 1
 *                     if snp_idx >= self._snp_num:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         done = True;
 *                         break
 */
              __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_snp_idx, __pyx_t_1, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289:                         done = True;</pre>
<pre id='line289' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":289
 *                     snp_idx += 1
 *                     if snp_idx >= self._snp_num:
 *                         done = True;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         break
 * 
 */
                __pyx_v_done = 1;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line290")'> 290:                         break</pre>
<pre id='line290' class='code' style='background-color: #FFFF96'>
                /* "LDModel.pyx":290
 *                     if snp_idx >= self._snp_num:
 *                         done = True;
 *                         break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     def read_genetic_map(self, genetic_map_file_name):
 */
                goto __pyx_L22_break;
                goto __pyx_L23;
              }
              __pyx_L23:;
            }
            __pyx_L22_break:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          }
          __pyx_L18_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L15_try_end;
        __pyx_L8_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291: </pre>
<pre id='line291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292: #     def read_genetic_map(self, genetic_map_file_name):</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293: #         '''</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294: #         read the genetic map from hapmap format file</pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295: #         '''</pre>
<pre id='line295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296: #         if not os.path.exists(genetic_map_file_name):</pre>
<pre id='line296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: #             print "the file: " + genetic_map_file_name + " does not exist!"</pre>
<pre id='line297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298: #             exit(-1)</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299: #</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300: #         print "reading from genetic map file: " + genetic_map_file_name</pre>
<pre id='line300' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301: #</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302: #         with open(genetic_map_file_name) as genetic_map_file:</pre>
<pre id='line302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: #</pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304: #             first_read = True</pre>
<pre id='line304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305: #             done = False</pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: #             buffer_size = 100</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307: #             snp_idx = 0</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308: #</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309: #             while True:</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310: #</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311: #                 if done:</pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line312")'> 312: #                     break</pre>
<pre id='line312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313: #                 # read next buffer_size lines from the file</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line314")'> 314: #                 if not first_read:</pre>
<pre id='line314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315: #                     lines = list(islice(genetic_map_file, buffer_size))</pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316: #                 else:</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317: #                     lines = list(islice(genetic_map_file, 1, buffer_size))</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318: #                     first_read = False</pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319: #</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320: #                 if len(lines) == 0:</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321: #                     done = True</pre>
<pre id='line321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322: #</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323: #                 for line in lines:</pre>
<pre id='line323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324: #                     #print "line: " + line</pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line325")'> 325: #                     line = line.split(" ")</pre>
<pre id='line325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326: #                     #print "pos: " + line[0]</pre>
<pre id='line326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327: #                     # TODO: this is a bug - need to read only positions that are in _position</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328: #                     self._genetic_map[snp_idx] = create_gen_map_entry(int(line[0]),float(line[1]),float(line[2]))</pre>
<pre id='line328' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329: #                     snp_idx += 1</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330: #                     if snp_idx &gt;= self._snp_num:</pre>
<pre id='line330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331: #                         done = True;</pre>
<pre id='line331' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332: #                         break</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333: </pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line334")'> 334:     def generate_random_haps_inplace(self, int anc, int count):</pre>
<pre id='line334' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":334
 * #                         break
 * 
 *     def generate_random_haps_inplace(self, int anc, int count):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._nr_haplos = count
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_14generate_random_haps_inplace(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_anc, int __pyx_v_count) {
  long __pyx_v_hap_idx;
  PyObject *__pyx_v_hap = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_random_haps_inplace", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("generate_random_haps_inplace", __pyx_f[0], 334);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line335")'> 335:         self._nr_haplos = count</pre>
<pre id='line335' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":335
 * 
 *     def generate_random_haps_inplace(self, int anc, int count):
 *         self._nr_haplos = count             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 *         for hap_idx in range(4):
 */
  __pyx_v_self->_nr_haplos = __pyx_v_count;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line336")'> 336:         self._haplos = &lt;char **&gt; malloc(self._nr_haplos * sizeof(char *))</pre>
<pre id='line336' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":336
 *     def generate_random_haps_inplace(self, int anc, int count):
 *         self._nr_haplos = count
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for hap_idx in range(4):
 *             self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 */
  __pyx_v_self->_haplos = ((char **)malloc((__pyx_v_self->_nr_haplos * (sizeof(char *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337:         for hap_idx in range(4):</pre>
<pre id='line337' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":337
 *         self._nr_haplos = count
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 *         for hap_idx in range(4):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 *             self.generate_random_hap(anc)
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 4; __pyx_t_1+=1) {
    __pyx_v_hap_idx = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line338")'> 338:             self._haplos[hap_idx] = &lt;char *&gt; malloc((self._snp_num) * sizeof(char))</pre>
<pre id='line338' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":338
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 *         for hap_idx in range(4):
 *             self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.generate_random_hap(anc)
 *             hap = self.generate_random_hap(anc)
 */
    (__pyx_v_self->_haplos[__pyx_v_hap_idx]) = ((char *)malloc((__pyx_v_self->_snp_num * (sizeof(char)))));
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line339")'> 339:             self.generate_random_hap(anc)</pre>
<pre id='line339' class='code' style='background-color: #FFFFe7'>
    /* "LDModel.pyx":339
 *         for hap_idx in range(4):
 *             self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 *             self.generate_random_hap(anc)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             hap = self.generate_random_hap(anc)
 *             strncpy(self._haplos[hap_idx], hap, self._snp_num)
 */
    __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->generate_random_hap(__pyx_v_self, __pyx_v_anc, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line340")'> 340:             hap = self.generate_random_hap(anc)</pre>
<pre id='line340' class='code' style='background-color: #FFFFe7'>
    /* "LDModel.pyx":340
 *             self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 *             self.generate_random_hap(anc)
 *             hap = self.generate_random_hap(anc)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             strncpy(self._haplos[hap_idx], hap, self._snp_num)
 * 
 */
    __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->generate_random_hap(__pyx_v_self, __pyx_v_anc, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap);
    __pyx_v_hap = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line341")'> 341:             strncpy(self._haplos[hap_idx], hap, self._snp_num)</pre>
<pre id='line341' class='code' style='background-color: #FFFF2b'>
    /* "LDModel.pyx":341
 *             self.generate_random_hap(anc)
 *             hap = self.generate_random_hap(anc)
 *             strncpy(self._haplos[hap_idx], hap, self._snp_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def read_haplos(self, file_name, scramble=False):
 */
    __pyx_t_3 = <span class='py_c_api'>PyBytes_AsString</span>(__pyx_v_hap);<span class='error_goto'> if (unlikely((!__pyx_t_3) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    strncpy((__pyx_v_self->_haplos[__pyx_v_hap_idx]), __pyx_t_3, __pyx_v_self->_snp_num);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_random_haps_inplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_17read_haplos(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_17read_haplos(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_file_name = 0;
  PyObject *__pyx_v_scramble = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_haplos (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__file_name,&__pyx_n_s__scramble,0};
    PyObject* values[2] = {0,0};
    values[1] = __pyx_k_25;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__file_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__scramble);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_haplos") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_file_name = values[0];
    __pyx_v_scramble = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_haplos", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_haplos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_16read_haplos(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_file_name, __pyx_v_scramble);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342: </pre>
<pre id='line342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line343")'> 343:     def read_haplos(self, file_name, scramble=False):</pre>
<pre id='line343' class='code' style='background-color: #FFFF96'>
/* "LDModel.pyx":343
 *             strncpy(self._haplos[hap_idx], hap, self._snp_num)
 * 
 *     def read_haplos(self, file_name, scramble=False):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if not os.path.exists(file_name):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_16read_haplos(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_file_name, PyObject *__pyx_v_scramble) {
  PyObject *__pyx_v_count = NULL;
  PyObject *__pyx_v_haplos_file = NULL;
  PyObject *__pyx_v_line = NULL;
  CYTHON_UNUSED int __pyx_v_first_read;
  int __pyx_v_done;
  long __pyx_v_buffer_size;
  PyObject *__pyx_v_hap_idx = NULL;
  PyObject *__pyx_v_lines = NULL;
  PyObject *__pyx_v_line_trunc = NULL;
  int __pyx_v_snp_idx;
  PyObject *__pyx_v_switch = NULL;
  PyObject *__pyx_v_temp_allele = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_haplos", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("read_haplos", __pyx_f[0], 343);

  /* "LDModel.pyx":343
 *             strncpy(self._haplos[hap_idx], hap, self._snp_num)
 * 
 *     def read_haplos(self, file_name, scramble=False):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if not os.path.exists(file_name):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_25 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line344")'> 344: </pre>
<pre id='line344' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line345")'> 345:         if not os.path.exists(file_name):</pre>
<pre id='line345' class='code' style='background-color: #FFFF39'>
  /* "LDModel.pyx":345
 *     def read_haplos(self, file_name, scramble=False):
 * 
 *         if not os.path.exists(file_name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "the file: " + file_name + " does not exist!"
 *             exit(-1)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exists);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line346")'> 346:             print "the file: " + file_name + " does not exist!"</pre>
<pre id='line346' class='code' style='background-color: #FFFF6a'>
    /* "LDModel.pyx":346
 * 
 *         if not os.path.exists(file_name):
 *             print "the file: " + file_name + " does not exist!"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             exit(-1)
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_18), __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_19));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line347")'> 347:             exit(-1)</pre>
<pre id='line347' class='code' style='background-color: #FFFF6e'>
    /* "LDModel.pyx":347
 *         if not os.path.exists(file_name):
 *             print "the file: " + file_name + " does not exist!"
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         count = 0
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_26), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "LDModel.pyx":347
 *         if not os.path.exists(file_name):
 *             print "the file: " + file_name + " does not exist!"
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         count = 0
 */
  __pyx_k_tuple_26 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_26);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_26, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_26));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348: </pre>
<pre id='line348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line349")'> 349:         count = 0</pre>
<pre id='line349' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":349
 *             exit(-1)
 * 
 *         count = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with open(file_name) as haplos_file:
 *             for line in haplos_file.xreadlines(  ):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_count = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line350")'> 350:         with open(file_name) as haplos_file:</pre>
<pre id='line350' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":350
 * 
 *         count = 0
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for line in haplos_file.xreadlines(  ):
 *                 count += 1
 */
  /*with:*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          __pyx_v_haplos_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

        /* "LDModel.pyx":350
 * 
 *         count = 0
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for line in haplos_file.xreadlines(  ):
 *                 count += 1
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_haplos", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_t_12, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(__pyx_t_5 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          __pyx_t_4 = (!__pyx_t_5);
          if (__pyx_t_4) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);
            __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
            goto __pyx_L21;
          }
          __pyx_L21:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L9_exception_handled;
        }
        __pyx_L10_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L9_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L15_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_6) {
        __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_k_tuple_27, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_9))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__pyx_t_4 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L22;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L22:;
  }

  /* "LDModel.pyx":350
 * 
 *         count = 0
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for line in haplos_file.xreadlines(  ):
 *                 count += 1
 */
  __pyx_k_tuple_27 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_27);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_27, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_27, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_27, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_27));
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line351")'> 351:             for line in haplos_file.xreadlines(  ):</pre>
<pre id='line351' class='code' style='background-color: #FFFF23'>
          /* "LDModel.pyx":351
 *         count = 0
 *         with open(file_name) as haplos_file:
 *             for line in haplos_file.xreadlines(  ):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 count += 1
 * 
 */
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_haplos_file, __pyx_n_s__xreadlines);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
            __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10 = 0;
            __pyx_t_11 = NULL;
          } else {
            __pyx_t_10 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          for (;;) {
            if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
              if (__pyx_t_10 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #else
              __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #endif
            } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
              if (__pyx_t_10 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #else
              __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              #endif
            } else {
              __pyx_t_3 = __pyx_t_11(__pyx_t_1);
              if (unlikely(!__pyx_t_3)) {
                if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                  if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                }
                break;
              }
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
            __pyx_v_line = __pyx_t_3;
            __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line352")'> 352:                 count += 1</pre>
<pre id='line352' class='code' style='background-color: #FFFF6e'>
            /* "LDModel.pyx":352
 *         with open(file_name) as haplos_file:
 *             for line in haplos_file.xreadlines(  ):
 *                 count += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if count == 0 or count % 2 == 1:
 */
            __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_count, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_count);
            __pyx_v_count = __pyx_t_3;
            __pyx_t_3 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L15_try_end;
        __pyx_L8_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line353")'> 353: </pre>
<pre id='line353' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line354")'> 354:         if count == 0 or count % 2 == 1:</pre>
<pre id='line354' class='code' style='background-color: #FFFF43'>
  /* "LDModel.pyx":354
 *                 count += 1
 * 
 *         if count == 0 or count % 2 == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "bad number of haplotypes. quitting..."
 *             exit(-1)
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_count, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_count, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_14 = __pyx_t_5;
  } else {
    __pyx_t_14 = __pyx_t_4;
  }
  if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line355")'> 355:             print "bad number of haplotypes. quitting..."</pre>
<pre id='line355' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":355
 * 
 *         if count == 0 or count % 2 == 1:
 *             print "bad number of haplotypes. quitting..."             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             exit(-1)
 * 
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_28)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line356")'> 356:             exit(-1)</pre>
<pre id='line356' class='code' style='background-color: #FFFF6e'>
    /* "LDModel.pyx":356
 *         if count == 0 or count % 2 == 1:
 *             print "bad number of haplotypes. quitting..."
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._nr_haplos = count
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_exit, ((PyObject *)__pyx_k_tuple_29), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L23;
  }
  __pyx_L23:;

  /* "LDModel.pyx":356
 *         if count == 0 or count % 2 == 1:
 *             print "bad number of haplotypes. quitting..."
 *             exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._nr_haplos = count
 */
  __pyx_k_tuple_29 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_29);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_29, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_neg_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_29));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357: </pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line358")'> 358:         self._nr_haplos = count</pre>
<pre id='line358' class='code' style='background-color: #FFFF7f'>
  /* "LDModel.pyx":358
 *             exit(-1)
 * 
 *         self._nr_haplos = count             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print "reading from haplos file: " + file_name
 */
  __pyx_t_15 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_count);<span class='error_goto'> if (unlikely((__pyx_t_15 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_nr_haplos = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line359")'> 359: </pre>
<pre id='line359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line360")'> 360:         print "reading from haplos file: " + file_name</pre>
<pre id='line360' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":360
 *         self._nr_haplos = count
 * 
 *         print "reading from haplos file: " + file_name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 * 
 */
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_30), __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line361")'> 361:         self._haplos = &lt;char **&gt; malloc(self._nr_haplos * sizeof(char *))</pre>
<pre id='line361' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":361
 * 
 *         print "reading from haplos file: " + file_name
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with open(file_name) as haplos_file:
 */
  __pyx_v_self->_haplos = ((char **)malloc((__pyx_v_self->_nr_haplos * (sizeof(char *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line362")'> 362: </pre>
<pre id='line362' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line363")'> 363:         with open(file_name) as haplos_file:</pre>
<pre id='line363' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":363
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 * 
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             first_read = True
 */
  /*with:*/ {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L24_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L24_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_haplos_file);
          __pyx_v_haplos_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

        /* "LDModel.pyx":363
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 * 
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             first_read = True
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_haplos", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_2, &__pyx_t_1, &__pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L30_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L30_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_t_12, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L30_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_14 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(__pyx_t_14 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L30_except_error;}</span>
          __pyx_t_4 = (!__pyx_t_14);
          if (__pyx_t_4) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);
            __pyx_t_2 = 0; __pyx_t_1 = 0; __pyx_t_3 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L30_except_error;}</span>
            goto __pyx_L46;
          }
          __pyx_L46:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          goto __pyx_L29_exception_handled;
        }
        __pyx_L30_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L29_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        __pyx_L35_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_6) {
        __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_k_tuple_31, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_7))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(__pyx_t_4 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L47;
    __pyx_L24_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L47:;
  }

  /* "LDModel.pyx":363
 *         self._haplos = <code><</code>char **> malloc(self._nr_haplos * sizeof(char *))
 * 
 *         with open(file_name) as haplos_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             first_read = True
 */
  __pyx_k_tuple_31 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_31);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_31, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_31, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_31, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_31));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364: </pre>
<pre id='line364' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365:             first_read = True</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":365
 *         with open(file_name) as haplos_file:
 * 
 *             first_read = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             done = False
 *             buffer_size = 100
 */
          __pyx_v_first_read = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366:             done = False</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":366
 * 
 *             first_read = True
 *             done = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             buffer_size = 100
 *             hap_idx = 0
 */
          __pyx_v_done = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367:             buffer_size = 100</pre>
<pre id='line367' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":367
 *             first_read = True
 *             done = False
 *             buffer_size = 100             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             hap_idx = 0
 * 
 */
          __pyx_v_buffer_size = 100;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line368")'> 368:             hap_idx = 0</pre>
<pre id='line368' class='code' style='background-color: #FFFFe7'>
          /* "LDModel.pyx":368
 *             done = False
 *             buffer_size = 100
 *             hap_idx = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             while True:
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          __pyx_v_hap_idx = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369: </pre>
<pre id='line369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line370")'> 370:             while True:</pre>
<pre id='line370' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":370
 *             hap_idx = 0
 * 
 *             while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if done:
 */
          while (1) {
            if (!1) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line371")'> 371: </pre>
<pre id='line371' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372:                 if done:</pre>
<pre id='line372' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":372
 *             while True:
 * 
 *                 if done:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     break
 *                 # read next buffer_size lines from the file
 */
            if (__pyx_v_done) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373:                     break</pre>
<pre id='line373' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":373
 * 
 *                 if done:
 *                     break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # read next buffer_size lines from the file
 *                 lines = list(islice(haplos_file, buffer_size))
 */
              goto __pyx_L38_break;
              goto __pyx_L39;
            }
            __pyx_L39:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374:                 # read next buffer_size lines from the file</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line375")'> 375:                 lines = list(islice(haplos_file, buffer_size))</pre>
<pre id='line375' class='code' style='background-color: #FFFF38'>
            /* "LDModel.pyx":375
 *                     break
 *                 # read next buffer_size lines from the file
 *                 lines = list(islice(haplos_file, buffer_size))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if len(lines) == 0:
 */
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__islice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_haplos_file);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_haplos_file);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_haplos_file);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            __pyx_t_2 = 0;
            __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            __pyx_t_2 = 0;
            __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_lines));
            __pyx_v_lines = ((PyObject*)__pyx_t_2);
            __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line376")'> 376: </pre>
<pre id='line376' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line377")'> 377:                 if len(lines) == 0:</pre>
<pre id='line377' class='code' style='background-color: #FFFFe7'>
            /* "LDModel.pyx":377
 *                 lines = list(islice(haplos_file, buffer_size))
 * 
 *                 if len(lines) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     done = True
 * 
 */
            __pyx_t_10 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_lines));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
            __pyx_t_14 = (__pyx_t_10 == 0);
            if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line378")'> 378:                     done = True</pre>
<pre id='line378' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":378
 * 
 *                 if len(lines) == 0:
 *                     done = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 for line in lines:
 */
              __pyx_v_done = 1;
              goto __pyx_L40;
            }
            __pyx_L40:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line379")'> 379: </pre>
<pre id='line379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line380")'> 380:                 for line in lines:</pre>
<pre id='line380' class='code' style='background-color: #FFFF9f'>
            /* "LDModel.pyx":380
 *                     done = True
 * 
 *                 for line in lines:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     #print "line: " + line
 *                     #print "pos: " + line[0]
 */
            __pyx_t_2 = ((PyObject *)__pyx_v_lines); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10 = 0;
            for (;;) {
              if (__pyx_t_10 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              #else
              __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              #endif
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
              __pyx_v_line = __pyx_t_3;
              __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:                     #print "line: " + line</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line382")'> 382:                     #print "pos: " + line[0]</pre>
<pre id='line382' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line383")'> 383:                     line_trunc = line[:self._snp_num]</pre>
<pre id='line383' class='code' style='background-color: #FFFF9f'>
              /* "LDModel.pyx":383
 *                     #print "line: " + line
 *                     #print "pos: " + line[0]
 *                     line_trunc = line[:self._snp_num]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 *                     strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)
 */
              __pyx_t_3 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_line, 0, __pyx_v_self->_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line_trunc);
              __pyx_v_line_trunc = __pyx_t_3;
              __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line384")'> 384:                     self._haplos[hap_idx] = &lt;char *&gt; malloc((self._snp_num) * sizeof(char))</pre>
<pre id='line384' class='code' style='background-color: #FFFF7f'>
              /* "LDModel.pyx":384
 *                     #print "pos: " + line[0]
 *                     line_trunc = line[:self._snp_num]
 *                     self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)
 *                     #py_bytes = line_trunc.encode('UTF-8')
 */
              __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              (__pyx_v_self->_haplos[__pyx_t_16]) = ((char *)malloc((__pyx_v_self->_snp_num * (sizeof(char)))));
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line385")'> 385:                     strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)</pre>
<pre id='line385' class='code' style='background-color: #FFFF55'>
              /* "LDModel.pyx":385
 *                     line_trunc = line[:self._snp_num]
 *                     self._haplos[hap_idx] = <code><</code>char *> malloc((self._snp_num) * sizeof(char))
 *                     strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     #py_bytes = line_trunc.encode('UTF-8')
 *                     #self._haplos[hap_idx] = py_bytes
 */
              __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              __pyx_t_17 = <span class='py_c_api'>PyBytes_AsString</span>(__pyx_v_line_trunc);<span class='error_goto'> if (unlikely((!__pyx_t_17) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              strncpy((__pyx_v_self->_haplos[__pyx_t_16]), __pyx_t_17, __pyx_v_self->_snp_num);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line386")'> 386:                     #py_bytes = line_trunc.encode('UTF-8')</pre>
<pre id='line386' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line387")'> 387:                     #self._haplos[hap_idx] = py_bytes</pre>
<pre id='line387' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388:                     #print self._haplos[hap_idx]</pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line389")'> 389:                     hap_idx += 1</pre>
<pre id='line389' class='code' style='background-color: #FFFF9f'>
              /* "LDModel.pyx":389
 *                     #self._haplos[hap_idx] = py_bytes
 *                     #print self._haplos[hap_idx]
 *                     hap_idx += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if hap_idx >= self._nr_haplos:
 *                         done = True;
 */
              __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_hap_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_hap_idx);
              __pyx_v_hap_idx = __pyx_t_3;
              __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line390")'> 390:                     if hap_idx &gt;= self._nr_haplos:</pre>
<pre id='line390' class='code' style='background-color: #FFFF5e'>
              /* "LDModel.pyx":390
 *                     #print self._haplos[hap_idx]
 *                     hap_idx += 1
 *                     if hap_idx >= self._nr_haplos:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         done = True;
 *                         break
 */
              __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_hap_idx, __pyx_t_3, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_14 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_14 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391:                         done = True;</pre>
<pre id='line391' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":391
 *                     hap_idx += 1
 *                     if hap_idx >= self._nr_haplos:
 *                         done = True;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         break
 * 
 */
                __pyx_v_done = 1;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line392")'> 392:                         break</pre>
<pre id='line392' class='code' style='background-color: #FFFF8d'>
                /* "LDModel.pyx":392
 *                     if hap_idx >= self._nr_haplos:
 *                         done = True;
 *                         break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if scramble:
 */
                goto __pyx_L42_break;
                goto __pyx_L43;
              }
              __pyx_L43:;
            }
            __pyx_L42_break:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          }
          __pyx_L38_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L35_try_end;
        __pyx_L28_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line393")'> 393: </pre>
<pre id='line393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line394")'> 394:         if scramble:</pre>
<pre id='line394' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":394
 *                         break
 * 
 *         if scramble:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for hap_idx in range(0,self._nr_haplos,2):
 *                 for snp_idx in range(self._snp_num):
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_scramble);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line395")'> 395:             for hap_idx in range(0,self._nr_haplos,2):</pre>
<pre id='line395' class='code' style='background-color: #FFFF1f'>
    /* "LDModel.pyx":395
 * 
 *         if scramble:
 *             for hap_idx in range(0,self._nr_haplos,2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for snp_idx in range(self._snp_num):
 *                     switch = random.randint(0, 1)
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_10 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_10 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_10 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_3 = __pyx_t_11(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap_idx);
      __pyx_v_hap_idx = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line396")'> 396:                 for snp_idx in range(self._snp_num):</pre>
<pre id='line396' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":396
 *         if scramble:
 *             for hap_idx in range(0,self._nr_haplos,2):
 *                 for snp_idx in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     switch = random.randint(0, 1)
 *                     if switch == 1:
 */
      __pyx_t_15 = __pyx_v_self->_snp_num;
      for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_15; __pyx_t_18+=1) {
        __pyx_v_snp_idx = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line397")'> 397:                     switch = random.randint(0, 1)</pre>
<pre id='line397' class='code' style='background-color: #FFFF4b'>
        /* "LDModel.pyx":397
 *             for hap_idx in range(0,self._nr_haplos,2):
 *                 for snp_idx in range(self._snp_num):
 *                     switch = random.randint(0, 1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if switch == 1:
 *                         temp_allele = self._haplos[hap_idx][snp_idx]
 */
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__randint);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_32), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_switch);
        __pyx_v_switch = __pyx_t_3;
        __pyx_t_3 = 0;

  /* "LDModel.pyx":397
 *             for hap_idx in range(0,self._nr_haplos,2):
 *                 for snp_idx in range(self._snp_num):
 *                     switch = random.randint(0, 1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if switch == 1:
 *                         temp_allele = self._haplos[hap_idx][snp_idx]
 */
  __pyx_k_tuple_32 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_32);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_32, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_32, 1, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_32));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line398")'> 398:                     if switch == 1:</pre>
<pre id='line398' class='code' style='background-color: #FFFF79'>
        /* "LDModel.pyx":398
 *                 for snp_idx in range(self._snp_num):
 *                     switch = random.randint(0, 1)
 *                     if switch == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         temp_allele = self._haplos[hap_idx][snp_idx]
 *                         self._haplos[hap_idx][snp_idx] = self._haplos[hap_idx+1][snp_idx]
 */
        __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_switch, __pyx_int_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line399")'> 399:                         temp_allele = self._haplos[hap_idx][snp_idx]</pre>
<pre id='line399' class='code' style='background-color: #FFFF62'>
          /* "LDModel.pyx":399
 *                     switch = random.randint(0, 1)
 *                     if switch == 1:
 *                         temp_allele = self._haplos[hap_idx][snp_idx]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._haplos[hap_idx][snp_idx] = self._haplos[hap_idx+1][snp_idx]
 *                         self._haplos[hap_idx+1][snp_idx] = temp_allele
 */
          __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_haplos[__pyx_t_16])[__pyx_v_snp_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp_allele);
          __pyx_v_temp_allele = __pyx_t_3;
          __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line400")'> 400:                         self._haplos[hap_idx][snp_idx] = self._haplos[hap_idx+1][snp_idx]</pre>
<pre id='line400' class='code' style='background-color: #FFFF46'>
          /* "LDModel.pyx":400
 *                     if switch == 1:
 *                         temp_allele = self._haplos[hap_idx][snp_idx]
 *                         self._haplos[hap_idx][snp_idx] = self._haplos[hap_idx+1][snp_idx]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._haplos[hap_idx+1][snp_idx] = temp_allele
 * 
 */
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_hap_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          ((__pyx_v_self->_haplos[__pyx_t_19])[__pyx_v_snp_idx]) = ((__pyx_v_self->_haplos[__pyx_t_16])[__pyx_v_snp_idx]);
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line401")'> 401:                         self._haplos[hap_idx+1][snp_idx] = temp_allele</pre>
<pre id='line401' class='code' style='background-color: #FFFF44'>
          /* "LDModel.pyx":401
 *                         temp_allele = self._haplos[hap_idx][snp_idx]
 *                         self._haplos[hap_idx][snp_idx] = self._haplos[hap_idx+1][snp_idx]
 *                         self._haplos[hap_idx+1][snp_idx] = temp_allele             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return self._nr_haplos
 */
          __pyx_t_20 = __Pyx_<span class='py_c_api'>PyInt_AsChar</span>(__pyx_v_temp_allele);<span class='error_goto'> if (unlikely((__pyx_t_20 == (char)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_hap_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          ((__pyx_v_self->_haplos[__pyx_t_16])[__pyx_v_snp_idx]) = __pyx_t_20;
          goto __pyx_L53;
        }
        __pyx_L53:;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L48;
  }
  __pyx_L48:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402: </pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line403")'> 403:         return self._nr_haplos</pre>
<pre id='line403' class='code' style='background-color: #FFFF26'>
  /* "LDModel.pyx":403
 *                         self._haplos[hap_idx+1][snp_idx] = temp_allele
 * 
 *         return self._nr_haplos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def read_from_bgl_file(self, file_name, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_haplos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_haplos_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line_trunc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_switch);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp_allele);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_19read_from_bgl_file(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7LDModel_7LDModel_18read_from_bgl_file[] = "\n        read the model from a beagle model file (.dag file)\n        ";
static PyObject *__pyx_pw_7LDModel_7LDModel_19read_from_bgl_file(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_file_name = 0;
  PyObject *__pyx_v_anc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_from_bgl_file (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__file_name,&__pyx_n_s__anc,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__file_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__anc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_from_bgl_file", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_from_bgl_file") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_file_name = values[0];
    __pyx_v_anc = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_from_bgl_file", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_18read_from_bgl_file(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_file_name, __pyx_v_anc);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line404")'> 404: </pre>
<pre id='line404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line405")'> 405:     def read_from_bgl_file(self, file_name, anc):</pre>
<pre id='line405' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":405
 *         return self._nr_haplos
 * 
 *     def read_from_bgl_file(self, file_name, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         '''
 *         read the model from a beagle model file (.dag file)
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_18read_from_bgl_file(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_file_name, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_model_file = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_v_curr_allele = NULL;
  PyObject *__pyx_v_blank_line = NULL;
  PyObject *__pyx_v_layer = NULL;
  PyObject *__pyx_v_nodes = NULL;
  PyObject *__pyx_v_nodes_prev = NULL;
  PyObject *__pyx_v_nodes_curr = NULL;
  int __pyx_v_first_read;
  int __pyx_v_done;
  PyObject *__pyx_v_lines = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_total_parent_count = NULL;
  PyObject *__pyx_v_edges_num = NULL;
  PyObject *__pyx_v_k = NULL;
  double __pyx_v_error_eps;
  PyObject *__pyx_v_edge_idx = NULL;
  PyObject *__pyx_v_sum_back_trans = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_from_bgl_file", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("read_from_bgl_file", __pyx_f[0], 405);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406:         '''</pre>
<pre id='line406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line407")'> 407:         read the model from a beagle model file (.dag file)</pre>
<pre id='line407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408:         '''</pre>
<pre id='line408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409: </pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line410")'> 410:         if not os.path.exists(file_name):</pre>
<pre id='line410' class='code' style='background-color: #FFFF39'>
  /* "LDModel.pyx":410
 *         '''
 * 
 *         if not os.path.exists(file_name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "the file: " + file_name + " does not exist!"
 *             return
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exists);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line411")'> 411:             print "the file: " + file_name + " does not exist!"</pre>
<pre id='line411' class='code' style='background-color: #FFFF6a'>
    /* "LDModel.pyx":411
 * 
 *         if not os.path.exists(file_name):
 *             print "the file: " + file_name + " does not exist!"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_18), __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_19));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line412")'> 412:             return</pre>
<pre id='line412' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":412
 *         if not os.path.exists(file_name):
 *             print "the file: " + file_name + " does not exist!"
 *             return             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print "reading from bgl model file: " + file_name
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413: </pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line414")'> 414:         print "reading from bgl model file: " + file_name</pre>
<pre id='line414' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":414
 *             return
 * 
 *         print "reading from bgl model file: " + file_name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # identify allele coding
 */
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_33), __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415: </pre>
<pre id='line415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:         # identify allele coding</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line417")'> 417:         with open(file_name) as model_file:</pre>
<pre id='line417' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":417
 * 
 *         # identify allele coding
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             model_file.readline()
 *             model_file.readline()
 */
  /*with:*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          __pyx_v_model_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

        /* "LDModel.pyx":417
 * 
 *         # identify allele coding
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             model_file.readline()
 *             model_file.readline()
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_3, &__pyx_t_2, &__pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_t_12, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(__pyx_t_5 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          __pyx_t_4 = (!__pyx_t_5);
          if (__pyx_t_4) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_3, __pyx_t_2, __pyx_t_1);
            __pyx_t_3 = 0; __pyx_t_2 = 0; __pyx_t_1 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
            goto __pyx_L25;
          }
          __pyx_L25:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L9_exception_handled;
        }
        __pyx_L10_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L9_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L15_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_6) {
        __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_k_tuple_37, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_9))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__pyx_t_4 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L26;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L26:;
  }

  /* "LDModel.pyx":417
 * 
 *         # identify allele coding
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             model_file.readline()
 *             model_file.readline()
 */
  __pyx_k_tuple_37 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_37);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_37, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_37, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_37, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_37));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line418")'> 418:             model_file.readline()</pre>
<pre id='line418' class='code' style='background-color: #FFFF73'>
          /* "LDModel.pyx":418
 *         # identify allele coding
 *         with open(file_name) as model_file:
 *             model_file.readline()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             model_file.readline()
 *             line = model_file.readline()
 */
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_model_file, __pyx_n_s__readline);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line419")'> 419:             model_file.readline()</pre>
<pre id='line419' class='code' style='background-color: #FFFF73'>
          /* "LDModel.pyx":419
 *         with open(file_name) as model_file:
 *             model_file.readline()
 *             model_file.readline()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             line = model_file.readline()
 *             node = line.split("\t")
 */
          __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_model_file, __pyx_n_s__readline);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line420")'> 420:             line = model_file.readline()</pre>
<pre id='line420' class='code' style='background-color: #FFFF79'>
          /* "LDModel.pyx":420
 *             model_file.readline()
 *             model_file.readline()
 *             line = model_file.readline()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             node = line.split("\t")
 *             self._allele_0 = int(node[4])
 */
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_model_file, __pyx_n_s__readline);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_v_line = __pyx_t_3;
          __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line421")'> 421:             node = line.split("\t")</pre>
<pre id='line421' class='code' style='background-color: #FFFF5b'>
          /* "LDModel.pyx":421
 *             model_file.readline()
 *             line = model_file.readline()
 *             node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._allele_0 = int(node[4])
 *             while True:
 */
          __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_35), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_v_node = __pyx_t_1;
          __pyx_t_1 = 0;

  /* "LDModel.pyx":421
 *             model_file.readline()
 *             line = model_file.readline()
 *             node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._allele_0 = int(node[4])
 *             while True:
 */
  __pyx_k_tuple_35 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_35);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_34));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_35, 0, ((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_35));
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line422")'> 422:             self._allele_0 = int(node[4])</pre>
<pre id='line422' class='code' style='background-color: #FFFF48'>
          /* "LDModel.pyx":422
 *             line = model_file.readline()
 *             node = line.split("\t")
 *             self._allele_0 = int(node[4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             while True:
 *                 line = model_file.readline()
 */
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_node, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
          __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsChar</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_v_self->_allele_0 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423:             while True:</pre>
<pre id='line423' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":423
 *             node = line.split("\t")
 *             self._allele_0 = int(node[4])
 *             while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 line = model_file.readline()
 *                 if len(line) > 0:
 */
          while (1) {
            if (!1) break;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line424")'> 424:                 line = model_file.readline()</pre>
<pre id='line424' class='code' style='background-color: #FFFF73'>
            /* "LDModel.pyx":424
 *             self._allele_0 = int(node[4])
 *             while True:
 *                 line = model_file.readline()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if len(line) > 0:
 *                     node = line.split("\t")
 */
            __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_model_file, __pyx_n_s__readline);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_line);
            __pyx_v_line = __pyx_t_3;
            __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line425")'> 425:                 if len(line) &gt; 0:</pre>
<pre id='line425' class='code' style='background-color: #FFFFaa'>
            /* "LDModel.pyx":425
 *             while True:
 *                 line = model_file.readline()
 *                 if len(line) > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     node = line.split("\t")
 *                     if len(node) > 4:
 */
            __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_line);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            __pyx_t_5 = (__pyx_t_11 > 0);
            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line426")'> 426:                     node = line.split("\t")</pre>
<pre id='line426' class='code' style='background-color: #FFFF57'>
              /* "LDModel.pyx":426
 *                 line = model_file.readline()
 *                 if len(line) > 0:
 *                     node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if len(node) > 4:
 *                         curr_allele = node[4]
 */
              __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_36), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_node);
              __pyx_v_node = __pyx_t_1;
              __pyx_t_1 = 0;

  /* "LDModel.pyx":426
 *                 line = model_file.readline()
 *                 if len(line) > 0:
 *                     node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if len(node) > 4:
 *                         curr_allele = node[4]
 */
  __pyx_k_tuple_36 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_36);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_34));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_36, 0, ((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_36));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line427")'> 427:                     if len(node) &gt; 4:</pre>
<pre id='line427' class='code' style='background-color: #FFFFaa'>
              /* "LDModel.pyx":427
 *                 if len(line) > 0:
 *                     node = line.split("\t")
 *                     if len(node) > 4:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         curr_allele = node[4]
 *                         if int(curr_allele) != self._allele_0:
 */
              __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_node);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              __pyx_t_5 = (__pyx_t_11 > 4);
              if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line428")'> 428:                         curr_allele = node[4]</pre>
<pre id='line428' class='code' style='background-color: #FFFFc4'>
                /* "LDModel.pyx":428
 *                     node = line.split("\t")
 *                     if len(node) > 4:
 *                         curr_allele = node[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if int(curr_allele) != self._allele_0:
 *                             if int(curr_allele) > self._allele_0:
 */
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_node, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_curr_allele);
                __pyx_v_curr_allele = __pyx_t_1;
                __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line429")'> 429:                         if int(curr_allele) != self._allele_0:</pre>
<pre id='line429' class='code' style='background-color: #FFFF3e'>
                /* "LDModel.pyx":429
 *                     if len(node) > 4:
 *                         curr_allele = node[4]
 *                         if int(curr_allele) != self._allele_0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if int(curr_allele) > self._allele_0:
 *                                 self._allele_1 = int(curr_allele)
 */
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_curr_allele);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_curr_allele);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_curr_allele);
                __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_NE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line430")'> 430:                             if int(curr_allele) &gt; self._allele_0:</pre>
<pre id='line430' class='code' style='background-color: #FFFF3e'>
                  /* "LDModel.pyx":430
 *                         curr_allele = node[4]
 *                         if int(curr_allele) != self._allele_0:
 *                             if int(curr_allele) > self._allele_0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._allele_1 = int(curr_allele)
 *                             else:
 */
                  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_curr_allele);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_curr_allele);
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_curr_allele);
                  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line431")'> 431:                                 self._allele_1 = int(curr_allele)</pre>
<pre id='line431' class='code' style='background-color: #FFFF4b'>
                    /* "LDModel.pyx":431
 *                         if int(curr_allele) != self._allele_0:
 *                             if int(curr_allele) > self._allele_0:
 *                                 self._allele_1 = int(curr_allele)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             else:
 *                                 self._allele_1 = self._allele_0
 */
                    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_curr_allele);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_curr_allele);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_curr_allele);
                    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsChar</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    __pyx_v_self->_allele_1 = __pyx_t_10;
                    goto __pyx_L22;
                  }
                  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line432")'> 432:                             else:</pre>
<pre id='line432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433:                                 self._allele_1 = self._allele_0</pre>
<pre id='line433' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":433
 *                                 self._allele_1 = int(curr_allele)
 *                             else:
 *                                 self._allele_1 = self._allele_0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._allele_0 = int(curr_allele)
 *                             break;
 */
                    __pyx_t_10 = __pyx_v_self->_allele_0;
                    __pyx_v_self->_allele_1 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line434")'> 434:                                 self._allele_0 = int(curr_allele)</pre>
<pre id='line434' class='code' style='background-color: #FFFF4b'>
                    /* "LDModel.pyx":434
 *                             else:
 *                                 self._allele_1 = self._allele_0
 *                                 self._allele_0 = int(curr_allele)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             break;
 * 
 */
                    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_curr_allele);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_curr_allele);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_curr_allele);
                    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsChar</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_v_self->_allele_0 = __pyx_t_10;
                  }
                  __pyx_L22:;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line435")'> 435:                             break;</pre>
<pre id='line435' class='code' style='background-color: #FFFF9f'>
                  /* "LDModel.pyx":435
 *                                 self._allele_1 = self._allele_0
 *                                 self._allele_0 = int(curr_allele)
 *                             break;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)
 */
                  goto __pyx_L18_break;
                  goto __pyx_L21;
                }
                __pyx_L21:;
                goto __pyx_L20;
              }
              __pyx_L20:;
              goto __pyx_L19;
            }
            __pyx_L19:;
          }
          __pyx_L18_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L15_try_end;
        __pyx_L8_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436: </pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line437")'> 437:         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)</pre>
<pre id='line437' class='code' style='background-color: #FFFF26'>
  /* "LDModel.pyx":437
 *                             break;
 * 
 *         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with open(file_name) as model_file:
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_38), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_39));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_allele_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438: </pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line439")'> 439:         with open(file_name) as model_file:</pre>
<pre id='line439' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":439
 *         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)
 * 
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             blank_line = '\n'
 */
  /*with:*/ {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_file_name);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file_name);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L27_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L27_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_model_file);
          __pyx_v_model_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

        /* "LDModel.pyx":439
 *         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)
 * 
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             blank_line = '\n'
 */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_2, &__pyx_t_3, &__pyx_t_22) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_22);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_t_12, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(__pyx_t_4 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          __pyx_t_5 = (!__pyx_t_4);
          if (__pyx_t_5) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_2, __pyx_t_3, __pyx_t_22);
            __pyx_t_2 = 0; __pyx_t_3 = 0; __pyx_t_22 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
            goto __pyx_L84;
          }
          __pyx_L84:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
          goto __pyx_L32_exception_handled;
        }
        __pyx_L33_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L32_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        __pyx_L38_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_6) {
        __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, __pyx_k_tuple_41, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_7))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(__pyx_t_5 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L85;
    __pyx_L27_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L85:;
  }

  /* "LDModel.pyx":439
 *         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)
 * 
 *         with open(file_name) as model_file:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             blank_line = '\n'
 */
  __pyx_k_tuple_41 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_41);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_41, 0, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_41, 1, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_41, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_41));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line440")'> 440: </pre>
<pre id='line440' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line441")'> 441:             blank_line = '\n'</pre>
<pre id='line441' class='code' style='background-color: #FFFFe7'>
          /* "LDModel.pyx":441
 *         with open(file_name) as model_file:
 * 
 *             blank_line = '\n'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer = 0
 *             nodes = []
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
          __pyx_v_blank_line = ((PyObject *)__pyx_kp_s_1);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line442")'> 442:             layer = 0</pre>
<pre id='line442' class='code' style='background-color: #FFFFe7'>
          /* "LDModel.pyx":442
 * 
 *             blank_line = '\n'
 *             layer = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             nodes = []
 *             nodes_prev = []
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          __pyx_v_layer = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line443")'> 443:             nodes = []</pre>
<pre id='line443' class='code' style='background-color: #FFFFaa'>
          /* "LDModel.pyx":443
 *             blank_line = '\n'
 *             layer = 0
 *             nodes = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             nodes_prev = []
 *             nodes_curr = []
 */
          __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_v_nodes = __pyx_t_1;
          __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line444")'> 444:             nodes_prev = []</pre>
<pre id='line444' class='code' style='background-color: #FFFFaa'>
          /* "LDModel.pyx":444
 *             layer = 0
 *             nodes = []
 *             nodes_prev = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             nodes_curr = []
 *             first_read = True
 */
          __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_v_nodes_prev = __pyx_t_1;
          __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line445")'> 445:             nodes_curr = []</pre>
<pre id='line445' class='code' style='background-color: #FFFFaa'>
          /* "LDModel.pyx":445
 *             nodes = []
 *             nodes_prev = []
 *             nodes_curr = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             first_read = True
 *             done = False
 */
          __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_v_nodes_curr = __pyx_t_1;
          __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446:             first_read = True</pre>
<pre id='line446' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":446
 *             nodes_prev = []
 *             nodes_curr = []
 *             first_read = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             done = False
 * 
 */
          __pyx_v_first_read = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line447")'> 447:             done = False</pre>
<pre id='line447' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":447
 *             nodes_curr = []
 *             first_read = True
 *             done = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             while True:
 */
          __pyx_v_done = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line448")'> 448: </pre>
<pre id='line448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line449")'> 449:             while True:</pre>
<pre id='line449' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":449
 *             done = False
 * 
 *             while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if done:
 */
          while (1) {
            if (!1) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450: </pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451:                 if done:</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":451
 *             while True:
 * 
 *                 if done:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     break
 *                 # read next buffer_size lines from the file
 */
            if (__pyx_v_done) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452:                     break</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":452
 * 
 *                 if done:
 *                     break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # read next buffer_size lines from the file
 *                 if first_read:
 */
              goto __pyx_L41_break;
              goto __pyx_L42;
            }
            __pyx_L42:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453:                 # read next buffer_size lines from the file</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454:                 if first_read:</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":454
 *                     break
 *                 # read next buffer_size lines from the file
 *                 if first_read:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     lines = read_until_blank_line(model_file,2)
 *                     first_read = False
 */
            if (__pyx_v_first_read) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line455")'> 455:                     lines = read_until_blank_line(model_file,2)</pre>
<pre id='line455' class='code' style='background-color: #FFFFe7'>
              /* "LDModel.pyx":455
 *                 # read next buffer_size lines from the file
 *                 if first_read:
 *                     lines = read_until_blank_line(model_file,2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     first_read = False
 *                 else:
 */
              __pyx_t_14.__pyx_n = 1;
              __pyx_t_14.first_line = __pyx_int_2;
              __pyx_t_1 = __pyx_f_7LDModel_read_until_blank_line(__pyx_v_model_file, &__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
              __pyx_v_lines = __pyx_t_1;
              __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456:                     first_read = False</pre>
<pre id='line456' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":456
 *                 if first_read:
 *                     lines = read_until_blank_line(model_file,2)
 *                     first_read = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     lines = read_until_blank_line(model_file)
 */
              __pyx_v_first_read = 0;
              goto __pyx_L43;
            }
            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457:                 else:</pre>
<pre id='line457' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line458")'> 458:                     lines = read_until_blank_line(model_file)</pre>
<pre id='line458' class='code' style='background-color: #FFFFe7'>
              /* "LDModel.pyx":458
 *                     first_read = False
 *                 else:
 *                     lines = read_until_blank_line(model_file)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if lines == [blank_line]:
 *                     break
 */
              __pyx_t_1 = __pyx_f_7LDModel_read_until_blank_line(__pyx_v_model_file, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
              __pyx_v_lines = __pyx_t_1;
              __pyx_t_1 = 0;
            }
            __pyx_L43:;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line459")'> 459:                 if lines == [blank_line]:</pre>
<pre id='line459' class='code' style='background-color: #FFFF57'>
            /* "LDModel.pyx":459
 *                 else:
 *                     lines = read_until_blank_line(model_file)
 *                 if lines == [blank_line]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     break
 * 
 */
            __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_blank_line);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_blank_line);
            __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_lines, ((PyObject *)__pyx_t_1), Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
            __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line460")'> 460:                     break</pre>
<pre id='line460' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":460
 *                     lines = read_until_blank_line(model_file)
 *                 if lines == [blank_line]:
 *                     break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 for line in lines:
 */
              goto __pyx_L41_break;
              goto __pyx_L44;
            }
            __pyx_L44:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line461")'> 461: </pre>
<pre id='line461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line462")'> 462:                 for line in lines:</pre>
<pre id='line462' class='code' style='background-color: #FFFF2a'>
            /* "LDModel.pyx":462
 *                     break
 * 
 *                 for line in lines:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if line != blank_line: # split next line
 *                         node = line.split("\t")
 */
            if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_lines) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_lines)) {
              __pyx_t_2 = __pyx_v_lines; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_11 = 0;
              __pyx_t_15 = NULL;
            } else {
              __pyx_t_11 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_lines);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
              __pyx_t_15 = Py_TYPE(__pyx_t_2)->tp_iternext;
            }
            for (;;) {
              if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
                if (__pyx_t_11 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #else
                __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #endif
              } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
                if (__pyx_t_11 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #else
                __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #endif
              } else {
                __pyx_t_1 = __pyx_t_15(__pyx_t_2);
                if (unlikely(!__pyx_t_1)) {
                  if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                    if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                    else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  }
                  break;
                }
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
              }
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
              __pyx_v_line = __pyx_t_1;
              __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line463")'> 463:                     if line != blank_line: # split next line</pre>
<pre id='line463' class='code' style='background-color: #FFFF79'>
              /* "LDModel.pyx":463
 * 
 *                 for line in lines:
 *                     if line != blank_line: # split next line             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         node = line.split("\t")
 *                         nodes.append(node[:6])
 */
              __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_line, __pyx_v_blank_line, Py_NE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line464")'> 464:                         node = line.split("\t")</pre>
<pre id='line464' class='code' style='background-color: #FFFF57'>
                /* "LDModel.pyx":464
 *                 for line in lines:
 *                     if line != blank_line: # split next line
 *                         node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nodes.append(node[:6])
 *                     else: # an entire level has been read
 */
                __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_40), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
                __pyx_v_node = __pyx_t_3;
                __pyx_t_3 = 0;

  /* "LDModel.pyx":464
 *                 for line in lines:
 *                     if line != blank_line: # split next line
 *                         node = line.split("\t")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nodes.append(node[:6])
 *                     else: # an entire level has been read
 */
  __pyx_k_tuple_40 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_40);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_34));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_40, 0, ((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_40));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line465")'> 465:                         nodes.append(node[:6])</pre>
<pre id='line465' class='code' style='background-color: #FFFF79'>
                /* "LDModel.pyx":465
 *                     if line != blank_line: # split next line
 *                         node = line.split("\t")
 *                         nodes.append(node[:6])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     else: # an entire level has been read
 *                         nodes_prev = nodes_curr
 */
                __pyx_t_3 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_node, 0, 6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                __pyx_t_16 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_nodes, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                goto __pyx_L47;
              }
              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line466")'> 466:                     else: # an entire level has been read</pre>
<pre id='line466' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line467")'> 467:                         nodes_prev = nodes_curr</pre>
<pre id='line467' class='code' style='background-color: #FFFFd4'>
                /* "LDModel.pyx":467
 *                         nodes.append(node[:6])
 *                     else: # an entire level has been read
 *                         nodes_prev = nodes_curr             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nodes_curr = nodes
 *                         nodes = []
 */
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_nodes_curr));
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_nodes_prev));
                __pyx_v_nodes_prev = __pyx_v_nodes_curr;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line468")'> 468:                         nodes_curr = nodes</pre>
<pre id='line468' class='code' style='background-color: #FFFFd4'>
                /* "LDModel.pyx":468
 *                     else: # an entire level has been read
 *                         nodes_prev = nodes_curr
 *                         nodes_curr = nodes             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nodes = []
 *                         #print "reading layer: " + str(layer) + ", snp id: " + nodes_curr[0][1]
 */
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_nodes));
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_nodes_curr));
                __pyx_v_nodes_curr = __pyx_v_nodes;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line469")'> 469:                         nodes = []</pre>
<pre id='line469' class='code' style='background-color: #FFFF9f'>
                /* "LDModel.pyx":469
 *                         nodes_prev = nodes_curr
 *                         nodes_curr = nodes
 *                         nodes = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         #print "reading layer: " + str(layer) + ", snp id: " + nodes_curr[0][1]
 * 
 */
                __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_nodes));
                __pyx_v_nodes = __pyx_t_3;
                __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line470")'> 470:                         #print "reading layer: " + str(layer) + ", snp id: " + nodes_curr[0][1]</pre>
<pre id='line470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line471")'> 471: </pre>
<pre id='line471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line472")'> 472:                         # allocate memory for transition probabilities</pre>
<pre id='line472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line473")'> 473:                         if layer % self._win_size == 0:</pre>
<pre id='line473' class='code' style='background-color: #FFFF4d'>
                /* "LDModel.pyx":473
 * 
 *                         # allocate memory for transition probabilities
 *                         if layer % self._win_size == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._pi[anc][int(layer / self._win_size)] = <code><</code>double *> malloc(len(nodes_curr) * sizeof(double))
 *                         if layer > 0:
 */
                __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_win_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_layer, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line474")'> 474:                             self._pi[anc][int(layer / self._win_size)] = &lt;double *&gt; malloc(len(nodes_curr) * sizeof(double))</pre>
<pre id='line474' class='code' style='background-color: #FFFF2e'>
                  /* "LDModel.pyx":474
 *                         # allocate memory for transition probabilities
 *                         if layer % self._win_size == 0:
 *                             self._pi[anc][int(layer / self._win_size)] = <code><</code>double *> malloc(len(nodes_curr) * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if layer > 0:
 *                             self._trans[anc][layer-1] = <code><</code>double **> malloc(len(nodes_prev) * sizeof(double*))
 */
                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_win_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_layer, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                  __pyx_t_1 = 0;
                  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                  __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  ((__pyx_v_self->_pi[__pyx_t_18])[__pyx_t_19]) = ((double *)malloc((__pyx_t_17 * (sizeof(double)))));
                  goto __pyx_L48;
                }
                __pyx_L48:;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line475")'> 475:                         if layer &gt; 0:</pre>
<pre id='line475' class='code' style='background-color: #FFFF79'>
                /* "LDModel.pyx":475
 *                         if layer % self._win_size == 0:
 *                             self._pi[anc][int(layer / self._win_size)] = <code><</code>double *> malloc(len(nodes_curr) * sizeof(double))
 *                         if layer > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._trans[anc][layer-1] = <code><</code>double **> malloc(len(nodes_prev) * sizeof(double*))
 *                             self._trans_idx[anc][layer-1] = <code><</code>int **> malloc(len(nodes_prev) * sizeof(int*))
 */
                __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line476")'> 476:                             self._trans[anc][layer-1] = &lt;double **&gt; malloc(len(nodes_prev) * sizeof(double*))</pre>
<pre id='line476' class='code' style='background-color: #FFFF44'>
                  /* "LDModel.pyx":476
 *                             self._pi[anc][int(layer / self._win_size)] = <code><</code>double *> malloc(len(nodes_curr) * sizeof(double))
 *                         if layer > 0:
 *                             self._trans[anc][layer-1] = <code><</code>double **> malloc(len(nodes_prev) * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._trans_idx[anc][layer-1] = <code><</code>int **> malloc(len(nodes_prev) * sizeof(int*))
 *                         self._back_trans[anc][layer] = <code><</code>double **> malloc(len(nodes_curr) * sizeof(double*))
 */
                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_prev));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  ((__pyx_v_self->_trans[__pyx_t_19])[__pyx_t_18]) = ((double **)malloc((__pyx_t_17 * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line477")'> 477:                             self._trans_idx[anc][layer-1] = &lt;int **&gt; malloc(len(nodes_prev) * sizeof(int*))</pre>
<pre id='line477' class='code' style='background-color: #FFFF44'>
                  /* "LDModel.pyx":477
 *                         if layer > 0:
 *                             self._trans[anc][layer-1] = <code><</code>double **> malloc(len(nodes_prev) * sizeof(double*))
 *                             self._trans_idx[anc][layer-1] = <code><</code>int **> malloc(len(nodes_prev) * sizeof(int*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._back_trans[anc][layer] = <code><</code>double **> malloc(len(nodes_curr) * sizeof(double*))
 *                         self._back_trans_idx[anc][layer] = <code><</code>int **> malloc(len(nodes_curr) * sizeof(int*))
 */
                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_prev));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  ((__pyx_v_self->_trans_idx[__pyx_t_18])[__pyx_t_19]) = ((int **)malloc((__pyx_t_17 * (sizeof(int *)))));
                  goto __pyx_L49;
                }
                __pyx_L49:;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line478")'> 478:                         self._back_trans[anc][layer] = &lt;double **&gt; malloc(len(nodes_curr) * sizeof(double*))</pre>
<pre id='line478' class='code' style='background-color: #FFFF52'>
                /* "LDModel.pyx":478
 *                             self._trans[anc][layer-1] = <code><</code>double **> malloc(len(nodes_prev) * sizeof(double*))
 *                             self._trans_idx[anc][layer-1] = <code><</code>int **> malloc(len(nodes_prev) * sizeof(int*))
 *                         self._back_trans[anc][layer] = <code><</code>double **> malloc(len(nodes_curr) * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._back_trans_idx[anc][layer] = <code><</code>int **> malloc(len(nodes_curr) * sizeof(int*))
 * 
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                ((__pyx_v_self->_back_trans[__pyx_t_19])[__pyx_t_18]) = ((double **)malloc((__pyx_t_17 * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line479")'> 479:                         self._back_trans_idx[anc][layer] = &lt;int **&gt; malloc(len(nodes_curr) * sizeof(int*))</pre>
<pre id='line479' class='code' style='background-color: #FFFF52'>
                /* "LDModel.pyx":479
 *                             self._trans_idx[anc][layer-1] = <code><</code>int **> malloc(len(nodes_prev) * sizeof(int*))
 *                         self._back_trans[anc][layer] = <code><</code>double **> malloc(len(nodes_curr) * sizeof(double*))
 *                         self._back_trans_idx[anc][layer] = <code><</code>int **> malloc(len(nodes_curr) * sizeof(int*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                         # set layer state nums and snp ids
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                ((__pyx_v_self->_back_trans_idx[__pyx_t_18])[__pyx_t_19]) = ((int **)malloc((__pyx_t_17 * (sizeof(int *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line480")'> 480: </pre>
<pre id='line480' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line481")'> 481:                         # set layer state nums and snp ids</pre>
<pre id='line481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line482")'> 482:                         self._layer_state_nums[anc][layer] = len(nodes_curr)</pre>
<pre id='line482' class='code' style='background-color: #FFFF52'>
                /* "LDModel.pyx":482
 * 
 *                         # set layer state nums and snp ids
 *                         self._layer_state_nums[anc][layer] = len(nodes_curr)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._snp_ids[layer] = nodes_curr[0][1]
 * 
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                ((__pyx_v_self->_layer_state_nums[__pyx_t_19])[__pyx_t_18]) = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line483")'> 483:                         self._snp_ids[layer] = nodes_curr[0][1]</pre>
<pre id='line483' class='code' style='background-color: #FFFF46'>
                /* "LDModel.pyx":483
 *                         # set layer state nums and snp ids
 *                         self._layer_state_nums[anc][layer] = len(nodes_curr)
 *                         self._snp_ids[layer] = nodes_curr[0][1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                         # allocate memory for the states
 */
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_nodes_curr), 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_20 = <span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((!__pyx_t_20) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_17 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self->_snp_ids[__pyx_t_17]) = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line484")'> 484: </pre>
<pre id='line484' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485:                         # allocate memory for the states</pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line486")'> 486:                         self._states[anc][layer] = &lt;state *&gt; malloc(len(nodes_curr) * sizeof(state))</pre>
<pre id='line486' class='code' style='background-color: #FFFF52'>
                /* "LDModel.pyx":486
 * 
 *                         # allocate memory for the states
 *                         self._states[anc][layer] = <code><</code>state *> malloc(len(nodes_curr) * sizeof(state))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                         for j in range(len(nodes_curr)):
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                ((__pyx_v_self->_states[__pyx_t_18])[__pyx_t_19]) = ((state *)malloc((__pyx_t_17 * (sizeof(state)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487: </pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line488")'> 488:                         for j in range(len(nodes_curr)):</pre>
<pre id='line488' class='code' style='background-color: #FFFF20'>
                /* "LDModel.pyx":488
 *                         self._states[anc][layer] = <code><</code>state *> malloc(len(nodes_curr) * sizeof(state))
 * 
 *                         for j in range(len(nodes_curr)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if layer == 0:
 *                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                __pyx_t_3 = 0;
                __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                  __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17 = 0;
                  __pyx_t_21 = NULL;
                } else {
                  __pyx_t_17 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  __pyx_t_21 = Py_TYPE(__pyx_t_1)->tp_iternext;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                for (;;) {
                  if (!__pyx_t_21 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
                    if (__pyx_t_17 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #else
                    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #endif
                  } else if (!__pyx_t_21 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                    if (__pyx_t_17 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #else
                    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #endif
                  } else {
                    __pyx_t_3 = __pyx_t_21(__pyx_t_1);
                    if (unlikely(!__pyx_t_3)) {
                      if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                        if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                        else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      }
                      break;
                    }
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  }
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
                  __pyx_v_j = __pyx_t_3;
                  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line489")'> 489:                             if layer == 0:</pre>
<pre id='line489' class='code' style='background-color: #FFFF79'>
                  /* "LDModel.pyx":489
 * 
 *                         for j in range(len(nodes_curr)):
 *                             if layer == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])
 *                                 self._pi[anc][0][j] = int(nodes_curr[j][5]) / total_parent_count
 */
                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line490")'> 490:                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])</pre>
<pre id='line490' class='code' style='background-color: #FFFF2c'>
                    /* "LDModel.pyx":490
 *                         for j in range(len(nodes_curr)):
 *                             if layer == 0:
 *                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._pi[anc][0][j] = int(nodes_curr[j][5]) / total_parent_count
 *                                 #print "layer: " + str(layer) + " pi in node " + str(j) + " is: " + str(self._pi[anc][0][j])
 */
                    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    __pyx_t_12 = ((PyObject *)__pyx_v_nodes_curr); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_19 = 0;
                    for (;;) {
                      if (__pyx_t_19 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_12)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_22 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_12, __pyx_t_19); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22); __pyx_t_19++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_22 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_19); __pyx_t_19++;<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
                      __pyx_v_x = __pyx_t_22;
                      __pyx_t_22 = 0;
                      __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_22) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_22);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
                      __pyx_t_22 = 0;
                      __pyx_t_22 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_23)); __pyx_t_23 = 0;
                      if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_22)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_3));
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, ((PyObject *)__pyx_t_3));
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_sum, ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_parent_count);
                    __pyx_v_total_parent_count = __pyx_t_3;
                    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line491")'> 491:                                 self._pi[anc][0][j] = int(nodes_curr[j][5]) / total_parent_count</pre>
<pre id='line491' class='code' style='background-color: #FFFF25'>
                    /* "LDModel.pyx":491
 *                             if layer == 0:
 *                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])
 *                                 self._pi[anc][0][j] = int(nodes_curr[j][5]) / total_parent_count             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 #print "layer: " + str(layer) + " pi in node " + str(j) + " is: " + str(self._pi[anc][0][j])
 *                                 #if j > 0:
 */
                    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_12);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_12);
                    __pyx_t_12 = 0;
                    __pyx_t_12 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_12, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_pi[__pyx_t_19])[0])[__pyx_t_18]) = __pyx_t_24;
                    goto __pyx_L52;
                  }
                  __pyx_L52:;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492:                                 #print "layer: " + str(layer) + " pi in node " + str(j) + " is: " + str(self._pi[anc][0][j])</pre>
<pre id='line492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493:                                 #if j &gt; 0:</pre>
<pre id='line493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line494")'> 494:                                 #    print "  pi in previous node " + str(j-1) + " is: " + str(self._pi[anc][0][j-1])</pre>
<pre id='line494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line495")'> 495: </pre>
<pre id='line495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line496")'> 496:                         for j in range(len(nodes_curr)):</pre>
<pre id='line496' class='code' style='background-color: #FFFF20'>
                /* "LDModel.pyx":496
 *                                 #    print "  pi in previous node " + str(j-1) + " is: " + str(self._pi[anc][0][j-1])
 * 
 *                         for j in range(len(nodes_curr)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             # find how many edges go into this node from the previous layer
 *                             edges_num = 0
 */
                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                  __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_17 = 0;
                  __pyx_t_21 = NULL;
                } else {
                  __pyx_t_17 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  __pyx_t_21 = Py_TYPE(__pyx_t_3)->tp_iternext;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                for (;;) {
                  if (!__pyx_t_21 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
                    if (__pyx_t_17 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #else
                    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #endif
                  } else if (!__pyx_t_21 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                    if (__pyx_t_17 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #else
                    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    #endif
                  } else {
                    __pyx_t_1 = __pyx_t_21(__pyx_t_3);
                    if (unlikely(!__pyx_t_1)) {
                      if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                        if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                        else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      }
                      break;
                    }
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  }
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
                  __pyx_v_j = __pyx_t_1;
                  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line497")'> 497:                             # find how many edges go into this node from the previous layer</pre>
<pre id='line497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line498")'> 498:                             edges_num = 0</pre>
<pre id='line498' class='code' style='background-color: #FFFFd4'>
                  /* "LDModel.pyx":498
 *                         for j in range(len(nodes_curr)):
 *                             # find how many edges go into this node from the previous layer
 *                             edges_num = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for k in range(len(nodes_prev)):
 *                                 if nodes_prev[k][3] == nodes_curr[j][2]:
 */
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges_num);
                  __pyx_v_edges_num = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line499")'> 499:                             for k in range(len(nodes_prev)):</pre>
<pre id='line499' class='code' style='background-color: #FFFF20'>
                  /* "LDModel.pyx":499
 *                             # find how many edges go into this node from the previous layer
 *                             edges_num = 0
 *                             for k in range(len(nodes_prev)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 if nodes_prev[k][3] == nodes_curr[j][2]:
 *                                     edges_num += 1
 */
                  __pyx_t_18 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_prev));<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                  __pyx_t_1 = 0;
                  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                    __pyx_t_12 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_18 = 0;
                    __pyx_t_25 = NULL;
                  } else {
                    __pyx_t_18 = -1; __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_25 = Py_TYPE(__pyx_t_12)->tp_iternext;
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  for (;;) {
                    if (!__pyx_t_25 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) {
                      if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_12)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_12, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                    } else if (!__pyx_t_25 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
                      if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_12)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_12, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                    } else {
                      __pyx_t_1 = __pyx_t_25(__pyx_t_12);
                      if (unlikely(!__pyx_t_1)) {
                        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        }
                        break;
                      }
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                    }
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
                    __pyx_v_k = __pyx_t_1;
                    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line500")'> 500:                                 if nodes_prev[k][3] == nodes_curr[j][2]:</pre>
<pre id='line500' class='code' style='background-color: #FFFF41'>
                    /* "LDModel.pyx":500
 *                             edges_num = 0
 *                             for k in range(len(nodes_prev)):
 *                                 if nodes_prev[k][3] == nodes_curr[j][2]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     edges_num += 1
 *                             # create states and set emission probability
 */
                    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_prev), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_22) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_22, __pyx_t_23, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line501")'> 501:                                     edges_num += 1</pre>
<pre id='line501' class='code' style='background-color: #FFFF96'>
                      /* "LDModel.pyx":501
 *                             for k in range(len(nodes_prev)):
 *                                 if nodes_prev[k][3] == nodes_curr[j][2]:
 *                                     edges_num += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             # create states and set emission probability
 *                             error_eps = self.eps*1e-1
 */
                      __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges_num, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_edges_num);
                      __pyx_v_edges_num = __pyx_t_1;
                      __pyx_t_1 = 0;
                      goto __pyx_L59;
                    }
                    __pyx_L59:;
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line502")'> 502:                             # create states and set emission probability</pre>
<pre id='line502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line503")'> 503:                             error_eps = self.eps*1e-1</pre>
<pre id='line503' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":503
 *                                     edges_num += 1
 *                             # create states and set emission probability
 *                             error_eps = self.eps*1e-1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if int(nodes_curr[j][4]) == self._allele_0:
 *                                 self._states[anc][layer][j] = create_state(1 - error_eps, error_eps, 0, edges_num)
 */
                  __pyx_v_error_eps = (__pyx_v_self->eps * 1e-1);
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line504")'> 504:                             if int(nodes_curr[j][4]) == self._allele_0:</pre>
<pre id='line504' class='code' style='background-color: #FFFF35'>
                  /* "LDModel.pyx":504
 *                             # create states and set emission probability
 *                             error_eps = self.eps*1e-1
 *                             if int(nodes_curr[j][4]) == self._allele_0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._states[anc][layer][j] = create_state(1 - error_eps, error_eps, 0, edges_num)
 *                                 #self._states[anc][layer][j] = create_state(1, 0, 0, edges_num)
 */
                  __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                  __pyx_t_1 = 0;
                  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                  __pyx_t_12 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                  __pyx_t_23 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_12, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_23);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line505")'> 505:                                 self._states[anc][layer][j] = create_state(1 - error_eps, error_eps, 0, edges_num)</pre>
<pre id='line505' class='code' style='background-color: #FFFF33'>
                    /* "LDModel.pyx":505
 *                             error_eps = self.eps*1e-1
 *                             if int(nodes_curr[j][4]) == self._allele_0:
 *                                 self._states[anc][layer][j] = create_state(1 - error_eps, error_eps, 0, edges_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 #self._states[anc][layer][j] = create_state(1, 0, 0, edges_num)
 *                             else:
 */
                    __pyx_t_26 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_26 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_states[__pyx_t_18])[__pyx_t_19])[__pyx_t_27]) = create_state((1.0 - __pyx_v_error_eps), __pyx_v_error_eps, 0, __pyx_t_26);
                    goto __pyx_L60;
                  }
                  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line506")'> 506:                                 #self._states[anc][layer][j] = create_state(1, 0, 0, edges_num)</pre>
<pre id='line506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507:                             else:</pre>
<pre id='line507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line508")'> 508:                                 self._states[anc][layer][j] = create_state(error_eps, 1 - error_eps, 0, edges_num)</pre>
<pre id='line508' class='code' style='background-color: #FFFF33'>
                    /* "LDModel.pyx":508
 *                                 #self._states[anc][layer][j] = create_state(1, 0, 0, edges_num)
 *                             else:
 *                                 self._states[anc][layer][j] = create_state(error_eps, 1 - error_eps, 0, edges_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 #self._states[anc][layer][j] = create_state(0, 1, 0, edges_num)
 * 
 */
                    __pyx_t_26 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_26 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_states[__pyx_t_27])[__pyx_t_19])[__pyx_t_18]) = create_state(__pyx_v_error_eps, (1.0 - __pyx_v_error_eps), 0, __pyx_t_26);
                  }
                  __pyx_L60:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line509")'> 509:                                 #self._states[anc][layer][j] = create_state(0, 1, 0, edges_num)</pre>
<pre id='line509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510: </pre>
<pre id='line510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line511")'> 511:                             if layer &gt; 0:</pre>
<pre id='line511' class='code' style='background-color: #FFFF79'>
                  /* "LDModel.pyx":511
 *                                 #self._states[anc][layer][j] = create_state(0, 1, 0, edges_num)
 * 
 *                             if layer > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # allocate memory for the edges
 *                                 self._back_trans[anc][layer][j] = <code><</code>double *> malloc(edges_num * sizeof(double))
 */
                  __pyx_t_23 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_23);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line512")'> 512:                                 # allocate memory for the edges</pre>
<pre id='line512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line513")'> 513:                                 self._back_trans[anc][layer][j] = &lt;double *&gt; malloc(edges_num * sizeof(double))</pre>
<pre id='line513' class='code' style='background-color: #FFFF29'>
                    /* "LDModel.pyx":513
 *                             if layer > 0:
 *                                 # allocate memory for the edges
 *                                 self._back_trans[anc][layer][j] = <code><</code>double *> malloc(edges_num * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._back_trans_idx[anc][layer][j] = <code><</code>int *> malloc(edges_num * sizeof(int))
 *                                 # set the edges transition probabilities
 */
                    __pyx_t_23 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((sizeof(double)));<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                    __pyx_t_28 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_28 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_back_trans[__pyx_t_18])[__pyx_t_19])[__pyx_t_27]) = ((double *)malloc(__pyx_t_28));
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line514")'> 514:                                 self._back_trans_idx[anc][layer][j] = &lt;int *&gt; malloc(edges_num * sizeof(int))</pre>
<pre id='line514' class='code' style='background-color: #FFFF29'>
                    /* "LDModel.pyx":514
 *                                 # allocate memory for the edges
 *                                 self._back_trans[anc][layer][j] = <code><</code>double *> malloc(edges_num * sizeof(double))
 *                                 self._back_trans_idx[anc][layer][j] = <code><</code>int *> malloc(edges_num * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0
 */
                    __pyx_t_12 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((sizeof(int)));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_23 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_28 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_23);<span class='error_goto'> if (unlikely((__pyx_t_28 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                    __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_back_trans_idx[__pyx_t_27])[__pyx_t_19])[__pyx_t_18]) = ((int *)malloc(__pyx_t_28));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line515")'> 515:                                 # set the edges transition probabilities</pre>
<pre id='line515' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line516")'> 516:                                 edge_idx = 0</pre>
<pre id='line516' class='code' style='background-color: #FFFFd4'>
                    /* "LDModel.pyx":516
 *                                 self._back_trans_idx[anc][layer][j] = <code><</code>int *> malloc(edges_num * sizeof(int))
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 sum_back_trans = 0
 *                                 for k in range(len(nodes_prev)):
 */
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_idx);
                    __pyx_v_edge_idx = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line517")'> 517:                                 sum_back_trans = 0</pre>
<pre id='line517' class='code' style='background-color: #FFFFd4'>
                    /* "LDModel.pyx":517
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0
 *                                 sum_back_trans = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for k in range(len(nodes_prev)):
 *                                     if nodes_prev[k][3] == nodes_curr[j][2]:
 */
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum_back_trans);
                    __pyx_v_sum_back_trans = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line518")'> 518:                                 for k in range(len(nodes_prev)):</pre>
<pre id='line518' class='code' style='background-color: #FFFF20'>
                    /* "LDModel.pyx":518
 *                                 edge_idx = 0
 *                                 sum_back_trans = 0
 *                                 for k in range(len(nodes_prev)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     if nodes_prev[k][3] == nodes_curr[j][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])
 */
                    __pyx_t_18 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_prev));<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_23 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_23);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_23);
                    __pyx_t_23 = 0;
                    __pyx_t_23 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_23) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_23)) {
                      __pyx_t_12 = __pyx_t_23; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_18 = 0;
                      __pyx_t_25 = NULL;
                    } else {
                      __pyx_t_18 = -1; __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      __pyx_t_25 = Py_TYPE(__pyx_t_12)->tp_iternext;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                    for (;;) {
                      if (!__pyx_t_25 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) {
                        if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_12)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_23 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_12, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_23 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else if (!__pyx_t_25 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
                        if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_12)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_23 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_12, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_23 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else {
                        __pyx_t_23 = __pyx_t_25(__pyx_t_12);
                        if (unlikely(!__pyx_t_23)) {
                          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          }
                          break;
                        }
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      }
                      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
                      __pyx_v_k = __pyx_t_23;
                      __pyx_t_23 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line519")'> 519:                                     if nodes_prev[k][3] == nodes_curr[j][2]:</pre>
<pre id='line519' class='code' style='background-color: #FFFF41'>
                      /* "LDModel.pyx":519
 *                                 sum_back_trans = 0
 *                                 for k in range(len(nodes_prev)):
 *                                     if nodes_prev[k][3] == nodes_curr[j][2]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])
 *                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count
 */
                      __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_prev), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_23, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                      __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_23, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_22) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                      __pyx_t_23 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_22, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_23);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line520")'> 520:                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])</pre>
<pre id='line520' class='code' style='background-color: #FFFF1f'>
                        /* "LDModel.pyx":520
 *                                 for k in range(len(nodes_prev)):
 *                                     if nodes_prev[k][3] == nodes_curr[j][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count
 *                                         self._back_trans_idx[anc][layer][j][edge_idx] = k
 */
                        __pyx_t_23 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        __pyx_t_22 = ((PyObject *)__pyx_v_nodes_curr); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22); __pyx_t_19 = 0;
                        for (;;) {
                          if (__pyx_t_19 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_22)) break;
                          #if CYTHON_COMPILING_IN_CPYTHON
                          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_22, __pyx_t_19); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_19++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #else
                          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_22, __pyx_t_19); __pyx_t_19++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #endif
                          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
                          __pyx_v_x = __pyx_t_1;
                          __pyx_t_1 = 0;
                          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                          __pyx_t_29 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_29) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                          __pyx_t_30 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_29, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_30) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_30);
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                          __pyx_t_29 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_30, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_29);<span class='error_goto'> if (unlikely(!__pyx_t_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
                          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_29);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                          if (__pyx_t_4) {
                            __pyx_t_29 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_29) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                            __pyx_t_30 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_30);
                            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0, __pyx_t_29);
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_29);
                            __pyx_t_29 = 0;
                            __pyx_t_29 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_30), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_30)); __pyx_t_30 = 0;
                            if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_23, (PyObject*)__pyx_t_29)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                            goto __pyx_L67;
                          }
                          __pyx_L67:;
                        }
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                        __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_23));
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, ((PyObject *)__pyx_t_23));
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_23));
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_23)); __pyx_t_23 = 0;
                        __pyx_t_23 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_sum, ((PyObject *)__pyx_t_22), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_22)); __pyx_t_22 = 0;
                        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_parent_count);
                        __pyx_v_total_parent_count = __pyx_t_23;
                        __pyx_t_23 = 0;
</pre><pre class='line' style='background-color: #FFFF1d' onclick='toggleDiv("line521")'> 521:                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count</pre>
<pre id='line521' class='code' style='background-color: #FFFF1d'>
                        /* "LDModel.pyx":521
 *                                     if nodes_prev[k][3] == nodes_curr[j][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])
 *                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._back_trans_idx[anc][layer][j][edge_idx] = k
 *                                         sum_back_trans += self._back_trans[anc][layer][j][edge_idx]
 */
                        __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_23, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_22) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                        __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_22);
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
                        __pyx_t_22 = 0;
                        __pyx_t_22 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_23)); __pyx_t_23 = 0;
                        __pyx_t_23 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_22, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                        __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_23);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                        __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        ((((__pyx_v_self->_back_trans[__pyx_t_19])[__pyx_t_27])[__pyx_t_31])[__pyx_t_32]) = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line522")'> 522:                                         self._back_trans_idx[anc][layer][j][edge_idx] = k</pre>
<pre id='line522' class='code' style='background-color: #FFFF2a'>
                        /* "LDModel.pyx":522
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])
 *                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count
 *                                         self._back_trans_idx[anc][layer][j][edge_idx] = k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         sum_back_trans += self._back_trans[anc][layer][j][edge_idx]
 *                                         edge_idx += 1
 */
                        __pyx_t_26 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_k);<span class='error_goto'> if (unlikely((__pyx_t_26 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        ((((__pyx_v_self->_back_trans_idx[__pyx_t_32])[__pyx_t_31])[__pyx_t_27])[__pyx_t_19]) = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line523")'> 523:                                         sum_back_trans += self._back_trans[anc][layer][j][edge_idx]</pre>
<pre id='line523' class='code' style='background-color: #FFFF29'>
                        /* "LDModel.pyx":523
 *                                         self._back_trans[anc][layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count
 *                                         self._back_trans_idx[anc][layer][j][edge_idx] = k
 *                                         sum_back_trans += self._back_trans[anc][layer][j][edge_idx]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         edge_idx += 1
 * 
 */
                        __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_back_trans[__pyx_t_19])[__pyx_t_27])[__pyx_t_31])[__pyx_t_32]));<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        __pyx_t_22 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_sum_back_trans, __pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sum_back_trans);
                        __pyx_v_sum_back_trans = __pyx_t_22;
                        __pyx_t_22 = 0;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line524")'> 524:                                         edge_idx += 1</pre>
<pre id='line524' class='code' style='background-color: #FFFF96'>
                        /* "LDModel.pyx":524
 *                                         self._back_trans_idx[anc][layer][j][edge_idx] = k
 *                                         sum_back_trans += self._back_trans[anc][layer][j][edge_idx]
 *                                         edge_idx += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                                 # set initial probabilities for every window
 */
                        __pyx_t_22 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edge_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_edge_idx);
                        __pyx_v_edge_idx = __pyx_t_22;
                        __pyx_t_22 = 0;
                        goto __pyx_L64;
                      }
                      __pyx_L64:;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line525")'> 525: </pre>
<pre id='line525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line526")'> 526:                                 # set initial probabilities for every window</pre>
<pre id='line526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line527")'> 527:                                 if layer % self._win_size == 0:</pre>
<pre id='line527' class='code' style='background-color: #FFFF4d'>
                    /* "LDModel.pyx":527
 * 
 *                                 # set initial probabilities for every window
 *                                 if layer % self._win_size == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._pi[anc][int(layer / self._win_size)][j] = 1 #sum_back_trans
 * 
 */
                    __pyx_t_12 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_win_size);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_22 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_layer, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_22, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line528")'> 528:                                     self._pi[anc][int(layer / self._win_size)][j] = 1 #sum_back_trans</pre>
<pre id='line528' class='code' style='background-color: #FFFF27'>
                      /* "LDModel.pyx":528
 *                                 # set initial probabilities for every window
 *                                 if layer % self._win_size == 0:
 *                                     self._pi[anc][int(layer / self._win_size)][j] = 1 #sum_back_trans             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                         if layer > 0:
 */
                      __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      __pyx_t_12 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_win_size);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      __pyx_t_22 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_layer, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_22);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
                      __pyx_t_22 = 0;
                      __pyx_t_22 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                      __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_22);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                      __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      (((__pyx_v_self->_pi[__pyx_t_18])[__pyx_t_32])[__pyx_t_31]) = 1.0;
                      goto __pyx_L68;
                    }
                    __pyx_L68:;
                    goto __pyx_L61;
                  }
                  __pyx_L61:;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line529")'> 529: </pre>
<pre id='line529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line530")'> 530:                         if layer &gt; 0:</pre>
<pre id='line530' class='code' style='background-color: #FFFF79'>
                /* "LDModel.pyx":530
 *                                     self._pi[anc][int(layer / self._win_size)][j] = 1 #sum_back_trans
 * 
 *                         if layer > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for j in range(len(nodes_prev)):
 *                                 # find how many edges go into this node from the previous layer
 */
                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line531")'> 531:                             for j in range(len(nodes_prev)):</pre>
<pre id='line531' class='code' style='background-color: #FFFF20'>
                  /* "LDModel.pyx":531
 * 
 *                         if layer > 0:
 *                             for j in range(len(nodes_prev)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # find how many edges go into this node from the previous layer
 *                                 edges_num = 0
 */
                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_prev));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_3);
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                  __pyx_t_3 = 0;
                  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_22), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_22)); __pyx_t_22 = 0;
                  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                    __pyx_t_22 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22); __pyx_t_17 = 0;
                    __pyx_t_21 = NULL;
                  } else {
                    __pyx_t_17 = -1; __pyx_t_22 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                    __pyx_t_21 = Py_TYPE(__pyx_t_22)->tp_iternext;
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  for (;;) {
                    if (!__pyx_t_21 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_22)) {
                      if (__pyx_t_17 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_22)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_22, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_22, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                    } else if (!__pyx_t_21 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_22)) {
                      if (__pyx_t_17 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_22)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_22, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_17++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_22, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                    } else {
                      __pyx_t_3 = __pyx_t_21(__pyx_t_22);
                      if (unlikely(!__pyx_t_3)) {
                        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        }
                        break;
                      }
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    }
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
                    __pyx_v_j = __pyx_t_3;
                    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532:                                 # find how many edges go into this node from the previous layer</pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line533")'> 533:                                 edges_num = 0</pre>
<pre id='line533' class='code' style='background-color: #FFFFd4'>
                    /* "LDModel.pyx":533
 *                             for j in range(len(nodes_prev)):
 *                                 # find how many edges go into this node from the previous layer
 *                                 edges_num = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 */
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges_num);
                    __pyx_v_edges_num = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line534")'> 534:                                 for k in range(len(nodes_curr)):</pre>
<pre id='line534' class='code' style='background-color: #FFFF20'>
                    /* "LDModel.pyx":534
 *                                 # find how many edges go into this node from the previous layer
 *                                 edges_num = 0
 *                                 for k in range(len(nodes_curr)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 *                                         edges_num += 1
 */
                    __pyx_t_31 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_31 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_31);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                    __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                      __pyx_t_12 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_31 = 0;
                      __pyx_t_25 = NULL;
                    } else {
                      __pyx_t_31 = -1; __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      __pyx_t_25 = Py_TYPE(__pyx_t_12)->tp_iternext;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    for (;;) {
                      if (!__pyx_t_25 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) {
                        if (__pyx_t_31 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_12)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_12, __pyx_t_31); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_31++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_31); __pyx_t_31++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else if (!__pyx_t_25 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
                        if (__pyx_t_31 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_12)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_12, __pyx_t_31); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_31++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_31); __pyx_t_31++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else {
                        __pyx_t_3 = __pyx_t_25(__pyx_t_12);
                        if (unlikely(!__pyx_t_3)) {
                          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          }
                          break;
                        }
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      }
                      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
                      __pyx_v_k = __pyx_t_3;
                      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line535")'> 535:                                     if nodes_prev[j][3] == nodes_curr[k][2]:</pre>
<pre id='line535' class='code' style='background-color: #FFFF41'>
                      /* "LDModel.pyx":535
 *                                 edges_num = 0
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         edges_num += 1
 * 
 */
                      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_prev), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_29 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_29) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_23, __pyx_t_29, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line536")'> 536:                                         edges_num += 1</pre>
<pre id='line536' class='code' style='background-color: #FFFF96'>
                        /* "LDModel.pyx":536
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 *                                         edges_num += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                                 # set states
 */
                        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges_num, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_edges_num);
                        __pyx_v_edges_num = __pyx_t_3;
                        __pyx_t_3 = 0;
                        goto __pyx_L74;
                      }
                      __pyx_L74:;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line537")'> 537: </pre>
<pre id='line537' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538:                                 # set states</pre>
<pre id='line538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line539")'> 539:                                 self._states[anc][layer-1][j].out_trans_num = edges_num</pre>
<pre id='line539' class='code' style='background-color: #FFFF2d'>
                    /* "LDModel.pyx":539
 * 
 *                                 # set states
 *                                 self._states[anc][layer-1][j].out_trans_num = edges_num             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # allocate memory for the edges
 *                                 self._trans[anc][layer-1][j] = <code><</code>double *> malloc(edges_num * sizeof(double))
 */
                    __pyx_t_26 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_26 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_states[__pyx_t_31])[__pyx_t_32])[__pyx_t_18]).out_trans_num = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line540")'> 540:                                 # allocate memory for the edges</pre>
<pre id='line540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line541")'> 541:                                 self._trans[anc][layer-1][j] = &lt;double *&gt; malloc(edges_num * sizeof(double))</pre>
<pre id='line541' class='code' style='background-color: #FFFF25'>
                    /* "LDModel.pyx":541
 *                                 self._states[anc][layer-1][j].out_trans_num = edges_num
 *                                 # allocate memory for the edges
 *                                 self._trans[anc][layer-1][j] = <code><</code>double *> malloc(edges_num * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._trans_idx[anc][layer-1][j] = <code><</code>int *> malloc(edges_num * sizeof(int))
 *                                 # set the edges transition probabilities
 */
                    __pyx_t_12 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((sizeof(double)));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_28 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_28 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 541; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_trans[__pyx_t_18])[__pyx_t_32])[__pyx_t_31]) = ((double *)malloc(__pyx_t_28));
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line542")'> 542:                                 self._trans_idx[anc][layer-1][j] = &lt;int *&gt; malloc(edges_num * sizeof(int))</pre>
<pre id='line542' class='code' style='background-color: #FFFF25'>
                    /* "LDModel.pyx":542
 *                                 # allocate memory for the edges
 *                                 self._trans[anc][layer-1][j] = <code><</code>double *> malloc(edges_num * sizeof(double))
 *                                 self._trans_idx[anc][layer-1][j] = <code><</code>int *> malloc(edges_num * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0
 */
                    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((sizeof(int)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_28 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_28 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    (((__pyx_v_self->_trans_idx[__pyx_t_31])[__pyx_t_32])[__pyx_t_18]) = ((int *)malloc(__pyx_t_28));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line543")'> 543:                                 # set the edges transition probabilities</pre>
<pre id='line543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line544")'> 544:                                 edge_idx = 0</pre>
<pre id='line544' class='code' style='background-color: #FFFFd4'>
                    /* "LDModel.pyx":544
 *                                 self._trans_idx[anc][layer-1][j] = <code><</code>int *> malloc(edges_num * sizeof(int))
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 */
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_idx);
                    __pyx_v_edge_idx = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line545")'> 545:                                 for k in range(len(nodes_curr)):</pre>
<pre id='line545' class='code' style='background-color: #FFFF20'>
                    /* "LDModel.pyx":545
 *                                 # set the edges transition probabilities
 *                                 edge_idx = 0
 *                                 for k in range(len(nodes_curr)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])
 */
                    __pyx_t_18 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_nodes_curr));<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_12 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_12);
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_12);
                    __pyx_t_12 = 0;
                    __pyx_t_12 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
                      __pyx_t_3 = __pyx_t_12; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_18 = 0;
                      __pyx_t_25 = NULL;
                    } else {
                      __pyx_t_18 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_25 = Py_TYPE(__pyx_t_3)->tp_iternext;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                    for (;;) {
                      if (!__pyx_t_25 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
                        if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else if (!__pyx_t_25 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                        if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
                        #if CYTHON_COMPILING_IN_CPYTHON
                        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #else
                        __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        #endif
                      } else {
                        __pyx_t_12 = __pyx_t_25(__pyx_t_3);
                        if (unlikely(!__pyx_t_12)) {
                          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          }
                          break;
                        }
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      }
                      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
                      __pyx_v_k = __pyx_t_12;
                      __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line546")'> 546:                                     if nodes_prev[j][3] == nodes_curr[k][2]:</pre>
<pre id='line546' class='code' style='background-color: #FFFF41'>
                      /* "LDModel.pyx":546
 *                                 edge_idx = 0
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])
 *                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count
 */
                      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_prev), __pyx_v_j);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      __pyx_t_29 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_29) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                      __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_29, __pyx_t_23, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line547")'> 547:                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])</pre>
<pre id='line547' class='code' style='background-color: #FFFF1f'>
                        /* "LDModel.pyx":547
 *                                 for k in range(len(nodes_curr)):
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count
 *                                         self._trans_idx[anc][layer-1][j][edge_idx] = k
 */
                        __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        __pyx_t_23 = ((PyObject *)__pyx_v_nodes_curr); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23); __pyx_t_32 = 0;
                        for (;;) {
                          if (__pyx_t_32 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_23)) break;
                          #if CYTHON_COMPILING_IN_CPYTHON
                          __pyx_t_29 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_23, __pyx_t_32); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_29); __pyx_t_32++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #else
                          __pyx_t_29 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_23, __pyx_t_32); __pyx_t_32++;<span class='error_goto'> if (unlikely(!__pyx_t_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #endif
                          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
                          __pyx_v_x = __pyx_t_29;
                          __pyx_t_29 = 0;
                          __pyx_t_29 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_29) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_29);
                          __pyx_t_30 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_30) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_30);
                          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_30, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
                          __pyx_t_30 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_29, __pyx_t_1, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_30);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_30);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
                          if (__pyx_t_4) {
                            __pyx_t_30 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_30) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_30);
                            __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_30);
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_30);
                            __pyx_t_30 = 0;
                            __pyx_t_30 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_30);
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                            if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_12, (PyObject*)__pyx_t_30)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
                            goto __pyx_L80;
                          }
                          __pyx_L80:;
                        }
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                        __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_12));
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, ((PyObject *)__pyx_t_12));
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_12));
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                        __pyx_t_12 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_sum, ((PyObject *)__pyx_t_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_23)); __pyx_t_23 = 0;
                        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_parent_count);
                        __pyx_v_total_parent_count = __pyx_t_12;
                        __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line548")'> 548:                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count</pre>
<pre id='line548' class='code' style='background-color: #FFFF1b'>
                        /* "LDModel.pyx":548
 *                                     if nodes_prev[j][3] == nodes_curr[k][2]:
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])
 *                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._trans_idx[anc][layer-1][j][edge_idx] = k
 *                                         edge_idx += 1
 */
                        __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_nodes_curr), __pyx_v_k);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_23) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_23);
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_23);
                        __pyx_t_23 = 0;
                        __pyx_t_23 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
                        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_23, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                        __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                        __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        ((((__pyx_v_self->_trans[__pyx_t_32])[__pyx_t_31])[__pyx_t_27])[__pyx_t_19]) = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line549")'> 549:                                         self._trans_idx[anc][layer-1][j][edge_idx] = k</pre>
<pre id='line549' class='code' style='background-color: #FFFF26'>
                        /* "LDModel.pyx":549
 *                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])
 *                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count
 *                                         self._trans_idx[anc][layer-1][j][edge_idx] = k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         edge_idx += 1
 * 
 */
                        __pyx_t_26 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_k);<span class='error_goto'> if (unlikely((__pyx_t_26 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_19 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                        __pyx_t_31 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely((__pyx_t_31 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_32 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_32 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        ((((__pyx_v_self->_trans_idx[__pyx_t_19])[__pyx_t_27])[__pyx_t_31])[__pyx_t_32]) = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line550")'> 550:                                         edge_idx += 1</pre>
<pre id='line550' class='code' style='background-color: #FFFF8d'>
                        /* "LDModel.pyx":550
 *                                         self._trans[anc][layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count
 *                                         self._trans_idx[anc][layer-1][j][edge_idx] = k
 *                                         edge_idx += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                         layer += 1
 */
                        __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edge_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_edge_idx);
                        __pyx_v_edge_idx = __pyx_t_12;
                        __pyx_t_12 = 0;
                        goto __pyx_L77;
                      }
                      __pyx_L77:;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                  goto __pyx_L69;
                }
                __pyx_L69:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line551")'> 551: </pre>
<pre id='line551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line552")'> 552:                         layer += 1</pre>
<pre id='line552' class='code' style='background-color: #FFFF9f'>
                /* "LDModel.pyx":552
 *                                         edge_idx += 1
 * 
 *                         layer += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if layer >= self._snp_num:
 *                             done = True;
 */
                __pyx_t_22 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_layer);
                __pyx_v_layer = __pyx_t_22;
                __pyx_t_22 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line553")'> 553:                         if layer &gt;= self._snp_num:</pre>
<pre id='line553' class='code' style='background-color: #FFFF5e'>
                /* "LDModel.pyx":553
 * 
 *                         layer += 1
 *                         if layer >= self._snp_num:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             done = True;
 *                             break
 */
                __pyx_t_22 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_t_22, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
                __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line554")'> 554:                             done = True;</pre>
<pre id='line554' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":554
 *                         layer += 1
 *                         if layer >= self._snp_num:
 *                             done = True;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             break
 *         print "Finished reading beagle file."
 */
                  __pyx_v_done = 1;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line555")'> 555:                             break</pre>
<pre id='line555' class='code' style='background-color: #FFFF73'>
                  /* "LDModel.pyx":555
 *                         if layer >= self._snp_num:
 *                             done = True;
 *                             break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print "Finished reading beagle file."
 * #         if self._debug:
 */
                  goto __pyx_L46_break;
                  goto __pyx_L81;
                }
                __pyx_L81:;
              }
              __pyx_L47:;
            }
            __pyx_L46_break:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          }
          __pyx_L41_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L38_try_end;
        __pyx_L31_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line556")'> 556:         print "Finished reading beagle file."</pre>
<pre id='line556' class='code' style='background-color: #FFFF22'>
  /* "LDModel.pyx":556
 *                             done = True;
 *                             break
 *         print "Finished reading beagle file."             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #         if self._debug:
 * #             self.print_transitions()
 */
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_42)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_model_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_curr_allele);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blank_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes_prev);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes_curr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_parent_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges_num);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum_back_trans);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_21set_ibs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_21set_ibs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ibs_dic = 0;
  PyObject *__pyx_v_by_position = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__ibs_dic,&__pyx_n_s__by_position,0};
    PyObject* values[2] = {0,0};
    values[1] = __pyx_k_43;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ibs_dic)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__by_position);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_ibs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_ibs_dic = values[0];
    __pyx_v_by_position = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_ibs", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_20set_ibs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_ibs_dic, __pyx_v_by_position);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line557")'> 557: #         if self._debug:</pre>
<pre id='line557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558: #             self.print_transitions()</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559: </pre>
<pre id='line559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line560")'> 560:                 #p = [self._pi[anc][i] for i in xrange(self._layer_state_nums[anc][0])]</pre>
<pre id='line560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line561")'> 561:                 #print "pi: " + str(p)</pre>
<pre id='line561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line562")'> 562: </pre>
<pre id='line562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line563")'> 563:     def set_ibs(self, ibs_dic, by_position = True):</pre>
<pre id='line563' class='code' style='background-color: #FFFF96'>
/* "LDModel.pyx":563
 *                 #print "pi: " + str(p)
 * 
 *     def set_ibs(self, ibs_dic, by_position = True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._debug:
 *             self._ibs_file.write(self._prefix_string + " ")
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_20set_ibs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_ibs_dic, PyObject *__pyx_v_by_position) {
  int __pyx_v_win_idx;
  PyObject *__pyx_v_inter = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_ibs", __pyx_f[0], 563);

  /* "LDModel.pyx":563
 *                 #print "pi: " + str(p)
 * 
 *     def set_ibs(self, ibs_dic, by_position = True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._debug:
 *             self._ibs_file.write(self._prefix_string + " ")
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_43 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line564")'> 564:         if self._debug:</pre>
<pre id='line564' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":564
 * 
 *     def set_ibs(self, ibs_dic, by_position = True):
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.write(self._prefix_string + " ")
 *         for win_idx in range(self.get_num_windows()):
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line565")'> 565:             self._ibs_file.write(self._prefix_string + " ")</pre>
<pre id='line565' class='code' style='background-color: #FFFF3f'>
    /* "LDModel.pyx":565
 *     def set_ibs(self, ibs_dic, by_position = True):
 *         if self._debug:
 *             self._ibs_file.write(self._prefix_string + " ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_prefix_string);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_2), ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line566")'> 566:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line566' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":566
 *         if self._debug:
 *             self._ibs_file.write(self._prefix_string + " ")
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if by_position:
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 */
  __pyx_t_4 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_win_idx = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line567")'> 567:             if by_position:</pre>
<pre id='line567' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":567
 *             self._ibs_file.write(self._prefix_string + " ")
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 *             else:
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_by_position);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 567; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line568")'> 568:                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])</pre>
<pre id='line568' class='code' style='background-color: #FFFF3f'>
      /* "LDModel.pyx":568
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 */
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_ibs_dic, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx)]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx) - 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
      __pyx_v_inter = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L6;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line569")'> 569:             else:</pre>
<pre id='line569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line570")'> 570:                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))</pre>
<pre id='line570' class='code' style='background-color: #FFFF3f'>
      /* "LDModel.pyx":570
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if len(inter) > 0:
 *                 self._ibs[win_idx] = True
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_ibs_dic, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_7 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
      __pyx_v_inter = __pyx_t_3;
      __pyx_t_3 = 0;
    }
    __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line571")'> 571:             if len(inter) &gt; 0:</pre>
<pre id='line571' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":571
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 *             if len(inter) > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibs[win_idx] = True
 *             else:
 */
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_inter);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = (__pyx_t_8 > 0);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line572")'> 572:                 self._ibs[win_idx] = True</pre>
<pre id='line572' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":572
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 *             if len(inter) > 0:
 *                 self._ibs[win_idx] = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 self._ibs[win_idx] = False
 */
      (__pyx_v_self->_ibs[__pyx_v_win_idx]) = 1;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line573")'> 573:             else:</pre>
<pre id='line573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line574")'> 574:                 self._ibs[win_idx] = False</pre>
<pre id='line574' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":574
 *                 self._ibs[win_idx] = True
 *             else:
 *                 self._ibs[win_idx] = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #self._ibs[win_idx] = True
 *             if self._debug:
 */
      (__pyx_v_self->_ibs[__pyx_v_win_idx]) = 0;
    }
    __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line575")'> 575:             #self._ibs[win_idx] = True</pre>
<pre id='line575' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line576")'> 576:             if self._debug:</pre>
<pre id='line576' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":576
 *                 self._ibs[win_idx] = False
 *             #self._ibs[win_idx] = True
 *             if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibs_file.write(str(int(self._ibs[win_idx])) + " ")
 * 
 */
    if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line577")'> 577:                 self._ibs_file.write(str(int(self._ibs[win_idx])) + " ")</pre>
<pre id='line577' class='code' style='background-color: #FFFF27'>
      /* "LDModel.pyx":577
 *             #self._ibs[win_idx] = True
 *             if self._debug:
 *                 self._ibs_file.write(str(int(self._ibs[win_idx])) + " ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._debug:
 */
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibs[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578: </pre>
<pre id='line578' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579:         if self._debug:</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":579
 *                 self._ibs_file.write(str(int(self._ibs[win_idx])) + " ")
 * 
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.write("\n")
 *             self._ibs_file.flush()
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line580")'> 580:             self._ibs_file.write("\n")</pre>
<pre id='line580' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":580
 * 
 *         if self._debug:
 *             self._ibs_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.flush()
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_44), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "LDModel.pyx":580
 * 
 *         if self._debug:
 *             self._ibs_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.flush()
 * 
 */
  __pyx_k_tuple_44 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_44);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_44, 0, ((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_44));
</pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line581")'> 581:             self._ibs_file.flush()</pre>
<pre id='line581' class='code' style='background-color: #FFFF28'>
    /* "LDModel.pyx":581
 *         if self._debug:
 *             self._ibs_file.write("\n")
 *             self._ibs_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L9;
  }
  __pyx_L9:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_23set_ibd_segment_endpoints(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_23set_ibd_segment_endpoints(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ibs_dic = 0;
  PyObject *__pyx_v_by_position = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibd_segment_endpoints (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__ibs_dic,&__pyx_n_s__by_position,0};
    PyObject* values[2] = {0,0};
    values[1] = __pyx_k_45;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ibs_dic)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__by_position);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_ibd_segment_endpoints") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_ibs_dic = values[0];
    __pyx_v_by_position = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_ibd_segment_endpoints", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibd_segment_endpoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_22set_ibd_segment_endpoints(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_ibs_dic, __pyx_v_by_position);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line582")'> 582: </pre>
<pre id='line582' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line583")'> 583:     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):</pre>
<pre id='line583' class='code' style='background-color: #FFFF96'>
/* "LDModel.pyx":583
 *             self._ibs_file.flush()
 * 
 *     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef bool* tmp_ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_22set_ibd_segment_endpoints(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_ibs_dic, PyObject *__pyx_v_by_position) {
  bool *__pyx_v_tmp_ibs;
  PyObject *__pyx_v_win_idx = NULL;
  PyObject *__pyx_v_inter = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_ibd_segment_endpoints", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_ibd_segment_endpoints", __pyx_f[0], 583);

  /* "LDModel.pyx":583
 *             self._ibs_file.flush()
 * 
 *     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef bool* tmp_ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_45 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584:         cdef bool* tmp_ibs = &lt;bool *&gt; malloc(self.get_num_windows() * sizeof(bool))</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":584
 * 
 *     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):
 *         cdef bool* tmp_ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:
 */
  __pyx_v_tmp_ibs = ((bool *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line585")'> 585:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line585' class='code' style='background-color: #FFFF20'>
  /* "LDModel.pyx":585
 *     def set_ibd_segment_endpoints(self, ibs_dic, by_position = True):
 *         cdef bool* tmp_ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if by_position:
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_win_idx);
    __pyx_v_win_idx = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line586")'> 586:             if by_position:</pre>
<pre id='line586' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":586
 *         cdef bool* tmp_ibs = <code><</code>bool *> malloc(self.get_num_windows() * sizeof(bool))
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 *             else:
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_by_position);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line587")'> 587:                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])</pre>
<pre id='line587' class='code' style='background-color: #FFFF2a'>
      /* "LDModel.pyx":587
 *         for win_idx in range(self.get_num_windows()):
 *             if by_position:
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_ibs_dic, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_6)]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_6) - 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
      __pyx_t_7 = 0;
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
      __pyx_v_inter = __pyx_t_8;
      __pyx_t_8 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line588")'> 588:             else:</pre>
<pre id='line588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line589")'> 589:                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))</pre>
<pre id='line589' class='code' style='background-color: #FFFF2a'>
      /* "LDModel.pyx":589
 *                 inter = ibs_dic.find(self._position[self.start_snp(win_idx)],self._position[self.end_snp(win_idx)-1])
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if len(inter) > 0:
 *                 tmp_ibs[win_idx] = True
 */
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_ibs_dic, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_6));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_6));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_9 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
      __pyx_v_inter = __pyx_t_1;
      __pyx_t_1 = 0;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line590")'> 590:             if len(inter) &gt; 0:</pre>
<pre id='line590' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":590
 *             else:
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 *             if len(inter) > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 tmp_ibs[win_idx] = True
 *             else:
 */
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_inter);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = (__pyx_t_10 > 0);
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line591")'> 591:                 tmp_ibs[win_idx] = True</pre>
<pre id='line591' class='code' style='background-color: #FFFF7f'>
      /* "LDModel.pyx":591
 *                 inter = ibs_dic.find(self.start_snp(win_idx),self.end_snp(win_idx))
 *             if len(inter) > 0:
 *                 tmp_ibs[win_idx] = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 tmp_ibs[win_idx] = False
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      (__pyx_v_tmp_ibs[__pyx_t_10]) = 1;
      goto __pyx_L6;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line592")'> 592:             else:</pre>
<pre id='line592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line593")'> 593:                 tmp_ibs[win_idx] = False</pre>
<pre id='line593' class='code' style='background-color: #FFFF79'>
      /* "LDModel.pyx":593
 *                 tmp_ibs[win_idx] = True
 *             else:
 *                 tmp_ibs[win_idx] = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._ibd_segment_start[0] = tmp_ibs[0]
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      (__pyx_v_tmp_ibs[__pyx_t_10]) = 0;
    }
    __pyx_L6:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594: </pre>
<pre id='line594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595:         self._ibd_segment_start[0] = tmp_ibs[0]</pre>
<pre id='line595' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":595
 *                 tmp_ibs[win_idx] = False
 * 
 *         self._ibd_segment_start[0] = tmp_ibs[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ibd_segment_end[self.get_num_windows()-1] = tmp_ibs[self.get_num_windows()-1]
 *         for win_idx in range(1,self.get_num_windows()-1):
 */
  (__pyx_v_self->_ibd_segment_start[0]) = (__pyx_v_tmp_ibs[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596:         self._ibd_segment_end[self.get_num_windows()-1] = tmp_ibs[self.get_num_windows()-1]</pre>
<pre id='line596' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":596
 * 
 *         self._ibd_segment_start[0] = tmp_ibs[0]
 *         self._ibd_segment_end[self.get_num_windows()-1] = tmp_ibs[self.get_num_windows()-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(1,self.get_num_windows()-1):
 *             # keep only start and end windows as IBS
 */
  (__pyx_v_self->_ibd_segment_end[(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) - 1)]) = (__pyx_v_tmp_ibs[(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) - 1)]);
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line597")'> 597:         for win_idx in range(1,self.get_num_windows()-1):</pre>
<pre id='line597' class='code' style='background-color: #FFFF1f'>
  /* "LDModel.pyx":597
 *         self._ibd_segment_start[0] = tmp_ibs[0]
 *         self._ibd_segment_end[self.get_num_windows()-1] = tmp_ibs[self.get_num_windows()-1]
 *         for win_idx in range(1,self.get_num_windows()-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # keep only start and end windows as IBS
 *             if tmp_ibs[win_idx] and not tmp_ibs[win_idx-1]:
 */
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_win_idx);
    __pyx_v_win_idx = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598:             # keep only start and end windows as IBS</pre>
<pre id='line598' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line599")'> 599:             if tmp_ibs[win_idx] and not tmp_ibs[win_idx-1]:</pre>
<pre id='line599' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":599
 *         for win_idx in range(1,self.get_num_windows()-1):
 *             # keep only start and end windows as IBS
 *             if tmp_ibs[win_idx] and not tmp_ibs[win_idx-1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibd_segment_start[win_idx] = True
 *             elif tmp_ibs[win_idx] and not tmp_ibs[win_idx+1]:
 */
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if ((__pyx_v_tmp_ibs[__pyx_t_10])) {
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_win_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_5 = (!(__pyx_v_tmp_ibs[__pyx_t_11]));
      __pyx_t_12 = __pyx_t_5;
    } else {
      __pyx_t_12 = (__pyx_v_tmp_ibs[__pyx_t_10]);
    }
    if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line600")'> 600:                 self._ibd_segment_start[win_idx] = True</pre>
<pre id='line600' class='code' style='background-color: #FFFF7f'>
      /* "LDModel.pyx":600
 *             # keep only start and end windows as IBS
 *             if tmp_ibs[win_idx] and not tmp_ibs[win_idx-1]:
 *                 self._ibd_segment_start[win_idx] = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif tmp_ibs[win_idx] and not tmp_ibs[win_idx+1]:
 *                 self._ibd_segment_end[win_idx] = True
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      (__pyx_v_self->_ibd_segment_start[__pyx_t_10]) = 1;
      goto __pyx_L9;
    }
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line601")'> 601:             elif tmp_ibs[win_idx] and not tmp_ibs[win_idx+1]:</pre>
<pre id='line601' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":601
 *             if tmp_ibs[win_idx] and not tmp_ibs[win_idx-1]:
 *                 self._ibd_segment_start[win_idx] = True
 *             elif tmp_ibs[win_idx] and not tmp_ibs[win_idx+1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibd_segment_end[win_idx] = True
 * 
 */
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if ((__pyx_v_tmp_ibs[__pyx_t_10])) {
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_win_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = (!(__pyx_v_tmp_ibs[__pyx_t_11]));
      __pyx_t_5 = __pyx_t_12;
    } else {
      __pyx_t_5 = (__pyx_v_tmp_ibs[__pyx_t_10]);
    }
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line602")'> 602:                 self._ibd_segment_end[win_idx] = True</pre>
<pre id='line602' class='code' style='background-color: #FFFF79'>
      /* "LDModel.pyx":602
 *                 self._ibd_segment_start[win_idx] = True
 *             elif tmp_ibs[win_idx] and not tmp_ibs[win_idx+1]:
 *                 self._ibd_segment_end[win_idx] = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._debug:
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      (__pyx_v_self->_ibd_segment_end[__pyx_t_10]) = 1;
      goto __pyx_L9;
    }
    __pyx_L9:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line603")'> 603: </pre>
<pre id='line603' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604:         if self._debug:</pre>
<pre id='line604' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":604
 *                 self._ibd_segment_end[win_idx] = True
 * 
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line605")'> 605:             for win_idx in range(self.get_num_windows()):</pre>
<pre id='line605' class='code' style='background-color: #FFFF20'>
    /* "LDModel.pyx":605
 * 
 *         if self._debug:
 *             for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")
 *             self._ibs_file.write("\n")
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
        if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_win_idx);
      __pyx_v_win_idx = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line606")'> 606:                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")</pre>
<pre id='line606' class='code' style='background-color: #FFFF22'>
      /* "LDModel.pyx":606
 *         if self._debug:
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ibs_file.write("\n")
 *             for win_idx in range(self.get_num_windows()):
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibd_segment_start[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line607")'> 607:             self._ibs_file.write("\n")</pre>
<pre id='line607' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":607
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")
 *             self._ibs_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_46), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;

  /* "LDModel.pyx":607
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")
 *             self._ibs_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")
 */
  __pyx_k_tuple_46 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_46);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_46, 0, ((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_46));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line608")'> 608:             for win_idx in range(self.get_num_windows()):</pre>
<pre id='line608' class='code' style='background-color: #FFFF20'>
    /* "LDModel.pyx":608
 *                 self._ibs_file.write(str(int(self._ibd_segment_start[win_idx])) + " ")
 *             self._ibs_file.write("\n")
 *             for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")
 * 
 */
    __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
      __pyx_t_2 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    for (;;) {
      if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
        if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_8 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_8)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_win_idx);
      __pyx_v_win_idx = __pyx_t_8;
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line609")'> 609:                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")</pre>
<pre id='line609' class='code' style='background-color: #FFFF22'>
      /* "LDModel.pyx":609
 *             self._ibs_file.write("\n")
 *             for win_idx in range(self.get_num_windows()):
 *                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         free(tmp_ibs)
 */
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ibs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibd_segment_end[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L10;
  }
  __pyx_L10:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line610")'> 610: </pre>
<pre id='line610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line611")'> 611:         free(tmp_ibs)</pre>
<pre id='line611' class='code' style='background-color: #FFFF6a'>
  /* "LDModel.pyx":611
 *                 self._ibs_file.write(str(int(self._ibd_segment_end[win_idx])) + " ")
 * 
 *         free(tmp_ibs)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def print_ibs(self):
 */
  free(__pyx_v_tmp_ibs);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_ibd_segment_endpoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_win_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inter);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_25print_ibs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_25print_ibs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibs (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_24print_ibs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: </pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line613")'> 613:     def print_ibs(self):</pre>
<pre id='line613' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":613
 *         free(tmp_ibs)
 * 
 *     def print_ibs(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_24print_ibs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_ibs_s = NULL;
  int __pyx_v_win_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_ibs", __pyx_f[0], 613);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line614")'> 614:         ibs_s = ""</pre>
<pre id='line614' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":614
 * 
 *     def print_ibs(self):
 *         ibs_s = ""             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibs[win_idx])) + " "
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_47));
  __pyx_v_ibs_s = ((PyObject *)__pyx_kp_s_47);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line615' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":615
 *     def print_ibs(self):
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ibs_s += str(int(self._ibs[win_idx])) + " "
 *         print ibs_s
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_win_idx = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line616")'> 616:             ibs_s += str(int(self._ibs[win_idx])) + " "</pre>
<pre id='line616' class='code' style='background-color: #FFFF31'>
    /* "LDModel.pyx":616
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibs[win_idx])) + " "             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print ibs_s
 * 
 */
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibs[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_ibs_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ibs_s);
    __pyx_v_ibs_s = __pyx_t_3;
    __pyx_t_3 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line617")'> 617:         print ibs_s</pre>
<pre id='line617' class='code' style='background-color: #FFFF73'>
  /* "LDModel.pyx":617
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibs[win_idx])) + " "
 *         print ibs_s             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def print_ibd_segment_start(self):
 */
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_v_ibs_s) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_ibs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ibs_s);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_27print_ibd_segment_start(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_27print_ibd_segment_start(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibd_segment_start (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_26print_ibd_segment_start(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618: </pre>
<pre id='line618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line619")'> 619:     def print_ibd_segment_start(self):</pre>
<pre id='line619' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":619
 *         print ibs_s
 * 
 *     def print_ibd_segment_start(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_26print_ibd_segment_start(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_ibs_s = NULL;
  int __pyx_v_win_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibd_segment_start", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_ibd_segment_start", __pyx_f[0], 619);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line620")'> 620:         ibs_s = ""</pre>
<pre id='line620' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":620
 * 
 *     def print_ibd_segment_start(self):
 *         ibs_s = ""             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_start[win_idx])) + " "
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_47));
  __pyx_v_ibs_s = ((PyObject *)__pyx_kp_s_47);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line621")'> 621:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line621' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":621
 *     def print_ibd_segment_start(self):
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ibs_s += str(int(self._ibd_segment_start[win_idx])) + " "
 *         print ibs_s
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_win_idx = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line622")'> 622:             ibs_s += str(int(self._ibd_segment_start[win_idx])) + " "</pre>
<pre id='line622' class='code' style='background-color: #FFFF31'>
    /* "LDModel.pyx":622
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_start[win_idx])) + " "             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print ibs_s
 * 
 */
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_ibs_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ibs_s);
    __pyx_v_ibs_s = __pyx_t_3;
    __pyx_t_3 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line623")'> 623:         print ibs_s</pre>
<pre id='line623' class='code' style='background-color: #FFFF73'>
  /* "LDModel.pyx":623
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_start[win_idx])) + " "
 *         print ibs_s             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def print_ibd_segment_end(self):
 */
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_v_ibs_s) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_ibd_segment_start", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ibs_s);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_29print_ibd_segment_end(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_29print_ibd_segment_end(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibd_segment_end (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_28print_ibd_segment_end(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624: </pre>
<pre id='line624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line625")'> 625:     def print_ibd_segment_end(self):</pre>
<pre id='line625' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":625
 *         print ibs_s
 * 
 *     def print_ibd_segment_end(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_28print_ibd_segment_end(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_ibs_s = NULL;
  int __pyx_v_win_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_ibd_segment_end", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_ibd_segment_end", __pyx_f[0], 625);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line626")'> 626:         ibs_s = ""</pre>
<pre id='line626' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":626
 * 
 *     def print_ibd_segment_end(self):
 *         ibs_s = ""             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_end[win_idx])) + " "
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_47));
  __pyx_v_ibs_s = ((PyObject *)__pyx_kp_s_47);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line627' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":627
 *     def print_ibd_segment_end(self):
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ibs_s += str(int(self._ibd_segment_end[win_idx])) + " "
 *         print ibs_s
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_win_idx = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line628")'> 628:             ibs_s += str(int(self._ibd_segment_end[win_idx])) + " "</pre>
<pre id='line628' class='code' style='background-color: #FFFF31'>
    /* "LDModel.pyx":628
 *         ibs_s = ""
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_end[win_idx])) + " "             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print ibs_s
 * 
 */
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>((__pyx_v_self->_ibd_segment_end[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_ibs_s, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ibs_s);
    __pyx_v_ibs_s = __pyx_t_3;
    __pyx_t_3 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line629")'> 629:         print ibs_s</pre>
<pre id='line629' class='code' style='background-color: #FFFF73'>
  /* "LDModel.pyx":629
 *         for win_idx in range(self.get_num_windows()):
 *             ibs_s += str(int(self._ibd_segment_end[win_idx])) + " "
 *         print ibs_s             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_haplo_num(self):
 */
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_v_ibs_s) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_ibd_segment_end", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ibs_s);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_31get_haplo_num(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_31get_haplo_num(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_haplo_num (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_30get_haplo_num(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line630")'> 630: </pre>
<pre id='line630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line631")'> 631:     def get_haplo_num(self):</pre>
<pre id='line631' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":631
 *         print ibs_s
 * 
 *     def get_haplo_num(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._nr_haplos
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_30get_haplo_num(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_haplo_num", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_haplo_num", __pyx_f[0], 631);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line632")'> 632:         return self._nr_haplos</pre>
<pre id='line632' class='code' style='background-color: #FFFF6a'>
  /* "LDModel.pyx":632
 * 
 *     def get_haplo_num(self):
 *         return self._nr_haplos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_snp_num(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_haplo_num", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_33get_snp_num(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_33get_snp_num(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_snp_num (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_32get_snp_num(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633: </pre>
<pre id='line633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line634")'> 634:     def get_snp_num(self):</pre>
<pre id='line634' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":634
 *         return self._nr_haplos
 * 
 *     def get_snp_num(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._snp_num
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_32get_snp_num(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_snp_num", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_snp_num", __pyx_f[0], 634);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line635")'> 635:         return self._snp_num</pre>
<pre id='line635' class='code' style='background-color: #FFFF6a'>
  /* "LDModel.pyx":635
 * 
 *     def get_snp_num(self):
 *         return self._snp_num             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_haplo(self,hap_idx):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_snp_num", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_35get_haplo(PyObject *__pyx_v_self, PyObject *__pyx_v_hap_idx); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_35get_haplo(PyObject *__pyx_v_self, PyObject *__pyx_v_hap_idx) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_haplo (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_34get_haplo(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_hap_idx));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636: </pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line637")'> 637:     def get_haplo(self,hap_idx):</pre>
<pre id='line637' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":637
 *         return self._snp_num
 * 
 *     def get_haplo(self,hap_idx):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #pystring = self._haplos[hap_idx][:self._snp_num].decode('UTF-8')
 *         pystring = self._haplos[hap_idx][:self._snp_num]
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_34get_haplo(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_hap_idx) {
  PyObject *__pyx_v_pystring = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_haplo", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_haplo", __pyx_f[0], 637);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line638")'> 638:         #pystring = self._haplos[hap_idx][:self._snp_num].decode('UTF-8')</pre>
<pre id='line638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line639")'> 639:         pystring = self._haplos[hap_idx][:self._snp_num]</pre>
<pre id='line639' class='code' style='background-color: #FFFF66'>
  /* "LDModel.pyx":639
 *     def get_haplo(self,hap_idx):
 *         #pystring = self._haplos[hap_idx][:self._snp_num].decode('UTF-8')
 *         pystring = self._haplos[hap_idx][:self._snp_num]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return pystring
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_1 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyBytes_FromStringAndSize</span>(((const char*)(__pyx_v_self->_haplos[__pyx_t_1])) + 0, __pyx_v_self->_snp_num - 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_v_pystring = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line640")'> 640:         return pystring</pre>
<pre id='line640' class='code' style='background-color: #FFFF31'>
  /* "LDModel.pyx":640
 *         #pystring = self._haplos[hap_idx][:self._snp_num].decode('UTF-8')
 *         pystring = self._haplos[hap_idx][:self._snp_num]
 *         return pystring             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_haplo(self,hap_idx,hap):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pystring);
  __pyx_r = __pyx_v_pystring;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_haplo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pystring);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_37set_haplo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_37set_haplo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_hap_idx = 0;
  PyObject *__pyx_v_hap = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_haplo (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__hap_idx,&__pyx_n_s__hap,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_haplo", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_haplo") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_hap_idx = values[0];
    __pyx_v_hap = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_haplo", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_haplo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_36set_haplo(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_hap_idx, __pyx_v_hap);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line641")'> 641: </pre>
<pre id='line641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line642")'> 642:     def set_haplo(self,hap_idx,hap):</pre>
<pre id='line642' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":642
 *         return pystring
 * 
 *     def set_haplo(self,hap_idx,hap):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         strncpy(self._haplos[hap_idx], hap, self._snp_num)
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_36set_haplo(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_hap_idx, PyObject *__pyx_v_hap) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_haplo", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("set_haplo", __pyx_f[0], 642);
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line643")'> 643:         strncpy(self._haplos[hap_idx], hap, self._snp_num)</pre>
<pre id='line643' class='code' style='background-color: #FFFF44'>
  /* "LDModel.pyx":643
 * 
 *     def set_haplo(self,hap_idx,hap):
 *         strncpy(self._haplos[hap_idx], hap, self._snp_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_layer_node_nums(self, anc):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_1 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyBytes_AsString</span>(__pyx_v_hap);<span class='error_goto'> if (unlikely((!__pyx_t_2) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  strncpy((__pyx_v_self->_haplos[__pyx_t_1]), __pyx_t_2, __pyx_v_self->_snp_num);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.set_haplo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_39get_layer_node_nums(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_39get_layer_node_nums(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_layer_node_nums (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_38get_layer_node_nums(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644: </pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line645")'> 645:     def get_layer_node_nums(self, anc):</pre>
<pre id='line645' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":645
 *         strncpy(self._haplos[hap_idx], hap, self._snp_num)
 * 
 *     def get_layer_node_nums(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         node_nums = []
 *         for layer in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_38get_layer_node_nums(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_node_nums = NULL;
  int __pyx_v_layer;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_layer_node_nums", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_layer_node_nums", __pyx_f[0], 645);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line646")'> 646:         node_nums = []</pre>
<pre id='line646' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":646
 * 
 *     def get_layer_node_nums(self, anc):
 *         node_nums = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(self._snp_num):
 *             node_nums.append(self._layer_state_nums[anc][layer])
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_node_nums = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line647")'> 647:         for layer in range(self._snp_num):</pre>
<pre id='line647' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":647
 *     def get_layer_node_nums(self, anc):
 *         node_nums = []
 *         for layer in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             node_nums.append(self._layer_state_nums[anc][layer])
 *         return node_nums
 */
  __pyx_t_2 = __pyx_v_self->_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line648")'> 648:             node_nums.append(self._layer_state_nums[anc][layer])</pre>
<pre id='line648' class='code' style='background-color: #FFFF52'>
    /* "LDModel.pyx":648
 *         node_nums = []
 *         for layer in range(self._snp_num):
 *             node_nums.append(self._layer_state_nums[anc][layer])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return node_nums
 * 
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_4])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_node_nums, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line649")'> 649:         return node_nums</pre>
<pre id='line649' class='code' style='background-color: #FFFF79'>
  /* "LDModel.pyx":649
 *         for layer in range(self._snp_num):
 *             node_nums.append(self._layer_state_nums[anc][layer])
 *         return node_nums             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_node_edges(self, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_node_nums));
  __pyx_r = ((PyObject *)__pyx_v_node_nums);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_layer_node_nums", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node_nums);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_41get_node_edges(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_41get_node_edges(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_edges (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_40get_node_edges(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650: </pre>
<pre id='line650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line651")'> 651:     def get_node_edges(self, anc):</pre>
<pre id='line651' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":651
 *         return node_nums
 * 
 *     def get_node_edges(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         edges = []
 *         edge_weights = []
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_40get_node_edges(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_edges = NULL;
  PyObject *__pyx_v_edge_weights = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_edges = NULL;
  PyObject *__pyx_v_layer_edge_weights = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_edges", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_node_edges", __pyx_f[0], 651);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line652")'> 652:         edges = []</pre>
<pre id='line652' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":652
 * 
 *     def get_node_edges(self, anc):
 *         edges = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         edge_weights = []
 *         for layer in range(self._snp_num-1):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_edges = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line653")'> 653:         edge_weights = []</pre>
<pre id='line653' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":653
 *     def get_node_edges(self, anc):
 *         edges = []
 *         edge_weights = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(self._snp_num-1):
 *             print "layer: " + str(layer)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_edge_weights = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654:         for layer in range(self._snp_num-1):</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":654
 *         edges = []
 *         edge_weights = []
 *         for layer in range(self._snp_num-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "layer: " + str(layer)
 *             layer_edges = []
 */
  __pyx_t_2 = (__pyx_v_self->_snp_num - 1);
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line655")'> 655:             print "layer: " + str(layer)</pre>
<pre id='line655' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":655
 *         edge_weights = []
 *         for layer in range(self._snp_num-1):
 *             print "layer: " + str(layer)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_edges = []
 *             layer_edge_weights = []
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_48), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line656")'> 656:             layer_edges = []</pre>
<pre id='line656' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":656
 *         for layer in range(self._snp_num-1):
 *             print "layer: " + str(layer)
 *             layer_edges = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_edges));
    __pyx_v_layer_edges = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line657")'> 657:             layer_edge_weights = []</pre>
<pre id='line657' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":657
 *             print "layer: " + str(layer)
 *             layer_edges = []
 *             layer_edge_weights = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_edge_weights));
    __pyx_v_layer_edge_weights = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line658")'> 658:             for node in range(self._layer_state_nums[anc][layer]):</pre>
<pre id='line658' class='code' style='background-color: #FFFF1c'>
    /* "LDModel.pyx":658
 *             layer_edges = []
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_5])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_4 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_4)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
      __pyx_v_node = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line659")'> 659:                 print "node: " + str(node)</pre>
<pre id='line659' class='code' style='background-color: #FFFF4f'>
      /* "LDModel.pyx":659
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 */
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_node);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_node);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_node);
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_49), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line660")'> 660:                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])</pre>
<pre id='line660' class='code' style='background-color: #FFFF10'>
      /* "LDModel.pyx":660
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             edges.append(layer_edges)
 */
      __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_t_8])[__pyx_v_layer])[__pyx_t_9]).out_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_xrange, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_10 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_9 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_9 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_10, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_9 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_10, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_7 = __pyx_t_11(__pyx_t_10);
          if (unlikely(!__pyx_t_7)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
        __pyx_v_i = __pyx_t_7;
        __pyx_t_7 = 0;
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_13 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(((((__pyx_v_self->_trans_idx[__pyx_t_8])[__pyx_v_layer])[__pyx_t_12])[__pyx_t_13]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = ((PyObject *)__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_edges, __pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line661")'> 661:                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])</pre>
<pre id='line661' class='code' style='background-color: #FFFF10'>
      /* "LDModel.pyx":661
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)
 */
      __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_t_9])[__pyx_v_layer])[__pyx_t_13]).out_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_xrange, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        __pyx_t_7 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_13 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_11 = Py_TYPE(__pyx_t_7)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) {
          if (__pyx_t_13 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
          if (__pyx_t_13 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_4 = __pyx_t_11(__pyx_t_7);
          if (unlikely(!__pyx_t_4)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
        __pyx_v_i = __pyx_t_4;
        __pyx_t_4 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_trans[__pyx_t_9])[__pyx_v_layer])[__pyx_t_12])[__pyx_t_8]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_10, (PyObject*)__pyx_t_4)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = ((PyObject *)__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_edge_weights, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line662")'> 662:             edges.append(layer_edges)</pre>
<pre id='line662' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":662
 *                 layer_edges.append([self._trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             edges.append(layer_edges)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             edge_weights.append(layer_edge_weights)
 *         return (edges, edge_weights)
 */
    __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_edges, ((PyObject *)__pyx_v_layer_edges));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line663")'> 663:             edge_weights.append(layer_edge_weights)</pre>
<pre id='line663' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":663
 *                 layer_edge_weights.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return (edges, edge_weights)
 * 
 */
    __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_edge_weights, ((PyObject *)__pyx_v_layer_edge_weights));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 663; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line664")'> 664:         return (edges, edge_weights)</pre>
<pre id='line664' class='code' style='background-color: #FFFF44'>
  /* "LDModel.pyx":664
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)
 *         return (edges, edge_weights)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_node_edges_back(self, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edges));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_edges));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_edges));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edge_weights));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_edge_weights));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_edge_weights));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_node_edges", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_43get_node_edges_back(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_43get_node_edges_back(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_edges_back (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_42get_node_edges_back(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665: </pre>
<pre id='line665' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line666")'> 666:     def get_node_edges_back(self, anc):</pre>
<pre id='line666' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":666
 *         return (edges, edge_weights)
 * 
 *     def get_node_edges_back(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         edges = []
 *         edge_weights = []
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_42get_node_edges_back(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_edges = NULL;
  PyObject *__pyx_v_edge_weights = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_edges = NULL;
  PyObject *__pyx_v_layer_edge_weights = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_edges_back", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_node_edges_back", __pyx_f[0], 666);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line667")'> 667:         edges = []</pre>
<pre id='line667' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":667
 * 
 *     def get_node_edges_back(self, anc):
 *         edges = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         edge_weights = []
 *         for layer in range(1,self._snp_num):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 667; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_edges = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line668")'> 668:         edge_weights = []</pre>
<pre id='line668' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":668
 *     def get_node_edges_back(self, anc):
 *         edges = []
 *         edge_weights = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(1,self._snp_num):
 *             print "layer: " + str(layer)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_edge_weights = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line669")'> 669:         for layer in range(1,self._snp_num):</pre>
<pre id='line669' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":669
 *         edges = []
 *         edge_weights = []
 *         for layer in range(1,self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "layer: " + str(layer)
 *             layer_edges = []
 */
  __pyx_t_2 = __pyx_v_self->_snp_num;
  for (__pyx_t_3 = 1; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line670")'> 670:             print "layer: " + str(layer)</pre>
<pre id='line670' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":670
 *         edge_weights = []
 *         for layer in range(1,self._snp_num):
 *             print "layer: " + str(layer)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_edges = []
 *             layer_edge_weights = []
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_48), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line671")'> 671:             layer_edges = []</pre>
<pre id='line671' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":671
 *         for layer in range(1,self._snp_num):
 *             print "layer: " + str(layer)
 *             layer_edges = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_edges));
    __pyx_v_layer_edges = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line672")'> 672:             layer_edge_weights = []</pre>
<pre id='line672' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":672
 *             print "layer: " + str(layer)
 *             layer_edges = []
 *             layer_edge_weights = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 672; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_edge_weights));
    __pyx_v_layer_edge_weights = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line673")'> 673:             for node in range(self._layer_state_nums[anc][layer]):</pre>
<pre id='line673' class='code' style='background-color: #FFFF1c'>
    /* "LDModel.pyx":673
 *             layer_edges = []
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_5])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_4 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_4)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
      __pyx_v_node = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line674")'> 674:                 print "node: " + str(node)</pre>
<pre id='line674' class='code' style='background-color: #FFFF4f'>
      /* "LDModel.pyx":674
 *             layer_edge_weights = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 */
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_node);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_node);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_node);
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_49), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line675")'> 675:                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])</pre>
<pre id='line675' class='code' style='background-color: #FFFF10'>
      /* "LDModel.pyx":675
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *             edges.append(layer_edges)
 */
      __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_t_8])[__pyx_v_layer])[__pyx_t_9]).in_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_xrange, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_10 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_9 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_9 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_10, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_9 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_10, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_7 = __pyx_t_11(__pyx_t_10);
          if (unlikely(!__pyx_t_7)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
        __pyx_v_i = __pyx_t_7;
        __pyx_t_7 = 0;
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_13 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(((((__pyx_v_self->_back_trans_idx[__pyx_t_8])[__pyx_v_layer])[__pyx_t_12])[__pyx_t_13]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = ((PyObject *)__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_edges, __pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line676")'> 676:                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])</pre>
<pre id='line676' class='code' style='background-color: #FFFF10'>
      /* "LDModel.pyx":676
 *                 print "node: " + str(node)
 *                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)
 */
      __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_t_9])[__pyx_v_layer])[__pyx_t_13]).in_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_xrange, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        __pyx_t_7 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_13 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_11 = Py_TYPE(__pyx_t_7)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) {
          if (__pyx_t_13 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
          if (__pyx_t_13 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_4 = __pyx_t_11(__pyx_t_7);
          if (unlikely(!__pyx_t_4)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
        __pyx_v_i = __pyx_t_4;
        __pyx_t_4 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_back_trans[__pyx_t_9])[__pyx_v_layer])[__pyx_t_12])[__pyx_t_8]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_10, (PyObject*)__pyx_t_4)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = ((PyObject *)__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_edge_weights, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line677")'> 677:             edges.append(layer_edges)</pre>
<pre id='line677' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":677
 *                 layer_edges.append([self._back_trans_idx[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *             edges.append(layer_edges)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             edge_weights.append(layer_edge_weights)
 *         return (edges, edge_weights)
 */
    __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_edges, ((PyObject *)__pyx_v_layer_edges));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line678")'> 678:             edge_weights.append(layer_edge_weights)</pre>
<pre id='line678' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":678
 *                 layer_edge_weights.append([self._back_trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].in_trans_num)])
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return (edges, edge_weights)
 * 
 */
    __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_edge_weights, ((PyObject *)__pyx_v_layer_edge_weights));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line679")'> 679:         return (edges, edge_weights)</pre>
<pre id='line679' class='code' style='background-color: #FFFF44'>
  /* "LDModel.pyx":679
 *             edges.append(layer_edges)
 *             edge_weights.append(layer_edge_weights)
 *         return (edges, edge_weights)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_node_ems_probs(self, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edges));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_edges));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_edges));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edge_weights));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_edge_weights));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_edge_weights));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_node_edges_back", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_45get_node_ems_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_45get_node_ems_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_ems_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_44get_node_ems_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line680")'> 680: </pre>
<pre id='line680' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line681")'> 681:     def get_node_ems_probs(self, anc):</pre>
<pre id='line681' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":681
 *         return (edges, edge_weights)
 * 
 *     def get_node_ems_probs(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ems_probs = []
 *         for layer in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_44get_node_ems_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_ems_probs = NULL;
  int __pyx_v_layer;
  PyObject *__pyx_v_layer_ems_probs = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_node_ems_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_node_ems_probs", __pyx_f[0], 681);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line682")'> 682:         ems_probs = []</pre>
<pre id='line682' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":682
 * 
 *     def get_node_ems_probs(self, anc):
 *         ems_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(self._snp_num):
 *             print "layer: " + str(layer)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_ems_probs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683:         for layer in range(self._snp_num):</pre>
<pre id='line683' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":683
 *     def get_node_ems_probs(self, anc):
 *         ems_probs = []
 *         for layer in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "layer: " + str(layer)
 *             layer_ems_probs = []
 */
  __pyx_t_2 = __pyx_v_self->_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line684")'> 684:             print "layer: " + str(layer)</pre>
<pre id='line684' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":684
 *         ems_probs = []
 *         for layer in range(self._snp_num):
 *             print "layer: " + str(layer)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_ems_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_48), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line685")'> 685:             layer_ems_probs = []</pre>
<pre id='line685' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":685
 *         for layer in range(self._snp_num):
 *             print "layer: " + str(layer)
 *             layer_ems_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 */
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_ems_probs));
    __pyx_v_layer_ems_probs = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line686")'> 686:             for node in range(self._layer_state_nums[anc][layer]):</pre>
<pre id='line686' class='code' style='background-color: #FFFF1c'>
    /* "LDModel.pyx":686
 *             print "layer: " + str(layer)
 *             layer_ems_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 print "node: " + str(node)
 *                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_5])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_4 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_4)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
      __pyx_v_node = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line687")'> 687:                 print "node: " + str(node)</pre>
<pre id='line687' class='code' style='background-color: #FFFF4f'>
      /* "LDModel.pyx":687
 *             layer_ems_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))
 *             ems_probs.append(layer_ems_probs)
 */
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_node);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_node);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_node);
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_49), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line688")'> 688:                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))</pre>
<pre id='line688' class='code' style='background-color: #FFFF22'>
      /* "LDModel.pyx":688
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 print "node: " + str(node)
 *                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ems_probs.append(layer_ems_probs)
 *         return ems_probs
 */
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_states[__pyx_t_8])[__pyx_v_layer])[__pyx_t_9]).prob_em[0]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_states[__pyx_t_9])[__pyx_v_layer])[__pyx_t_8]).prob_em[1]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      __pyx_t_4 = 0;
      __pyx_t_7 = 0;
      __pyx_t_11 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_ems_probs, ((PyObject *)__pyx_t_10));<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line689")'> 689:             ems_probs.append(layer_ems_probs)</pre>
<pre id='line689' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":689
 *                 print "node: " + str(node)
 *                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))
 *             ems_probs.append(layer_ems_probs)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return ems_probs
 * 
 */
    __pyx_t_11 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_ems_probs, ((PyObject *)__pyx_v_layer_ems_probs));<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line690")'> 690:         return ems_probs</pre>
<pre id='line690' class='code' style='background-color: #FFFF62'>
  /* "LDModel.pyx":690
 *                 layer_ems_probs.append((self._states[anc][layer][node].prob_em[0],self._states[anc][layer][node].prob_em[1]))
 *             ems_probs.append(layer_ems_probs)
 *         return ems_probs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_trans_probs(self, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_ems_probs));
  __pyx_r = ((PyObject *)__pyx_v_ems_probs);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_node_ems_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ems_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_ems_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_47get_trans_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_47get_trans_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_trans_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_46get_trans_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line691")'> 691: </pre>
<pre id='line691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line692")'> 692:     def get_trans_probs(self, anc):</pre>
<pre id='line692' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":692
 *         return ems_probs
 * 
 *     def get_trans_probs(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         probs = []
 *         for layer in range(self._snp_num-1):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_46get_trans_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_probs = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_probs = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_trans_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_trans_probs", __pyx_f[0], 692);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line693")'> 693:         probs = []</pre>
<pre id='line693' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":693
 * 
 *     def get_trans_probs(self, anc):
 *         probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(self._snp_num-1):
 *             layer_probs = []
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_probs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line694")'> 694:         for layer in range(self._snp_num-1):</pre>
<pre id='line694' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":694
 *     def get_trans_probs(self, anc):
 *         probs = []
 *         for layer in range(self._snp_num-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 */
  __pyx_t_2 = (__pyx_v_self->_snp_num - 1);
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line695")'> 695:             layer_probs = []</pre>
<pre id='line695' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":695
 *         probs = []
 *         for layer in range(self._snp_num-1):
 *             layer_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_probs));
    __pyx_v_layer_probs = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line696")'> 696:             for node in range(self._layer_state_nums[anc][layer]):</pre>
<pre id='line696' class='code' style='background-color: #FFFF1c'>
    /* "LDModel.pyx":696
 *         for layer in range(self._snp_num-1):
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             probs.append(layer_probs)
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_4])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_4 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) {
        if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
        if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
      __pyx_v_node = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line697")'> 697:                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])</pre>
<pre id='line697' class='code' style='background-color: #FFFF10'>
      /* "LDModel.pyx":697
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             probs.append(layer_probs)
 *         return probs
 */
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_t_7])[__pyx_v_layer])[__pyx_t_8]).out_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_xrange, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
        __pyx_t_10 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_8 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      for (;;) {
        if (!__pyx_t_11 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_8 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_10, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_11 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_8 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_10, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_9 = __pyx_t_11(__pyx_t_10);
          if (unlikely(!__pyx_t_9)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
        __pyx_v_i = __pyx_t_9;
        __pyx_t_9 = 0;
        __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_12 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_node);<span class='error_goto'> if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_13 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_trans[__pyx_t_7])[__pyx_v_layer])[__pyx_t_12])[__pyx_t_13]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_9)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = ((PyObject *)__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_probs, __pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line698")'> 698:             probs.append(layer_probs)</pre>
<pre id='line698' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":698
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             probs.append(layer_probs)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return probs
 * 
 */
    __pyx_t_14 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_probs, ((PyObject *)__pyx_v_layer_probs));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line699")'> 699:         return probs</pre>
<pre id='line699' class='code' style='background-color: #FFFF5e'>
  /* "LDModel.pyx":699
 *                 layer_probs.append([self._trans[anc][layer][node][i] for i in xrange(self._states[anc][layer][node].out_trans_num)])
 *             probs.append(layer_probs)
 *         return probs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_forward_probs(self, anc):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_probs));
  __pyx_r = ((PyObject *)__pyx_v_probs);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_trans_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_49get_forward_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_49get_forward_probs(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_forward_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_48get_forward_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line700")'> 700: </pre>
<pre id='line700' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line701")'> 701:     def get_forward_probs(self, anc):</pre>
<pre id='line701' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":701
 *         return probs
 * 
 *     def get_forward_probs(self, anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         probs = []
 *         for layer in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_48get_forward_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_probs = NULL;
  int __pyx_v_layer;
  PyObject *__pyx_v_layer_probs = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_forward_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_forward_probs", __pyx_f[0], 701);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line702")'> 702:         probs = []</pre>
<pre id='line702' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":702
 * 
 *     def get_forward_probs(self, anc):
 *         probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for layer in range(self._snp_num):
 *             layer_probs = []
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_probs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line703")'> 703:         for layer in range(self._snp_num):</pre>
<pre id='line703' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":703
 *     def get_forward_probs(self, anc):
 *         probs = []
 *         for layer in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 */
  __pyx_t_2 = __pyx_v_self->_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line704")'> 704:             layer_probs = []</pre>
<pre id='line704' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":704
 *         probs = []
 *         for layer in range(self._snp_num):
 *             layer_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append(self._forward_probs[layer][node])
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_layer_probs));
    __pyx_v_layer_probs = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line705")'> 705:             for node in range(self._layer_state_nums[anc][layer]):</pre>
<pre id='line705' class='code' style='background-color: #FFFF1c'>
    /* "LDModel.pyx":705
 *         for layer in range(self._snp_num):
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 layer_probs.append(self._forward_probs[layer][node])
 *             probs.append(layer_probs)
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->_layer_state_nums[__pyx_t_4])[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_4 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) {
        if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
        if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
      __pyx_v_node = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line706")'> 706:                 layer_probs.append(self._forward_probs[layer][node])</pre>
<pre id='line706' class='code' style='background-color: #FFFF52'>
      /* "LDModel.pyx":706
 *             layer_probs = []
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append(self._forward_probs[layer][node])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             probs.append(layer_probs)
 *         return probs
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___forward_probs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_layer, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_7, __pyx_v_node);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_layer_probs, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line707")'> 707:             probs.append(layer_probs)</pre>
<pre id='line707' class='code' style='background-color: #FFFFaa'>
    /* "LDModel.pyx":707
 *             for node in range(self._layer_state_nums[anc][layer]):
 *                 layer_probs.append(self._forward_probs[layer][node])
 *             probs.append(layer_probs)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return probs
 * 
 */
    __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_probs, ((PyObject *)__pyx_v_layer_probs));<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line708")'> 708:         return probs</pre>
<pre id='line708' class='code' style='background-color: #FFFF66'>
  /* "LDModel.pyx":708
 *                 layer_probs.append(self._forward_probs[layer][node])
 *             probs.append(layer_probs)
 *         return probs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def print_emissions(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_probs));
  __pyx_r = ((PyObject *)__pyx_v_probs);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_forward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_51print_emissions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_51print_emissions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_emissions (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_50print_emissions(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line709")'> 709: </pre>
<pre id='line709' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line710")'> 710:     def print_emissions(self):</pre>
<pre id='line710' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":710
 *         return probs
 * 
 *     def print_emissions(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")
 *         for snp_idx in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_50print_emissions(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  int __pyx_v_snp_idx;
  int __pyx_v_admx_idx;
  int __pyx_v_node_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_emissions", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_emissions", __pyx_f[0], 710);
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line711")'> 711:         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")</pre>
<pre id='line711' class='code' style='background-color: #FFFF57'>
  /* "LDModel.pyx":711
 * 
 *     def print_emissions(self):
 *         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ems_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_51), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "LDModel.pyx":711
 * 
 *     def print_emissions(self):
 *         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 */
  __pyx_k_tuple_51 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_51);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_50));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_51, 0, ((PyObject *)__pyx_kp_s_50));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_50));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_51));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line712")'> 712:         for snp_idx in range(self._snp_num):</pre>
<pre id='line712' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":712
 *     def print_emissions(self):
 *         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")
 *         for snp_idx in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 */
  __pyx_t_3 = __pyx_v_self->_snp_num;
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_snp_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line713")'> 713:             for admx_idx in range(self.K):</pre>
<pre id='line713' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":713
 *         self._ems_file.write("snp ancestry node ems_prob0 ems_prob1\n")
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     self._ems_file.write(str(snp_idx) + " " +
 */
    __pyx_t_5 = __pyx_v_self->K;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_admx_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line714")'> 714:                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):</pre>
<pre id='line714' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":714
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._ems_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +
 */
      __pyx_t_7 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx])[__pyx_v_snp_idx]);
      for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_node_idx = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line715")'> 715:                     self._ems_file.write(str(snp_idx) + " " +</pre>
<pre id='line715' class='code' style='background-color: #FFFF43'>
        /* "LDModel.pyx":715
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     self._ems_file.write(str(snp_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +
 */
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_ems_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);

        /* "LDModel.pyx":716
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     self._ems_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(node_idx) + " " +
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[0]) + " " +
 */
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line716")'> 716:                                   str(admx_idx) + " " +</pre>
<pre id='line716' class='code' style='background-color: #FFFF3f'>        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line717")'> 717:                                   str(node_idx) + " " +</pre>
<pre id='line717' class='code' style='background-color: #FFFF3f'>
        /* "LDModel.pyx":717
 *                     self._ems_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[0]) + " " +
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[1]) + "\n")
 */
        __pyx_t_10 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line718")'> 718:                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[0]) + " " +</pre>
<pre id='line718' class='code' style='background-color: #FFFF3f'>
        /* "LDModel.pyx":718
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[0]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[1]) + "\n")
 * 
 */
        __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_states[__pyx_v_admx_idx])[__pyx_v_snp_idx])[__pyx_v_node_idx]).prob_em[0]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line719")'> 719:                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[1]) + "\n")</pre>
<pre id='line719' class='code' style='background-color: #FFFF27'>
        /* "LDModel.pyx":719
 *                                   str(node_idx) + " " +
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[0]) + " " +
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[1]) + "\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def print_transitions(self):
 */
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_states[__pyx_v_admx_idx])[__pyx_v_snp_idx])[__pyx_v_node_idx]).prob_em[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
    }
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_emissions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_53print_transitions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_53print_transitions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_transitions (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_52print_transitions(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line720")'> 720: </pre>
<pre id='line720' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line721")'> 721:     def print_transitions(self):</pre>
<pre id='line721' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":721
 *                                   str(self._states[admx_idx][snp_idx][node_idx].prob_em[1]) + "\n")
 * 
 *     def print_transitions(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._trans_file.write("snp ancestry node next_node transition\n")
 *         for snp_idx in range(self._snp_num):
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_52print_transitions(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  int __pyx_v_snp_idx;
  int __pyx_v_admx_idx;
  int __pyx_v_node_idx;
  int __pyx_v_nxt_node_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_transitions", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_transitions", __pyx_f[0], 721);
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line722")'> 722:         self._trans_file.write("snp ancestry node next_node transition\n")</pre>
<pre id='line722' class='code' style='background-color: #FFFF57'>
  /* "LDModel.pyx":722
 * 
 *     def print_transitions(self):
 *         self._trans_file.write("snp ancestry node next_node transition\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_trans_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 722; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_53), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 722; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "LDModel.pyx":722
 * 
 *     def print_transitions(self):
 *         self._trans_file.write("snp ancestry node next_node transition\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 */
  __pyx_k_tuple_53 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_53)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 722; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_53);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_52));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_53, 0, ((PyObject *)__pyx_kp_s_52));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_52));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_53));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line723")'> 723:         for snp_idx in range(self._snp_num):</pre>
<pre id='line723' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":723
 *     def print_transitions(self):
 *         self._trans_file.write("snp ancestry node next_node transition\n")
 *         for snp_idx in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 */
  __pyx_t_3 = __pyx_v_self->_snp_num;
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_snp_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line724")'> 724:             for admx_idx in range(self.K):</pre>
<pre id='line724' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":724
 *         self._trans_file.write("snp ancestry node next_node transition\n")
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)
 */
    __pyx_t_5 = __pyx_v_self->K;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_admx_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line725")'> 725:                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):</pre>
<pre id='line725' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":725
 *         for snp_idx in range(self._snp_num):
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)
 *                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):
 */
      __pyx_t_7 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx])[__pyx_v_snp_idx]);
      for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_node_idx = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line726")'> 726:                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)</pre>
<pre id='line726' class='code' style='background-color: #FFFF15'>
        /* "LDModel.pyx":726
 *             for admx_idx in range(self.K):
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):
 *                         self._trans_file.write(str(snp_idx) + " " +
 */
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((((__pyx_v_self->_states[__pyx_v_admx_idx])[__pyx_v_snp_idx])[__pyx_v_node_idx]).out_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line727")'> 727:                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):</pre>
<pre id='line727' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":727
 *                 for node_idx in range(self._layer_state_nums[admx_idx][snp_idx]):
 *                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)
 *                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._trans_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +
 */
        __pyx_t_10 = (((__pyx_v_self->_states[__pyx_v_admx_idx])[__pyx_v_snp_idx])[__pyx_v_node_idx]).out_trans_num;
        for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
          __pyx_v_nxt_node_idx = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line728")'> 728:                         self._trans_file.write(str(snp_idx) + " " +</pre>
<pre id='line728' class='code' style='background-color: #FFFF43'>
          /* "LDModel.pyx":728
 *                     print str(snp_idx) + " " + str(admx_idx) + " " + str(node_idx) + " " + str(self._states[admx_idx][snp_idx][node_idx].out_trans_num)
 *                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):
 *                         self._trans_file.write(str(snp_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +
 */
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_trans_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);

          /* "LDModel.pyx":729
 *                     for nxt_node_idx in range(self._states[admx_idx][snp_idx][node_idx].out_trans_num):
 *                         self._trans_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(node_idx) + " " +
 *                                   str(nxt_node_idx) + " " +
 */
          __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line729")'> 729:                                   str(admx_idx) + " " +</pre>
<pre id='line729' class='code' style='background-color: #FFFF3f'>          __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line730")'> 730:                                   str(node_idx) + " " +</pre>
<pre id='line730' class='code' style='background-color: #FFFF3f'>
          /* "LDModel.pyx":730
 *                         self._trans_file.write(str(snp_idx) + " " +
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(nxt_node_idx) + " " +
 *                                   str(self._trans[admx_idx][snp_idx][node_idx][nxt_node_idx]) + "\n")
 */
          __pyx_t_12 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_12 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line731")'> 731:                                   str(nxt_node_idx) + " " +</pre>
<pre id='line731' class='code' style='background-color: #FFFF3f'>
          /* "LDModel.pyx":731
 *                                   str(admx_idx) + " " +
 *                                   str(node_idx) + " " +
 *                                   str(nxt_node_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                   str(self._trans[admx_idx][snp_idx][node_idx][nxt_node_idx]) + "\n")
 *         self._trans_file.flush()
 */
          __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nxt_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line732")'> 732:                                   str(self._trans[admx_idx][snp_idx][node_idx][nxt_node_idx]) + "\n")</pre>
<pre id='line732' class='code' style='background-color: #FFFF2f'>
          /* "LDModel.pyx":732
 *                                   str(node_idx) + " " +
 *                                   str(nxt_node_idx) + " " +
 *                                   str(self._trans[admx_idx][snp_idx][node_idx][nxt_node_idx]) + "\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._trans_file.flush()
 * 
 */
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_trans[__pyx_v_admx_idx])[__pyx_v_snp_idx])[__pyx_v_node_idx])[__pyx_v_nxt_node_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_12)); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line733")'> 733:         self._trans_file.flush()</pre>
<pre id='line733' class='code' style='background-color: #FFFF4f'>
  /* "LDModel.pyx":733
 *                                   str(nxt_node_idx) + " " +
 *                                   str(self._trans[admx_idx][snp_idx][node_idx][nxt_node_idx]) + "\n")
 *         self._trans_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef generate_random_hap(self, int anc):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_trans_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_12 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_transitions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line734")'> 734: </pre>
<pre id='line734' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line735")'> 735:     cpdef generate_random_hap(self, int anc):</pre>
<pre id='line735' class='code' style='background-color: #FFFF36'>
/* "LDModel.pyx":735
 *         self._trans_file.flush()
 * 
 *     cpdef generate_random_hap(self, int anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         hap = ""
 *         p = [self._pi[anc][0][i] for i in xrange(self._layer_state_nums[anc][0])]
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_55generate_random_hap(PyObject *__pyx_v_self, PyObject *__pyx_arg_anc); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_generate_random_hap(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_anc, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_hap = NULL;
  PyObject *__pyx_v_p = NULL;
  int __pyx_v_next_node;
  int __pyx_v_layer;
  PyObject *__pyx_v_t = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_random_hap", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("generate_random_hap", __pyx_f[0], 735);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__generate_random_hap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_55generate_random_hap)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_anc);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":735
 *         self._trans_file.flush()
 * 
 *     cpdef generate_random_hap(self, int anc):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         hap = ""
 *         p = [self._pi[anc][0][i] for i in xrange(self._layer_state_nums[anc][0])]
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_54generate_random_hap(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_anc) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_random_hap", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("generate_random_hap", __pyx_f[0], 735);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->generate_random_hap(__pyx_v_self, __pyx_v_anc, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_random_hap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line736")'> 736:         hap = ""</pre>
<pre id='line736' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":736
 * 
 *     cpdef generate_random_hap(self, int anc):
 *         hap = ""             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         p = [self._pi[anc][0][i] for i in xrange(self._layer_state_nums[anc][0])]
 *         #print "layer state nums: " + str(self._layer_state_nums[anc][0])
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_47));
  __pyx_v_hap = ((PyObject *)__pyx_kp_s_47);
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line737")'> 737:         p = [self._pi[anc][0][i] for i in xrange(self._layer_state_nums[anc][0])]</pre>
<pre id='line737' class='code' style='background-color: #FFFF5b'>
  /* "LDModel.pyx":737
 *     cpdef generate_random_hap(self, int anc):
 *         hap = ""
 *         p = [self._pi[anc][0][i] for i in xrange(self._layer_state_nums[anc][0])]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #print "layer state nums: " + str(self._layer_state_nums[anc][0])
 *         #print "pi: " + str(p)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = ((__pyx_v_self->_layer_state_nums[__pyx_v_anc])[0]);
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self->_pi[__pyx_v_anc])[0])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = ((PyObject *)__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_p = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line738")'> 738:         #print "layer state nums: " + str(self._layer_state_nums[anc][0])</pre>
<pre id='line738' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line739")'> 739:         #print "pi: " + str(p)</pre>
<pre id='line739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line740")'> 740:         cdef int next_node = np.array(p).cumsum().searchsorted(np.random.sample(1))[0]</pre>
<pre id='line740' class='code' style='background-color: #FFFF18'>
  /* "LDModel.pyx":740
 *         #print "layer state nums: " + str(self._layer_state_nums[anc][0])
 *         #print "pi: " + str(p)
 *         cdef int next_node = np.array(p).cumsum().searchsorted(np.random.sample(1))[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #print "next node: " + str(next_node)
 *         for layer in range(self._snp_num):
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_p));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_p));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_p));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__sample);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_54), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_next_node = __pyx_t_4;

  /* "LDModel.pyx":740
 *         #print "layer state nums: " + str(self._layer_state_nums[anc][0])
 *         #print "pi: " + str(p)
 *         cdef int next_node = np.array(p).cumsum().searchsorted(np.random.sample(1))[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #print "next node: " + str(next_node)
 *         for layer in range(self._snp_num):
 */
  __pyx_k_tuple_54 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_54)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_54);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_54, 0, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_54));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line741")'> 741:         #print "next node: " + str(next_node)</pre>
<pre id='line741' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line742")'> 742:         for layer in range(self._snp_num):</pre>
<pre id='line742' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":742
 *         cdef int next_node = np.array(p).cumsum().searchsorted(np.random.sample(1))[0]
 *         #print "next node: " + str(next_node)
 *         for layer in range(self._snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "generating haplotype for layer: " + str(layer)
 *             if self._states[anc][layer][next_node].prob_em[0] > 0.5:
 */
  __pyx_t_4 = __pyx_v_self->_snp_num;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_layer = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line743")'> 743:             #print "generating haplotype for layer: " + str(layer)</pre>
<pre id='line743' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line744")'> 744:             if self._states[anc][layer][next_node].prob_em[0] &gt; 0.5:</pre>
<pre id='line744' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":744
 *         for layer in range(self._snp_num):
 *             #print "generating haplotype for layer: " + str(layer)
 *             if self._states[anc][layer][next_node].prob_em[0] > 0.5:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 hap += '0'
 *             else:
 */
    __pyx_t_6 = (((((__pyx_v_self->_states[__pyx_v_anc])[__pyx_v_layer])[__pyx_v_next_node]).prob_em[0]) > 0.5);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line745")'> 745:                 hap += '0'</pre>
<pre id='line745' class='code' style='background-color: #FFFF9f'>
      /* "LDModel.pyx":745
 *             #print "generating haplotype for layer: " + str(layer)
 *             if self._states[anc][layer][next_node].prob_em[0] > 0.5:
 *                 hap += '0'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 hap += '1'
 */
      __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_hap, ((PyObject *)__pyx_kp_s__0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_hap);
      __pyx_v_hap = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line746")'> 746:             else:</pre>
<pre id='line746' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line747")'> 747:                 hap += '1'</pre>
<pre id='line747' class='code' style='background-color: #FFFF9f'>
      /* "LDModel.pyx":747
 *                 hap += '0'
 *             else:
 *                 hap += '1'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if layer <code><</code> self._snp_num - 1:
 *                 #print "states in layer: " + str(layer)
 */
      __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_hap, ((PyObject *)__pyx_kp_s__1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_hap);
      __pyx_v_hap = __pyx_t_3;
      __pyx_t_3 = 0;
    }
    __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line748")'> 748:             if layer &lt; self._snp_num - 1:</pre>
<pre id='line748' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":748
 *             else:
 *                 hap += '1'
 *             if layer <code><</code> self._snp_num - 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #print "states in layer: " + str(layer)
 *                 t = [self._trans[anc][layer][next_node][i] for i in xrange(self._states[anc][layer][next_node].out_trans_num)]
 */
    __pyx_t_6 = (__pyx_v_layer <code><</code> (__pyx_v_self->_snp_num - 1));
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line749")'> 749:                 #print "states in layer: " + str(layer)</pre>
<pre id='line749' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line750")'> 750:                 t = [self._trans[anc][layer][next_node][i] for i in xrange(self._states[anc][layer][next_node].out_trans_num)]</pre>
<pre id='line750' class='code' style='background-color: #FFFF57'>
      /* "LDModel.pyx":750
 *             if layer <code><</code> self._snp_num - 1:
 *                 #print "states in layer: " + str(layer)
 *                 t = [self._trans[anc][layer][next_node][i] for i in xrange(self._states[anc][layer][next_node].out_trans_num)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #print "transition probs: " + str(t)
 *                 next_node = self._trans_idx[anc][layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]
 */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = (((__pyx_v_self->_states[__pyx_v_anc])[__pyx_v_layer])[__pyx_v_next_node]).out_trans_num;
      for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_i = __pyx_t_8;
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_trans[__pyx_v_anc])[__pyx_v_layer])[__pyx_v_next_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        if (unlikely(__Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = ((PyObject *)__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_t));
      __pyx_v_t = ((PyObject*)__pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line751")'> 751:                 #print "transition probs: " + str(t)</pre>
<pre id='line751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line752")'> 752:                 next_node = self._trans_idx[anc][layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]</pre>
<pre id='line752' class='code' style='background-color: #FFFF19'>
      /* "LDModel.pyx":752
 *                 t = [self._trans[anc][layer][next_node][i] for i in xrange(self._states[anc][layer][next_node].out_trans_num)]
 *                 #print "transition probs: " + str(t)
 *                 next_node = self._trans_idx[anc][layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #print "next node: " + str(next_node)
 *         return hap
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_t));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_t));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_t));
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__sample);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_55), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_next_node = ((((__pyx_v_self->_trans_idx[__pyx_v_anc])[__pyx_v_layer])[__pyx_v_next_node])[__pyx_t_9]);
      goto __pyx_L8;
    }
    __pyx_L8:;
  }

  /* "LDModel.pyx":752
 *                 t = [self._trans[anc][layer][next_node][i] for i in xrange(self._states[anc][layer][next_node].out_trans_num)]
 *                 #print "transition probs: " + str(t)
 *                 next_node = self._trans_idx[anc][layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #print "next node: " + str(next_node)
 *         return hap
 */
  __pyx_k_tuple_55 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_55)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_55);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_55, 0, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_55));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line753")'> 753:                 #print "next node: " + str(next_node)</pre>
<pre id='line753' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line754")'> 754:         return hap</pre>
<pre id='line754' class='code' style='background-color: #FFFF43'>
  /* "LDModel.pyx":754
 *                 next_node = self._trans_idx[anc][layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]
 *                 #print "next node: " + str(next_node)
 *         return hap             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_ibd_prior(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_hap);
  __pyx_r = __pyx_v_hap;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_random_hap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_55generate_random_hap(PyObject *__pyx_v_self, PyObject *__pyx_arg_anc); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_55generate_random_hap(PyObject *__pyx_v_self, PyObject *__pyx_arg_anc) {
  int __pyx_v_anc;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_random_hap (wrapper)", 0);
  assert(__pyx_arg_anc); {
    __pyx_v_anc = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_anc);<span class='error_goto'> if (unlikely((__pyx_v_anc == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_random_hap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_54generate_random_hap(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((int)__pyx_v_anc));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line755")'> 755: </pre>
<pre id='line755' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line756")'> 756:     cpdef calc_ibd_prior(self):</pre>
<pre id='line756' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":756
 *         return hap
 * 
 *     cpdef calc_ibd_prior(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef double d
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_57calc_ibd_prior(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_ibd_prior(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  double __pyx_v_d;
  int __pyx_v_anc;
  long __pyx_v_j;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_ibd_prior", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_ibd_prior", __pyx_f[0], 756);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__calc_ibd_prior);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_57calc_ibd_prior)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":756
 *         return hap
 * 
 *     cpdef calc_ibd_prior(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef double d
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_56calc_ibd_prior(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_ibd_prior", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_ibd_prior", __pyx_f[0], 756);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_ibd_prior(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_ibd_prior", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line757")'> 757:         cdef int win_idx</pre>
<pre id='line757' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line758")'> 758:         cdef double d</pre>
<pre id='line758' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line759")'> 759:         self._s = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line759' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":759
 *         cdef int win_idx
 *         cdef double d
 *         self._s = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for anc in range(self.K):
 *             self._s[anc] = <code><</code>double ***> malloc((self.get_num_windows()) * sizeof(double ***))
 */
  __pyx_v_self->_s = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line760")'> 760:         for anc in range(self.K):</pre>
<pre id='line760' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":760
 *         cdef double d
 *         self._s = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         for anc in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._s[anc] = <code><</code>double ***> malloc((self.get_num_windows()) * sizeof(double ***))
 *             for win_idx in range(self.get_num_windows()):
 */
  __pyx_t_3 = __pyx_v_self->K;
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_anc = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line761")'> 761:             self._s[anc] = &lt;double ***&gt; malloc((self.get_num_windows()) * sizeof(double ***))</pre>
<pre id='line761' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":761
 *         self._s = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *         for anc in range(self.K):
 *             self._s[anc] = <code><</code>double ***> malloc((self.get_num_windows()) * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for win_idx in range(self.get_num_windows()):
 *                 self._s[anc][win_idx] = <code><</code>double **> malloc(2 * sizeof(double *))
 */
    (__pyx_v_self->_s[__pyx_v_anc]) = ((double ***)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line762")'> 762:             for win_idx in range(self.get_num_windows()):</pre>
<pre id='line762' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":762
 *         for anc in range(self.K):
 *             self._s[anc] = <code><</code>double ***> malloc((self.get_num_windows()) * sizeof(double ***))
 *             for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._s[anc][win_idx] = <code><</code>double **> malloc(2 * sizeof(double *))
 *                 for j in range(2):
 */
    __pyx_t_5 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_win_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line763")'> 763:                 self._s[anc][win_idx] = &lt;double **&gt; malloc(2 * sizeof(double *))</pre>
<pre id='line763' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":763
 *             self._s[anc] = <code><</code>double ***> malloc((self.get_num_windows()) * sizeof(double ***))
 *             for win_idx in range(self.get_num_windows()):
 *                 self._s[anc][win_idx] = <code><</code>double **> malloc(2 * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for j in range(2):
 *                     self._s[anc][win_idx][j] = <code><</code>double *> malloc(2 * sizeof(double))
 */
      ((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx]) = ((double **)malloc((2 * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line764")'> 764:                 for j in range(2):</pre>
<pre id='line764' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":764
 *             for win_idx in range(self.get_num_windows()):
 *                 self._s[anc][win_idx] = <code><</code>double **> malloc(2 * sizeof(double *))
 *                 for j in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._s[anc][win_idx][j] = <code><</code>double *> malloc(2 * sizeof(double))
 * 
 */
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> 2; __pyx_t_7+=1) {
        __pyx_v_j = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line765")'> 765:                     self._s[anc][win_idx][j] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line765' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":765
 *                 self._s[anc][win_idx] = <code><</code>double **> malloc(2 * sizeof(double *))
 *                 for j in range(2):
 *                     self._s[anc][win_idx][j] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for win_idx in range(self.get_num_windows()):
 */
        (((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[__pyx_v_j]) = ((double *)malloc((2 * (sizeof(double)))));
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line766")'> 766: </pre>
<pre id='line766' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line767")'> 767:             for win_idx in range(self.get_num_windows()):</pre>
<pre id='line767' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":767
 *                     self._s[anc][win_idx][j] = <code><</code>double *> malloc(2 * sizeof(double))
 * 
 *             for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 d = self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)]
 *                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)
 */
    __pyx_t_5 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_win_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line768")'> 768:                 d = self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)]</pre>
<pre id='line768' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":768
 * 
 *             for win_idx in range(self.get_num_windows()):
 *                 d = self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)
 *                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)
 */
      __pyx_v_d = ((__pyx_v_self->_genetic_dist[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx)]) - (__pyx_v_self->_genetic_dist[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx)]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line769")'> 769:                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)</pre>
<pre id='line769' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":769
 *             for win_idx in range(self.get_num_windows()):
 *                 d = self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)]
 *                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)
 *                 self._s[anc][win_idx][1][0] = 1 - self._s[anc][win_idx][1][1]
 */
      ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[1])[1]) = exp(((-(__pyx_v_self->_t_1_0[__pyx_v_anc])) * __pyx_v_d));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line770")'> 770:                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)</pre>
<pre id='line770' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":770
 *                 d = self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)]
 *                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)
 *                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._s[anc][win_idx][1][0] = 1 - self._s[anc][win_idx][1][1]
 *                 self._s[anc][win_idx][0][1] = 1 - self._s[anc][win_idx][0][0]
 */
      ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[0])[0]) = exp(((-(__pyx_v_self->_t_0_1[__pyx_v_anc])) * __pyx_v_d));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line771")'> 771:                 self._s[anc][win_idx][1][0] = 1 - self._s[anc][win_idx][1][1]</pre>
<pre id='line771' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":771
 *                 self._s[anc][win_idx][1][1] = exp(-self._t_1_0[anc] * d)
 *                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)
 *                 self._s[anc][win_idx][1][0] = 1 - self._s[anc][win_idx][1][1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._s[anc][win_idx][0][1] = 1 - self._s[anc][win_idx][0][0]
 *                 #for i in range(2):
 */
      ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[1])[0]) = (1.0 - ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[1])[1]));
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line772")'> 772:                 self._s[anc][win_idx][0][1] = 1 - self._s[anc][win_idx][0][0]</pre>
<pre id='line772' class='code' style='background-color: #FFFF86'>
      /* "LDModel.pyx":772
 *                 self._s[anc][win_idx][0][0] = exp(-self._t_0_1[anc] * d)
 *                 self._s[anc][win_idx][1][0] = 1 - self._s[anc][win_idx][1][1]
 *                 self._s[anc][win_idx][0][1] = 1 - self._s[anc][win_idx][0][0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #for i in range(2):
 *                 #    for j in range(2):
 */
      ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[0])[1]) = (1.0 - ((((__pyx_v_self->_s[__pyx_v_anc])[__pyx_v_win_idx])[0])[0]));
    }
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_ibd_prior", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_57calc_ibd_prior(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_57calc_ibd_prior(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_ibd_prior (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_56calc_ibd_prior(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line773")'> 773:                 #for i in range(2):</pre>
<pre id='line773' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line774")'> 774:                 #    for j in range(2):</pre>
<pre id='line774' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line775")'> 775:                 #        print "ibd trans: " + str(anc) + " " + str(win_idx) + " " + str(i) + " " + str(j) + " : " + str(self._s[anc][win_idx][i][j])</pre>
<pre id='line775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line776")'> 776: </pre>
<pre id='line776' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line777")'> 777:         #self._s[self.get_num_windows()-1][0][0] = 1</pre>
<pre id='line777' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line778")'> 778:         #self._s[self.get_num_windows()-1][0][1] = 1</pre>
<pre id='line778' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line779")'> 779:         #self._s[self.get_num_windows()-1][1][0] = 1</pre>
<pre id='line779' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line780")'> 780:         #self._s[self.get_num_windows()-1][1][1] = 1</pre>
<pre id='line780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line781")'> 781: </pre>
<pre id='line781' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line782")'> 782:     cpdef calc_anc_trans(self):</pre>
<pre id='line782' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":782
 *         #self._s[self.get_num_windows()-1][1][1] = 1
 * 
 *     cpdef calc_anc_trans(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_59calc_anc_trans(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_anc_trans(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_nxt_admx_idx1;
  int __pyx_v_nxt_admx_idx2;
  int __pyx_v_nxt_admx_idx3;
  int __pyx_v_nxt_admx_idx4;
  double *__pyx_v_win_recomb;
  PyObject *__pyx_v_sum = NULL;
  PyObject *__pyx_v_scale = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_anc_trans", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_anc_trans", __pyx_f[0], 782);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__calc_anc_trans);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_59calc_anc_trans)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":782
 *         #self._s[self.get_num_windows()-1][1][1] = 1
 * 
 *     cpdef calc_anc_trans(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_58calc_anc_trans(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_anc_trans", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_anc_trans", __pyx_f[0], 782);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_anc_trans(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_anc_trans", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line783")'> 783:         cdef int win_idx</pre>
<pre id='line783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line784")'> 784:         cdef int admx_idx1</pre>
<pre id='line784' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line785")'> 785:         cdef int admx_idx2</pre>
<pre id='line785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line786")'> 786:         cdef int admx_idx3</pre>
<pre id='line786' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line787")'> 787:         cdef int admx_idx4</pre>
<pre id='line787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line788")'> 788:         cdef int nxt_admx_idx1</pre>
<pre id='line788' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line789")'> 789:         cdef int nxt_admx_idx2</pre>
<pre id='line789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line790")'> 790:         cdef int nxt_admx_idx3</pre>
<pre id='line790' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line791")'> 791:         cdef int nxt_admx_idx4</pre>
<pre id='line791' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line792")'> 792: </pre>
<pre id='line792' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line793")'> 793:         cdef double *win_recomb</pre>
<pre id='line793' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line794")'> 794:         win_recomb = &lt;double *&gt; malloc((self.get_num_windows()) * sizeof(double))</pre>
<pre id='line794' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":794
 * 
 *         cdef double *win_recomb
 *         win_recomb = <code><</code>double *> malloc((self.get_num_windows()) * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             # the approximated recombination rate accross the window: for smnll distances, r = d/100 (approx.) where d is genetic distance (cM) and r is recombination rate (M/b)
 */
  __pyx_v_win_recomb = ((double *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line795")'> 795:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line795' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":795
 *         cdef double *win_recomb
 *         win_recomb = <code><</code>double *> malloc((self.get_num_windows()) * sizeof(double))
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # the approximated recombination rate accross the window: for smnll distances, r = d/100 (approx.) where d is genetic distance (cM) and r is recombination rate (M/b)
 *             win_recomb[win_idx] = (self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)])
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line796")'> 796:             # the approximated recombination rate accross the window: for smnll distances, r = d/100 (approx.) where d is genetic distance (cM) and r is recombination rate (M/b)</pre>
<pre id='line796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line797")'> 797:             win_recomb[win_idx] = (self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)])</pre>
<pre id='line797' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":797
 *         for win_idx in range(self.get_num_windows()):
 *             # the approximated recombination rate accross the window: for smnll distances, r = d/100 (approx.) where d is genetic distance (cM) and r is recombination rate (M/b)
 *             win_recomb[win_idx] = (self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._anc_trans = <code><</code>double *********> malloc((self.get_num_windows()) * sizeof(double ********))
 */
    (__pyx_v_win_recomb[__pyx_v_win_idx]) = ((__pyx_v_self->_genetic_dist[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx)]) - (__pyx_v_self->_genetic_dist[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx)]));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line798")'> 798: </pre>
<pre id='line798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line799")'> 799:         self._anc_trans = &lt;double *********&gt; malloc((self.get_num_windows()) * sizeof(double ********))</pre>
<pre id='line799' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":799
 *             win_recomb[win_idx] = (self._genetic_dist[self.end_snp(win_idx)] - self._genetic_dist[self.start_snp(win_idx)])
 * 
 *         self._anc_trans = <code><</code>double *********> malloc((self.get_num_windows()) * sizeof(double ********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             sum = 0
 */
  __pyx_v_self->_anc_trans = ((double *********)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double ********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line800")'> 800:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line800' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":800
 * 
 *         self._anc_trans = <code><</code>double *********> malloc((self.get_num_windows()) * sizeof(double ********))
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sum = 0
 *             #print "calculating ancestry transitions for window: " + str(win_idx)
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line801")'> 801:             sum = 0</pre>
<pre id='line801' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":801
 *         self._anc_trans = <code><</code>double *********> malloc((self.get_num_windows()) * sizeof(double ********))
 *         for win_idx in range(self.get_num_windows()):
 *             sum = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "calculating ancestry transitions for window: " + str(win_idx)
 *             self._anc_trans[win_idx] = <code><</code>double ********> malloc(self.K * sizeof(double *******))
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum);
    __pyx_v_sum = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line802")'> 802:             #print "calculating ancestry transitions for window: " + str(win_idx)</pre>
<pre id='line802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line803")'> 803:             self._anc_trans[win_idx] = &lt;double ********&gt; malloc(self.K * sizeof(double *******))</pre>
<pre id='line803' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":803
 *             sum = 0
 *             #print "calculating ancestry transitions for window: " + str(win_idx)
 *             self._anc_trans[win_idx] = <code><</code>double ********> malloc(self.K * sizeof(double *******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 self._anc_trans[win_idx][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double ******))
 */
    (__pyx_v_self->_anc_trans[__pyx_v_win_idx]) = ((double ********)malloc((__pyx_v_self->K * (sizeof(double *******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line804")'> 804:             for admx_idx1 in range(self.K):</pre>
<pre id='line804' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":804
 *             #print "calculating ancestry transitions for window: " + str(win_idx)
 *             self._anc_trans[win_idx] = <code><</code>double ********> malloc(self.K * sizeof(double *******))
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._anc_trans[win_idx][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double ******))
 *                 for admx_idx2 in range(self.K):
 */
    __pyx_t_5 = __pyx_v_self->K;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line805")'> 805:                 self._anc_trans[win_idx][admx_idx1] = &lt;double *******&gt; malloc(self.K * sizeof(double ******))</pre>
<pre id='line805' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":805
 *             self._anc_trans[win_idx] = <code><</code>double ********> malloc(self.K * sizeof(double *******))
 *             for admx_idx1 in range(self.K):
 *                 self._anc_trans[win_idx][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double ******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double *****))
 */
      ((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1]) = ((double *******)malloc((__pyx_v_self->K * (sizeof(double ******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line806")'> 806:                 for admx_idx2 in range(self.K):</pre>
<pre id='line806' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":806
 *             for admx_idx1 in range(self.K):
 *                 self._anc_trans[win_idx][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double ******))
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double *****))
 *                     for admx_idx3 in range(self.K):
 */
      __pyx_t_7 = __pyx_v_self->K;
      for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line807")'> 807:                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = &lt;double ******&gt; malloc(self.K * sizeof(double *****))</pre>
<pre id='line807' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":807
 *                 self._anc_trans[win_idx][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double ******))
 *                 for admx_idx2 in range(self.K):
 *                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 */
        (((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ******)malloc((__pyx_v_self->K * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line808")'> 808:                     for admx_idx3 in range(self.K):</pre>
<pre id='line808' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":808
 *                 for admx_idx2 in range(self.K):
 *                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double *****))
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                         for admx_idx4 in range(self.K):
 */
        __pyx_t_9 = __pyx_v_self->K;
        for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
          __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line809")'> 809:                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = &lt;double *****&gt; malloc(self.K * sizeof(double ****))</pre>
<pre id='line809' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":809
 *                     self._anc_trans[win_idx][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double *****))
 *                     for admx_idx3 in range(self.K):
 *                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double ****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
          ((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line810")'> 810:                         for admx_idx4 in range(self.K):</pre>
<pre id='line810' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":810
 *                     for admx_idx3 in range(self.K):
 *                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                             for nxt_admx_idx1 in range(self.K):
 */
          __pyx_t_11 = __pyx_v_self->K;
          for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
            __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line811")'> 811:                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line811' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":811
 *                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                         for admx_idx4 in range(self.K):
 *                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 */
            (((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line812")'> 812:                             for nxt_admx_idx1 in range(self.K):</pre>
<pre id='line812' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":812
 *                         for admx_idx4 in range(self.K):
 *                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                             for nxt_admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                                 for nxt_admx_idx2 in range(self.K):
 */
            __pyx_t_13 = __pyx_v_self->K;
            for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
              __pyx_v_nxt_admx_idx1 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line813")'> 813:                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = &lt;double ***&gt; malloc(self.K * sizeof(double **))</pre>
<pre id='line813' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":813
 *                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = <code><</code>double ***> malloc(self.K * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = <code><</code>double **> malloc(self.K * sizeof(double *))
 */
              ((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line814")'> 814:                                 for nxt_admx_idx2 in range(self.K):</pre>
<pre id='line814' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":814
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                                 for nxt_admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                                     for nxt_admx_idx3 in range(self.K):
 */
              __pyx_t_15 = __pyx_v_self->K;
              for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
                __pyx_v_nxt_admx_idx2 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line815")'> 815:                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = &lt;double **&gt; malloc(self.K * sizeof(double *))</pre>
<pre id='line815' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":815
 *                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = <code><</code>double **> malloc(self.K * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = <code><</code>double *> malloc(self.K * sizeof(double))
 */
                (((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line816")'> 816:                                     for nxt_admx_idx3 in range(self.K):</pre>
<pre id='line816' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":816
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                                     for nxt_admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = <code><</code>double *> malloc(self.K * sizeof(double))
 *                                         for nxt_admx_idx4 in range(self.K):
 */
                __pyx_t_17 = __pyx_v_self->K;
                for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                  __pyx_v_nxt_admx_idx3 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line817")'> 817:                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = &lt;double *&gt; malloc(self.K * sizeof(double))</pre>
<pre id='line817' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":817
 *                                     self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = <code><</code>double *> malloc(self.K * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             if win_recomb[win_idx] > 0:
 */
                  ((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3]) = ((double *)malloc((__pyx_v_self->K * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line818")'> 818:                                         for nxt_admx_idx4 in range(self.K):</pre>
<pre id='line818' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":818
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = <code><</code>double *> malloc(self.K * sizeof(double))
 *                                         for nxt_admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             if win_recomb[win_idx] > 0:
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = (self.g - 1) * win_recomb[win_idx]
 */
                  __pyx_t_19 = __pyx_v_self->K;
                  for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
                    __pyx_v_nxt_admx_idx4 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line819")'> 819:                                             if win_recomb[win_idx] &gt; 0:</pre>
<pre id='line819' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":819
 *                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3] = <code><</code>double *> malloc(self.K * sizeof(double))
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             if win_recomb[win_idx] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = (self.g - 1) * win_recomb[win_idx]
 *                                             else:
 */
                    __pyx_t_21 = ((__pyx_v_win_recomb[__pyx_v_win_idx]) > 0.0);
                    if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line820")'> 820:                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = (self.g - 1) * win_recomb[win_idx]</pre>
<pre id='line820' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":820
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             if win_recomb[win_idx] > 0:
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = (self.g - 1) * win_recomb[win_idx]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             else:
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 1
 */
                      (((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]) = ((__pyx_v_self->g - 1) * (__pyx_v_win_recomb[__pyx_v_win_idx]));
                      goto __pyx_L23;
                    }
                    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line821")'> 821:                                             else:</pre>
<pre id='line821' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line822")'> 822:                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 1</pre>
<pre id='line822' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":822
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = (self.g - 1) * win_recomb[win_idx]
 *                                             else:
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             sum += self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]
 *             scale = 1.0
 */
                      (((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]) = 1.0;
                    }
                    __pyx_L23:;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line823")'> 823:                                             sum += self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]</pre>
<pre id='line823' class='code' style='background-color: #FFFF73'>
                    /* "LDModel.pyx":823
 *                                             else:
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 1
 *                                             sum += self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             scale = 1.0
 *             if sum == 0:
 */
                    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_sum, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sum);
                    __pyx_v_sum = __pyx_t_2;
                    __pyx_t_2 = 0;
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line824")'> 824:             scale = 1.0</pre>
<pre id='line824' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":824
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 1
 *                                             sum += self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]
 *             scale = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if sum == 0:
 *                 scale = 1.0
 */
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scale);
    __pyx_v_scale = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line825")'> 825:             if sum == 0:</pre>
<pre id='line825' class='code' style='background-color: #FFFF79'>
    /* "LDModel.pyx":825
 *                                             sum += self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]
 *             scale = 1.0
 *             if sum == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 scale = 1.0
 *             else:
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_sum, __pyx_int_0, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_21 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_21 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line826")'> 826:                 scale = 1.0</pre>
<pre id='line826' class='code' style='background-color: #FFFF9f'>
      /* "LDModel.pyx":826
 *             scale = 1.0
 *             if sum == 0:
 *                 scale = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 scale = 1.0/sum
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_scale);
      __pyx_v_scale = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L24;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line827")'> 827:             else:</pre>
<pre id='line827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line828")'> 828:                 scale = 1.0/sum</pre>
<pre id='line828' class='code' style='background-color: #FFFF73'>
      /* "LDModel.pyx":828
 *                 scale = 1.0
 *             else:
 *                 scale = 1.0/sum             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if not c_isfinite(scale):
 *                     scale = 1.0
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_2, __pyx_v_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_scale);
      __pyx_v_scale = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line829")'> 829:                 if not c_isfinite(scale):</pre>
<pre id='line829' class='code' style='background-color: #FFFF7f'>
      /* "LDModel.pyx":829
 *             else:
 *                 scale = 1.0/sum
 *                 if not c_isfinite(scale):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     scale = 1.0
 *             for admx_idx1 in range(self.K):
 */
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_scale);<span class='error_goto'> if (unlikely((__pyx_t_22 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_21 = (!c_isfinite(__pyx_t_22));
      if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line830")'> 830:                     scale = 1.0</pre>
<pre id='line830' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":830
 *                 scale = 1.0/sum
 *                 if not c_isfinite(scale):
 *                     scale = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_scale);
        __pyx_v_scale = __pyx_t_1;
        __pyx_t_1 = 0;
        goto __pyx_L25;
      }
      __pyx_L25:;
    }
    __pyx_L24:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line831")'> 831:             for admx_idx1 in range(self.K):</pre>
<pre id='line831' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":831
 *                 if not c_isfinite(scale):
 *                     scale = 1.0
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_5 = __pyx_v_self->K;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line832")'> 832:                 for admx_idx2 in range(self.K):</pre>
<pre id='line832' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":832
 *                     scale = 1.0
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_7 = __pyx_v_self->K;
      for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line833")'> 833:                     for admx_idx3 in range(self.K):</pre>
<pre id='line833' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":833
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for nxt_admx_idx1 in range(self.K):
 */
        __pyx_t_9 = __pyx_v_self->K;
        for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
          __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line834")'> 834:                         for admx_idx4 in range(self.K):</pre>
<pre id='line834' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":834
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 for nxt_admx_idx2 in range(self.K):
 */
          __pyx_t_11 = __pyx_v_self->K;
          for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
            __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line835")'> 835:                             for nxt_admx_idx1 in range(self.K):</pre>
<pre id='line835' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":835
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for nxt_admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     for nxt_admx_idx3 in range(self.K):
 */
            __pyx_t_13 = __pyx_v_self->K;
            for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
              __pyx_v_nxt_admx_idx1 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line836")'> 836:                                 for nxt_admx_idx2 in range(self.K):</pre>
<pre id='line836' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":836
 *                         for admx_idx4 in range(self.K):
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 for nxt_admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         for nxt_admx_idx4 in range(self.K):
 */
              __pyx_t_15 = __pyx_v_self->K;
              for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
                __pyx_v_nxt_admx_idx2 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line837")'> 837:                                     for nxt_admx_idx3 in range(self.K):</pre>
<pre id='line837' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":837
 *                             for nxt_admx_idx1 in range(self.K):
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     for nxt_admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \
 */
                __pyx_t_17 = __pyx_v_self->K;
                for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                  __pyx_v_nxt_admx_idx3 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line838")'> 838:                                         for nxt_admx_idx4 in range(self.K):</pre>
<pre id='line838' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":838
 *                                 for nxt_admx_idx2 in range(self.K):
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         for nxt_admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale
 */
                  __pyx_t_19 = __pyx_v_self->K;
                  for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
                    __pyx_v_nxt_admx_idx4 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line839")'> 839:                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \</pre>
<pre id='line839' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":839
 *                                     for nxt_admx_idx3 in range(self.K):
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale
 *                                             if not c_isfinite(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]):
 */
                    (((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]) = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line840")'> 840:                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale</pre>
<pre id='line840' class='code' style='background-color: #FFFF4f'>
                    /* "LDModel.pyx":840
 *                                         for nxt_admx_idx4 in range(self.K):
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             if not c_isfinite(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]):
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0
 */
                    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_scale);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_22 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line841")'> 841:                                             if not c_isfinite(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]):</pre>
<pre id='line841' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":841
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = \
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale
 *                                             if not c_isfinite(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0
 * 
 */
                    __pyx_t_21 = (!c_isfinite((((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4])));
                    if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line842")'> 842:                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0</pre>
<pre id='line842' class='code' style='background-color: #FFFF79'>
                      /* "LDModel.pyx":842
 *                                             self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * scale
 *                                             if not c_isfinite(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]):
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef emission_prob_ibd_admx_mem_alloc(self, int win_idx, bool post):
 */
                      (((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]) = 0.0;
                      goto __pyx_L42;
                    }
                    __pyx_L42:;
                  }
                }
              }
            }
          }
        }
      }
    }
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_anc_trans", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scale);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_59calc_anc_trans(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_59calc_anc_trans(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_anc_trans (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_58calc_anc_trans(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line843")'> 843: </pre>
<pre id='line843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line844")'> 844:     cpdef emission_prob_ibd_admx_mem_alloc(self, int win_idx, bool post):</pre>
<pre id='line844' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":844
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0
 * 
 *     cpdef emission_prob_ibd_admx_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_61emission_prob_ibd_admx_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_emission_prob_ibd_admx_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("emission_prob_ibd_admx_mem_alloc", __pyx_f[0], 844);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_56);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_61emission_prob_ibd_admx_mem_alloc)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":844
 *                                                 self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] = 0.0
 * 
 *     cpdef emission_prob_ibd_admx_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_60emission_prob_ibd_admx_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("emission_prob_ibd_admx_mem_alloc", __pyx_f[0], 844);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_alloc(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line845")'> 845:         cdef int snp_idx</pre>
<pre id='line845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line846")'> 846:         cdef int node_idx1</pre>
<pre id='line846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line847")'> 847:         cdef int node_idx2</pre>
<pre id='line847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line848")'> 848:         cdef int node_idx3</pre>
<pre id='line848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line849")'> 849:         cdef int node_idx4</pre>
<pre id='line849' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line850")'> 850:         cdef int admx_idx1</pre>
<pre id='line850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line851")'> 851:         cdef int admx_idx2</pre>
<pre id='line851' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line852")'> 852:         cdef int admx_idx3</pre>
<pre id='line852' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line853")'> 853:         cdef int admx_idx4</pre>
<pre id='line853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line854")'> 854:         cdef int snp_idx_win</pre>
<pre id='line854' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line855")'> 855:         #cdef double sum</pre>
<pre id='line855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line856")'> 856: </pre>
<pre id='line856' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line857")'> 857:         snp_idx_win = 0</pre>
<pre id='line857' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":857
 *         #cdef double sum
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(self._win_size * sizeof(double ********))
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line858")'> 858:         if not post:</pre>
<pre id='line858' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":858
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(self._win_size * sizeof(double ********))
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line859")'> 859:             self._emission_prob_ibd_admx = &lt;double *********&gt; malloc(self._win_size * sizeof(double ********))</pre>
<pre id='line859' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":859
 *         snp_idx_win = 0
 *         if not post:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(self._win_size * sizeof(double ********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
    __pyx_v_self->_emission_prob_ibd_admx = ((double *********)malloc((__pyx_v_self->_win_size * (sizeof(double ********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line860")'> 860:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line860' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":860
 *         if not post:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(self._win_size * sizeof(double ********))
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line861")'> 861:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line861' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":861
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(self._win_size * sizeof(double ********))
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(3 * self._win_size * sizeof(double ********))
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line862")'> 862:         else:</pre>
<pre id='line862' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line863")'> 863:             self._emission_prob_ibd_admx = &lt;double *********&gt; malloc(3 * self._win_size * sizeof(double ********))</pre>
<pre id='line863' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":863
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(3 * self._win_size * sizeof(double ********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 */
    __pyx_v_self->_emission_prob_ibd_admx = ((double *********)malloc(((3 * __pyx_v_self->_win_size) * (sizeof(double ********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line864")'> 864:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line864' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":864
 *         else:
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(3 * self._win_size * sizeof(double ********))
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line865")'> 865:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line865' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":865
 *             self._emission_prob_ibd_admx = <code><</code>double *********> malloc(3 * self._win_size * sizeof(double ********))
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line866")'> 866:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line866' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":866
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line867")'> 867:             else:</pre>
<pre id='line867' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line868")'> 868:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line868' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":868
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line869")'> 869:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line869' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":869
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             self._emission_prob_ibd_admx[snp_idx_win] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line870")'> 870:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line870' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":870
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._emission_prob_ibd_admx[snp_idx_win] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line871")'> 871:             self._emission_prob_ibd_admx[snp_idx_win] = &lt;double ********&gt; malloc(self.K * sizeof(double*******))</pre>
<pre id='line871' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":871
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             self._emission_prob_ibd_admx[snp_idx_win] = <code><</code>double ********> malloc(self.K * sizeof(double*******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 */
    (__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win]) = ((double ********)malloc((__pyx_v_self->K * (sizeof(double *******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line872")'> 872:             for admx_idx1 in range(self.K):</pre>
<pre id='line872' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":872
 *         for snp_idx in range(start_snp, end_snp):
 *             self._emission_prob_ibd_admx[snp_idx_win] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                 for admx_idx2 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line873")'> 873:                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = &lt;double *******&gt; malloc(self.K * sizeof(double******))</pre>
<pre id='line873' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":873
 *             self._emission_prob_ibd_admx[snp_idx_win] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *             for admx_idx1 in range(self.K):
 *                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 */
      ((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]) = ((double *******)malloc((__pyx_v_self->K * (sizeof(double ******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line874")'> 874:                 for admx_idx2 in range(self.K):</pre>
<pre id='line874' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":874
 *             for admx_idx1 in range(self.K):
 *                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                     for admx_idx3 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line875")'> 875:                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = &lt;double ******&gt; malloc(self.K * sizeof(double*****))</pre>
<pre id='line875' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":875
 *                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                 for admx_idx2 in range(self.K):
 *                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double*****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 */
        (((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ******)malloc((__pyx_v_self->K * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line876")'> 876:                     for admx_idx3 in range(self.K):</pre>
<pre id='line876' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":876
 *                 for admx_idx2 in range(self.K):
 *                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *                         for admx_idx4 in range(self.K):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line877")'> 877:                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = &lt;double *****&gt; malloc(self.K * sizeof(double****))</pre>
<pre id='line877' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":877
 *                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                     for admx_idx3 in range(self.K):
 *                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))
 */
          ((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line878")'> 878:                         for admx_idx4 in range(self.K):</pre>
<pre id='line878' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":878
 *                     for admx_idx3 in range(self.K):
 *                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line879")'> 879:                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;double ****&gt; malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))</pre>
<pre id='line879' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":879
 *                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *                         for admx_idx4 in range(self.K):
 *                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))
 */
            (((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double ****)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]) * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line880")'> 880:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line880' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":880
 *                         for admx_idx4 in range(self.K):
 *                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line881")'> 881:                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = &lt;double ***&gt; malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))</pre>
<pre id='line881' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":881
 *                             self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double***))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))
 */
              ((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1]) = ((double ***)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]) * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line882")'> 882:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line882' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":882
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line883")'> 883:                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = &lt;double **&gt; malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))</pre>
<pre id='line883' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":883
 *                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double**))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double *> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double))
 */
                (((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2]) = ((double **)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]) * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line884")'> 884:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line884' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":884
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double *> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double))
 *             snp_idx_win += 1
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line885")'> 885:                                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = &lt;double *&gt; malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double))</pre>
<pre id='line885' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":885
 *                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double*))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double *> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
                  ((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3]) = ((double *)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]) * (sizeof(double)))));
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line886")'> 886:             snp_idx_win += 1</pre>
<pre id='line886' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":886
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double *> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double))
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef emission_prob_ibd_admx_mem_free(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_61emission_prob_ibd_admx_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_61emission_prob_ibd_admx_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_alloc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emission_prob_ibd_admx_mem_alloc", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "emission_prob_ibd_admx_mem_alloc") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emission_prob_ibd_admx_mem_alloc", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_60emission_prob_ibd_admx_mem_alloc(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line887")'> 887: </pre>
<pre id='line887' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line888")'> 888:     cpdef emission_prob_ibd_admx_mem_free(self, int win_idx, bool post):</pre>
<pre id='line888' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":888
 *             snp_idx_win += 1
 * 
 *     cpdef emission_prob_ibd_admx_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_63emission_prob_ibd_admx_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_emission_prob_ibd_admx_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("emission_prob_ibd_admx_mem_free", __pyx_f[0], 888);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_57);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_63emission_prob_ibd_admx_mem_free)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":888
 *             snp_idx_win += 1
 * 
 *     cpdef emission_prob_ibd_admx_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_62emission_prob_ibd_admx_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("emission_prob_ibd_admx_mem_free", __pyx_f[0], 888);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_free(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line889")'> 889:         cdef int snp_idx</pre>
<pre id='line889' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line890")'> 890:         cdef int node_idx1</pre>
<pre id='line890' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line891")'> 891:         cdef int node_idx2</pre>
<pre id='line891' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line892")'> 892:         cdef int node_idx3</pre>
<pre id='line892' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line893")'> 893:         cdef int node_idx4</pre>
<pre id='line893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line894")'> 894:         cdef int admx_idx1</pre>
<pre id='line894' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line895")'> 895:         cdef int admx_idx2</pre>
<pre id='line895' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line896")'> 896:         cdef int admx_idx3</pre>
<pre id='line896' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line897")'> 897:         cdef int admx_idx4</pre>
<pre id='line897' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line898")'> 898:         cdef int snp_idx_win</pre>
<pre id='line898' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line899")'> 899: </pre>
<pre id='line899' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line900")'> 900:         snp_idx_win = 0</pre>
<pre id='line900' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":900
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line901")'> 901:         if not post:</pre>
<pre id='line901' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":901
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line902")'> 902:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line902' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":902
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line903")'> 903:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line903' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":903
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line904")'> 904:         else:</pre>
<pre id='line904' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line905")'> 905:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line905' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":905
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line906")'> 906:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line906' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":906
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line907")'> 907:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line907' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":907
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line908")'> 908:             else:</pre>
<pre id='line908' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line909")'> 909:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line909' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":909
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line910")'> 910:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line910' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":910
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line911")'> 911:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line911' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":911
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line912")'> 912:             for admx_idx1 in range(self.K):</pre>
<pre id='line912' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":912
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line913")'> 913:                 for admx_idx2 in range(self.K):</pre>
<pre id='line913' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":913
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line914")'> 914:                     for admx_idx3 in range(self.K):</pre>
<pre id='line914' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":914
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line915")'> 915:                         for admx_idx4 in range(self.K):</pre>
<pre id='line915' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":915
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line916")'> 916:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line916' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":916
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line917")'> 917:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line917' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":917
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line918")'> 918:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line918' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":918
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line919")'> 919:                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])</pre>
<pre id='line919' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":919
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 */
                  free(((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3]));
                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line920")'> 920:                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])</pre>
<pre id='line920' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":920
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 */
                free((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2]));
              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line921")'> 921:                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])</pre>
<pre id='line921' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":921
 *                                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 */
              free(((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1]));
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line922")'> 922:                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])</pre>
<pre id='line922' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":922
 *                                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 */
            free((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]));
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line923")'> 923:                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])</pre>
<pre id='line923' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":923
 *                                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])
 */
          free(((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line924")'> 924:                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])</pre>
<pre id='line924' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":924
 *                             free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._emission_prob_ibd_admx[snp_idx_win])
 */
        free((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]));
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line925")'> 925:                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])</pre>
<pre id='line925' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":925
 *                         free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             free(self._emission_prob_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1
 */
      free(((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line926")'> 926:             free(self._emission_prob_ibd_admx[snp_idx_win])</pre>
<pre id='line926' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":926
 *                     free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._emission_prob_ibd_admx[snp_idx_win])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 *         free(self._emission_prob_ibd_admx)
 */
    free((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line927")'> 927:             snp_idx_win += 1</pre>
<pre id='line927' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":927
 *                 free(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._emission_prob_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         free(self._emission_prob_ibd_admx)
 * 
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line928")'> 928:         free(self._emission_prob_ibd_admx)</pre>
<pre id='line928' class='code' style='background-color: #FFFF23'>
  /* "LDModel.pyx":928
 *             free(self._emission_prob_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1
 *         free(self._emission_prob_ibd_admx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_emission_probs_ibd_admx(self, int win_idx, bool post):
 */
  free(__pyx_v_self->_emission_prob_ibd_admx);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_63emission_prob_ibd_admx_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_63emission_prob_ibd_admx_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("emission_prob_ibd_admx_mem_free (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emission_prob_ibd_admx_mem_free", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "emission_prob_ibd_admx_mem_free") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emission_prob_ibd_admx_mem_free", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.emission_prob_ibd_admx_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_62emission_prob_ibd_admx_mem_free(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line929")'> 929: </pre>
<pre id='line929' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line930")'> 930:     cpdef calc_emission_probs_ibd_admx(self, int win_idx, bool post):</pre>
<pre id='line930' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":930
 *         free(self._emission_prob_ibd_admx)
 * 
 *     cpdef calc_emission_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_65calc_emission_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_emission_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_emission_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_emission_probs_ibd_admx", __pyx_f[0], 930);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_58);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_65calc_emission_probs_ibd_admx)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":930
 *         free(self._emission_prob_ibd_admx)
 * 
 *     cpdef calc_emission_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_64calc_emission_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_emission_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_emission_probs_ibd_admx", __pyx_f[0], 930);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_emission_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_emission_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line931")'> 931: </pre>
<pre id='line931' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line932")'> 932:         cdef int snp_idx</pre>
<pre id='line932' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line933")'> 933:         cdef int node_idx1</pre>
<pre id='line933' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line934")'> 934:         cdef int node_idx2</pre>
<pre id='line934' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line935")'> 935:         cdef int node_idx3</pre>
<pre id='line935' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line936")'> 936:         cdef int node_idx4</pre>
<pre id='line936' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line937")'> 937:         cdef int ibd</pre>
<pre id='line937' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line938")'> 938:         cdef int admx_idx1</pre>
<pre id='line938' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line939")'> 939:         cdef int admx_idx2</pre>
<pre id='line939' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line940")'> 940:         cdef int admx_idx3</pre>
<pre id='line940' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line941")'> 941:         cdef int admx_idx4</pre>
<pre id='line941' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line942")'> 942:         cdef int snp_idx_win</pre>
<pre id='line942' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line943")'> 943: </pre>
<pre id='line943' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line944")'> 944:         snp_idx_win = 0</pre>
<pre id='line944' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":944
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line945")'> 945:         if not post:</pre>
<pre id='line945' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":945
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line946")'> 946:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line946' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":946
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line947")'> 947:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line947' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":947
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line948")'> 948:         else:</pre>
<pre id='line948' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line949")'> 949:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line949' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":949
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line950")'> 950:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line950' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":950
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line951")'> 951:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line951' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":951
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line952")'> 952:             else:</pre>
<pre id='line952' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line953")'> 953:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line953' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":953
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line954")'> 954:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line954' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":954
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "calculating emission probs in layer: " + str(snp_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line955")'> 955:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line955' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":955
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "calculating emission probs in layer: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line956")'> 956:             #print "calculating emission probs in layer: " + str(snp_idx)</pre>
<pre id='line956' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line957")'> 957:             for admx_idx1 in range(self.K):</pre>
<pre id='line957' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":957
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "calculating emission probs in layer: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line958")'> 958:                 for admx_idx2 in range(self.K):</pre>
<pre id='line958' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":958
 *             #print "calculating emission probs in layer: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line959")'> 959:                     for admx_idx3 in range(self.K):</pre>
<pre id='line959' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":959
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line960")'> 960:                         for admx_idx4 in range(self.K):</pre>
<pre id='line960' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":960
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line961")'> 961:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line961' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":961
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line962")'> 962:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line962' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":962
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line963")'> 963:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line963' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":963
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             #print "admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " snp_idx: " + str(snp_idx) + " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4)
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line964")'> 964:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line964' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":964
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             #print "admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " snp_idx: " + str(snp_idx) + " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4)
 *                                             if not self._phased:
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_node_idx4 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line965")'> 965:                                             #print "admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " snp_idx: " + str(snp_idx) + " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4)</pre>
<pre id='line965' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line966")'> 966:                                             if not self._phased:</pre>
<pre id='line966' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":966
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             #print "admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " snp_idx: " + str(snp_idx) + " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4)
 *                                             if not self._phased:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 if self._chr1[snp_idx] == self._chr2[snp_idx]:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \
 */
                    __pyx_t_5 = (!__pyx_v_self->_phased);
                    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line967")'> 967:                                                 if self._chr1[snp_idx] == self._chr2[snp_idx]:</pre>
<pre id='line967' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":967
 *                                             #print "admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " snp_idx: " + str(snp_idx) + " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4)
 *                                             if not self._phased:
 *                                                 if self._chr1[snp_idx] == self._chr2[snp_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]]
 */
                      __pyx_t_5 = ((__pyx_v_self->_chr1[__pyx_v_snp_idx]) == (__pyx_v_self->_chr2[__pyx_v_snp_idx]));
                      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line968")'> 968:                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \</pre>
<pre id='line968' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":968
 *                                             if not self._phased:
 *                                                 if self._chr1[snp_idx] == self._chr2[snp_idx]:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]]
 *                                                 else:
 */
                        (((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]) = (((((__pyx_v_self->_states[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1]).prob_em[(__pyx_v_self->_chr1[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2]).prob_em[(__pyx_v_self->_chr2[__pyx_v_snp_idx])]));
                        goto __pyx_L24;
                      }
                      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line969")'> 969:                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]]</pre>
<pre id='line969' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line970")'> 970:                                                 else:</pre>
<pre id='line970' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line971")'> 971:                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \</pre>
<pre id='line971' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":971
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]]
 *                                                 else:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]] + \
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr2[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr1[snp_idx]]
 */
                        (((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]) = ((((((__pyx_v_self->_states[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1]).prob_em[(__pyx_v_self->_chr1[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2]).prob_em[(__pyx_v_self->_chr2[__pyx_v_snp_idx])])) + (((((__pyx_v_self->_states[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1]).prob_em[(__pyx_v_self->_chr2[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2]).prob_em[(__pyx_v_self->_chr1[__pyx_v_snp_idx])])));
                      }
                      __pyx_L24:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line972")'> 972:                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]] + \</pre>
<pre id='line972' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line973")'> 973:                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr2[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr1[snp_idx]]</pre>
<pre id='line973' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line974")'> 974: </pre>
<pre id='line974' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line975")'> 975:                                                 if self._chr3[snp_idx] == self._chr4[snp_idx]:</pre>
<pre id='line975' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":975
 *                                                     self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr2[snp_idx]] * self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr1[snp_idx]]
 * 
 *                                                 if self._chr3[snp_idx] == self._chr4[snp_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]
 */
                      __pyx_t_5 = ((__pyx_v_self->_chr3[__pyx_v_snp_idx]) == (__pyx_v_self->_chr4[__pyx_v_snp_idx]));
                      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line976")'> 976:                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \</pre>
<pre id='line976' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":976
 * 
 *                                                 if self._chr3[snp_idx] == self._chr4[snp_idx]:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]
 *                                                 else:
 */
                        __pyx_t_24 = __pyx_v_snp_idx_win;
                        __pyx_t_25 = __pyx_v_admx_idx1;
                        __pyx_t_26 = __pyx_v_admx_idx2;
                        __pyx_t_27 = __pyx_v_admx_idx3;
                        __pyx_t_28 = __pyx_v_admx_idx4;
                        __pyx_t_29 = __pyx_v_node_idx1;
                        __pyx_t_30 = __pyx_v_node_idx2;
                        __pyx_t_31 = __pyx_v_node_idx3;
                        __pyx_t_32 = __pyx_v_node_idx4;

                        /* "LDModel.pyx":977
 *                                                 if self._chr3[snp_idx] == self._chr4[snp_idx]:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 else:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \
 */
                        (((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_t_24])[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31])[__pyx_t_32]) = ((((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_t_24])[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31])[__pyx_t_32]) * (((((__pyx_v_self->_states[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3]).prob_em[(__pyx_v_self->_chr3[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4]).prob_em[(__pyx_v_self->_chr4[__pyx_v_snp_idx])])));
                        goto __pyx_L25;
                      }
                      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line977")'> 977:                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]</pre>
<pre id='line977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line978")'> 978:                                                 else:</pre>
<pre id='line978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line979")'> 979:                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \</pre>
<pre id='line979' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":979
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]
 *                                                 else:
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]] + \
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr4[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr3[snp_idx]]
 */
                        __pyx_t_24 = __pyx_v_snp_idx_win;
                        __pyx_t_25 = __pyx_v_admx_idx1;
                        __pyx_t_26 = __pyx_v_admx_idx2;
                        __pyx_t_27 = __pyx_v_admx_idx3;
                        __pyx_t_28 = __pyx_v_admx_idx4;
                        __pyx_t_29 = __pyx_v_node_idx1;
                        __pyx_t_30 = __pyx_v_node_idx2;
                        __pyx_t_31 = __pyx_v_node_idx3;
                        __pyx_t_32 = __pyx_v_node_idx4;

                        /* "LDModel.pyx":981
 *                                                     self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] *= \
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]] + \
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr4[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr3[snp_idx]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             else:
 *                                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \
 */
                        (((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_t_24])[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31])[__pyx_t_32]) = ((((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_t_24])[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31])[__pyx_t_32]) * ((((((__pyx_v_self->_states[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3]).prob_em[(__pyx_v_self->_chr3[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4]).prob_em[(__pyx_v_self->_chr4[__pyx_v_snp_idx])])) + (((((__pyx_v_self->_states[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3]).prob_em[(__pyx_v_self->_chr4[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4]).prob_em[(__pyx_v_self->_chr3[__pyx_v_snp_idx])]))));
                      }
                      __pyx_L25:;
                      goto __pyx_L23;
                    }
                    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line980")'> 980:                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]] + \</pre>
<pre id='line980' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line981")'> 981:                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr4[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr3[snp_idx]]</pre>
<pre id='line981' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line982")'> 982:                                             else:</pre>
<pre id='line982' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line983")'> 983:                                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \</pre>
<pre id='line983' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":983
 *                                                     self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr4[snp_idx]] * self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr3[snp_idx]]
 *                                             else:
 *                                                 self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * \
 *                                                 self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]] * \
 */
                      (((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]) = (((((((__pyx_v_self->_states[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1]).prob_em[(__pyx_v_self->_chr1[__pyx_v_snp_idx])]) * ((((__pyx_v_self->_states[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2]).prob_em[(__pyx_v_self->_chr2[__pyx_v_snp_idx])])) * ((((__pyx_v_self->_states[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3]).prob_em[(__pyx_v_self->_chr3[__pyx_v_snp_idx])])) * ((((__pyx_v_self->_states[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4]).prob_em[(__pyx_v_self->_chr4[__pyx_v_snp_idx])]));
                    }
                    __pyx_L23:;
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line984")'> 984:                                                 self._states[admx_idx1][snp_idx][node_idx1].prob_em[self._chr1[snp_idx]] * \</pre>
<pre id='line984' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line985")'> 985:                                                 self._states[admx_idx2][snp_idx][node_idx2].prob_em[self._chr2[snp_idx]] * \</pre>
<pre id='line985' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line986")'> 986:                                                 self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * \</pre>
<pre id='line986' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line987")'> 987:                                                 self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]</pre>
<pre id='line987' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line988")'> 988:             snp_idx_win += 1</pre>
<pre id='line988' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":988
 *                                                 self._states[admx_idx3][snp_idx][node_idx3].prob_em[self._chr3[snp_idx]] * \
 *                                                 self._states[admx_idx4][snp_idx][node_idx4].prob_em[self._chr4[snp_idx]]
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef scale_factors_mem_alloc(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_emission_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_65calc_emission_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_65calc_emission_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_emission_probs_ibd_admx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_emission_probs_ibd_admx", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_emission_probs_ibd_admx") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_emission_probs_ibd_admx", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 930; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_emission_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_64calc_emission_probs_ibd_admx(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line989")'> 989: </pre>
<pre id='line989' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line990")'> 990:     cpdef scale_factors_mem_alloc(self, int win_idx, bool post):</pre>
<pre id='line990' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":990
 *             snp_idx_win += 1
 * 
 *     cpdef scale_factors_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int ibd
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_67scale_factors_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_scale_factors_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("scale_factors_mem_alloc", __pyx_f[0], 990);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_59);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_67scale_factors_mem_alloc)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":990
 *             snp_idx_win += 1
 * 
 *     cpdef scale_factors_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int ibd
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_66scale_factors_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("scale_factors_mem_alloc", __pyx_f[0], 990);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_alloc(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line991")'> 991:         cdef int snp_idx</pre>
<pre id='line991' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line992")'> 992:         cdef int ibd</pre>
<pre id='line992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line993")'> 993:         cdef int admx_idx1</pre>
<pre id='line993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line994")'> 994:         cdef int admx_idx2</pre>
<pre id='line994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line995")'> 995:         cdef int admx_idx3</pre>
<pre id='line995' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line996")'> 996:         cdef int admx_idx4</pre>
<pre id='line996' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line997")'> 997:         cdef int snp_idx_win</pre>
<pre id='line997' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line998")'> 998: </pre>
<pre id='line998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line999")'> 999:         snp_idx_win = 0</pre>
<pre id='line999' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":999
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             self._scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1000")'> 1000:         if not post:</pre>
<pre id='line1000' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1000
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             self._backward_scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1001")'> 1001:             self._scale_factor = &lt;double ******&gt; malloc(self._win_size * sizeof(double *****))</pre>
<pre id='line1001' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1001
 *         snp_idx_win = 0
 *         if not post:
 *             self._scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._backward_scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             start_snp = self.start_snp(win_idx)
 */
    __pyx_v_self->_scale_factor = ((double ******)malloc((__pyx_v_self->_win_size * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1002")'> 1002:             self._backward_scale_factor = &lt;double ******&gt; malloc(self._win_size * sizeof(double *****))</pre>
<pre id='line1002' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1002
 *         if not post:
 *             self._scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             self._backward_scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
    __pyx_v_self->_backward_scale_factor = ((double ******)malloc((__pyx_v_self->_win_size * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1003")'> 1003:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1003' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1003
 *             self._scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             self._backward_scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1004")'> 1004:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1004' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1004
 *             self._backward_scale_factor = <code><</code>double ******> malloc(self._win_size * sizeof(double *****))
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             self._scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1005")'> 1005:         else:</pre>
<pre id='line1005' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1006")'> 1006:             self._scale_factor = &lt;double ******&gt; malloc(3 * self._win_size * sizeof(double *****))</pre>
<pre id='line1006' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1006
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             self._scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._backward_scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_self->_scale_factor = ((double ******)malloc(((3 * __pyx_v_self->_win_size) * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1007")'> 1007:             self._backward_scale_factor = &lt;double ******&gt; malloc(3 * self._win_size * sizeof(double *****))</pre>
<pre id='line1007' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1007
 *         else:
 *             self._scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 *             self._backward_scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 */
    __pyx_v_self->_backward_scale_factor = ((double ******)malloc(((3 * __pyx_v_self->_win_size) * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1008")'> 1008:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1008' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1008
 *             self._scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 *             self._backward_scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1009")'> 1009:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1009' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1009
 *             self._backward_scale_factor = <code><</code>double ******> malloc(3 * self._win_size * sizeof(double *****))
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1010")'> 1010:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1010' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1010
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1011")'> 1011:             else:</pre>
<pre id='line1011' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1012")'> 1012:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1012' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1012
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1013")'> 1013:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1013' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1013
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             self._scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1014")'> 1014:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1014' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1014
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             self._backward_scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1015")'> 1015:             self._scale_factor[snp_idx_win] = &lt;double *****&gt; malloc(self.K * sizeof(double****))</pre>
<pre id='line1015' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1015
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             self._scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._backward_scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             for admx_idx1 in range(self.K):
 */
    (__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1016")'> 1016:             self._backward_scale_factor[snp_idx_win] = &lt;double *****&gt; malloc(self.K * sizeof(double****))</pre>
<pre id='line1016' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1016
 *         for snp_idx in range(start_snp, end_snp):
 *             self._scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             self._backward_scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 self._scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 */
    (__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1017")'> 1017:             for admx_idx1 in range(self.K):</pre>
<pre id='line1017' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1017
 *             self._scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             self._backward_scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 self._backward_scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1018")'> 1018:                 self._scale_factor[snp_idx_win][admx_idx1] = &lt;double ****&gt; malloc(self.K * sizeof(double***))</pre>
<pre id='line1018' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1018
 *             self._backward_scale_factor[snp_idx_win] = <code><</code>double *****> malloc(self.K * sizeof(double****))
 *             for admx_idx1 in range(self.K):
 *                 self._scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._backward_scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 for admx_idx2 in range(self.K):
 */
      ((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1019")'> 1019:                 self._backward_scale_factor[snp_idx_win][admx_idx1] = &lt;double ****&gt; malloc(self.K * sizeof(double***))</pre>
<pre id='line1019' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1019
 *             for admx_idx1 in range(self.K):
 *                 self._scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 self._backward_scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 */
      ((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1020")'> 1020:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1020' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1020
 *                 self._scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 self._backward_scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1021")'> 1021:                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = &lt;double ***&gt; malloc(self.K * sizeof(double**))</pre>
<pre id='line1021' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1021
 *                 self._backward_scale_factor[snp_idx_win][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double***))
 *                 for admx_idx2 in range(self.K):
 *                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     for admx_idx3 in range(self.K):
 */
        (((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1022")'> 1022:                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = &lt;double ***&gt; malloc(self.K * sizeof(double**))</pre>
<pre id='line1022' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1022
 *                 for admx_idx2 in range(self.K):
 *                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 */
        (((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1023")'> 1023:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1023' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1023
 *                     self._scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1024")'> 1024:                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = &lt;double **&gt; malloc(self.K * sizeof(double*))</pre>
<pre id='line1024' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1024
 *                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double**))
 *                     for admx_idx3 in range(self.K):
 *                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         for admx_idx4 in range(self.K):
 */
          ((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1025")'> 1025:                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = &lt;double **&gt; malloc(self.K * sizeof(double*))</pre>
<pre id='line1025' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1025
 *                     for admx_idx3 in range(self.K):
 *                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 */
          ((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1026")'> 1026:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1026' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1026
 *                         self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1027")'> 1027:                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= &lt;double *&gt; malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))</pre>
<pre id='line1027' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1027
 *                         self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double*))
 *                         for admx_idx4 in range(self.K):
 *                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             for ibd in range(2):
 */
            (((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1028")'> 1028:                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= &lt;double *&gt; malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))</pre>
<pre id='line1028' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1028
 *                         for admx_idx4 in range(self.K):
 *                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
            (((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1029")'> 1029:                             for ibd in range(2):</pre>
<pre id='line1029' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1029
 *                             self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> 2; __pyx_t_16+=1) {
              __pyx_v_ibd = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1030")'> 1030:                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1030' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1030
 *                             self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double))
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
              ((((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1031")'> 1031:                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1031' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1031
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
              ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1032")'> 1032:             snp_idx_win += 1</pre>
<pre id='line1032' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":1032
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef scale_factors_mem_free(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_67scale_factors_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_67scale_factors_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_alloc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_factors_mem_alloc", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "scale_factors_mem_alloc") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_factors_mem_alloc", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_66scale_factors_mem_alloc(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1033")'> 1033: </pre>
<pre id='line1033' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1034")'> 1034:     cpdef scale_factors_mem_free(self, int win_idx, bool post):</pre>
<pre id='line1034' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1034
 *             snp_idx_win += 1
 * 
 *     cpdef scale_factors_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int ibd
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_69scale_factors_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_scale_factors_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  CYTHON_UNUSED int __pyx_v_snp_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("scale_factors_mem_free", __pyx_f[0], 1034);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_60);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_69scale_factors_mem_free)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1034
 *             snp_idx_win += 1
 * 
 *     cpdef scale_factors_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int ibd
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_68scale_factors_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("scale_factors_mem_free", __pyx_f[0], 1034);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_free(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1035")'> 1035:         cdef int snp_idx</pre>
<pre id='line1035' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1036")'> 1036:         cdef int ibd</pre>
<pre id='line1036' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1037")'> 1037:         cdef int admx_idx1</pre>
<pre id='line1037' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1038")'> 1038:         cdef int admx_idx2</pre>
<pre id='line1038' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1039")'> 1039:         cdef int admx_idx3</pre>
<pre id='line1039' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1040")'> 1040:         cdef int admx_idx4</pre>
<pre id='line1040' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1041")'> 1041:         cdef int snp_idx_win</pre>
<pre id='line1041' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1042")'> 1042: </pre>
<pre id='line1042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1043")'> 1043:         snp_idx_win = 0</pre>
<pre id='line1043' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1043
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1044")'> 1044:         if not post:</pre>
<pre id='line1044' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1044
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1045")'> 1045:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1045' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1045
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1046")'> 1046:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1046' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1046
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1047")'> 1047:         else:</pre>
<pre id='line1047' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1048")'> 1048:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1048' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1048
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1049")'> 1049:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1049' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1049
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1050")'> 1050:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1050' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1050
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1051")'> 1051:             else:</pre>
<pre id='line1051' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1052")'> 1052:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1052' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1052
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1053")'> 1053:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1053' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1053
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "freeing in snp: " + str(snp_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1054")'> 1054:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1054' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1054
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1055")'> 1055:             #print "freeing in snp: " + str(snp_idx)</pre>
<pre id='line1055' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1056")'> 1056:             for admx_idx1 in range(self.K):</pre>
<pre id='line1056' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1056
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1057")'> 1057:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1057' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1057
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1058")'> 1058:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1058' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1058
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1059")'> 1059:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1059' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1059
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1060")'> 1060:                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])</pre>
<pre id='line1060' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1060
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 */
            free((((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1061")'> 1061:                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])</pre>
<pre id='line1061' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1061
 *                         for admx_idx4 in range(self.K):
 *                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 */
            free((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]));
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1062")'> 1062:                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])</pre>
<pre id='line1062' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1062
 *                             free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 */
          free(((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1063")'> 1063:                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])</pre>
<pre id='line1063' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1063
 *                             free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 */
          free(((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1064")'> 1064:                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])</pre>
<pre id='line1064' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1064
 *                         free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._scale_factor[snp_idx_win][admx_idx1])
 */
        free((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1065")'> 1065:                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])</pre>
<pre id='line1065' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1065
 *                         free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 free(self._scale_factor[snp_idx_win][admx_idx1])
 *                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])
 */
        free((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]));
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1066")'> 1066:                 free(self._scale_factor[snp_idx_win][admx_idx1])</pre>
<pre id='line1066' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1066
 *                     free(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._scale_factor[snp_idx_win][admx_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])
 *             free(self._scale_factor[snp_idx_win])
 */
      free(((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1067")'> 1067:                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])</pre>
<pre id='line1067' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1067
 *                     free(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._scale_factor[snp_idx_win][admx_idx1])
 *                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             free(self._scale_factor[snp_idx_win])
 *             free(self._backward_scale_factor[snp_idx_win])
 */
      free(((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1068")'> 1068:             free(self._scale_factor[snp_idx_win])</pre>
<pre id='line1068' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1068
 *                 free(self._scale_factor[snp_idx_win][admx_idx1])
 *                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])
 *             free(self._scale_factor[snp_idx_win])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             free(self._backward_scale_factor[snp_idx_win])
 *             snp_idx_win += 1
 */
    free((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1069")'> 1069:             free(self._backward_scale_factor[snp_idx_win])</pre>
<pre id='line1069' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1069
 *                 free(self._backward_scale_factor[snp_idx_win][admx_idx1])
 *             free(self._scale_factor[snp_idx_win])
 *             free(self._backward_scale_factor[snp_idx_win])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 *         free(self._scale_factor)
 */
    free((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1070")'> 1070:             snp_idx_win += 1</pre>
<pre id='line1070' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1070
 *             free(self._scale_factor[snp_idx_win])
 *             free(self._backward_scale_factor[snp_idx_win])
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         free(self._scale_factor)
 *         free(self._backward_scale_factor)
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1071")'> 1071:         free(self._scale_factor)</pre>
<pre id='line1071' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1071
 *             free(self._backward_scale_factor[snp_idx_win])
 *             snp_idx_win += 1
 *         free(self._scale_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         free(self._backward_scale_factor)
 * 
 */
  free(__pyx_v_self->_scale_factor);
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1072")'> 1072:         free(self._backward_scale_factor)</pre>
<pre id='line1072' class='code' style='background-color: #FFFF23'>
  /* "LDModel.pyx":1072
 *             snp_idx_win += 1
 *         free(self._scale_factor)
 *         free(self._backward_scale_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef scale_factors_init(self, int win_idx, bool post):
 */
  free(__pyx_v_self->_backward_scale_factor);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_69scale_factors_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_69scale_factors_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_mem_free (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_factors_mem_free", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "scale_factors_mem_free") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_factors_mem_free", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.scale_factors_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_68scale_factors_mem_free(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1073")'> 1073: </pre>
<pre id='line1073' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1074")'> 1074:     cdef scale_factors_init(self, int win_idx, bool post):</pre>
<pre id='line1074' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":1074
 *         free(self._backward_scale_factor)
 * 
 *     cdef scale_factors_init(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_f_7LDModel_7LDModel_scale_factors_init(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  CYTHON_UNUSED int __pyx_v_snp_idx;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("scale_factors_init", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("scale_factors_init", __pyx_f[0], 1074);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1075")'> 1075:         cdef int snp_idx</pre>
<pre id='line1075' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1076")'> 1076:         cdef int node_idx1</pre>
<pre id='line1076' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1077")'> 1077:         cdef int node_idx2</pre>
<pre id='line1077' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1078")'> 1078:         cdef int node_idx3</pre>
<pre id='line1078' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1079")'> 1079:         cdef int node_idx4</pre>
<pre id='line1079' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1080")'> 1080:         cdef int ibd</pre>
<pre id='line1080' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1081")'> 1081:         cdef int admx_idx1</pre>
<pre id='line1081' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1082")'> 1082:         cdef int admx_idx2</pre>
<pre id='line1082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1083")'> 1083:         cdef int admx_idx3</pre>
<pre id='line1083' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1084")'> 1084:         cdef int admx_idx4</pre>
<pre id='line1084' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1085")'> 1085:         cdef int snp_idx_win</pre>
<pre id='line1085' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1086")'> 1086: </pre>
<pre id='line1086' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1087")'> 1087:         snp_idx_win = 0</pre>
<pre id='line1087' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1087
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1088")'> 1088:         if not post:</pre>
<pre id='line1088' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1088
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_1 = (!__pyx_v_post);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1089")'> 1089:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1089' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1089
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1090")'> 1090:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1090' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1090
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1091")'> 1091:         else:</pre>
<pre id='line1091' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1092")'> 1092:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1092' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1092
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1093")'> 1093:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1093' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1093
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1094")'> 1094:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1094' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1094
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1095")'> 1095:             else:</pre>
<pre id='line1095' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1096")'> 1096:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1096' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1096
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1097")'> 1097:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1097' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1097
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1098")'> 1098:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1098' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1098
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
  __pyx_t_2 = __pyx_v_end_snp;
  for (__pyx_t_3 = __pyx_v_start_snp; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_snp_idx = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1099")'> 1099:             for admx_idx1 in range(self.K):</pre>
<pre id='line1099' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1099
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_4 = __pyx_v_self->K;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_admx_idx1 = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1100")'> 1100:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1100' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1100
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_6 = __pyx_v_self->K;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_admx_idx2 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1101")'> 1101:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1101' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1101
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 */
        __pyx_t_8 = __pyx_v_self->K;
        for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
          __pyx_v_admx_idx3 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1102")'> 1102:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1102' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1102
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
          __pyx_t_10 = __pyx_v_self->K;
          for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
            __pyx_v_admx_idx4 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1103")'> 1103:                             for ibd in range(2):</pre>
<pre id='line1103' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1103
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> 2; __pyx_t_12+=1) {
              __pyx_v_ibd = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1104")'> 1104:                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1104' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1104
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
              ((((((__pyx_v_self->_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1105")'> 1105:                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1105' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1105
 *                             for ibd in range(2):
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
              ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1106")'> 1106:             snp_idx_win += 1</pre>
<pre id='line1106' class='code' style='background-color: #FFFFb6'>
    /* "LDModel.pyx":1106
 *                                 self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1107")'> 1107: </pre>
<pre id='line1107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1108")'> 1108: </pre>
<pre id='line1108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1109")'> 1109:     cpdef forward_probs_mem_alloc(self, int win_idx, bool post):</pre>
<pre id='line1109' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1109
 * 
 * 
 *     cpdef forward_probs_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_71forward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_forward_probs_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("forward_probs_mem_alloc", __pyx_f[0], 1109);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_61);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_71forward_probs_mem_alloc)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1109
 * 
 * 
 *     cpdef forward_probs_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_70forward_probs_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("forward_probs_mem_alloc", __pyx_f[0], 1109);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1110")'> 1110:         cdef int snp_idx</pre>
<pre id='line1110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1111")'> 1111:         cdef int node_idx1</pre>
<pre id='line1111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1112")'> 1112:         cdef int node_idx2</pre>
<pre id='line1112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1113")'> 1113:         cdef int node_idx3</pre>
<pre id='line1113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1114")'> 1114:         cdef int node_idx4</pre>
<pre id='line1114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1115")'> 1115:         cdef int ibd</pre>
<pre id='line1115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1116")'> 1116:         cdef int admx_idx1</pre>
<pre id='line1116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1117")'> 1117:         cdef int admx_idx2</pre>
<pre id='line1117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1118")'> 1118:         cdef int admx_idx3</pre>
<pre id='line1118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1119")'> 1119:         cdef int admx_idx4</pre>
<pre id='line1119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1120")'> 1120:         cdef int snp_idx_win</pre>
<pre id='line1120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1121")'> 1121: </pre>
<pre id='line1121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1122")'> 1122:         snp_idx_win = 0</pre>
<pre id='line1122' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1122
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1123")'> 1123:         if not post:</pre>
<pre id='line1123' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1123
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1124")'> 1124:             self._forward_probs_ibd_admx = &lt;double **********&gt; malloc(self._win_size * sizeof(double *********))</pre>
<pre id='line1124' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1124
 *         snp_idx_win = 0
 *         if not post:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
    __pyx_v_self->_forward_probs_ibd_admx = ((double **********)malloc((__pyx_v_self->_win_size * (sizeof(double *********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1125")'> 1125:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1125' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1125
 *         if not post:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1126")'> 1126:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1126' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1126
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1127")'> 1127:         else:</pre>
<pre id='line1127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1128")'> 1128:             self._forward_probs_ibd_admx = &lt;double **********&gt; malloc(3 * self._win_size * sizeof(double *********))</pre>
<pre id='line1128' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1128
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 */
    __pyx_v_self->_forward_probs_ibd_admx = ((double **********)malloc(((3 * __pyx_v_self->_win_size) * (sizeof(double *********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1129")'> 1129:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1129' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1129
 *         else:
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1130")'> 1130:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1130' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1130
 *             self._forward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1131")'> 1131:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1131' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1131
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1132")'> 1132:             else:</pre>
<pre id='line1132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1133")'> 1133:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1133' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1133
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1134")'> 1134:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1134' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1134
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             self._forward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1135")'> 1135:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1135' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1135
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._forward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1136")'> 1136:             self._forward_probs_ibd_admx[snp_idx_win] = &lt;double *********&gt; malloc(self.K * sizeof(double********))</pre>
<pre id='line1136' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1136
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             self._forward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 */
    (__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win]) = ((double *********)malloc((__pyx_v_self->K * (sizeof(double ********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1137")'> 1137:             for admx_idx1 in range(self.K):</pre>
<pre id='line1137' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1137
 *         for snp_idx in range(start_snp, end_snp):
 *             self._forward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1138")'> 1138:                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = &lt;double ********&gt; malloc(self.K * sizeof(double*******))</pre>
<pre id='line1138' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1138
 *             self._forward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):
 *                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 */
      ((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]) = ((double ********)malloc((__pyx_v_self->K * (sizeof(double *******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1139")'> 1139:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1139' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1139
 *             for admx_idx1 in range(self.K):
 *                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1140")'> 1140:                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = &lt;double *******&gt; malloc(self.K * sizeof(double******))</pre>
<pre id='line1140' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1140
 *                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):
 *                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 */
        (((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double *******)malloc((__pyx_v_self->K * (sizeof(double ******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1141")'> 1141:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1141' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1141
 *                 for admx_idx2 in range(self.K):
 *                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1142")'> 1142:                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = &lt;double ******&gt; malloc(self.K * sizeof(double*****))</pre>
<pre id='line1142' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1142
 *                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):
 *                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 */
          ((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double ******)malloc((__pyx_v_self->K * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1143")'> 1143:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1143' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1143
 *                     for admx_idx3 in range(self.K):
 *                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1144")'> 1144:                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= &lt;double *****&gt; malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))</pre>
<pre id='line1144' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1144
 *                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):
 *                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 */
            (((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *****)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]) * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1145")'> 1145:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1145' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1145
 *                         for admx_idx4 in range(self.K):
 *                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1146")'> 1146:                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = &lt;double ****&gt; malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))</pre>
<pre id='line1146' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1146
 *                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 */
              ((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1]) = ((double ****)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]) * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1147")'> 1147:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1147' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1147
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1148")'> 1148:                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = &lt;double ***&gt; malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))</pre>
<pre id='line1148' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1148
 *                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 */
                (((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2]) = ((double ***)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]) * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1149")'> 1149:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1149' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1149
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1150")'> 1150:                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = &lt;double **&gt; malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))</pre>
<pre id='line1150' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1150
 *                                     self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 */
                  ((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3]) = ((double **)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]) * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1151")'> 1151:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1151' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1151
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_node_idx4 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1152")'> 1152:                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line1152' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1152
 *                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 */
                    (((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1153")'> 1153:                                             for ibd in range(2):</pre>
<pre id='line1153' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1153
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
                    for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> 2; __pyx_t_24+=1) {
                      __pyx_v_ibd = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1154")'> 1154:                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0</pre>
<pre id='line1154' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1154
 *                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
                      ((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = 0.0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1155")'> 1155:             snp_idx_win += 1</pre>
<pre id='line1155' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":1155
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef forward_probs_mem_free(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_71forward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_71forward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_alloc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forward_probs_mem_alloc", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "forward_probs_mem_alloc") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forward_probs_mem_alloc", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_70forward_probs_mem_alloc(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1156")'> 1156: </pre>
<pre id='line1156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1157")'> 1157:     cpdef forward_probs_mem_free(self, int win_idx, bool post):</pre>
<pre id='line1157' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1157
 *             snp_idx_win += 1
 * 
 *     cpdef forward_probs_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_73forward_probs_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_forward_probs_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("forward_probs_mem_free", __pyx_f[0], 1157);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_62);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_73forward_probs_mem_free)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1157
 *             snp_idx_win += 1
 * 
 *     cpdef forward_probs_mem_free(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_72forward_probs_mem_free(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_free", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("forward_probs_mem_free", __pyx_f[0], 1157);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_free(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1158")'> 1158:         cdef int snp_idx</pre>
<pre id='line1158' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1159")'> 1159:         cdef int node_idx1</pre>
<pre id='line1159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1160")'> 1160:         cdef int node_idx2</pre>
<pre id='line1160' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1161")'> 1161:         cdef int node_idx3</pre>
<pre id='line1161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1162")'> 1162:         cdef int node_idx4</pre>
<pre id='line1162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1163")'> 1163:         cdef int ibd</pre>
<pre id='line1163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1164")'> 1164:         cdef int admx_idx1</pre>
<pre id='line1164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1165")'> 1165:         cdef int admx_idx2</pre>
<pre id='line1165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1166")'> 1166:         cdef int admx_idx3</pre>
<pre id='line1166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1167")'> 1167:         cdef int admx_idx4</pre>
<pre id='line1167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1168")'> 1168:         cdef int snp_idx_win</pre>
<pre id='line1168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1169")'> 1169: </pre>
<pre id='line1169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1170")'> 1170:         snp_idx_win = 0</pre>
<pre id='line1170' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1170
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1171")'> 1171:         if not post:</pre>
<pre id='line1171' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1171
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1172")'> 1172:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1172' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1172
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1173")'> 1173:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1173' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1173
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1174")'> 1174:         else:</pre>
<pre id='line1174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1175")'> 1175:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1175' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1175
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1176")'> 1176:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1176' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1176
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1177")'> 1177:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1177' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1177
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1178")'> 1178:             else:</pre>
<pre id='line1178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1179")'> 1179:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1179' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1179
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1180")'> 1180:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1180' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1180
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "freeing in snp: " + str(snp_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1181")'> 1181:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1181' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1181
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1182")'> 1182:             #print "freeing in snp: " + str(snp_idx)</pre>
<pre id='line1182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1183")'> 1183:             for admx_idx1 in range(self.K):</pre>
<pre id='line1183' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1183
 *         for snp_idx in range(start_snp, end_snp):
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1184")'> 1184:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1184' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1184
 *             #print "freeing in snp: " + str(snp_idx)
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1185")'> 1185:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1185' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1185
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1186")'> 1186:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1186' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1186
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1187")'> 1187:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1187' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1187
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1188")'> 1188:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1188' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1188
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1189")'> 1189:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1189' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1189
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1190")'> 1190:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1190' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1190
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])
 *                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_node_idx4 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1191")'> 1191:                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])</pre>
<pre id='line1191' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1191
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 */
                    free((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]));
                  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1192")'> 1192:                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])</pre>
<pre id='line1192' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1192
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])
 *                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 */
                  free(((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3]));
                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1193")'> 1193:                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])</pre>
<pre id='line1193' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1193
 *                                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4])
 *                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 */
                free((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2]));
              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1194")'> 1194:                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])</pre>
<pre id='line1194' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1194
 *                                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3])
 *                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 */
              free(((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1]));
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1195")'> 1195:                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])</pre>
<pre id='line1195' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1195
 *                                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2])
 *                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 */
            free((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]));
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1196")'> 1196:                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])</pre>
<pre id='line1196' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1196
 *                                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1])
 *                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])
 */
          free(((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1197")'> 1197:                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])</pre>
<pre id='line1197' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1197
 *                             free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4])
 *                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._forward_probs_ibd_admx[snp_idx_win])
 */
        free((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]));
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1198")'> 1198:                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])</pre>
<pre id='line1198' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1198
 *                         free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3])
 *                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             free(self._forward_probs_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1
 */
      free(((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1199")'> 1199:             free(self._forward_probs_ibd_admx[snp_idx_win])</pre>
<pre id='line1199' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1199
 *                     free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2])
 *                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._forward_probs_ibd_admx[snp_idx_win])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 *         free(self._forward_probs_ibd_admx)
 */
    free((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1200")'> 1200:             snp_idx_win += 1</pre>
<pre id='line1200' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1200
 *                 free(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1])
 *             free(self._forward_probs_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         free(self._forward_probs_ibd_admx)
 * 
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1201")'> 1201:         free(self._forward_probs_ibd_admx)</pre>
<pre id='line1201' class='code' style='background-color: #FFFF23'>
  /* "LDModel.pyx":1201
 *             free(self._forward_probs_ibd_admx[snp_idx_win])
 *             snp_idx_win += 1
 *         free(self._forward_probs_ibd_admx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef forward_probs_init(self, int win_idx, bool post):
 */
  free(__pyx_v_self->_forward_probs_ibd_admx);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_73forward_probs_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_73forward_probs_mem_free(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_mem_free (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forward_probs_mem_free", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "forward_probs_mem_free") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("forward_probs_mem_free", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.forward_probs_mem_free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_72forward_probs_mem_free(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1202")'> 1202: </pre>
<pre id='line1202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1203")'> 1203:     cdef forward_probs_init(self, int win_idx, bool post):</pre>
<pre id='line1203' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":1203
 *         free(self._forward_probs_ibd_admx)
 * 
 *     cdef forward_probs_init(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_f_7LDModel_7LDModel_forward_probs_init(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("forward_probs_init", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("forward_probs_init", __pyx_f[0], 1203);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1204")'> 1204:         cdef int snp_idx</pre>
<pre id='line1204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1205")'> 1205:         cdef int node_idx1</pre>
<pre id='line1205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1206")'> 1206:         cdef int node_idx2</pre>
<pre id='line1206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1207")'> 1207:         cdef int node_idx3</pre>
<pre id='line1207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1208")'> 1208:         cdef int node_idx4</pre>
<pre id='line1208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1209")'> 1209:         cdef int ibd</pre>
<pre id='line1209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1210")'> 1210:         cdef int admx_idx1</pre>
<pre id='line1210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1211")'> 1211:         cdef int admx_idx2</pre>
<pre id='line1211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1212")'> 1212:         cdef int admx_idx3</pre>
<pre id='line1212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1213")'> 1213:         cdef int admx_idx4</pre>
<pre id='line1213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1214")'> 1214:         cdef int snp_idx_win</pre>
<pre id='line1214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1215")'> 1215: </pre>
<pre id='line1215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1216")'> 1216:         snp_idx_win = 0</pre>
<pre id='line1216' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1216
 *         cdef int snp_idx_win
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1217")'> 1217:         if not post:</pre>
<pre id='line1217' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1217
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_1 = (!__pyx_v_post);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1218")'> 1218:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1218' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1218
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1219")'> 1219:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1219' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1219
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1220")'> 1220:         else:</pre>
<pre id='line1220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1221")'> 1221:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1221' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1221
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1222")'> 1222:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1222' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1222
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1223")'> 1223:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1223' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1223
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1224")'> 1224:             else:</pre>
<pre id='line1224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1225")'> 1225:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1225' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1225
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1226")'> 1226:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1226' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1226
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1227")'> 1227:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1227' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1227
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
  __pyx_t_2 = __pyx_v_end_snp;
  for (__pyx_t_3 = __pyx_v_start_snp; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_snp_idx = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1228")'> 1228:             for admx_idx1 in range(self.K):</pre>
<pre id='line1228' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1228
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_4 = __pyx_v_self->K;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_admx_idx1 = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1229")'> 1229:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1229' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1229
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_6 = __pyx_v_self->K;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_admx_idx2 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1230")'> 1230:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1230' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1230
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_8 = __pyx_v_self->K;
        for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
          __pyx_v_admx_idx3 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1231")'> 1231:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1231' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1231
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_10 = __pyx_v_self->K;
          for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
            __pyx_v_admx_idx4 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1232")'> 1232:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1232' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1232
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_12 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
              __pyx_v_node_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1233")'> 1233:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1233' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1233
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_14 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
                __pyx_v_node_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1234")'> 1234:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1234' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1234
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 */
                __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
                  __pyx_v_node_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1235")'> 1235:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1235' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1235
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 */
                  __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                    __pyx_v_node_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1236")'> 1236:                                             for ibd in range(2):</pre>
<pre id='line1236' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1236
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
                    for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                      __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1237")'> 1237:                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0</pre>
<pre id='line1237' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1237
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
                      ((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = 0.0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1238")'> 1238:             snp_idx_win += 1</pre>
<pre id='line1238' class='code' style='background-color: #FFFFb6'>
    /* "LDModel.pyx":1238
 *                                             for ibd in range(2):
 *                                                 self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_forward_probs_ibd_admx(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1239")'> 1239: </pre>
<pre id='line1239' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1240")'> 1240:     cpdef calc_forward_probs_ibd_admx(self, int win_idx, bool post):</pre>
<pre id='line1240' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1240
 *             snp_idx_win += 1
 * 
 *     cpdef calc_forward_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_75calc_forward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_forward_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_prev_node_idx1;
  int __pyx_v_prev_node_idx2;
  int __pyx_v_prev_node_idx3;
  int __pyx_v_prev_node_idx4;
  int __pyx_v_prev_node1;
  int __pyx_v_prev_node2;
  int __pyx_v_prev_node3;
  int __pyx_v_prev_node4;
  int __pyx_v_ibd;
  int __pyx_v_prev_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  long __pyx_v_first_win_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_forward_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_forward_probs_ibd_admx", __pyx_f[0], 1240);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_63);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_75calc_forward_probs_ibd_admx)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1240
 *             snp_idx_win += 1
 * 
 *     cpdef calc_forward_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_74calc_forward_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_forward_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_forward_probs_ibd_admx", __pyx_f[0], 1240);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_forward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_forward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1241")'> 1241: </pre>
<pre id='line1241' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1242")'> 1242:         cdef int snp_idx</pre>
<pre id='line1242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1243")'> 1243:         cdef int node_idx1</pre>
<pre id='line1243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1244")'> 1244:         cdef int node_idx2</pre>
<pre id='line1244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1245")'> 1245:         cdef int node_idx3</pre>
<pre id='line1245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1246")'> 1246:         cdef int node_idx4</pre>
<pre id='line1246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1247")'> 1247:         cdef int prev_node_idx1</pre>
<pre id='line1247' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1248")'> 1248:         cdef int prev_node_idx2</pre>
<pre id='line1248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1249")'> 1249:         cdef int prev_node_idx3</pre>
<pre id='line1249' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1250")'> 1250:         cdef int prev_node_idx4</pre>
<pre id='line1250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1251")'> 1251:         cdef int prev_node1</pre>
<pre id='line1251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1252")'> 1252:         cdef int prev_node2</pre>
<pre id='line1252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1253")'> 1253:         cdef int prev_node3</pre>
<pre id='line1253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1254")'> 1254:         cdef int prev_node4</pre>
<pre id='line1254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1255")'> 1255:         cdef int ibd</pre>
<pre id='line1255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1256")'> 1256:         cdef int prev_ibd</pre>
<pre id='line1256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1257")'> 1257:         cdef int admx_idx1</pre>
<pre id='line1257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1258")'> 1258:         cdef int admx_idx2</pre>
<pre id='line1258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1259")'> 1259:         cdef int admx_idx3</pre>
<pre id='line1259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1260")'> 1260:         cdef int admx_idx4</pre>
<pre id='line1260' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1261")'> 1261:         cdef int prev_admx_idx1</pre>
<pre id='line1261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1262")'> 1262:         cdef int prev_admx_idx2</pre>
<pre id='line1262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1263")'> 1263:         cdef int prev_admx_idx3</pre>
<pre id='line1263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1264")'> 1264:         cdef int prev_admx_idx4</pre>
<pre id='line1264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1265")'> 1265:         cdef double temp_mult</pre>
<pre id='line1265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1266")'> 1266:         cdef double sum</pre>
<pre id='line1266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1267")'> 1267:         cdef double eps_or_1_eps</pre>
<pre id='line1267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1268")'> 1268:         cdef int snp_idx_win</pre>
<pre id='line1268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1269")'> 1269:         cdef int start_snp</pre>
<pre id='line1269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1270")'> 1270:         cdef int end_snp</pre>
<pre id='line1270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1271")'> 1271: </pre>
<pre id='line1271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1272")'> 1272:         if not post:</pre>
<pre id='line1272' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1272
 *         cdef int end_snp
 * 
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             first_win_idx = win_idx
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1273")'> 1273:             first_win_idx = win_idx</pre>
<pre id='line1273' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1273
 * 
 *         if not post:
 *             first_win_idx = win_idx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
    __pyx_v_first_win_idx = __pyx_v_win_idx;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1274")'> 1274:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1274' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1274
 *         if not post:
 *             first_win_idx = win_idx
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1275")'> 1275:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1275' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1275
 *             first_win_idx = win_idx
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             first_win_idx = max(0,win_idx-1)
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1276")'> 1276:         else:</pre>
<pre id='line1276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1277")'> 1277:             first_win_idx = max(0,win_idx-1)</pre>
<pre id='line1277' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1277
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             first_win_idx = max(0,win_idx-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 */
    __pyx_t_6 = (__pyx_v_win_idx - 1);
    __pyx_t_7 = 0;
    if ((__pyx_t_6 > __pyx_t_7)) {
      __pyx_t_8 = __pyx_t_6;
    } else {
      __pyx_t_8 = __pyx_t_7;
    }
    __pyx_v_first_win_idx = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1278")'> 1278:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1278' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1278
 *         else:
 *             first_win_idx = max(0,win_idx-1)
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1279")'> 1279:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1279' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1279
 *             first_win_idx = max(0,win_idx-1)
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1280")'> 1280:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1280' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1280
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1281")'> 1281:             else:</pre>
<pre id='line1281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1282")'> 1282:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1282' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1282
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 * 
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1283")'> 1283:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1283' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1283
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # first layer
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1284")'> 1284: </pre>
<pre id='line1284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1285")'> 1285:         # first layer</pre>
<pre id='line1285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1286")'> 1286:         for admx_idx1 in range(self.K):</pre>
<pre id='line1286' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1286
 * 
 *         # first layer
 *         for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 */
  __pyx_t_9 = __pyx_v_self->K;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_admx_idx1 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1287")'> 1287:             for admx_idx2 in range(self.K):</pre>
<pre id='line1287' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1287
 *         # first layer
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 */
    __pyx_t_11 = __pyx_v_self->K;
    for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_admx_idx2 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1288")'> 1288:                 for admx_idx3 in range(self.K):</pre>
<pre id='line1288' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1288
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 */
      __pyx_t_13 = __pyx_v_self->K;
      for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
        __pyx_v_admx_idx3 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1289")'> 1289:                     for admx_idx4 in range(self.K):</pre>
<pre id='line1289' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1289
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 */
        __pyx_t_15 = __pyx_v_self->K;
        for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
          __pyx_v_admx_idx4 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1290")'> 1290:                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):</pre>
<pre id='line1290' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1290
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 */
          __pyx_t_17 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_start_snp]);
          for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
            __pyx_v_node_idx1 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1291")'> 1291:                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):</pre>
<pre id='line1291' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1291
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 */
            __pyx_t_19 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_start_snp]);
            for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
              __pyx_v_node_idx2 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1292")'> 1292:                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):</pre>
<pre id='line1292' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1292
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                         for ibd in range(2):
 */
              __pyx_t_21 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_start_snp]);
              for (__pyx_t_22 = 0; __pyx_t_22 <code><</code> __pyx_t_21; __pyx_t_22+=1) {
                __pyx_v_node_idx3 = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1293")'> 1293:                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):</pre>
<pre id='line1293' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1293
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for ibd in range(2):
 *                                             if ibd == 0:
 */
                __pyx_t_23 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_start_snp]);
                for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> __pyx_t_23; __pyx_t_24+=1) {
                  __pyx_v_node_idx4 = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1294")'> 1294:                                         for ibd in range(2):</pre>
<pre id='line1294' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1294
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                         for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             if ibd == 0:
 *                                                 self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \
 */
                  for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> 2; __pyx_t_25+=1) {
                    __pyx_v_ibd = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1295")'> 1295:                                             if ibd == 0:</pre>
<pre id='line1295' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1295
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                         for ibd in range(2):
 *                                             if ibd == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \
 *                                                 self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx3][first_win_idx][node_idx3] * self._pi[admx_idx4][first_win_idx][node_idx4] * \
 */
                    __pyx_t_5 = (__pyx_v_ibd == 0);
                    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1296")'> 1296:                                                 self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \</pre>
<pre id='line1296' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1296
 *                                         for ibd in range(2):
 *                                             if ibd == 0:
 *                                                 self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx3][first_win_idx][node_idx3] * self._pi[admx_idx4][first_win_idx][node_idx4] * \
 *                                                 self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]
 */
                      ((((((((((__pyx_v_self->_forward_probs_ibd_admx[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = (((((((__pyx_v_self->_pi[__pyx_v_admx_idx1])[__pyx_v_first_win_idx])[__pyx_v_node_idx1]) * (((__pyx_v_self->_pi[__pyx_v_admx_idx2])[__pyx_v_first_win_idx])[__pyx_v_node_idx2])) * (((__pyx_v_self->_pi[__pyx_v_admx_idx3])[__pyx_v_first_win_idx])[__pyx_v_node_idx3])) * (((__pyx_v_self->_pi[__pyx_v_admx_idx4])[__pyx_v_first_win_idx])[__pyx_v_node_idx4])) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]));
                      goto __pyx_L23;
                    }
                    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1297")'> 1297:                                                 self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx3][first_win_idx][node_idx3] * self._pi[admx_idx4][first_win_idx][node_idx4] * \</pre>
<pre id='line1297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1298")'> 1298:                                                 self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]</pre>
<pre id='line1298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1299")'> 1299:                                             else:</pre>
<pre id='line1299' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1300")'> 1300:                                                 if admx_idx1 == admx_idx3:</pre>
<pre id='line1300' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1300
 *                                                 self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]
 *                                             else:
 *                                                 if admx_idx1 == admx_idx3:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \
 *                                                     self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx4][first_win_idx][node_idx4] * \
 */
                      __pyx_t_5 = (__pyx_v_admx_idx1 == __pyx_v_admx_idx3);
                      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1301")'> 1301:                                                     self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \</pre>
<pre id='line1301' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":1301
 *                                             else:
 *                                                 if admx_idx1 == admx_idx3:
 *                                                     self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx4][first_win_idx][node_idx4] * \
 *                                                     self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]
 */
                        ((((((((((__pyx_v_self->_forward_probs_ibd_admx[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = ((((((__pyx_v_self->_pi[__pyx_v_admx_idx1])[__pyx_v_first_win_idx])[__pyx_v_node_idx1]) * (((__pyx_v_self->_pi[__pyx_v_admx_idx2])[__pyx_v_first_win_idx])[__pyx_v_node_idx2])) * (((__pyx_v_self->_pi[__pyx_v_admx_idx4])[__pyx_v_first_win_idx])[__pyx_v_node_idx4])) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]));
                        goto __pyx_L24;
                      }
                      __pyx_L24:;
                    }
                    __pyx_L23:;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1302")'> 1302:                                                     self._pi[admx_idx1][first_win_idx][node_idx1] * self._pi[admx_idx2][first_win_idx][node_idx2] * self._pi[admx_idx4][first_win_idx][node_idx4] * \</pre>
<pre id='line1302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1303")'> 1303:                                                     self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]</pre>
<pre id='line1303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1304")'> 1304:         # rescaling to avoid underflow</pre>
<pre id='line1304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1305")'> 1305:         for admx_idx1 in range(self.K):</pre>
<pre id='line1305' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1305
 *                                                     self._emission_prob_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]
 *         # rescaling to avoid underflow
 *         for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 */
  __pyx_t_9 = __pyx_v_self->K;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_admx_idx1 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1306")'> 1306:             for admx_idx2 in range(self.K):</pre>
<pre id='line1306' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1306
 *         # rescaling to avoid underflow
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 */
    __pyx_t_11 = __pyx_v_self->K;
    for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_admx_idx2 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1307")'> 1307:                 for admx_idx3 in range(self.K):</pre>
<pre id='line1307' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1307
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):
 */
      __pyx_t_13 = __pyx_v_self->K;
      for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
        __pyx_v_admx_idx3 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1308")'> 1308:                     for admx_idx4 in range(self.K):</pre>
<pre id='line1308' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1308
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 */
        __pyx_t_15 = __pyx_v_self->K;
        for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
          __pyx_v_admx_idx4 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1309")'> 1309:                         for ibd in range(2):</pre>
<pre id='line1309' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1309
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 */
          for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> 2; __pyx_t_17+=1) {
            __pyx_v_ibd = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1310")'> 1310:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):</pre>
<pre id='line1310' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1310
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 */
            __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_start_snp]);
            for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
              __pyx_v_node_idx1 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1311")'> 1311:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):</pre>
<pre id='line1311' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1311
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 */
              __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_start_snp]);
              for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                __pyx_v_node_idx2 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1312")'> 1312:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):</pre>
<pre id='line1312' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1312
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][start_snp]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 */
                __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_start_snp]);
                for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                  __pyx_v_node_idx3 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1313")'> 1313:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):</pre>
<pre id='line1313' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1313
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][start_snp]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 */
                  __pyx_t_24 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_start_snp]);
                  for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
                    __pyx_v_node_idx4 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1314")'> 1314:                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]</pre>
<pre id='line1314' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1314
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][start_snp]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 */
                    __pyx_t_8 = 0;
                    __pyx_t_26 = __pyx_v_admx_idx1;
                    __pyx_t_27 = __pyx_v_admx_idx2;
                    __pyx_t_28 = __pyx_v_admx_idx3;
                    __pyx_t_29 = __pyx_v_admx_idx4;
                    __pyx_t_30 = __pyx_v_ibd;
                    ((((((__pyx_v_self->_scale_factor[__pyx_t_8])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30]) = (((((((__pyx_v_self->_scale_factor[__pyx_t_8])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30]) + ((((((((((__pyx_v_self->_forward_probs_ibd_admx[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]));
                  }
                }
              }
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1315")'> 1315:                             if self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &gt; 0:</pre>
<pre id='line1315' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1315
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][start_snp]):
 *                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                             else:
 */
            __pyx_t_5 = (((((((__pyx_v_self->_scale_factor[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) > 0.0);
            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1316")'> 1316:                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1316' class='code' style='background-color: #FFFFaa'>
              /* "LDModel.pyx":1316
 *                                             self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             else:
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX
 */
              if (unlikely(((((((__pyx_v_self->_scale_factor[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) == 0)) {
                <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              ((((((__pyx_v_self->_scale_factor[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (1.0 / ((((((__pyx_v_self->_scale_factor[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
              goto __pyx_L43;
            }
            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1317")'> 1317:                             else:</pre>
<pre id='line1317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1318")'> 1318:                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX</pre>
<pre id='line1318' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1318
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                             else:
 *                                 self._scale_factor[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # all other layers
 */
              ((((((__pyx_v_self->_scale_factor[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = DBL_MAX;
            }
            __pyx_L43:;
          }
        }
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1319")'> 1319: </pre>
<pre id='line1319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1320")'> 1320:         # all other layers</pre>
<pre id='line1320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1321")'> 1321:         snp_idx_win = 0</pre>
<pre id='line1321' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1321
 * 
 *         # all other layers
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp-1):
 *             # calculate forward probabilities
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1322")'> 1322:         for snp_idx in range(start_snp, end_snp-1):</pre>
<pre id='line1322' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1322
 *         # all other layers
 *         snp_idx_win = 0
 *         for snp_idx in range(start_snp, end_snp-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # calculate forward probabilities
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_8 = (__pyx_v_end_snp - 1);
  for (__pyx_t_9 = __pyx_v_start_snp; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_snp_idx = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1323")'> 1323:             # calculate forward probabilities</pre>
<pre id='line1323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1324")'> 1324:             for admx_idx1 in range(self.K):</pre>
<pre id='line1324' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1324
 *         for snp_idx in range(start_snp, end_snp-1):
 *             # calculate forward probabilities
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_10 = __pyx_v_self->K;
    for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_admx_idx1 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1325")'> 1325:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1325' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1325
 *             # calculate forward probabilities
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_12 = __pyx_v_self->K;
      for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
        __pyx_v_admx_idx2 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1326")'> 1326:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1326' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1326
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 */
        __pyx_t_14 = __pyx_v_self->K;
        for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
          __pyx_v_admx_idx3 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1327")'> 1327:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1327' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1327
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 */
          __pyx_t_16 = __pyx_v_self->K;
          for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
            __pyx_v_admx_idx4 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1328")'> 1328:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):</pre>
<pre id='line1328' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1328
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 */
            __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)]);
            for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
              __pyx_v_node_idx1 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1329")'> 1329:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):</pre>
<pre id='line1329' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1329
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 */
              __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)]);
              for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                __pyx_v_node_idx2 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1330")'> 1330:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):</pre>
<pre id='line1330' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1330
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                             for ibd in range(2):
 */
                __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)]);
                for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                  __pyx_v_node_idx3 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1331")'> 1331:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):</pre>
<pre id='line1331' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1331
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 * 
 */
                  __pyx_t_24 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)]);
                  for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
                    __pyx_v_node_idx4 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1332")'> 1332:                                             for ibd in range(2):</pre>
<pre id='line1332' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1332
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                                                 for prev_node_idx1 in range(self._states[admx_idx1][snp_idx+1][node_idx1].in_trans_num):
 */
                    for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> 2; __pyx_t_26+=1) {
                      __pyx_v_ibd = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1333")'> 1333: </pre>
<pre id='line1333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1334")'> 1334:                                                 for prev_node_idx1 in range(self._states[admx_idx1][snp_idx+1][node_idx1].in_trans_num):</pre>
<pre id='line1334' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1334
 *                                             for ibd in range(2):
 * 
 *                                                 for prev_node_idx1 in range(self._states[admx_idx1][snp_idx+1][node_idx1].in_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     for prev_node_idx2 in range(self._states[admx_idx2][snp_idx+1][node_idx2].in_trans_num):
 *                                                         for prev_node_idx3 in range(self._states[admx_idx3][snp_idx+1][node_idx3].in_trans_num):
 */
                      __pyx_t_27 = (((__pyx_v_self->_states[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx1]).in_trans_num;
                      for (__pyx_t_28 = 0; __pyx_t_28 <code><</code> __pyx_t_27; __pyx_t_28+=1) {
                        __pyx_v_prev_node_idx1 = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1335")'> 1335:                                                     for prev_node_idx2 in range(self._states[admx_idx2][snp_idx+1][node_idx2].in_trans_num):</pre>
<pre id='line1335' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":1335
 * 
 *                                                 for prev_node_idx1 in range(self._states[admx_idx1][snp_idx+1][node_idx1].in_trans_num):
 *                                                     for prev_node_idx2 in range(self._states[admx_idx2][snp_idx+1][node_idx2].in_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         for prev_node_idx3 in range(self._states[admx_idx3][snp_idx+1][node_idx3].in_trans_num):
 *                                                             for prev_node_idx4 in range(self._states[admx_idx4][snp_idx+1][node_idx4].in_trans_num):
 */
                        __pyx_t_29 = (((__pyx_v_self->_states[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx2]).in_trans_num;
                        for (__pyx_t_30 = 0; __pyx_t_30 <code><</code> __pyx_t_29; __pyx_t_30+=1) {
                          __pyx_v_prev_node_idx2 = __pyx_t_30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1336")'> 1336:                                                         for prev_node_idx3 in range(self._states[admx_idx3][snp_idx+1][node_idx3].in_trans_num):</pre>
<pre id='line1336' class='code' style='background-color: #FFFFff'>
                          /* "LDModel.pyx":1336
 *                                                 for prev_node_idx1 in range(self._states[admx_idx1][snp_idx+1][node_idx1].in_trans_num):
 *                                                     for prev_node_idx2 in range(self._states[admx_idx2][snp_idx+1][node_idx2].in_trans_num):
 *                                                         for prev_node_idx3 in range(self._states[admx_idx3][snp_idx+1][node_idx3].in_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                             for prev_node_idx4 in range(self._states[admx_idx4][snp_idx+1][node_idx4].in_trans_num):
 *                                                                 #for prev_ibd in range(2):
 */
                          __pyx_t_31 = (((__pyx_v_self->_states[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx3]).in_trans_num;
                          for (__pyx_t_32 = 0; __pyx_t_32 <code><</code> __pyx_t_31; __pyx_t_32+=1) {
                            __pyx_v_prev_node_idx3 = __pyx_t_32;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1337")'> 1337:                                                             for prev_node_idx4 in range(self._states[admx_idx4][snp_idx+1][node_idx4].in_trans_num):</pre>
<pre id='line1337' class='code' style='background-color: #FFFFff'>
                            /* "LDModel.pyx":1337
 *                                                     for prev_node_idx2 in range(self._states[admx_idx2][snp_idx+1][node_idx2].in_trans_num):
 *                                                         for prev_node_idx3 in range(self._states[admx_idx3][snp_idx+1][node_idx3].in_trans_num):
 *                                                             for prev_node_idx4 in range(self._states[admx_idx4][snp_idx+1][node_idx4].in_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                 #for prev_ibd in range(2):
 *                                                                     prev_ibd = ibd
 */
                            __pyx_t_33 = (((__pyx_v_self->_states[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx4]).in_trans_num;
                            for (__pyx_t_34 = 0; __pyx_t_34 <code><</code> __pyx_t_33; __pyx_t_34+=1) {
                              __pyx_v_prev_node_idx4 = __pyx_t_34;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1338")'> 1338:                                                                 #for prev_ibd in range(2):</pre>
<pre id='line1338' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1339")'> 1339:                                                                     prev_ibd = ibd</pre>
<pre id='line1339' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1339
 *                                                             for prev_node_idx4 in range(self._states[admx_idx4][snp_idx+1][node_idx4].in_trans_num):
 *                                                                 #for prev_ibd in range(2):
 *                                                                     prev_ibd = ibd             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     prev_node1 = self._back_trans_idx[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1]
 *                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]
 */
                              __pyx_v_prev_ibd = __pyx_v_ibd;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1340")'> 1340:                                                                     prev_node1 = self._back_trans_idx[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1]</pre>
<pre id='line1340' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1340
 *                                                                 #for prev_ibd in range(2):
 *                                                                     prev_ibd = ibd
 *                                                                     prev_node1 = self._back_trans_idx[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]
 *                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]
 */
                              __pyx_v_prev_node1 = ((((__pyx_v_self->_back_trans_idx[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx1])[__pyx_v_prev_node_idx1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1341")'> 1341:                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]</pre>
<pre id='line1341' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1341
 *                                                                     prev_ibd = ibd
 *                                                                     prev_node1 = self._back_trans_idx[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1]
 *                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]
 *                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]
 */
                              __pyx_v_prev_node2 = ((((__pyx_v_self->_back_trans_idx[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx2])[__pyx_v_prev_node_idx2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1342")'> 1342:                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]</pre>
<pre id='line1342' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1342
 *                                                                     prev_node1 = self._back_trans_idx[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1]
 *                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]
 *                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]
 *                                                                     if ibd == 0:
 */
                              __pyx_v_prev_node3 = ((((__pyx_v_self->_back_trans_idx[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx3])[__pyx_v_prev_node_idx3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1343")'> 1343:                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]</pre>
<pre id='line1343' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1343
 *                                                                     prev_node2 = self._back_trans_idx[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2]
 *                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]
 *                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     if ibd == 0:
 *                                                                         self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \
 */
                              __pyx_v_prev_node4 = ((((__pyx_v_self->_back_trans_idx[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx4])[__pyx_v_prev_node_idx4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1344")'> 1344:                                                                     if ibd == 0:</pre>
<pre id='line1344' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1344
 *                                                                     prev_node3 = self._back_trans_idx[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3]
 *                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]
 *                                                                     if ibd == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \
 *                                                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \
 */
                              __pyx_t_5 = (__pyx_v_ibd == 0);
                              if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1345")'> 1345:                                                                         self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \</pre>
<pre id='line1345' class='code' style='background-color: #FFFFff'>
                                /* "LDModel.pyx":1345
 *                                                                     prev_node4 = self._back_trans_idx[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]
 *                                                                     if ibd == 0:
 *                                                                         self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \
 *                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] * \
 */
                                __pyx_t_6 = (__pyx_v_snp_idx_win + 1);
                                __pyx_t_35 = __pyx_v_admx_idx1;
                                __pyx_t_36 = __pyx_v_admx_idx2;
                                __pyx_t_37 = __pyx_v_admx_idx3;
                                __pyx_t_38 = __pyx_v_admx_idx4;
                                __pyx_t_39 = __pyx_v_node_idx1;
                                __pyx_t_40 = __pyx_v_node_idx2;
                                __pyx_t_41 = __pyx_v_node_idx3;
                                __pyx_t_42 = __pyx_v_node_idx4;
                                __pyx_t_43 = __pyx_v_ibd;

                                /* "LDModel.pyx":1351
 *                                                                         self._back_trans[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2] * \
 *                                                                         self._back_trans[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3] * \
 *                                                                         self._back_trans[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     else:
 *                                                                         #if admx_idx1 == admx_idx3 and get_likely_allele(self._states[admx_idx1][snp_idx+1][node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx+1][node_idx3]) and get_likely_allele(self._states[admx_idx1][snp_idx][prev_node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx][prev_node_idx3]):
 */
                                ((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_t_6])[__pyx_t_35])[__pyx_t_36])[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43]) = (((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_t_6])[__pyx_t_35])[__pyx_t_36])[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43]) + (((((((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_prev_node1])[__pyx_v_prev_node2])[__pyx_v_prev_node3])[__pyx_v_prev_node4])[__pyx_v_prev_ibd]) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx1])[__pyx_v_prev_node_idx1])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx2])[__pyx_v_prev_node_idx2])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx3])[__pyx_v_prev_node_idx3])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx4])[__pyx_v_prev_node_idx4])));
                                goto __pyx_L72;
                              }
                              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1346")'> 1346:                                                                         self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \</pre>
<pre id='line1346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1347")'> 1347:                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] * \</pre>
<pre id='line1347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1348")'> 1348:                                                                         self._back_trans[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1] * \</pre>
<pre id='line1348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1349")'> 1349:                                                                         self._back_trans[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2] * \</pre>
<pre id='line1349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1350")'> 1350:                                                                         self._back_trans[admx_idx3][snp_idx+1][node_idx3][prev_node_idx3] * \</pre>
<pre id='line1350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1351")'> 1351:                                                                         self._back_trans[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]</pre>
<pre id='line1351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1352")'> 1352:                                                                     else:</pre>
<pre id='line1352' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1353")'> 1353:                                                                         #if admx_idx1 == admx_idx3 and get_likely_allele(self._states[admx_idx1][snp_idx+1][node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx+1][node_idx3]) and get_likely_allele(self._states[admx_idx1][snp_idx][prev_node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx][prev_node_idx3]):</pre>
<pre id='line1353' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1354")'> 1354:                                                                         if admx_idx1 == admx_idx3 and node_idx1 == node_idx3 and prev_node1 == prev_node3:</pre>
<pre id='line1354' class='code' style='background-color: #FFFFff'>
                                /* "LDModel.pyx":1354
 *                                                                     else:
 *                                                                         #if admx_idx1 == admx_idx3 and get_likely_allele(self._states[admx_idx1][snp_idx+1][node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx+1][node_idx3]) and get_likely_allele(self._states[admx_idx1][snp_idx][prev_node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx][prev_node_idx3]):
 *                                                                         if admx_idx1 == admx_idx3 and node_idx1 == node_idx3 and prev_node1 == prev_node3:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                             self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \
 *                                                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \
 */
                                __pyx_t_5 = (__pyx_v_admx_idx1 == __pyx_v_admx_idx3);
                                if (__pyx_t_5) {
                                  __pyx_t_44 = (__pyx_v_node_idx1 == __pyx_v_node_idx3);
                                  if (__pyx_t_44) {
                                    __pyx_t_45 = (__pyx_v_prev_node1 == __pyx_v_prev_node3);
                                    __pyx_t_46 = __pyx_t_45;
                                  } else {
                                    __pyx_t_46 = __pyx_t_44;
                                  }
                                  __pyx_t_44 = __pyx_t_46;
                                } else {
                                  __pyx_t_44 = __pyx_t_5;
                                }
                                if (__pyx_t_44) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1355")'> 1355:                                                                             self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \</pre>
<pre id='line1355' class='code' style='background-color: #FFFFff'>
                                  /* "LDModel.pyx":1355
 *                                                                         #if admx_idx1 == admx_idx3 and get_likely_allele(self._states[admx_idx1][snp_idx+1][node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx+1][node_idx3]) and get_likely_allele(self._states[admx_idx1][snp_idx][prev_node_idx1]) == get_likely_allele(self._states[admx_idx3][snp_idx][prev_node_idx3]):
 *                                                                         if admx_idx1 == admx_idx3 and node_idx1 == node_idx3 and prev_node1 == prev_node3:
 *                                                                             self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \
 *                                                                             self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] * \
 */
                                  __pyx_t_6 = (__pyx_v_snp_idx_win + 1);
                                  __pyx_t_35 = __pyx_v_admx_idx1;
                                  __pyx_t_36 = __pyx_v_admx_idx2;
                                  __pyx_t_37 = __pyx_v_admx_idx3;
                                  __pyx_t_38 = __pyx_v_admx_idx4;
                                  __pyx_t_39 = __pyx_v_node_idx1;
                                  __pyx_t_40 = __pyx_v_node_idx2;
                                  __pyx_t_41 = __pyx_v_node_idx3;
                                  __pyx_t_42 = __pyx_v_node_idx4;
                                  __pyx_t_43 = __pyx_v_ibd;

                                  /* "LDModel.pyx":1360
 *                                                                             self._back_trans[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1] * \
 *                                                                             self._back_trans[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2] * \
 *                                                                             self._back_trans[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # rescaling to avoid underflow
 */
                                  ((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_t_6])[__pyx_t_35])[__pyx_t_36])[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43]) = (((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_t_6])[__pyx_t_35])[__pyx_t_36])[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43]) + ((((((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_prev_node1])[__pyx_v_prev_node2])[__pyx_v_prev_node3])[__pyx_v_prev_node4])[__pyx_v_prev_ibd]) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx1])[__pyx_v_prev_node_idx1])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx2])[__pyx_v_prev_node_idx2])) * ((((__pyx_v_self->_back_trans[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)])[__pyx_v_node_idx4])[__pyx_v_prev_node_idx4])));
                                  goto __pyx_L73;
                                }
                                __pyx_L73:;
                              }
                              __pyx_L72:;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1356")'> 1356:                                                                             self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][prev_node1][prev_node2][prev_node3][prev_node4][prev_ibd] * \</pre>
<pre id='line1356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1357")'> 1357:                                                                             self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] * \</pre>
<pre id='line1357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1358")'> 1358:                                                                             self._back_trans[admx_idx1][snp_idx+1][node_idx1][prev_node_idx1] * \</pre>
<pre id='line1358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1359")'> 1359:                                                                             self._back_trans[admx_idx2][snp_idx+1][node_idx2][prev_node_idx2] * \</pre>
<pre id='line1359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1360")'> 1360:                                                                             self._back_trans[admx_idx4][snp_idx+1][node_idx4][prev_node_idx4]</pre>
<pre id='line1360' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1361")'> 1361: </pre>
<pre id='line1361' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1362")'> 1362:             # rescaling to avoid underflow</pre>
<pre id='line1362' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1363")'> 1363:             for admx_idx1 in range(self.K):</pre>
<pre id='line1363' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1363
 * 
 *             # rescaling to avoid underflow
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_10 = __pyx_v_self->K;
    for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_admx_idx1 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1364")'> 1364:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1364' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1364
 *             # rescaling to avoid underflow
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_12 = __pyx_v_self->K;
      for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
        __pyx_v_admx_idx2 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1365")'> 1365:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1365' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1365
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 */
        __pyx_t_14 = __pyx_v_self->K;
        for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
          __pyx_v_admx_idx3 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1366")'> 1366:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1366' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1366
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 */
          __pyx_t_16 = __pyx_v_self->K;
          for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
            __pyx_v_admx_idx4 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1367")'> 1367:                             for ibd in range(2):</pre>
<pre id='line1367' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1367
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 */
            for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> 2; __pyx_t_18+=1) {
              __pyx_v_ibd = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1368")'> 1368:                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):</pre>
<pre id='line1368' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1368
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 */
              __pyx_t_19 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)]);
              for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
                __pyx_v_node_idx1 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1369")'> 1369:                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):</pre>
<pre id='line1369' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1369
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 */
                __pyx_t_21 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)]);
                for (__pyx_t_22 = 0; __pyx_t_22 <code><</code> __pyx_t_21; __pyx_t_22+=1) {
                  __pyx_v_node_idx2 = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1370")'> 1370:                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):</pre>
<pre id='line1370' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1370
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 */
                  __pyx_t_23 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)]);
                  for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> __pyx_t_23; __pyx_t_24+=1) {
                    __pyx_v_node_idx3 = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1371")'> 1371:                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):</pre>
<pre id='line1371' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1371
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 */
                    __pyx_t_25 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)]);
                    for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> __pyx_t_25; __pyx_t_26+=1) {
                      __pyx_v_node_idx4 = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1372")'> 1372:                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]</pre>
<pre id='line1372' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1372
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 */
                      __pyx_t_6 = (__pyx_v_snp_idx_win + 1);
                      __pyx_t_27 = __pyx_v_admx_idx1;
                      __pyx_t_28 = __pyx_v_admx_idx2;
                      __pyx_t_29 = __pyx_v_admx_idx3;
                      __pyx_t_30 = __pyx_v_admx_idx4;
                      __pyx_t_31 = __pyx_v_ibd;
                      ((((((__pyx_v_self->_scale_factor[__pyx_t_6])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31]) = (((((((__pyx_v_self->_scale_factor[__pyx_t_6])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_31]) + ((((((((((__pyx_v_self->_forward_probs_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]));
                    }
                  }
                }
              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1373")'> 1373:                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &gt; 0:</pre>
<pre id='line1373' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1373
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                                 else:
 */
              __pyx_t_44 = (((((((__pyx_v_self->_scale_factor[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) > 0.0);
              if (__pyx_t_44) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1374")'> 1374:                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1374' class='code' style='background-color: #FFFFaa'>
                /* "LDModel.pyx":1374
 *                                                 self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 else:
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX
 */
                __pyx_t_47 = ((((((__pyx_v_self->_scale_factor[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]);
                if (unlikely(__pyx_t_47 == 0)) {
                  <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
                 <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                ((((((__pyx_v_self->_scale_factor[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (1.0 / __pyx_t_47);
                goto __pyx_L92;
              }
              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1375")'> 1375:                                 else:</pre>
<pre id='line1375' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1376")'> 1376:                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX</pre>
<pre id='line1376' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1376
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                                 else:
 *                                     self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                     print " snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                ((((((__pyx_v_self->_scale_factor[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = DBL_MAX;
              }
              __pyx_L92:;
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1377")'> 1377: #                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1:</pre>
<pre id='line1377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1378")'> 1378: #                                     print " snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1378' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1379")'> 1379: </pre>
<pre id='line1379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1380")'> 1380:             for admx_idx1 in range(self.K):</pre>
<pre id='line1380' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1380
 * #                                     print " snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_10 = __pyx_v_self->K;
    for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_admx_idx1 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1381")'> 1381:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1381' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1381
 * 
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_12 = __pyx_v_self->K;
      for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
        __pyx_v_admx_idx2 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1382")'> 1382:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1382' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1382
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 */
        __pyx_t_14 = __pyx_v_self->K;
        for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
          __pyx_v_admx_idx3 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1383")'> 1383:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1383' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1383
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 */
          __pyx_t_16 = __pyx_v_self->K;
          for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
            __pyx_v_admx_idx4 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1384")'> 1384:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):</pre>
<pre id='line1384' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1384
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 */
            __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[(__pyx_v_snp_idx + 1)]);
            for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
              __pyx_v_node_idx1 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1385")'> 1385:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):</pre>
<pre id='line1385' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1385
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 */
              __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[(__pyx_v_snp_idx + 1)]);
              for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                __pyx_v_node_idx2 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1386")'> 1386:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):</pre>
<pre id='line1386' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1386
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx+1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                             for ibd in range(2):
 */
                __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[(__pyx_v_snp_idx + 1)]);
                for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                  __pyx_v_node_idx3 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1387")'> 1387:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):</pre>
<pre id='line1387' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1387
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx+1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 * #                                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 */
                  __pyx_t_24 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[(__pyx_v_snp_idx + 1)]);
                  for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
                    __pyx_v_node_idx4 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1388")'> 1388:                                             for ibd in range(2):</pre>
<pre id='line1388' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1388
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx+1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx+1]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 * #                                                     print " snp_idx: " + str(snp_idx+1) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \
 */
                    for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> 2; __pyx_t_26+=1) {
                      __pyx_v_ibd = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1389")'> 1389: #                                                 if self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] &gt; 1:</pre>
<pre id='line1389' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1390")'> 1390: #                                                     print " snp_idx: " + str(snp_idx+1) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \</pre>
<pre id='line1390' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1391")'> 1391: #                                                     " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4) + " ibd: " + str(ibd) + " forward prob: " + str(self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd])</pre>
<pre id='line1391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1392")'> 1392:                                                 self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \</pre>
<pre id='line1392' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1392
 * #                                                     print " snp_idx: " + str(snp_idx+1) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \
 * #                                                     " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4) + " ibd: " + str(ibd) + " forward prob: " + str(self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd])
 *                                                 self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] * self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 * 
 */
                      ((((((((((__pyx_v_self->_forward_probs_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = (((((((((((__pyx_v_self->_forward_probs_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) * ((((((__pyx_v_self->_scale_factor[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1393")'> 1393:                                                 self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] * self._scale_factor[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1394")'> 1394: </pre>
<pre id='line1394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1395")'> 1395:                                                 #if snp_idx == (self.end_snp(win_idx) - 1):</pre>
<pre id='line1395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1396")'> 1396:                                                 #    self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += \</pre>
<pre id='line1396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1397")'> 1397:                                                 #    self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]</pre>
<pre id='line1397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1398")'> 1398:             snp_idx_win += 1</pre>
<pre id='line1398' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":1398
 *                                                 #    self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += \
 *                                                 #    self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef backward_probs_mem_alloc(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_forward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_75calc_forward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_75calc_forward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_forward_probs_ibd_admx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_forward_probs_ibd_admx", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_forward_probs_ibd_admx") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_forward_probs_ibd_admx", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_forward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_74calc_forward_probs_ibd_admx(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1399")'> 1399: </pre>
<pre id='line1399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1400")'> 1400:     cpdef backward_probs_mem_alloc(self, int win_idx, bool post):</pre>
<pre id='line1400' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1400
 *             snp_idx_win += 1
 * 
 *     cpdef backward_probs_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_77backward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_backward_probs_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("backward_probs_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("backward_probs_mem_alloc", __pyx_f[0], 1400);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_77backward_probs_mem_alloc)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1400
 *             snp_idx_win += 1
 * 
 *     cpdef backward_probs_mem_alloc(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_76backward_probs_mem_alloc(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("backward_probs_mem_alloc", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("backward_probs_mem_alloc", __pyx_f[0], 1400);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->backward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.backward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1401")'> 1401:         cdef int snp_idx</pre>
<pre id='line1401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1402")'> 1402:         cdef int node_idx1</pre>
<pre id='line1402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1403")'> 1403:         cdef int node_idx2</pre>
<pre id='line1403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1404")'> 1404:         cdef int node_idx3</pre>
<pre id='line1404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1405")'> 1405:         cdef int node_idx4</pre>
<pre id='line1405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1406")'> 1406:         cdef int ibd</pre>
<pre id='line1406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1407")'> 1407:         cdef int admx_idx1</pre>
<pre id='line1407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1408")'> 1408:         cdef int admx_idx2</pre>
<pre id='line1408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1409")'> 1409:         cdef int admx_idx3</pre>
<pre id='line1409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1410")'> 1410:         cdef int admx_idx4</pre>
<pre id='line1410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1411")'> 1411:         cdef int snp_idx_win</pre>
<pre id='line1411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1412")'> 1412:         cdef int start_snp</pre>
<pre id='line1412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1413")'> 1413:         cdef int end_snp</pre>
<pre id='line1413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1414")'> 1414: </pre>
<pre id='line1414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1415")'> 1415:         snp_idx_win = 0</pre>
<pre id='line1415' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1415
 *         cdef int end_snp
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1416")'> 1416:         if not post:</pre>
<pre id='line1416' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1416
 * 
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1417")'> 1417:             self._backward_probs_ibd_admx = &lt;double **********&gt; malloc(self._win_size * sizeof(double *********))</pre>
<pre id='line1417' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1417
 *         snp_idx_win = 0
 *         if not post:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
    __pyx_v_self->_backward_probs_ibd_admx = ((double **********)malloc((__pyx_v_self->_win_size * (sizeof(double *********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1418")'> 1418:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1418' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1418
 *         if not post:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1419")'> 1419:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1419' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1419
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(self._win_size * sizeof(double *********))
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1420")'> 1420:         else:</pre>
<pre id='line1420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1421")'> 1421:             self._backward_probs_ibd_admx = &lt;double **********&gt; malloc(3 * self._win_size * sizeof(double *********))</pre>
<pre id='line1421' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1421
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 */
    __pyx_v_self->_backward_probs_ibd_admx = ((double **********)malloc(((3 * __pyx_v_self->_win_size) * (sizeof(double *********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1422")'> 1422:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1422' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1422
 *         else:
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1423")'> 1423:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1423' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1423
 *             self._backward_probs_ibd_admx = <code><</code>double **********> malloc(3 * self._win_size * sizeof(double *********))
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1424")'> 1424:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1424' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1424
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1425")'> 1425:             else:</pre>
<pre id='line1425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1426")'> 1426:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1426' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1426
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1427")'> 1427:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1427' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1427
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             self._backward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1428")'> 1428:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1428' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1428
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._backward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1429")'> 1429:             self._backward_probs_ibd_admx[snp_idx_win] = &lt;double *********&gt; malloc(self.K * sizeof(double********))</pre>
<pre id='line1429' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1429
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             self._backward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 */
    (__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win]) = ((double *********)malloc((__pyx_v_self->K * (sizeof(double ********)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1430")'> 1430:             for admx_idx1 in range(self.K):</pre>
<pre id='line1430' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1430
 *         for snp_idx in range(start_snp, end_snp):
 *             self._backward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1431")'> 1431:                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = &lt;double ********&gt; malloc(self.K * sizeof(double*******))</pre>
<pre id='line1431' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1431
 *             self._backward_probs_ibd_admx[snp_idx_win] = <code><</code>double *********> malloc(self.K * sizeof(double********))
 *             for admx_idx1 in range(self.K):
 *                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 */
      ((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1]) = ((double ********)malloc((__pyx_v_self->K * (sizeof(double *******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1432")'> 1432:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1432' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1432
 *             for admx_idx1 in range(self.K):
 *                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1433")'> 1433:                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = &lt;double *******&gt; malloc(self.K * sizeof(double******))</pre>
<pre id='line1433' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1433
 *                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1] = <code><</code>double ********> malloc(self.K * sizeof(double*******))
 *                 for admx_idx2 in range(self.K):
 *                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 */
        (((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double *******)malloc((__pyx_v_self->K * (sizeof(double ******)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1434")'> 1434:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1434' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1434
 *                 for admx_idx2 in range(self.K):
 *                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1435")'> 1435:                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = &lt;double ******&gt; malloc(self.K * sizeof(double*****))</pre>
<pre id='line1435' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1435
 *                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2] = <code><</code>double *******> malloc(self.K * sizeof(double******))
 *                     for admx_idx3 in range(self.K):
 *                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 */
          ((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double ******)malloc((__pyx_v_self->K * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1436")'> 1436:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1436' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1436
 *                     for admx_idx3 in range(self.K):
 *                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1437")'> 1437:                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= &lt;double *****&gt; malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))</pre>
<pre id='line1437' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1437
 *                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double ******> malloc(self.K * sizeof(double*****))
 *                         for admx_idx4 in range(self.K):
 *                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 */
            (((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *****)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]) * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1438")'> 1438:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1438' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1438
 *                         for admx_idx4 in range(self.K):
 *                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1439")'> 1439:                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = &lt;double ****&gt; malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))</pre>
<pre id='line1439' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1439
 *                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4]= <code><</code>double *****> malloc((self._layer_state_nums[admx_idx1][snp_idx]) * sizeof(double****))
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 */
              ((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1]) = ((double ****)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]) * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1440")'> 1440:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1440' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1440
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1441")'> 1441:                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = &lt;double ***&gt; malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))</pre>
<pre id='line1441' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1441
 *                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1] = <code><</code>double ****> malloc((self._layer_state_nums[admx_idx2][snp_idx]) * sizeof(double***))
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 */
                (((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2]) = ((double ***)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]) * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1442")'> 1442:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1442' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1442
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1443")'> 1443:                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = &lt;double **&gt; malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))</pre>
<pre id='line1443' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1443
 *                                     self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2] = <code><</code>double ***> malloc((self._layer_state_nums[admx_idx3][snp_idx]) * sizeof(double**))
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 */
                  ((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3]) = ((double **)malloc((((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]) * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1444")'> 1444:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1444' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1444
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_node_idx4 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1445")'> 1445:                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line1445' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1445
 *                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3] = <code><</code>double **> malloc((self._layer_state_nums[admx_idx4][snp_idx]) * sizeof(double*))
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 */
                    (((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1446")'> 1446:                                             for ibd in range(2):</pre>
<pre id='line1446' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1446
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
                    for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> 2; __pyx_t_24+=1) {
                      __pyx_v_ibd = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1447")'> 1447:                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0</pre>
<pre id='line1447' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1447
 *                                             self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
                      ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = 0.0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1448")'> 1448:             snp_idx_win += 1</pre>
<pre id='line1448' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":1448
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef backward_probs_init(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.backward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_77backward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_77backward_probs_mem_alloc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("backward_probs_mem_alloc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("backward_probs_mem_alloc", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "backward_probs_mem_alloc") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("backward_probs_mem_alloc", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.backward_probs_mem_alloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_76backward_probs_mem_alloc(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1449")'> 1449: </pre>
<pre id='line1449' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1450")'> 1450:     cdef backward_probs_init(self, int win_idx, bool post):</pre>
<pre id='line1450' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":1450
 *             snp_idx_win += 1
 * 
 *     cdef backward_probs_init(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int snp_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_f_7LDModel_7LDModel_backward_probs_init(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("backward_probs_init", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("backward_probs_init", __pyx_f[0], 1450);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1451")'> 1451:         cdef int snp_idx</pre>
<pre id='line1451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1452")'> 1452:         cdef int node_idx1</pre>
<pre id='line1452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1453")'> 1453:         cdef int node_idx2</pre>
<pre id='line1453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1454")'> 1454:         cdef int node_idx3</pre>
<pre id='line1454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1455")'> 1455:         cdef int node_idx4</pre>
<pre id='line1455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1456")'> 1456:         cdef int ibd</pre>
<pre id='line1456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1457")'> 1457:         cdef int admx_idx1</pre>
<pre id='line1457' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1458")'> 1458:         cdef int admx_idx2</pre>
<pre id='line1458' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1459")'> 1459:         cdef int admx_idx3</pre>
<pre id='line1459' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1460")'> 1460:         cdef int admx_idx4</pre>
<pre id='line1460' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1461")'> 1461:         cdef int snp_idx_win</pre>
<pre id='line1461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1462")'> 1462:         cdef int start_snp</pre>
<pre id='line1462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1463")'> 1463:         cdef int end_snp</pre>
<pre id='line1463' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1464")'> 1464: </pre>
<pre id='line1464' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1465")'> 1465:         if not post:</pre>
<pre id='line1465' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1465
 *         cdef int end_snp
 * 
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_1 = (!__pyx_v_post);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1466")'> 1466:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1466' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1466
 * 
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1467")'> 1467:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1467' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1467
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1468")'> 1468:         else:</pre>
<pre id='line1468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1469")'> 1469:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1469' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1469
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1470")'> 1470:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1470' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1470
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1471")'> 1471:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1471' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1471
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1472")'> 1472:             else:</pre>
<pre id='line1472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1473")'> 1473:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1473' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1473
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 * 
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1474")'> 1474:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1474' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1474
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         snp_idx_win = 0
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1475")'> 1475: </pre>
<pre id='line1475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1476")'> 1476:         snp_idx_win = 0</pre>
<pre id='line1476' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1476
 *                 end_snp = self.end_snp(win_idx+2)
 * 
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 */
  __pyx_v_snp_idx_win = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1477")'> 1477:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1477' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1477
 * 
 *         snp_idx_win = 0
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
  __pyx_t_2 = __pyx_v_end_snp;
  for (__pyx_t_3 = __pyx_v_start_snp; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_snp_idx = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1478")'> 1478:             for admx_idx1 in range(self.K):</pre>
<pre id='line1478' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1478
 *         snp_idx_win = 0
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_4 = __pyx_v_self->K;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_admx_idx1 = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1479")'> 1479:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1479' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1479
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_6 = __pyx_v_self->K;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_admx_idx2 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1480")'> 1480:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1480' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1480
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_8 = __pyx_v_self->K;
        for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
          __pyx_v_admx_idx3 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1481")'> 1481:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1481' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1481
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_10 = __pyx_v_self->K;
          for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
            __pyx_v_admx_idx4 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1482")'> 1482:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1482' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1482
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_12 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
              __pyx_v_node_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1483")'> 1483:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1483' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1483
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_14 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
                __pyx_v_node_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1484")'> 1484:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1484' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1484
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 */
                __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
                  __pyx_v_node_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1485")'> 1485:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1485' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1485
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 */
                  __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                    __pyx_v_node_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1486")'> 1486:                                             for ibd in range(2):</pre>
<pre id='line1486' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1486
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1
 */
                    for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                      __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1487")'> 1487:                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0</pre>
<pre id='line1487' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1487
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win += 1
 * 
 */
                      ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = 0.0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1488")'> 1488:             snp_idx_win += 1</pre>
<pre id='line1488' class='code' style='background-color: #FFFFb6'>
    /* "LDModel.pyx":1488
 *                                             for ibd in range(2):
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 0
 *             snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_backward_probs_ibd_admx(self, int win_idx, bool post):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win + 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1489")'> 1489: </pre>
<pre id='line1489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line1490")'> 1490:     cpdef calc_backward_probs_ibd_admx(self, int win_idx, bool post):</pre>
<pre id='line1490' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":1490
 *             snp_idx_win += 1
 * 
 *     cpdef calc_backward_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_79calc_backward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_backward_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  int __pyx_v_nxt_node_idx1;
  int __pyx_v_nxt_node_idx2;
  int __pyx_v_nxt_node_idx3;
  int __pyx_v_nxt_node_idx4;
  int __pyx_v_nxt_node1;
  int __pyx_v_nxt_node2;
  int __pyx_v_nxt_node3;
  int __pyx_v_nxt_node4;
  int __pyx_v_ibd;
  int __pyx_v_nxt_ibd;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_snp_idx_win;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  int __pyx_v_win_size;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_backward_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_backward_probs_ibd_admx", __pyx_f[0], 1490);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_65);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_79calc_backward_probs_ibd_admx)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1490
 *             snp_idx_win += 1
 * 
 *     cpdef calc_backward_probs_ibd_admx(self, int win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int snp_idx
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_78calc_backward_probs_ibd_admx(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_backward_probs_ibd_admx", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_backward_probs_ibd_admx", __pyx_f[0], 1490);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_backward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_backward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1491")'> 1491: </pre>
<pre id='line1491' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1492")'> 1492:         cdef int snp_idx</pre>
<pre id='line1492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1493")'> 1493:         cdef int node_idx1</pre>
<pre id='line1493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1494")'> 1494:         cdef int node_idx2</pre>
<pre id='line1494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1495")'> 1495:         cdef int node_idx3</pre>
<pre id='line1495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1496")'> 1496:         cdef int node_idx4</pre>
<pre id='line1496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1497")'> 1497:         cdef int nxt_node_idx1</pre>
<pre id='line1497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1498")'> 1498:         cdef int nxt_node_idx2</pre>
<pre id='line1498' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1499")'> 1499:         cdef int nxt_node_idx3</pre>
<pre id='line1499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1500")'> 1500:         cdef int nxt_node_idx4</pre>
<pre id='line1500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1501")'> 1501:         cdef int nxt_node1</pre>
<pre id='line1501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1502")'> 1502:         cdef int nxt_node2</pre>
<pre id='line1502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1503")'> 1503:         cdef int nxt_node3</pre>
<pre id='line1503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1504")'> 1504:         cdef int nxt_node4</pre>
<pre id='line1504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1505")'> 1505:         cdef int ibd</pre>
<pre id='line1505' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1506")'> 1506:         cdef int nxt_ibd</pre>
<pre id='line1506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1507")'> 1507:         cdef int admx_idx1</pre>
<pre id='line1507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1508")'> 1508:         cdef int admx_idx2</pre>
<pre id='line1508' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1509")'> 1509:         cdef int admx_idx3</pre>
<pre id='line1509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1510")'> 1510:         cdef int admx_idx4</pre>
<pre id='line1510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1511")'> 1511:         cdef int nxt_admx_idx1</pre>
<pre id='line1511' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1512")'> 1512:         cdef int nxt_admx_idx2</pre>
<pre id='line1512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1513")'> 1513:         cdef int nxt_admx_idx3</pre>
<pre id='line1513' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1514")'> 1514:         cdef int nxt_admx_idx4</pre>
<pre id='line1514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1515")'> 1515:         cdef int snp_idx_win</pre>
<pre id='line1515' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1516")'> 1516:         cdef int start_snp</pre>
<pre id='line1516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1517")'> 1517:         cdef int end_snp</pre>
<pre id='line1517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1518")'> 1518:         cdef int win_size</pre>
<pre id='line1518' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1519")'> 1519: </pre>
<pre id='line1519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1520")'> 1520:         if not post:</pre>
<pre id='line1520' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1520
 *         cdef int win_size
 * 
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_5 = (!__pyx_v_post);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1521")'> 1521:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1521' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1521
 * 
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1522")'> 1522:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1522' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1522
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1523")'> 1523:         else:</pre>
<pre id='line1523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1524")'> 1524:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1524' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1524
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1525")'> 1525:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1525' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1525
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, (__pyx_v_win_idx - 2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1526")'> 1526:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1526' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1526
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1527")'> 1527:             else:</pre>
<pre id='line1527' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1528")'> 1528:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1528' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1528
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         win_size=end_snp-start_snp
 */
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1529")'> 1529:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1529' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1529
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         win_size=end_snp-start_snp
 * 
 */
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, (__pyx_v_win_idx + 2));
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1530")'> 1530:         win_size=end_snp-start_snp</pre>
<pre id='line1530' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1530
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         win_size=end_snp-start_snp             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # last layer
 */
  __pyx_v_win_size = (__pyx_v_end_snp - __pyx_v_start_snp);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1531")'> 1531: </pre>
<pre id='line1531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1532")'> 1532:         # last layer</pre>
<pre id='line1532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1533")'> 1533: #         print "backward probs calc in snp num " + str(end_snp - 1)</pre>
<pre id='line1533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1534")'> 1534:         for admx_idx1 in range(self.K):</pre>
<pre id='line1534' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1534
 *         # last layer
 * #         print "backward probs calc in snp num " + str(end_snp - 1)
 *         for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_self->K;
  for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_admx_idx1 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1535")'> 1535:             for admx_idx2 in range(self.K):</pre>
<pre id='line1535' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1535
 * #         print "backward probs calc in snp num " + str(end_snp - 1)
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx2 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1536")'> 1536:                 for admx_idx3 in range(self.K):</pre>
<pre id='line1536' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1536
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx3 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1537")'> 1537:                     for admx_idx4 in range(self.K):</pre>
<pre id='line1537' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1537
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx4 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1538")'> 1538:                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):</pre>
<pre id='line1538' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1538
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 */
          __pyx_t_14 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[(__pyx_v_end_snp - 1)]);
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_node_idx1 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1539")'> 1539:                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):</pre>
<pre id='line1539' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1539
 *                     for admx_idx4 in range(self.K):
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[(__pyx_v_end_snp - 1)]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx2 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1540")'> 1540:                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):</pre>
<pre id='line1540' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1540
 *                         for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                         for ibd in range(2):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[(__pyx_v_end_snp - 1)]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx3 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1541")'> 1541:                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):</pre>
<pre id='line1541' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1541
 *                             for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for ibd in range(2):
 *                                             if ibd == 0 or admx_idx1 == admx_idx3:
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[(__pyx_v_end_snp - 1)]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx4 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1542")'> 1542:                                         for ibd in range(2):</pre>
<pre id='line1542' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1542
 *                                 for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                         for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             if ibd == 0 or admx_idx1 == admx_idx3:
 *                                                 self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 1
 */
                  for (__pyx_t_22 = 0; __pyx_t_22 <code><</code> 2; __pyx_t_22+=1) {
                    __pyx_v_ibd = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1543")'> 1543:                                             if ibd == 0 or admx_idx1 == admx_idx3:</pre>
<pre id='line1543' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1543
 *                                     for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                         for ibd in range(2):
 *                                             if ibd == 0 or admx_idx1 == admx_idx3:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 1
 * 
 */
                    __pyx_t_5 = (__pyx_v_ibd == 0);
                    if (!__pyx_t_5) {
                      __pyx_t_23 = (__pyx_v_admx_idx1 == __pyx_v_admx_idx3);
                      __pyx_t_24 = __pyx_t_23;
                    } else {
                      __pyx_t_24 = __pyx_t_5;
                    }
                    if (__pyx_t_24) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1544")'> 1544:                                                 self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 1</pre>
<pre id='line1544' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1544
 *                                         for ibd in range(2):
 *                                             if ibd == 0 or admx_idx1 == admx_idx3:
 *                                                 self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # rescaling to avoid underflow
 */
                      ((((((((((__pyx_v_self->_backward_probs_ibd_admx[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = 1.0;
                      goto __pyx_L23;
                    }
                    __pyx_L23:;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1545")'> 1545: </pre>
<pre id='line1545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1546")'> 1546:         # rescaling to avoid underflow</pre>
<pre id='line1546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1547")'> 1547:         for admx_idx1 in range(self.K):</pre>
<pre id='line1547' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1547
 * 
 *         # rescaling to avoid underflow
 *         for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 */
  __pyx_t_6 = __pyx_v_self->K;
  for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_admx_idx1 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1548")'> 1548:             for admx_idx2 in range(self.K):</pre>
<pre id='line1548' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1548
 *         # rescaling to avoid underflow
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx2 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1549")'> 1549:                 for admx_idx3 in range(self.K):</pre>
<pre id='line1549' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1549
 *         for admx_idx1 in range(self.K):
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx3 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1550")'> 1550:                     for admx_idx4 in range(self.K):</pre>
<pre id='line1550' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1550
 *             for admx_idx2 in range(self.K):
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx4 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1551")'> 1551:                         for ibd in range(2):</pre>
<pre id='line1551' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1551
 *                 for admx_idx3 in range(self.K):
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 */
          for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> 2; __pyx_t_14+=1) {
            __pyx_v_ibd = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1552")'> 1552:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):</pre>
<pre id='line1552' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1552
 *                     for admx_idx4 in range(self.K):
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 */
            __pyx_t_15 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[(__pyx_v_end_snp - 1)]);
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
              __pyx_v_node_idx1 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1553")'> 1553:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):</pre>
<pre id='line1553' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1553
 *                         for ibd in range(2):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 */
              __pyx_t_17 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[(__pyx_v_end_snp - 1)]);
              for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                __pyx_v_node_idx2 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1554")'> 1554:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):</pre>
<pre id='line1554' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1554
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][end_snp - 1]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 */
                __pyx_t_19 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[(__pyx_v_end_snp - 1)]);
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
                  __pyx_v_node_idx3 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1555")'> 1555:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):</pre>
<pre id='line1555' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1555
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][end_snp - 1]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 */
                  __pyx_t_21 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[(__pyx_v_end_snp - 1)]);
                  for (__pyx_t_22 = 0; __pyx_t_22 <code><</code> __pyx_t_21; __pyx_t_22+=1) {
                    __pyx_v_node_idx4 = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1556")'> 1556:                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]</pre>
<pre id='line1556' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1556
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][end_snp - 1]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 */
                    __pyx_t_25 = (__pyx_v_win_size - 1);
                    __pyx_t_26 = __pyx_v_admx_idx1;
                    __pyx_t_27 = __pyx_v_admx_idx2;
                    __pyx_t_28 = __pyx_v_admx_idx3;
                    __pyx_t_29 = __pyx_v_admx_idx4;
                    __pyx_t_30 = __pyx_v_ibd;
                    ((((((__pyx_v_self->_backward_scale_factor[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30]) = (((((((__pyx_v_self->_backward_scale_factor[__pyx_t_25])[__pyx_t_26])[__pyx_t_27])[__pyx_t_28])[__pyx_t_29])[__pyx_t_30]) + ((((((((((__pyx_v_self->_backward_probs_ibd_admx[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]));
                  }
                }
              }
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1557")'> 1557:                             if self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &gt; 0:</pre>
<pre id='line1557' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1557
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][end_snp - 1]):
 *                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                             else:
 */
            __pyx_t_24 = (((((((__pyx_v_self->_backward_scale_factor[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) > 0.0);
            if (__pyx_t_24) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1558")'> 1558:                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1558' class='code' style='background-color: #FFFFaa'>
              /* "LDModel.pyx":1558
 *                                             self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                             if self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             else:
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX
 */
              __pyx_t_31 = ((((((__pyx_v_self->_backward_scale_factor[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]);
              if (unlikely(__pyx_t_31 == 0)) {
                <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              ((((((__pyx_v_self->_backward_scale_factor[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (1.0 / __pyx_t_31);
              goto __pyx_L42;
            }
            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1559")'> 1559:                             else:</pre>
<pre id='line1559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1560")'> 1560:                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX</pre>
<pre id='line1560' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1560
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                             else:
 *                                 self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                             if ibd ==0 and self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 * #                             print " snp_idx: " + str(end_snp - 1) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \
 */
              ((((((__pyx_v_self->_backward_scale_factor[(__pyx_v_win_size - 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = DBL_MAX;
            }
            __pyx_L42:;
          }
        }
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1561")'> 1561: #                             if ibd ==0 and self._backward_scale_factor[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] &gt; 1:</pre>
<pre id='line1561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1562")'> 1562: #                             print " snp_idx: " + str(end_snp - 1) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \</pre>
<pre id='line1562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1563")'> 1563: #                             " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4) + " ibd: " + str(ibd) + " backward prob: " + str(self._backward_probs_ibd_admx[win_size - 1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd])</pre>
<pre id='line1563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1564")'> 1564: </pre>
<pre id='line1564' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1565")'> 1565:         # all other layers</pre>
<pre id='line1565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1566")'> 1566:         snp_idx_win = win_size - 2</pre>
<pre id='line1566' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1566
 * 
 *         # all other layers
 *         snp_idx_win = win_size - 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in reversed(range(start_snp, end_snp - 1)):
 * #             print "backward probs calc in snp num " + str(snp_idx)
 */
  __pyx_v_snp_idx_win = (__pyx_v_win_size - 2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1567")'> 1567:         for snp_idx in reversed(range(start_snp, end_snp - 1)):</pre>
<pre id='line1567' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1567
 *         # all other layers
 *         snp_idx_win = win_size - 2
 *         for snp_idx in reversed(range(start_snp, end_snp - 1)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #             print "backward probs calc in snp num " + str(snp_idx)
 *             # calculate forward probabilities
 */
  __pyx_t_6 = __pyx_v_start_snp;
  for (__pyx_t_7 = (__pyx_v_end_snp - 1)-1; __pyx_t_7 >= __pyx_t_6; __pyx_t_7-=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1568")'> 1568: #             print "backward probs calc in snp num " + str(snp_idx)</pre>
<pre id='line1568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1569")'> 1569:             # calculate forward probabilities</pre>
<pre id='line1569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1570")'> 1570:             for admx_idx1 in range(self.K):</pre>
<pre id='line1570' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1570
 * #             print "backward probs calc in snp num " + str(snp_idx)
 *             # calculate forward probabilities
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1571")'> 1571:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1571' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1571
 *             # calculate forward probabilities
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1572")'> 1572:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1572' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1572
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1573")'> 1573:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1573' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1573
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1574")'> 1574:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1574' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1574
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1575")'> 1575:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1575' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1575
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1576")'> 1576:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1576' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1576
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1577")'> 1577:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1577' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1577
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> __pyx_t_22; __pyx_t_26+=1) {
                    __pyx_v_node_idx4 = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1578")'> 1578:                                             for ibd in range(2):</pre>
<pre id='line1578' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1578
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):
 *                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):
 */
                    for (__pyx_t_27 = 0; __pyx_t_27 <code><</code> 2; __pyx_t_27+=1) {
                      __pyx_v_ibd = __pyx_t_27;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1579")'> 1579:                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):</pre>
<pre id='line1579' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1579
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 *                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):
 *                                                         for nxt_node_idx3 in range(self._states[admx_idx3][snp_idx][node_idx3].out_trans_num):
 */
                      __pyx_t_28 = (((__pyx_v_self->_states[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1]).out_trans_num;
                      for (__pyx_t_29 = 0; __pyx_t_29 <code><</code> __pyx_t_28; __pyx_t_29+=1) {
                        __pyx_v_nxt_node_idx1 = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1580")'> 1580:                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):</pre>
<pre id='line1580' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":1580
 *                                             for ibd in range(2):
 *                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):
 *                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         for nxt_node_idx3 in range(self._states[admx_idx3][snp_idx][node_idx3].out_trans_num):
 *                                                             for nxt_node_idx4 in range(self._states[admx_idx4][snp_idx][node_idx4].out_trans_num):
 */
                        __pyx_t_30 = (((__pyx_v_self->_states[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2]).out_trans_num;
                        for (__pyx_t_32 = 0; __pyx_t_32 <code><</code> __pyx_t_30; __pyx_t_32+=1) {
                          __pyx_v_nxt_node_idx2 = __pyx_t_32;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1581")'> 1581:                                                         for nxt_node_idx3 in range(self._states[admx_idx3][snp_idx][node_idx3].out_trans_num):</pre>
<pre id='line1581' class='code' style='background-color: #FFFFff'>
                          /* "LDModel.pyx":1581
 *                                                 for nxt_node_idx1 in range(self._states[admx_idx1][snp_idx][node_idx1].out_trans_num):
 *                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):
 *                                                         for nxt_node_idx3 in range(self._states[admx_idx3][snp_idx][node_idx3].out_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                             for nxt_node_idx4 in range(self._states[admx_idx4][snp_idx][node_idx4].out_trans_num):
 *                                                                 #for nxt_ibd in range(2):
 */
                          __pyx_t_33 = (((__pyx_v_self->_states[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3]).out_trans_num;
                          for (__pyx_t_34 = 0; __pyx_t_34 <code><</code> __pyx_t_33; __pyx_t_34+=1) {
                            __pyx_v_nxt_node_idx3 = __pyx_t_34;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1582")'> 1582:                                                             for nxt_node_idx4 in range(self._states[admx_idx4][snp_idx][node_idx4].out_trans_num):</pre>
<pre id='line1582' class='code' style='background-color: #FFFFff'>
                            /* "LDModel.pyx":1582
 *                                                     for nxt_node_idx2 in range(self._states[admx_idx2][snp_idx][node_idx2].out_trans_num):
 *                                                         for nxt_node_idx3 in range(self._states[admx_idx3][snp_idx][node_idx3].out_trans_num):
 *                                                             for nxt_node_idx4 in range(self._states[admx_idx4][snp_idx][node_idx4].out_trans_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                 #for nxt_ibd in range(2):
 *                                                                     nxt_ibd = ibd
 */
                            __pyx_t_35 = (((__pyx_v_self->_states[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4]).out_trans_num;
                            for (__pyx_t_36 = 0; __pyx_t_36 <code><</code> __pyx_t_35; __pyx_t_36+=1) {
                              __pyx_v_nxt_node_idx4 = __pyx_t_36;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1583")'> 1583:                                                                 #for nxt_ibd in range(2):</pre>
<pre id='line1583' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1584")'> 1584:                                                                     nxt_ibd = ibd</pre>
<pre id='line1584' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1584
 *                                                             for nxt_node_idx4 in range(self._states[admx_idx4][snp_idx][node_idx4].out_trans_num):
 *                                                                 #for nxt_ibd in range(2):
 *                                                                     nxt_ibd = ibd             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     nxt_node1 = self._trans_idx[admx_idx1][snp_idx][node_idx1][nxt_node_idx1]
 *                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]
 */
                              __pyx_v_nxt_ibd = __pyx_v_ibd;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1585")'> 1585:                                                                     nxt_node1 = self._trans_idx[admx_idx1][snp_idx][node_idx1][nxt_node_idx1]</pre>
<pre id='line1585' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1585
 *                                                                 #for nxt_ibd in range(2):
 *                                                                     nxt_ibd = ibd
 *                                                                     nxt_node1 = self._trans_idx[admx_idx1][snp_idx][node_idx1][nxt_node_idx1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]
 *                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]
 */
                              __pyx_v_nxt_node1 = ((((__pyx_v_self->_trans_idx[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1])[__pyx_v_nxt_node_idx1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1586")'> 1586:                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]</pre>
<pre id='line1586' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1586
 *                                                                     nxt_ibd = ibd
 *                                                                     nxt_node1 = self._trans_idx[admx_idx1][snp_idx][node_idx1][nxt_node_idx1]
 *                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]
 *                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]
 */
                              __pyx_v_nxt_node2 = ((((__pyx_v_self->_trans_idx[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2])[__pyx_v_nxt_node_idx2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1587")'> 1587:                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]</pre>
<pre id='line1587' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1587
 *                                                                     nxt_node1 = self._trans_idx[admx_idx1][snp_idx][node_idx1][nxt_node_idx1]
 *                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]
 *                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]
 *                                                                     if ibd == 0:
 */
                              __pyx_v_nxt_node3 = ((((__pyx_v_self->_trans_idx[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3])[__pyx_v_nxt_node_idx3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1588")'> 1588:                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]</pre>
<pre id='line1588' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1588
 *                                                                     nxt_node2 = self._trans_idx[admx_idx2][snp_idx][node_idx2][nxt_node_idx2]
 *                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]
 *                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                     if ibd == 0:
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \
 */
                              __pyx_v_nxt_node4 = ((((__pyx_v_self->_trans_idx[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4])[__pyx_v_nxt_node_idx4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1589")'> 1589:                                                                     if ibd == 0:</pre>
<pre id='line1589' class='code' style='background-color: #FFFFff'>
                              /* "LDModel.pyx":1589
 *                                                                     nxt_node3 = self._trans_idx[admx_idx3][snp_idx][node_idx3][nxt_node_idx3]
 *                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]
 *                                                                     if ibd == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4][nxt_ibd] * \
 */
                              __pyx_t_24 = (__pyx_v_ibd == 0);
                              if (__pyx_t_24) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1590")'> 1590:                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \</pre>
<pre id='line1590' class='code' style='background-color: #FFFFff'>
                                /* "LDModel.pyx":1590
 *                                                                     nxt_node4 = self._trans_idx[admx_idx4][snp_idx][node_idx4][nxt_node_idx4]
 *                                                                     if ibd == 0:
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4][nxt_ibd] * \
 *                                                                         self._trans[admx_idx1][snp_idx][node_idx1][nxt_node_idx1] * \
 */
                                __pyx_t_37 = __pyx_v_snp_idx_win;
                                __pyx_t_38 = __pyx_v_admx_idx1;
                                __pyx_t_39 = __pyx_v_admx_idx2;
                                __pyx_t_40 = __pyx_v_admx_idx3;
                                __pyx_t_41 = __pyx_v_admx_idx4;
                                __pyx_t_42 = __pyx_v_node_idx1;
                                __pyx_t_43 = __pyx_v_node_idx2;
                                __pyx_t_44 = __pyx_v_node_idx3;
                                __pyx_t_45 = __pyx_v_node_idx4;
                                __pyx_t_46 = __pyx_v_ibd;

                                /* "LDModel.pyx":1596
 *                                                                         self._trans[admx_idx3][snp_idx][node_idx3][nxt_node_idx3] * \
 *                                                                         self._trans[admx_idx4][snp_idx][node_idx4][nxt_node_idx4] * \
 *                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4] #* \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         #self._s[snp_idx][ibd][nxt_ibd]
 *                                                                     else:
 */
                                ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43])[__pyx_t_44])[__pyx_t_45])[__pyx_t_46]) = (((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43])[__pyx_t_44])[__pyx_t_45])[__pyx_t_46]) + (((((((((((((((__pyx_v_self->_backward_probs_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_node1])[__pyx_v_nxt_node2])[__pyx_v_nxt_node3])[__pyx_v_nxt_node4])[__pyx_v_nxt_ibd]) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1])[__pyx_v_nxt_node_idx1])) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2])[__pyx_v_nxt_node_idx2])) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx3])[__pyx_v_snp_idx])[__pyx_v_node_idx3])[__pyx_v_nxt_node_idx3])) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4])[__pyx_v_nxt_node_idx4])) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_node1])[__pyx_v_nxt_node2])[__pyx_v_nxt_node3])[__pyx_v_nxt_node4])));
                                goto __pyx_L71;
                              }
                              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1591")'> 1591:                                                                         self._backward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4][nxt_ibd] * \</pre>
<pre id='line1591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1592")'> 1592:                                                                         self._trans[admx_idx1][snp_idx][node_idx1][nxt_node_idx1] * \</pre>
<pre id='line1592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1593")'> 1593:                                                                         self._trans[admx_idx2][snp_idx][node_idx2][nxt_node_idx2] * \</pre>
<pre id='line1593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1594")'> 1594:                                                                         self._trans[admx_idx3][snp_idx][node_idx3][nxt_node_idx3] * \</pre>
<pre id='line1594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1595")'> 1595:                                                                         self._trans[admx_idx4][snp_idx][node_idx4][nxt_node_idx4] * \</pre>
<pre id='line1595' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1596")'> 1596:                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4] #* \</pre>
<pre id='line1596' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1597")'> 1597:                                                                         #self._s[snp_idx][ibd][nxt_ibd]</pre>
<pre id='line1597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1598")'> 1598:                                                                     else:</pre>
<pre id='line1598' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1599")'> 1599: #                                                                         if admx_idx1 == admx_idx3 and node_idx1 == node_idx3 and nxt_node1 == nxt_node3:</pre>
<pre id='line1599' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1600")'> 1600:                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \</pre>
<pre id='line1600' class='code' style='background-color: #FFFFff'>
                                /* "LDModel.pyx":1600
 *                                                                     else:
 * #                                                                         if admx_idx1 == admx_idx3 and node_idx1 == node_idx3 and nxt_node1 == nxt_node3:
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] += \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         self._backward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4][nxt_ibd] * \
 *                                                                         self._trans[admx_idx1][snp_idx][node_idx1][nxt_node_idx1] * \
 */
                                __pyx_t_37 = __pyx_v_snp_idx_win;
                                __pyx_t_38 = __pyx_v_admx_idx1;
                                __pyx_t_39 = __pyx_v_admx_idx2;
                                __pyx_t_40 = __pyx_v_admx_idx3;
                                __pyx_t_41 = __pyx_v_admx_idx4;
                                __pyx_t_42 = __pyx_v_node_idx1;
                                __pyx_t_43 = __pyx_v_node_idx2;
                                __pyx_t_44 = __pyx_v_node_idx3;
                                __pyx_t_45 = __pyx_v_node_idx4;
                                __pyx_t_46 = __pyx_v_ibd;

                                /* "LDModel.pyx":1605
 *                                                                         self._trans[admx_idx2][snp_idx][node_idx2][nxt_node_idx2] * \
 *                                                                         self._trans[admx_idx4][snp_idx][node_idx4][nxt_node_idx4] * \
 *                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                                         #self._s[snp_idx][ibd][nxt_ibd] * \
 *             # rescaling to avoid underflow
 */
                                ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43])[__pyx_t_44])[__pyx_t_45])[__pyx_t_46]) = (((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_t_37])[__pyx_t_38])[__pyx_t_39])[__pyx_t_40])[__pyx_t_41])[__pyx_t_42])[__pyx_t_43])[__pyx_t_44])[__pyx_t_45])[__pyx_t_46]) + ((((((((((((((__pyx_v_self->_backward_probs_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_node1])[__pyx_v_nxt_node2])[__pyx_v_nxt_node3])[__pyx_v_nxt_node4])[__pyx_v_nxt_ibd]) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx1])[__pyx_v_snp_idx])[__pyx_v_node_idx1])[__pyx_v_nxt_node_idx1])) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx2])[__pyx_v_snp_idx])[__pyx_v_node_idx2])[__pyx_v_nxt_node_idx2])) * ((((__pyx_v_self->_trans[__pyx_v_admx_idx4])[__pyx_v_snp_idx])[__pyx_v_node_idx4])[__pyx_v_nxt_node_idx4])) * (((((((((__pyx_v_self->_emission_prob_ibd_admx[(__pyx_v_snp_idx_win + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_node1])[__pyx_v_nxt_node2])[__pyx_v_nxt_node3])[__pyx_v_nxt_node4])));
                              }
                              __pyx_L71:;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1601")'> 1601:                                                                         self._backward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4][nxt_ibd] * \</pre>
<pre id='line1601' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1602")'> 1602:                                                                         self._trans[admx_idx1][snp_idx][node_idx1][nxt_node_idx1] * \</pre>
<pre id='line1602' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1603")'> 1603:                                                                         self._trans[admx_idx2][snp_idx][node_idx2][nxt_node_idx2] * \</pre>
<pre id='line1603' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1604")'> 1604:                                                                         self._trans[admx_idx4][snp_idx][node_idx4][nxt_node_idx4] * \</pre>
<pre id='line1604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1605")'> 1605:                                                                         self._emission_prob_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_node1][nxt_node2][nxt_node3][nxt_node4]</pre>
<pre id='line1605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1606")'> 1606:                                                                         #self._s[snp_idx][ibd][nxt_ibd] * \</pre>
<pre id='line1606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1607")'> 1607:             # rescaling to avoid underflow</pre>
<pre id='line1607' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1608")'> 1608:             for admx_idx1 in range(self.K):</pre>
<pre id='line1608' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1608
 *                                                                         #self._s[snp_idx][ibd][nxt_ibd] * \
 *             # rescaling to avoid underflow
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1609")'> 1609:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1609' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1609
 *             # rescaling to avoid underflow
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1610")'> 1610:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1610' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1610
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1611")'> 1611:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1611' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1611
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1612")'> 1612:                             for ibd in range(2):</pre>
<pre id='line1612' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1612
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> 2; __pyx_t_16+=1) {
              __pyx_v_ibd = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1613")'> 1613:                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1613' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1613
 *                         for admx_idx4 in range(self.K):
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
              __pyx_t_17 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
              for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                __pyx_v_node_idx1 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1614")'> 1614:                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1614' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1614
 *                             for ibd in range(2):
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
                __pyx_t_19 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> __pyx_t_19; __pyx_t_20+=1) {
                  __pyx_v_node_idx2 = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1615")'> 1615:                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1615' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1615
 *                                 for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 */
                  __pyx_t_21 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                  for (__pyx_t_22 = 0; __pyx_t_22 <code><</code> __pyx_t_21; __pyx_t_22+=1) {
                    __pyx_v_node_idx3 = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1616")'> 1616:                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1616' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1616
 *                                     for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 */
                    __pyx_t_26 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                    for (__pyx_t_27 = 0; __pyx_t_27 <code><</code> __pyx_t_26; __pyx_t_27+=1) {
                      __pyx_v_node_idx4 = __pyx_t_27;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1617")'> 1617:                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]</pre>
<pre id='line1617' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1617
 *                                         for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 */
                      __pyx_t_28 = __pyx_v_snp_idx_win;
                      __pyx_t_29 = __pyx_v_admx_idx1;
                      __pyx_t_30 = __pyx_v_admx_idx2;
                      __pyx_t_32 = __pyx_v_admx_idx3;
                      __pyx_t_33 = __pyx_v_admx_idx4;
                      __pyx_t_34 = __pyx_v_ibd;
                      ((((((__pyx_v_self->_backward_scale_factor[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_32])[__pyx_t_33])[__pyx_t_34]) = (((((((__pyx_v_self->_backward_scale_factor[__pyx_t_28])[__pyx_t_29])[__pyx_t_30])[__pyx_t_32])[__pyx_t_33])[__pyx_t_34]) + ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]));
                    }
                  }
                }
              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1618")'> 1618:                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &gt; 0:</pre>
<pre id='line1618' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1618
 *                                             for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                                 else:
 */
              __pyx_t_24 = (((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) > 0.0);
              if (__pyx_t_24) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1619")'> 1619:                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1619' class='code' style='background-color: #FFFFaa'>
                /* "LDModel.pyx":1619
 *                                                 self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]
 *                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] > 0:
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 else:
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX
 */
                if (unlikely(((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) == 0)) {
                  <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
                 <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (1.0 / ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
                goto __pyx_L90;
              }
              /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1620")'> 1620:                                 else:</pre>
<pre id='line1620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1621")'> 1621:                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX</pre>
<pre id='line1621' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1621
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 1.0 / self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *                                 else:
 *                                     self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                     print " backward scale factor, snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = DBL_MAX;
              }
              __pyx_L90:;
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1622")'> 1622: #                                 if self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1:</pre>
<pre id='line1622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1623")'> 1623: #                                     print " backward scale factor, snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1624")'> 1624: </pre>
<pre id='line1624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1625")'> 1625:             for admx_idx1 in range(self.K):</pre>
<pre id='line1625' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1625
 * #                                     print " backward scale factor, snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + " ibd: " + str(ibd) + "scale factor: " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1626")'> 1626:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1626' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1626
 * 
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1627")'> 1627:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1627' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1627
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1628")'> 1628:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1628' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1628
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1629")'> 1629:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1629' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1629
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1630")'> 1630:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1630' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1630
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1631")'> 1631:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1631' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1631
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1632")'> 1632:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1632' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1632
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 * #                                                 if ibd ==0 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> __pyx_t_22; __pyx_t_26+=1) {
                    __pyx_v_node_idx4 = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1633")'> 1633:                                             for ibd in range(2):</pre>
<pre id='line1633' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1633
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                                 if ibd ==0 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 * #                                                 if self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] > 1:
 */
                    for (__pyx_t_27 = 0; __pyx_t_27 <code><</code> 2; __pyx_t_27+=1) {
                      __pyx_v_ibd = __pyx_t_27;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1634")'> 1634: #                                                 if ibd ==0 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1: #and self._forward_probs_ibd_admx[snp_idx_win+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] &gt; 1:</pre>
<pre id='line1634' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1635")'> 1635: #                                                 if self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] &gt; 1:</pre>
<pre id='line1635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1636")'> 1636: #                                                     print " snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \</pre>
<pre id='line1636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1637")'> 1637: #                                                     " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4) + " ibd: " + str(ibd) + " backward prob: " + str(self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd])</pre>
<pre id='line1637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1638")'> 1638:                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \</pre>
<pre id='line1638' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1638
 * #                                                     print " snp_idx: " + str(snp_idx) + " admx_idx1: " + str(admx_idx1) + " admx_idx2: " + str(admx_idx2) + " admx_idx3: " + str(admx_idx3) + " admx_idx4: " + str(admx_idx4) + \
 * #                                                     " node_idx1: " + str(node_idx1) + " node_idx2: " + str(node_idx2) + " node_idx3: " + str(node_idx3) + " node_idx4: " + str(node_idx4) + " ibd: " + str(ibd) + " backward prob: " + str(self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd])
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] * self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *             snp_idx_win -= 1
 */
                      ((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) = (((((((((((__pyx_v_self->_backward_probs_ibd_admx[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]) * ((((((__pyx_v_self->_backward_scale_factor[__pyx_v_snp_idx_win])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1639")'> 1639:                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] * self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line1639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1640")'> 1640:             snp_idx_win -= 1</pre>
<pre id='line1640' class='code' style='background-color: #FFFF23'>
    /* "LDModel.pyx":1640
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] = \
 *                                                 self._backward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd] * self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]
 *             snp_idx_win -= 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef top_level_alloc_mem(self):
 */
    __pyx_v_snp_idx_win = (__pyx_v_snp_idx_win - 1);
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_backward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_79calc_backward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_79calc_backward_probs_ibd_admx(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_win_idx;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_backward_probs_ibd_admx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_backward_probs_ibd_admx", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_backward_probs_ibd_admx") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_win_idx == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_backward_probs_ibd_admx", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1490; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_backward_probs_ibd_admx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_78calc_backward_probs_ibd_admx(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1641")'> 1641: </pre>
<pre id='line1641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line1642")'> 1642:     cpdef top_level_alloc_mem(self):</pre>
<pre id='line1642' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":1642
 *             snp_idx_win -= 1
 * 
 *     cpdef top_level_alloc_mem(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_81top_level_alloc_mem(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_top_level_alloc_mem(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_alloc_mem", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_alloc_mem", __pyx_f[0], 1642);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__top_level_alloc_mem);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_81top_level_alloc_mem)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1642
 *             snp_idx_win -= 1
 * 
 *     cpdef top_level_alloc_mem(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_80top_level_alloc_mem(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_alloc_mem", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_alloc_mem", __pyx_f[0], 1642);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->top_level_alloc_mem(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_alloc_mem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1643")'> 1643:         cdef int win_idx</pre>
<pre id='line1643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1644")'> 1644:         cdef int admx_idx1</pre>
<pre id='line1644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1645")'> 1645:         cdef int admx_idx2</pre>
<pre id='line1645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1646")'> 1646:         cdef int admx_idx3</pre>
<pre id='line1646' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1647")'> 1647:         cdef int admx_idx4</pre>
<pre id='line1647' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1648")'> 1648:         cdef int ibd</pre>
<pre id='line1648' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1649")'> 1649: </pre>
<pre id='line1649' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1650")'> 1650:         self._top_level_ems_prob = &lt;double ******&gt; malloc(self.get_num_windows() * sizeof(double *****))</pre>
<pre id='line1650' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1650
 *         cdef int ibd
 * 
 *         self._top_level_ems_prob = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._top_level_forward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 */
  __pyx_v_self->_top_level_ems_prob = ((double ******)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1651")'> 1651:         self._top_level_forward_probs = &lt;double ******&gt; malloc(self.get_num_windows() * sizeof(double *****))</pre>
<pre id='line1651' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1651
 * 
 *         self._top_level_ems_prob = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_forward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._top_level_backward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backtrack = <code><</code>int ******> malloc(self.get_num_windows() * sizeof(int *****))
 */
  __pyx_v_self->_top_level_forward_probs = ((double ******)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1652")'> 1652:         self._top_level_backward_probs = &lt;double ******&gt; malloc(self.get_num_windows() * sizeof(double *****))</pre>
<pre id='line1652' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1652
 *         self._top_level_ems_prob = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_forward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._top_level_backtrack = <code><</code>int ******> malloc(self.get_num_windows() * sizeof(int *****))
 *         self._top_level_scale_factor = <code><</code>double*> malloc(self.get_num_windows() * sizeof(double))
 */
  __pyx_v_self->_top_level_backward_probs = ((double ******)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1653")'> 1653:         self._top_level_backtrack = &lt;int ******&gt; malloc(self.get_num_windows() * sizeof(int *****))</pre>
<pre id='line1653' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1653
 *         self._top_level_forward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backtrack = <code><</code>int ******> malloc(self.get_num_windows() * sizeof(int *****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._top_level_scale_factor = <code><</code>double*> malloc(self.get_num_windows() * sizeof(double))
 *         for win_idx in range(self.get_num_windows()):
 */
  __pyx_v_self->_top_level_backtrack = ((int ******)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(int *****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1654")'> 1654:         self._top_level_scale_factor = &lt;double*&gt; malloc(self.get_num_windows() * sizeof(double))</pre>
<pre id='line1654' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1654
 *         self._top_level_backward_probs = <code><</code>double ******> malloc(self.get_num_windows() * sizeof(double *****))
 *         self._top_level_backtrack = <code><</code>int ******> malloc(self.get_num_windows() * sizeof(int *****))
 *         self._top_level_scale_factor = <code><</code>double*> malloc(self.get_num_windows() * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             self._top_level_scale_factor[win_idx] = 0
 */
  __pyx_v_self->_top_level_scale_factor = ((double *)malloc((((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1655")'> 1655:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1655' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1655
 *         self._top_level_backtrack = <code><</code>int ******> malloc(self.get_num_windows() * sizeof(int *****))
 *         self._top_level_scale_factor = <code><</code>double*> malloc(self.get_num_windows() * sizeof(double))
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._top_level_scale_factor[win_idx] = 0
 *             if self._ibs[win_idx]:
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1656")'> 1656:             self._top_level_scale_factor[win_idx] = 0</pre>
<pre id='line1656' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1656
 *         self._top_level_scale_factor = <code><</code>double*> malloc(self.get_num_windows() * sizeof(double))
 *         for win_idx in range(self.get_num_windows()):
 *             self._top_level_scale_factor[win_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 self._top_level_ems_prob[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 */
    (__pyx_v_self->_top_level_scale_factor[__pyx_v_win_idx]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1657")'> 1657:             if self._ibs[win_idx]:</pre>
<pre id='line1657' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1657
 *         for win_idx in range(self.get_num_windows()):
 *             self._top_level_scale_factor[win_idx] = 0
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._top_level_ems_prob[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_forward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1658")'> 1658:                 self._top_level_ems_prob[win_idx] = &lt;double *****&gt; malloc(self.K * sizeof(double ****))</pre>
<pre id='line1658' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1658
 *             self._top_level_scale_factor[win_idx] = 0
 *             if self._ibs[win_idx]:
 *                 self._top_level_ems_prob[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._top_level_forward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 */
      (__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1659")'> 1659:                 self._top_level_forward_probs[win_idx] = &lt;double *****&gt; malloc(self.K * sizeof(double ****))</pre>
<pre id='line1659' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1659
 *             if self._ibs[win_idx]:
 *                 self._top_level_ems_prob[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_forward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._top_level_backward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backtrack[win_idx] = <code><</code>int *****> malloc(self.K * sizeof(int ****))
 */
      (__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1660")'> 1660:                 self._top_level_backward_probs[win_idx] = &lt;double *****&gt; malloc(self.K * sizeof(double ****))</pre>
<pre id='line1660' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1660
 *                 self._top_level_ems_prob[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_forward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._top_level_backtrack[win_idx] = <code><</code>int *****> malloc(self.K * sizeof(int ****))
 *                 for admx_idx1 in range(self.K):
 */
      (__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx]) = ((double *****)malloc((__pyx_v_self->K * (sizeof(double ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1661")'> 1661:                 self._top_level_backtrack[win_idx] = &lt;int *****&gt; malloc(self.K * sizeof(int ****))</pre>
<pre id='line1661' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1661
 *                 self._top_level_forward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backtrack[win_idx] = <code><</code>int *****> malloc(self.K * sizeof(int ****))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx1 in range(self.K):
 *                     self._top_level_ems_prob[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
      (__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx]) = ((int *****)malloc((__pyx_v_self->K * (sizeof(int ****)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1662")'> 1662:                 for admx_idx1 in range(self.K):</pre>
<pre id='line1662' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1662
 *                 self._top_level_backward_probs[win_idx] = <code><</code>double *****> malloc(self.K * sizeof(double ****))
 *                 self._top_level_backtrack[win_idx] = <code><</code>int *****> malloc(self.K * sizeof(int ****))
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._top_level_ems_prob[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_forward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
      __pyx_t_5 = __pyx_v_self->K;
      for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1663")'> 1663:                     self._top_level_ems_prob[win_idx][admx_idx1] = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line1663' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1663
 *                 self._top_level_backtrack[win_idx] = <code><</code>int *****> malloc(self.K * sizeof(int ****))
 *                 for admx_idx1 in range(self.K):
 *                     self._top_level_ems_prob[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._top_level_forward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 */
        ((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1664")'> 1664:                     self._top_level_forward_probs[win_idx][admx_idx1] = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line1664' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1664
 *                 for admx_idx1 in range(self.K):
 *                     self._top_level_ems_prob[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_forward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._top_level_backward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backtrack[win_idx][admx_idx1] = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 */
        ((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1665")'> 1665:                     self._top_level_backward_probs[win_idx][admx_idx1] = &lt;double ****&gt; malloc(self.K * sizeof(double ***))</pre>
<pre id='line1665' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1665
 *                     self._top_level_ems_prob[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_forward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._top_level_backtrack[win_idx][admx_idx1] = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *                     for admx_idx2 in range(self.K):
 */
        ((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1]) = ((double ****)malloc((__pyx_v_self->K * (sizeof(double ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1666")'> 1666:                     self._top_level_backtrack[win_idx][admx_idx1] = &lt;int ****&gt; malloc(self.K * sizeof(int ***))</pre>
<pre id='line1666' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1666
 *                     self._top_level_forward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backtrack[win_idx][admx_idx1] = <code><</code>int ****> malloc(self.K * sizeof(int ***))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 */
        ((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1]) = ((int ****)malloc((__pyx_v_self->K * (sizeof(int ***)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1667")'> 1667:                     for admx_idx2 in range(self.K):</pre>
<pre id='line1667' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1667
 *                     self._top_level_backward_probs[win_idx][admx_idx1] = <code><</code>double ****> malloc(self.K * sizeof(double ***))
 *                     self._top_level_backtrack[win_idx][admx_idx1] = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 */
        __pyx_t_7 = __pyx_v_self->K;
        for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1668")'> 1668:                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = &lt;double ***&gt; malloc(self.K * sizeof(double **))</pre>
<pre id='line1668' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1668
 *                     self._top_level_backtrack[win_idx][admx_idx1] = <code><</code>int ****> malloc(self.K * sizeof(int ***))
 *                     for admx_idx2 in range(self.K):
 *                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 */
          (((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1669")'> 1669:                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = &lt;double ***&gt; malloc(self.K * sizeof(double **))</pre>
<pre id='line1669' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1669
 *                     for admx_idx2 in range(self.K):
 *                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = <code><</code>int ***> malloc(self.K * sizeof(int **))
 */
          (((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1670")'> 1670:                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = &lt;double ***&gt; malloc(self.K * sizeof(double **))</pre>
<pre id='line1670' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1670
 *                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = <code><</code>int ***> malloc(self.K * sizeof(int **))
 *                         for admx_idx3 in range(self.K):
 */
          (((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((double ***)malloc((__pyx_v_self->K * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1671")'> 1671:                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = &lt;int ***&gt; malloc(self.K * sizeof(int **))</pre>
<pre id='line1671' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1671
 *                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = <code><</code>int ***> malloc(self.K * sizeof(int **))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 */
          (((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2]) = ((int ***)malloc((__pyx_v_self->K * (sizeof(int **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1672")'> 1672:                         for admx_idx3 in range(self.K):</pre>
<pre id='line1672' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1672
 *                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2] = <code><</code>double ***> malloc(self.K * sizeof(double **))
 *                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = <code><</code>int ***> malloc(self.K * sizeof(int **))
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 */
          __pyx_t_9 = __pyx_v_self->K;
          for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1673")'> 1673:                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = &lt;double **&gt; malloc(self.K * sizeof(double *))</pre>
<pre id='line1673' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1673
 *                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2] = <code><</code>int ***> malloc(self.K * sizeof(int **))
 *                         for admx_idx3 in range(self.K):
 *                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 */
            ((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1674")'> 1674:                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = &lt;double **&gt; malloc(self.K * sizeof(double *))</pre>
<pre id='line1674' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1674
 *                         for admx_idx3 in range(self.K):
 *                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>int **> malloc(self.K * sizeof(int *))
 */
            ((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1675")'> 1675:                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = &lt;double **&gt; malloc(self.K * sizeof(double *))</pre>
<pre id='line1675' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1675
 *                             self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>int **> malloc(self.K * sizeof(int *))
 *                             for admx_idx4 in range(self.K):
 */
            ((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((double **)malloc((__pyx_v_self->K * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1676")'> 1676:                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = &lt;int **&gt; malloc(self.K * sizeof(int *))</pre>
<pre id='line1676' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1676
 *                             self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>int **> malloc(self.K * sizeof(int *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 */
            ((((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3]) = ((int **)malloc((__pyx_v_self->K * (sizeof(int *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1677")'> 1677:                             for admx_idx4 in range(self.K):</pre>
<pre id='line1677' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1677
 *                             self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>double **> malloc(self.K * sizeof(double *))
 *                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>int **> malloc(self.K * sizeof(int *))
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 */
            __pyx_t_11 = __pyx_v_self->K;
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1678")'> 1678:                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line1678' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1678
 *                             self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3] = <code><</code>int **> malloc(self.K * sizeof(int *))
 *                             for admx_idx4 in range(self.K):
 *                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 */
              (((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1679")'> 1679:                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line1679' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1679
 *                             for admx_idx4 in range(self.K):
 *                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>int *> malloc(2 * sizeof(int))
 */
              (((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1680")'> 1680:                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;double *&gt; malloc(2 * sizeof(double))</pre>
<pre id='line1680' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1680
 *                                 self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>int *> malloc(2 * sizeof(int))
 *                                 for ibd in range(2):
 */
              (((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((double *)malloc((2 * (sizeof(double)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1681")'> 1681:                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = &lt;int *&gt; malloc(2 * sizeof(int))</pre>
<pre id='line1681' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1681
 *                                 self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>int *> malloc(2 * sizeof(int))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
              (((((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]) = ((int *)malloc((2 * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1682")'> 1682:                                 for ibd in range(2):</pre>
<pre id='line1682' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1682
 *                                 self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>double *> malloc(2 * sizeof(double))
 *                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>int *> malloc(2 * sizeof(int))
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
              for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> 2; __pyx_t_13+=1) {
                __pyx_v_ibd = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1683")'> 1683:                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1683' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1683
 *                                 self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4] = <code><</code>int *> malloc(2 * sizeof(int))
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
                ((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1684")'> 1684:                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1684' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1684
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
                ((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1685")'> 1685:                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1685' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1685
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 */
                ((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line1686")'> 1686:                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1686' class='code' style='background-color: #FFFF86'>
                /* "LDModel.pyx":1686
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef top_level_init(self):
 */
                ((((((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0;
              }
            }
          }
        }
      }
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_alloc_mem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_81top_level_alloc_mem(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_81top_level_alloc_mem(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_alloc_mem (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_80top_level_alloc_mem(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1687")'> 1687: </pre>
<pre id='line1687' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line1688")'> 1688:     cpdef top_level_init(self):</pre>
<pre id='line1688' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":1688
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 *     cpdef top_level_init(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_83top_level_init(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_top_level_init(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_init", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_init", __pyx_f[0], 1688);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__top_level_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_83top_level_init)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1688
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 *     cpdef top_level_init(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_82top_level_init(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_init", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_init", __pyx_f[0], 1688);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->top_level_init(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1689")'> 1689:         cdef int win_idx</pre>
<pre id='line1689' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1690")'> 1690:         cdef int admx_idx1</pre>
<pre id='line1690' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1691")'> 1691:         cdef int admx_idx2</pre>
<pre id='line1691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1692")'> 1692:         cdef int admx_idx3</pre>
<pre id='line1692' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1693")'> 1693:         cdef int admx_idx4</pre>
<pre id='line1693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1694")'> 1694:         cdef int ibd</pre>
<pre id='line1694' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1695")'> 1695: </pre>
<pre id='line1695' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1696")'> 1696:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1696' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1696
 *         cdef int ibd
 * 
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1697")'> 1697:             #print "initializing window %d" % win_idx</pre>
<pre id='line1697' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1698")'> 1698:             if self._ibs[win_idx]:</pre>
<pre id='line1698' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1698
 *         for win_idx in range(self.get_num_windows()):
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._top_level_scale_factor[win_idx] = 0
 *                 for admx_idx1 in range(self.K):
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1699")'> 1699:                 self._top_level_scale_factor[win_idx] = 0</pre>
<pre id='line1699' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1699
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:
 *                 self._top_level_scale_factor[win_idx] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 */
      (__pyx_v_self->_top_level_scale_factor[__pyx_v_win_idx]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1700")'> 1700:                 for admx_idx1 in range(self.K):</pre>
<pre id='line1700' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1700
 *             if self._ibs[win_idx]:
 *                 self._top_level_scale_factor[win_idx] = 0
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 */
      __pyx_t_5 = __pyx_v_self->K;
      for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1701")'> 1701:                     for admx_idx2 in range(self.K):</pre>
<pre id='line1701' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1701
 *                 self._top_level_scale_factor[win_idx] = 0
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 */
        __pyx_t_7 = __pyx_v_self->K;
        for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1702")'> 1702:                         for admx_idx3 in range(self.K):</pre>
<pre id='line1702' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1702
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 */
          __pyx_t_9 = __pyx_v_self->K;
          for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1703")'> 1703:                             for admx_idx4 in range(self.K):</pre>
<pre id='line1703' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1703
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
            __pyx_t_11 = __pyx_v_self->K;
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1704")'> 1704:                                 for ibd in range(2):</pre>
<pre id='line1704' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1704
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
              for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> 2; __pyx_t_13+=1) {
                __pyx_v_ibd = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1705")'> 1705:                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1705' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1705
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
                ((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1706")'> 1706:                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1706' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1706
 *                                 for ibd in range(2):
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
                ((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1707")'> 1707:                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1707' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1707
 *                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 */
                ((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line1708")'> 1708:                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1708' class='code' style='background-color: #FFFF86'>
                /* "LDModel.pyx":1708
 *                                     self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef top_level_print(self):
 */
                ((((((__pyx_v_self->_top_level_backtrack[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0;
              }
            }
          }
        }
      }
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_83top_level_init(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_83top_level_init(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_init (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_82top_level_init(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1709")'> 1709: </pre>
<pre id='line1709' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line1710")'> 1710:     cpdef top_level_print(self):</pre>
<pre id='line1710' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":1710
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 *     cpdef top_level_print(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_85top_level_print(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_top_level_print(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  double __pyx_v_curr_gamma;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_print", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_print", __pyx_f[0], 1710);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__top_level_print);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_85top_level_print)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1710
 *                                     self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 * 
 *     cpdef top_level_print(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_84top_level_print(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_print", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("top_level_print", __pyx_f[0], 1710);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->top_level_print(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_print", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1711")'> 1711:         cdef int win_idx</pre>
<pre id='line1711' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1712")'> 1712:         cdef int admx_idx1</pre>
<pre id='line1712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1713")'> 1713:         cdef int admx_idx2</pre>
<pre id='line1713' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1714")'> 1714:         cdef int admx_idx3</pre>
<pre id='line1714' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1715")'> 1715:         cdef int admx_idx4</pre>
<pre id='line1715' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1716")'> 1716:         cdef int ibd</pre>
<pre id='line1716' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1717")'> 1717: </pre>
<pre id='line1717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1718")'> 1718:         self._probs_file.write("ind1 ind2 win admx1 admx2 admx3 admx4 ibd forward backward gamma emission alpha1 alpha2 alpha3 alpha4 s1 s2 s3 s4\n")</pre>
<pre id='line1718' class='code' style='background-color: #FFFF57'>
  /* "LDModel.pyx":1718
 *         cdef int ibd
 * 
 *         self._probs_file.write("ind1 ind2 win admx1 admx2 admx3 admx4 ibd forward backward gamma emission alpha1 alpha2 alpha3 alpha4 s1 s2 s3 s4\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             #print "initializing window %d" % win_idx
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_probs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_67), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "LDModel.pyx":1718
 *         cdef int ibd
 * 
 *         self._probs_file.write("ind1 ind2 win admx1 admx2 admx3 admx4 ibd forward backward gamma emission alpha1 alpha2 alpha3 alpha4 s1 s2 s3 s4\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             #print "initializing window %d" % win_idx
 */
  __pyx_k_tuple_67 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_67)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_67);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_66));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_67, 0, ((PyObject *)__pyx_kp_s_66));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_66));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_67));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1719")'> 1719:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1719' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1719
 * 
 *         self._probs_file.write("ind1 ind2 win admx1 admx2 admx3 admx4 ibd forward backward gamma emission alpha1 alpha2 alpha3 alpha4 s1 s2 s3 s4\n")
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1720")'> 1720:             #print "initializing window %d" % win_idx</pre>
<pre id='line1720' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1721")'> 1721:             if self._ibs[win_idx]:</pre>
<pre id='line1721' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1721
 *         for win_idx in range(self.get_num_windows()):
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1722")'> 1722:                 for admx_idx1 in range(self.K):</pre>
<pre id='line1722' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1722
 *             #print "initializing window %d" % win_idx
 *             if self._ibs[win_idx]:
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 */
      __pyx_t_5 = __pyx_v_self->K;
      for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1723")'> 1723:                     for admx_idx2 in range(self.K):</pre>
<pre id='line1723' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1723
 *             if self._ibs[win_idx]:
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 */
        __pyx_t_7 = __pyx_v_self->K;
        for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1724")'> 1724:                         for admx_idx3 in range(self.K):</pre>
<pre id='line1724' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1724
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 */
          __pyx_t_9 = __pyx_v_self->K;
          for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1725")'> 1725:                             for admx_idx4 in range(self.K):</pre>
<pre id='line1725' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1725
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 */
            __pyx_t_11 = __pyx_v_self->K;
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1726")'> 1726:                                 for ibd in range(2):</pre>
<pre id='line1726' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1726
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +
 */
              for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> 2; __pyx_t_13+=1) {
                __pyx_v_ibd = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1727")'> 1727:                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])</pre>
<pre id='line1727' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1727
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +
 *                                     str(admx_idx1) + " " +
 */
                __pyx_v_curr_gamma = (((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) + ((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line1728")'> 1728:                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +</pre>
<pre id='line1728' class='code' style='background-color: #FFFF2d'>
                /* "LDModel.pyx":1728
 *                                 for ibd in range(2):
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx1) + " " +
 *                                     str(admx_idx2) + " " +
 */
                __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_probs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);

                /* "LDModel.pyx":1729
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +
 *                                     str(admx_idx1) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx2) + " " +
 *                                     str(admx_idx3) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_prefix_string);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;

                /* "LDModel.pyx":1728
 *                                 for ibd in range(2):
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx1) + " " +
 *                                     str(admx_idx2) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1729")'> 1729:                                     str(admx_idx1) + " " +</pre>
<pre id='line1729' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1729
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +
 *                                     str(admx_idx1) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx2) + " " +
 *                                     str(admx_idx3) + " " +
 */
                __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1730")'> 1730:                                     str(admx_idx2) + " " +</pre>
<pre id='line1730' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1730
 *                                     self._probs_file.write(self._prefix_string + " " + str(win_idx) + " " +
 *                                     str(admx_idx1) + " " +
 *                                     str(admx_idx2) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx3) + " " +
 *                                     str(admx_idx4) + " " +
 */
                __pyx_t_14 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1731")'> 1731:                                     str(admx_idx3) + " " +</pre>
<pre id='line1731' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1731
 *                                     str(admx_idx1) + " " +
 *                                     str(admx_idx2) + " " +
 *                                     str(admx_idx3) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(admx_idx4) + " " +
 *                                     str(ibd) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1732")'> 1732:                                     str(admx_idx4) + " " +</pre>
<pre id='line1732' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1732
 *                                     str(admx_idx2) + " " +
 *                                     str(admx_idx3) + " " +
 *                                     str(admx_idx4) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(ibd) + " " +
 *                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 */
                __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx4);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1733")'> 1733:                                     str(ibd) + " " +</pre>
<pre id='line1733' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1733
 *                                     str(admx_idx3) + " " +
 *                                     str(admx_idx4) + " " +
 *                                     str(ibd) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 */
                __pyx_t_14 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ibd);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1734")'> 1734:                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +</pre>
<pre id='line1734' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1734
 *                                     str(admx_idx4) + " " +
 *                                     str(ibd) + " " +
 *                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(curr_gamma) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1735")'> 1735:                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +</pre>
<pre id='line1735' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1735
 *                                     str(ibd) + " " +
 *                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(curr_gamma) + " " +
 *                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 */
                __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1736")'> 1736:                                     str(curr_gamma) + " " +</pre>
<pre id='line1736' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1736
 *                                     str(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(curr_gamma) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._alphas[admx_idx1]) + " " +
 */
                __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_gamma);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1737")'> 1737:                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +</pre>
<pre id='line1737' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1737
 *                                     str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(curr_gamma) + " " +
 *                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._alphas[admx_idx1]) + " " +
 *                                     str(self._alphas[admx_idx2]) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1738")'> 1738:                                     str(self._alphas[admx_idx1]) + " " +</pre>
<pre id='line1738' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1738
 *                                     str(curr_gamma) + " " +
 *                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._alphas[admx_idx1]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._alphas[admx_idx2]) + " " +
 *                                     str(self._alphas[admx_idx3]) + " " +
 */
                __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_alphas[__pyx_v_admx_idx1]));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1739")'> 1739:                                     str(self._alphas[admx_idx2]) + " " +</pre>
<pre id='line1739' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1739
 *                                     str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                     str(self._alphas[admx_idx1]) + " " +
 *                                     str(self._alphas[admx_idx2]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._alphas[admx_idx3]) + " " +
 *                                     str(self._alphas[admx_idx4]) + " " +
 */
                __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_alphas[__pyx_v_admx_idx2]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1740")'> 1740:                                     str(self._alphas[admx_idx3]) + " " +</pre>
<pre id='line1740' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1740
 *                                     str(self._alphas[admx_idx1]) + " " +
 *                                     str(self._alphas[admx_idx2]) + " " +
 *                                     str(self._alphas[admx_idx3]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._alphas[admx_idx4]) + " " +
 *                                     str(self._s[0][win_idx][0][0]) + " " +
 */
                __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_alphas[__pyx_v_admx_idx3]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1741")'> 1741:                                     str(self._alphas[admx_idx4]) + " " +</pre>
<pre id='line1741' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1741
 *                                     str(self._alphas[admx_idx2]) + " " +
 *                                     str(self._alphas[admx_idx3]) + " " +
 *                                     str(self._alphas[admx_idx4]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._s[0][win_idx][0][0]) + " " +
 *                                     str(self._s[0][win_idx][0][1]) + " " +
 */
                __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_alphas[__pyx_v_admx_idx4]));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1742")'> 1742:                                     str(self._s[0][win_idx][0][0]) + " " +</pre>
<pre id='line1742' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1742
 *                                     str(self._alphas[admx_idx3]) + " " +
 *                                     str(self._alphas[admx_idx4]) + " " +
 *                                     str(self._s[0][win_idx][0][0]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._s[0][win_idx][0][1]) + " " +
 *                                     str(self._s[0][win_idx][1][0]) + " " +
 */
                __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_s[0])[__pyx_v_win_idx])[0])[0]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1743")'> 1743:                                     str(self._s[0][win_idx][0][1]) + " " +</pre>
<pre id='line1743' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1743
 *                                     str(self._alphas[admx_idx4]) + " " +
 *                                     str(self._s[0][win_idx][0][0]) + " " +
 *                                     str(self._s[0][win_idx][0][1]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._s[0][win_idx][1][0]) + " " +
 *                                     str(self._s[0][win_idx][1][1]) + "\n")
 */
                __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_s[0])[__pyx_v_win_idx])[0])[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1744")'> 1744:                                     str(self._s[0][win_idx][1][0]) + " " +</pre>
<pre id='line1744' class='code' style='background-color: #FFFF3f'>
                /* "LDModel.pyx":1744
 *                                     str(self._s[0][win_idx][0][0]) + " " +
 *                                     str(self._s[0][win_idx][0][1]) + " " +
 *                                     str(self._s[0][win_idx][1][0]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     str(self._s[0][win_idx][1][1]) + "\n")
 *         self._probs_file.flush()
 */
                __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_s[0])[__pyx_v_win_idx])[1])[0]));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_15);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
                __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line1745")'> 1745:                                     str(self._s[0][win_idx][1][1]) + "\n")</pre>
<pre id='line1745' class='code' style='background-color: #FFFF2f'>
                /* "LDModel.pyx":1745
 *                                     str(self._s[0][win_idx][0][1]) + " " +
 *                                     str(self._s[0][win_idx][1][0]) + " " +
 *                                     str(self._s[0][win_idx][1][1]) + "\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._probs_file.flush()
 * 
 */
                __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((__pyx_v_self->_s[0])[__pyx_v_win_idx])[1])[1]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
                __pyx_t_14 = 0;
                __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
              }
            }
          }
        }
      }
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line1746")'> 1746:         self._probs_file.flush()</pre>
<pre id='line1746' class='code' style='background-color: #FFFF4d'>
  /* "LDModel.pyx":1746
 *                                     str(self._s[0][win_idx][1][0]) + " " +
 *                                     str(self._s[0][win_idx][1][1]) + "\n")
 *         self._probs_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef print_inner_probs(self, win_idx, bool post):
 */
  __pyx_t_14 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_probs_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_14, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.top_level_print", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_85top_level_print(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_85top_level_print(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("top_level_print (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_84top_level_print(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1747")'> 1747: </pre>
<pre id='line1747' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line1748")'> 1748:     cpdef print_inner_probs(self, win_idx, bool post):</pre>
<pre id='line1748' class='code' style='background-color: #FFFF34'>
/* "LDModel.pyx":1748
 *         self._probs_file.flush()
 * 
 *     cpdef print_inner_probs(self, win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         snp_idx_win = 0
 *         if not post:
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_87print_inner_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_print_inner_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_win_idx, bool __pyx_v_post, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_snp_idx_win = NULL;
  int __pyx_v_start_snp;
  int __pyx_v_end_snp;
  int __pyx_v_snp_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_node_idx1;
  int __pyx_v_node_idx2;
  int __pyx_v_node_idx3;
  int __pyx_v_node_idx4;
  long __pyx_v_ibd;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_inner_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_inner_probs", __pyx_f[0], 1748);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__print_inner_probs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_87print_inner_probs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_post);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_win_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_win_idx);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_win_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1748
 *         self._probs_file.flush()
 * 
 *     cpdef print_inner_probs(self, win_idx, bool post):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         snp_idx_win = 0
 *         if not post:
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_86print_inner_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_win_idx, bool __pyx_v_post) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_inner_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("print_inner_probs", __pyx_f[0], 1748);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->print_inner_probs(__pyx_v_self, __pyx_v_win_idx, __pyx_v_post, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_inner_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1749")'> 1749:         snp_idx_win = 0</pre>
<pre id='line1749' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":1749
 * 
 *     cpdef print_inner_probs(self, win_idx, bool post):
 *         snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_snp_idx_win = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1750")'> 1750:         if not post:</pre>
<pre id='line1750' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1750
 *     cpdef print_inner_probs(self, win_idx, bool post):
 *         snp_idx_win = 0
 *         if not post:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)
 */
  __pyx_t_4 = (!__pyx_v_post);
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1751")'> 1751:             start_snp = self.start_snp(win_idx)</pre>
<pre id='line1751' class='code' style='background-color: #FFFF7f'>
    /* "LDModel.pyx":1751
 *         snp_idx_win = 0
 *         if not post:
 *             start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_snp = self.end_snp(win_idx)
 *         else:
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_5);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1752")'> 1752:             end_snp = self.end_snp(win_idx)</pre>
<pre id='line1752' class='code' style='background-color: #FFFF7f'>
    /* "LDModel.pyx":1752
 *         if not post:
 *             start_snp = self.start_snp(win_idx)
 *             end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_5);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1753")'> 1753:         else:</pre>
<pre id='line1753' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1754")'> 1754:             if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1754' class='code' style='background-color: #FFFF7f'>
    /* "LDModel.pyx":1754
 *             end_snp = self.end_snp(win_idx)
 *         else:
 *             if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if ((__pyx_v_self->_ibd_segment_start[__pyx_t_6])) {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1755")'> 1755:                 start_snp = self.start_snp(win_idx-2)</pre>
<pre id='line1755' class='code' style='background-color: #FFFF62'>
      /* "LDModel.pyx":1755
 *         else:
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_win_idx, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_5);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1756")'> 1756:                 end_snp = self.end_snp(win_idx)</pre>
<pre id='line1756' class='code' style='background-color: #FFFF7f'>
      /* "LDModel.pyx":1756
 *             if self._ibd_segment_start[win_idx]:
 *                 start_snp = self.start_snp(win_idx-2)
 *                 end_snp = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 */
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_5);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1757")'> 1757:             else:</pre>
<pre id='line1757' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1758")'> 1758:                 start_snp = self.start_snp(win_idx)</pre>
<pre id='line1758' class='code' style='background-color: #FFFF7f'>
      /* "LDModel.pyx":1758
 *                 end_snp = self.end_snp(win_idx)
 *             else:
 *                 start_snp = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 */
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1758; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_start_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_5);
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1759")'> 1759:                 end_snp = self.end_snp(win_idx+2)</pre>
<pre id='line1759' class='code' style='background-color: #FFFF62'>
      /* "LDModel.pyx":1759
 *             else:
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_win_idx, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_end_snp = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_5);
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1760")'> 1760:         for snp_idx in range(start_snp, end_snp):</pre>
<pre id='line1760' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1760
 *                 start_snp = self.start_snp(win_idx)
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 */
  __pyx_t_5 = __pyx_v_end_snp;
  for (__pyx_t_7 = __pyx_v_start_snp; __pyx_t_7 <code><</code> __pyx_t_5; __pyx_t_7+=1) {
    __pyx_v_snp_idx = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1761")'> 1761:             for admx_idx1 in range(self.K):</pre>
<pre id='line1761' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1761
 *                 end_snp = self.end_snp(win_idx+2)
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 */
    __pyx_t_8 = __pyx_v_self->K;
    for (__pyx_t_9 = 0; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_admx_idx1 = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1762")'> 1762:                 for admx_idx2 in range(self.K):</pre>
<pre id='line1762' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1762
 *         for snp_idx in range(start_snp, end_snp):
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 */
      __pyx_t_10 = __pyx_v_self->K;
      for (__pyx_t_11 = 0; __pyx_t_11 <code><</code> __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_admx_idx2 = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1763")'> 1763:                     for admx_idx3 in range(self.K):</pre>
<pre id='line1763' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1763
 *             for admx_idx1 in range(self.K):
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 */
        __pyx_t_12 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_admx_idx3 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1764")'> 1764:                         for admx_idx4 in range(self.K):</pre>
<pre id='line1764' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1764
 *                 for admx_idx2 in range(self.K):
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx4 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1765")'> 1765:                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):</pre>
<pre id='line1765' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1765
 *                     for admx_idx3 in range(self.K):
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 */
            __pyx_t_16 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx1])[__pyx_v_snp_idx]);
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_node_idx1 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1766")'> 1766:                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):</pre>
<pre id='line1766' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1766
 *                         for admx_idx4 in range(self.K):
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 */
              __pyx_t_18 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx2])[__pyx_v_snp_idx]);
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_node_idx2 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1767")'> 1767:                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):</pre>
<pre id='line1767' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1767
 *                             for node_idx1 in range(self._layer_state_nums[admx_idx1][snp_idx]):
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 */
                __pyx_t_20 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx3])[__pyx_v_snp_idx]);
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_node_idx3 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1768")'> 1768:                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):</pre>
<pre id='line1768' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1768
 *                                 for node_idx2 in range(self._layer_state_nums[admx_idx2][snp_idx]):
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for ibd in range(2):
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +
 */
                  __pyx_t_22 = ((__pyx_v_self->_layer_state_nums[__pyx_v_admx_idx4])[__pyx_v_snp_idx]);
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_node_idx4 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1769")'> 1769:                                             for ibd in range(2):</pre>
<pre id='line1769' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1769
 *                                     for node_idx3 in range(self._layer_state_nums[admx_idx3][snp_idx]):
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +
 *                                                           str(admx_idx1) + " " +
 */
                    for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> 2; __pyx_t_24+=1) {
                      __pyx_v_ibd = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line1770")'> 1770:                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +</pre>
<pre id='line1770' class='code' style='background-color: #FFFF2d'>
                      /* "LDModel.pyx":1770
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx1) + " " +
 *                                                           str(admx_idx2) + " " +
 */
                      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);

                      /* "LDModel.pyx":1771
 *                                             for ibd in range(2):
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +
 *                                                           str(admx_idx1) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx2) + " " +
 *                                                           str(admx_idx3) + " " +
 */
                      __pyx_t_2 = <span class='py_c_api'>PyBytes_FromString</span>(__pyx_v_self->_prefix_string);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_2), ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;

                      /* "LDModel.pyx":1770
 *                                         for node_idx4 in range(self._layer_state_nums[admx_idx4][snp_idx]):
 *                                             for ibd in range(2):
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx1) + " " +
 *                                                           str(admx_idx2) + " " +
 */
                      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1771")'> 1771:                                                           str(admx_idx1) + " " +</pre>
<pre id='line1771' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1771
 *                                             for ibd in range(2):
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +
 *                                                           str(admx_idx1) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx2) + " " +
 *                                                           str(admx_idx3) + " " +
 */
                      __pyx_t_25 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_25);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_25);
                      __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1772")'> 1772:                                                           str(admx_idx2) + " " +</pre>
<pre id='line1772' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1772
 *                                                 self._inner_probs_file.write(self._prefix_string + " " + str(snp_idx) + " " +
 *                                                           str(admx_idx1) + " " +
 *                                                           str(admx_idx2) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx3) + " " +
 *                                                           str(admx_idx4) + " " +
 */
                      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                      __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1773")'> 1773:                                                           str(admx_idx3) + " " +</pre>
<pre id='line1773' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1773
 *                                                           str(admx_idx1) + " " +
 *                                                           str(admx_idx2) + " " +
 *                                                           str(admx_idx3) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(admx_idx4) + " " +
 *                                                           str(node_idx1) + " " +
 */
                      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1774")'> 1774:                                                           str(admx_idx4) + " " +</pre>
<pre id='line1774' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1774
 *                                                           str(admx_idx2) + " " +
 *                                                           str(admx_idx3) + " " +
 *                                                           str(admx_idx4) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(node_idx1) + " " +
 *                                                           str(node_idx2) + " " +
 */
                      __pyx_t_25 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_admx_idx4);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_25);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_25);
                      __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1775")'> 1775:                                                           str(node_idx1) + " " +</pre>
<pre id='line1775' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1775
 *                                                           str(admx_idx3) + " " +
 *                                                           str(admx_idx4) + " " +
 *                                                           str(node_idx1) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(node_idx2) + " " +
 *                                                           str(node_idx3) + " " +
 */
                      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                      __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1776")'> 1776:                                                           str(node_idx2) + " " +</pre>
<pre id='line1776' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1776
 *                                                           str(admx_idx4) + " " +
 *                                                           str(node_idx1) + " " +
 *                                                           str(node_idx2) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(node_idx3) + " " +
 *                                                           str(node_idx4) + " " +
 */
                      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1777")'> 1777:                                                           str(node_idx3) + " " +</pre>
<pre id='line1777' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1777
 *                                                           str(node_idx1) + " " +
 *                                                           str(node_idx2) + " " +
 *                                                           str(node_idx3) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(node_idx4) + " " +
 *                                                           str(ibd) + " " +
 */
                      __pyx_t_25 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx3);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_25);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_25);
                      __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1778")'> 1778:                                                           str(node_idx4) + " " +</pre>
<pre id='line1778' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1778
 *                                                           str(node_idx2) + " " +
 *                                                           str(node_idx3) + " " +
 *                                                           str(node_idx4) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(ibd) + " " +
 *                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +
 */
                      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_node_idx4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                      __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1779")'> 1779:                                                           str(ibd) + " " +</pre>
<pre id='line1779' class='code' style='background-color: #FFFF3f'>
                      /* "LDModel.pyx":1779
 *                                                           str(node_idx3) + " " +
 *                                                           str(node_idx4) + " " +
 *                                                           str(ibd) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +
 *                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 */
                      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ibd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1780")'> 1780:                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +</pre>
<pre id='line1780' class='code' style='background-color: #FFFF33'>
                      /* "LDModel.pyx":1780
 *                                                           str(node_idx4) + " " +
 *                                                           str(ibd) + " " +
 *                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")
 */
                      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      __pyx_t_25 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((((((__pyx_v_self->_forward_probs_ibd_admx[__pyx_t_6])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_25);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_25);
                      __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1781")'> 1781:                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +</pre>
<pre id='line1781' class='code' style='background-color: #FFFF33'>
                      /* "LDModel.pyx":1781
 *                                                           str(ibd) + " " +
 *                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +
 *                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")
 *             snp_idx_win+=1
 */
                      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_scale_factor[__pyx_t_6])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
                      __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line1782")'> 1782:                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")</pre>
<pre id='line1782' class='code' style='background-color: #FFFF27'>
                      /* "LDModel.pyx":1782
 *                                                           str(self._forward_probs_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4][ibd]) + " " +
 *                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             snp_idx_win+=1
 *         self._inner_probs_file.flush()
 */
                      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((((((((__pyx_v_self->_emission_prob_ibd_admx[__pyx_t_6])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_node_idx1])[__pyx_v_node_idx2])[__pyx_v_node_idx3])[__pyx_v_node_idx4]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
                      __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
                      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_2);
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                      __pyx_t_2 = 0;
                      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_25)); __pyx_t_25 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1783")'> 1783:             snp_idx_win+=1</pre>
<pre id='line1783' class='code' style='background-color: #FFFF9f'>
    /* "LDModel.pyx":1783
 *                                                           str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " +
 *                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")
 *             snp_idx_win+=1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._inner_probs_file.flush()
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_snp_idx_win, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_snp_idx_win);
    __pyx_v_snp_idx_win = __pyx_t_2;
    __pyx_t_2 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line1784")'> 1784:         self._inner_probs_file.flush()</pre>
<pre id='line1784' class='code' style='background-color: #FFFF22'>
  /* "LDModel.pyx":1784
 *                                                           str(self._emission_prob_ibd_admx[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][node_idx1][node_idx2][node_idx3][node_idx4]) + "\n")
 *             snp_idx_win+=1
 *         self._inner_probs_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_top_level_ems_probs_inner(self):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_25 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_inner_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_87print_inner_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_87print_inner_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_win_idx = 0;
  bool __pyx_v_post;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("print_inner_probs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__win_idx,&__pyx_n_s__post,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__win_idx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__post)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("print_inner_probs", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "print_inner_probs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_win_idx = values[0];
    __pyx_v_post = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_post == (bool)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("print_inner_probs", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1748; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.print_inner_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_86print_inner_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_win_idx, __pyx_v_post);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1785")'> 1785: </pre>
<pre id='line1785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line1786")'> 1786:     cpdef calc_top_level_ems_probs_inner(self):</pre>
<pre id='line1786' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":1786
 *         self._inner_probs_file.flush()
 * 
 *     cpdef calc_top_level_ems_probs_inner(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_89calc_top_level_ems_probs_inner(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_top_level_ems_probs_inner(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  double __pyx_v_tmp;
  PyObject *__pyx_v_snp_idx_win = NULL;
  CYTHON_UNUSED int __pyx_v_snp_idx;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs_inner", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_ems_probs_inner", __pyx_f[0], 1786);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_68);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_89calc_top_level_ems_probs_inner)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1786
 *         self._inner_probs_file.flush()
 * 
 *     cpdef calc_top_level_ems_probs_inner(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_88calc_top_level_ems_probs_inner(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs_inner", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_ems_probs_inner", __pyx_f[0], 1786);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_ems_probs_inner(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_ems_probs_inner", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1787")'> 1787:         cdef int win_idx</pre>
<pre id='line1787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1788")'> 1788:         cdef int node_idx1</pre>
<pre id='line1788' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1789")'> 1789:         cdef int node_idx2</pre>
<pre id='line1789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1790")'> 1790:         cdef int node_idx3</pre>
<pre id='line1790' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1791")'> 1791:         cdef int node_idx4</pre>
<pre id='line1791' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1792")'> 1792:         cdef int admx_idx1</pre>
<pre id='line1792' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1793")'> 1793:         cdef int admx_idx2</pre>
<pre id='line1793' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1794")'> 1794:         cdef int admx_idx3</pre>
<pre id='line1794' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1795")'> 1795:         cdef int admx_idx4</pre>
<pre id='line1795' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1796")'> 1796:         cdef int ibd</pre>
<pre id='line1796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1797")'> 1797:         cdef double tmp</pre>
<pre id='line1797' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1798")'> 1798: </pre>
<pre id='line1798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1799")'> 1799:         if self._debug:</pre>
<pre id='line1799' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1799
 *         cdef double tmp
 * 
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward scaling emission\n")
 * 
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1800")'> 1800:             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward scaling emission\n")</pre>
<pre id='line1800' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":1800
 * 
 *         if self._debug:
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward scaling emission\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(self.get_num_windows()):
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_70), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "LDModel.pyx":1800
 * 
 *         if self._debug:
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward scaling emission\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(self.get_num_windows()):
 */
  __pyx_k_tuple_70 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_70)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_70);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_69));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_70, 0, ((PyObject *)__pyx_kp_s_69));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_69));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_70));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1801")'> 1801: </pre>
<pre id='line1801' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1802")'> 1802:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1802' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1802
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward scaling emission\n")
 * 
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1803")'> 1803:             if self._ibs[win_idx]:</pre>
<pre id='line1803' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1803
 * 
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)
 *                 self.calc_emission_probs_ibd_admx(win_idx,False)
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1804")'> 1804:                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)</pre>
<pre id='line1804' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1804
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_emission_probs_ibd_admx(win_idx,False)
 *                 self.scale_factors_mem_alloc(win_idx,False)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1805")'> 1805:                 self.calc_emission_probs_ibd_admx(win_idx,False)</pre>
<pre id='line1805' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1805
 *             if self._ibs[win_idx]:
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)
 *                 self.calc_emission_probs_ibd_admx(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.scale_factors_mem_alloc(win_idx,False)
 *                 self.forward_probs_mem_alloc(win_idx,False)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_emission_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1806")'> 1806:                 self.scale_factors_mem_alloc(win_idx,False)</pre>
<pre id='line1806' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1806
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx,False)
 *                 self.calc_emission_probs_ibd_admx(win_idx,False)
 *                 self.scale_factors_mem_alloc(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.forward_probs_mem_alloc(win_idx,False)
 *                 self.calc_forward_probs_ibd_admx(win_idx,False)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1807")'> 1807:                 self.forward_probs_mem_alloc(win_idx,False)</pre>
<pre id='line1807' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1807
 *                 self.calc_emission_probs_ibd_admx(win_idx,False)
 *                 self.scale_factors_mem_alloc(win_idx,False)
 *                 self.forward_probs_mem_alloc(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_forward_probs_ibd_admx(win_idx,False)
 *                 self.backward_probs_mem_alloc(win_idx,False)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1808")'> 1808:                 self.calc_forward_probs_ibd_admx(win_idx,False)</pre>
<pre id='line1808' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1808
 *                 self.scale_factors_mem_alloc(win_idx,False)
 *                 self.forward_probs_mem_alloc(win_idx,False)
 *                 self.calc_forward_probs_ibd_admx(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.backward_probs_mem_alloc(win_idx,False)
 *                 self.calc_backward_probs_ibd_admx(win_idx,False)
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_forward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1809")'> 1809:                 self.backward_probs_mem_alloc(win_idx,False)</pre>
<pre id='line1809' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1809
 *                 self.forward_probs_mem_alloc(win_idx,False)
 *                 self.calc_forward_probs_ibd_admx(win_idx,False)
 *                 self.backward_probs_mem_alloc(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_backward_probs_ibd_admx(win_idx,False)
 * 
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->backward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1810")'> 1810:                 self.calc_backward_probs_ibd_admx(win_idx,False)</pre>
<pre id='line1810' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1810
 *                 self.calc_forward_probs_ibd_admx(win_idx,False)
 *                 self.backward_probs_mem_alloc(win_idx,False)
 *                 self.calc_backward_probs_ibd_admx(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._debug:
 */
      __pyx_t_2 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_backward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1811")'> 1811: </pre>
<pre id='line1811' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1812")'> 1812:                 if self._debug:</pre>
<pre id='line1812' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1812
 *                 self.calc_backward_probs_ibd_admx(win_idx,False)
 * 
 *                 if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self.print_inner_probs(win_idx,False)
 *                 #self.backward_probs_mem_alloc(win_idx)
 */
      if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line1813")'> 1813:                     self.print_inner_probs(win_idx,False)</pre>
<pre id='line1813' class='code' style='background-color: #FFFF96'>
        /* "LDModel.pyx":1813
 * 
 *                 if self._debug:
 *                     self.print_inner_probs(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #self.backward_probs_mem_alloc(win_idx)
 *                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)
 */
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->print_inner_probs(__pyx_v_self, __pyx_t_2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1814")'> 1814:                 #self.backward_probs_mem_alloc(win_idx)</pre>
<pre id='line1814' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1815")'> 1815:                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)</pre>
<pre id='line1815' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1816")'> 1816:                 for admx_idx1 in range(self.K):</pre>
<pre id='line1816' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1816
 *                 #self.backward_probs_mem_alloc(win_idx)
 *                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 */
      __pyx_t_5 = __pyx_v_self->K;
      for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1817")'> 1817:                     for admx_idx2 in range(self.K):</pre>
<pre id='line1817' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1817
 *                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 */
        __pyx_t_7 = __pyx_v_self->K;
        for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1818")'> 1818:                         for admx_idx3 in range(self.K):</pre>
<pre id='line1818' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1818
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 */
          __pyx_t_9 = __pyx_v_self->K;
          for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1819")'> 1819:                             for admx_idx4 in range(self.K):</pre>
<pre id='line1819' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1819
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 *                                     snp_idx_win = 0
 */
            __pyx_t_11 = __pyx_v_self->K;
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1820")'> 1820:                                 for ibd in range(2):</pre>
<pre id='line1820' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1820
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     snp_idx_win = 0
 *                                     tmp = 0
 */
              for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> 2; __pyx_t_13+=1) {
                __pyx_v_ibd = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1821")'> 1821:                                     snp_idx_win = 0</pre>
<pre id='line1821' class='code' style='background-color: #FFFFd4'>
                /* "LDModel.pyx":1821
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 *                                     snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     tmp = 0
 *                                     for snp_idx in range(self.start_snp(win_idx), self.end_snp(win_idx)):
 */
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
                __pyx_v_snp_idx_win = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1822")'> 1822:                                     tmp = 0</pre>
<pre id='line1822' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1822
 *                                 for ibd in range(2):
 *                                     snp_idx_win = 0
 *                                     tmp = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for snp_idx in range(self.start_snp(win_idx), self.end_snp(win_idx)):
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 */
                __pyx_v_tmp = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1823")'> 1823:                                     for snp_idx in range(self.start_snp(win_idx), self.end_snp(win_idx)):</pre>
<pre id='line1823' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1823
 *                                     snp_idx_win = 0
 *                                     tmp = 0
 *                                     for snp_idx in range(self.start_snp(win_idx), self.end_snp(win_idx)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 */
                __pyx_t_14 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
                for (__pyx_t_15 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx); __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
                  __pyx_v_snp_idx = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1824")'> 1824:                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line1824' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1824
 *                                     tmp = 0
 *                                     for snp_idx in range(self.start_snp(win_idx), self.end_snp(win_idx)):
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  ((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) - log(((((((__pyx_v_self->_scale_factor[__pyx_t_16])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1825")'> 1825:                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \</pre>
<pre id='line1825' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1826")'> 1826:                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1826' class='code' style='background-color: #FFFF7f'>
                  /* "LDModel.pyx":1826
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                                         tmp = \
 */
                  __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1827")'> 1827: </pre>
<pre id='line1827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1828")'> 1828:                                         tmp = \</pre>
<pre id='line1828' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1829")'> 1829:                                         tmp - \</pre>
<pre id='line1829' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1830")'> 1830:                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1830' class='code' style='background-color: #FFFF7f'>
                  /* "LDModel.pyx":1830
 *                                         tmp = \
 *                                         tmp - \
 *                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                         print "forward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * #                                         print "backward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_16 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  __pyx_v_tmp = (__pyx_v_tmp - log(((((((__pyx_v_self->_backward_scale_factor[__pyx_t_16])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1831")'> 1831: #                                         print "forward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1831' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1832")'> 1832: #                                         print "backward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1832' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1833")'> 1833:                                         snp_idx_win += 1</pre>
<pre id='line1833' class='code' style='background-color: #FFFF9f'>
                  /* "LDModel.pyx":1833
 * #                                         print "forward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * #                                         print "backward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                                         snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     print str(win_idx) + " " + str(ibd) + " " + str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " + str(tmp)
 *                                     #self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_snp_idx_win, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_snp_idx_win);
                  __pyx_v_snp_idx_win = __pyx_t_1;
                  __pyx_t_1 = 0;
                }
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line1834")'> 1834:                                     print str(win_idx) + " " + str(ibd) + " " + str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " + str(tmp)</pre>
<pre id='line1834' class='code' style='background-color: #FFFF15'>
                /* "LDModel.pyx":1834
 * #                                         print "backward scale factor " + str(snp_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                                         snp_idx_win += 1
 *                                     print str(win_idx) + " " + str(ibd) + " " + str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " + str(tmp)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     #self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                 self.emission_prob_ibd_admx_mem_free(win_idx,False)
 */
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ibd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
                __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_17);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_17);
                __pyx_t_17 = 0;
                __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tmp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                __pyx_t_2 = 0;
                __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              }
            }
          }
        }
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1835")'> 1835:                                     #self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1835' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1836")'> 1836:                 self.emission_prob_ibd_admx_mem_free(win_idx,False)</pre>
<pre id='line1836' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1836
 *                                     print str(win_idx) + " " + str(ibd) + " " + str(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]) + " " + str(tmp)
 *                                     #self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                 self.emission_prob_ibd_admx_mem_free(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.forward_probs_mem_free(win_idx,False)
 *                 self.scale_factors_mem_free(win_idx,False)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_free(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1837")'> 1837:                 self.forward_probs_mem_free(win_idx,False)</pre>
<pre id='line1837' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1837
 *                                     #self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                 self.emission_prob_ibd_admx_mem_free(win_idx,False)
 *                 self.forward_probs_mem_free(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.scale_factors_mem_free(win_idx,False)
 * 
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_free(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1838")'> 1838:                 self.scale_factors_mem_free(win_idx,False)</pre>
<pre id='line1838' class='code' style='background-color: #FFFF73'>
      /* "LDModel.pyx":1838
 *                 self.emission_prob_ibd_admx_mem_free(win_idx,False)
 *                 self.forward_probs_mem_free(win_idx,False)
 *                 self.scale_factors_mem_free(win_idx,False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_free(__pyx_v_self, __pyx_v_win_idx, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L6;
    }
    __pyx_L6:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_ems_probs_inner", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_89calc_top_level_ems_probs_inner(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_89calc_top_level_ems_probs_inner(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs_inner (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_88calc_top_level_ems_probs_inner(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1839")'> 1839: </pre>
<pre id='line1839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line1840")'> 1840:     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):</pre>
<pre id='line1840' class='code' style='background-color: #FFFF27'>
/* "LDModel.pyx":1840
 *                 self.scale_factors_mem_free(win_idx,False)
 * 
 *     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.set_chrs(self._haplos[hap_idx1],self._haplos[hap_idx2],self._haplos[hap_idx3],self._haplos[hap_idx4])
 *         self.calc_top_level_ems_probs_inner()
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_91calc_top_level_ems_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_top_level_ems_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_hap_idx1, int __pyx_v_hap_idx2, int __pyx_v_hap_idx3, int __pyx_v_hap_idx4, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_ems_probs", __pyx_f[0], 1840);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_71);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_91calc_top_level_ems_probs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_hap_idx1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_hap_idx2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_hap_idx3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_hap_idx4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_5);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1840
 *                 self.scale_factors_mem_free(win_idx,False)
 * 
 *     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.set_chrs(self._haplos[hap_idx1],self._haplos[hap_idx2],self._haplos[hap_idx3],self._haplos[hap_idx4])
 *         self.calc_top_level_ems_probs_inner()
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_90calc_top_level_ems_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_hap_idx1, int __pyx_v_hap_idx2, int __pyx_v_hap_idx3, int __pyx_v_hap_idx4) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_ems_probs", __pyx_f[0], 1840);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_ems_probs(__pyx_v_self, __pyx_v_hap_idx1, __pyx_v_hap_idx2, __pyx_v_hap_idx3, __pyx_v_hap_idx4, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_ems_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1841")'> 1841:         self.set_chrs(self._haplos[hap_idx1],self._haplos[hap_idx2],self._haplos[hap_idx3],self._haplos[hap_idx4])</pre>
<pre id='line1841' class='code' style='background-color: #FFFFe7'>
  /* "LDModel.pyx":1841
 * 
 *     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):
 *         self.set_chrs(self._haplos[hap_idx1],self._haplos[hap_idx2],self._haplos[hap_idx3],self._haplos[hap_idx4])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.calc_top_level_ems_probs_inner()
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->set_chrs(__pyx_v_self, (__pyx_v_self->_haplos[__pyx_v_hap_idx1]), (__pyx_v_self->_haplos[__pyx_v_hap_idx2]), (__pyx_v_self->_haplos[__pyx_v_hap_idx3]), (__pyx_v_self->_haplos[__pyx_v_hap_idx4]), 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF16' onclick='toggleDiv("line1842")'> 1842:         self.calc_top_level_ems_probs_inner()</pre>
<pre id='line1842' class='code' style='background-color: #FFFF16'>
  /* "LDModel.pyx":1842
 *     cpdef calc_top_level_ems_probs(self, int hap_idx1, int hap_idx2, int hap_idx3, int hap_idx4):
 *         self.set_chrs(self._haplos[hap_idx1],self._haplos[hap_idx2],self._haplos[hap_idx3],self._haplos[hap_idx4])
 *         self.calc_top_level_ems_probs_inner()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_post_probs(self):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_ems_probs_inner(__pyx_v_self, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_ems_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_91calc_top_level_ems_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_91calc_top_level_ems_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_hap_idx1;
  int __pyx_v_hap_idx2;
  int __pyx_v_hap_idx3;
  int __pyx_v_hap_idx4;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_ems_probs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__hap_idx1,&__pyx_n_s__hap_idx2,&__pyx_n_s__hap_idx3,&__pyx_n_s__hap_idx4,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap_idx1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap_idx2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_ems_probs", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap_idx3)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_ems_probs", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__hap_idx4)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_ems_probs", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_top_level_ems_probs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_hap_idx1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_hap_idx1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_hap_idx2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_hap_idx2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_hap_idx3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_hap_idx3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_hap_idx4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_hap_idx4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_ems_probs", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_ems_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_90calc_top_level_ems_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_hap_idx1, __pyx_v_hap_idx2, __pyx_v_hap_idx3, __pyx_v_hap_idx4);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1843")'> 1843: </pre>
<pre id='line1843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line1844")'> 1844:     cpdef calc_post_probs(self):</pre>
<pre id='line1844' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":1844
 *         self.calc_top_level_ems_probs_inner()
 * 
 *     cpdef calc_post_probs(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_93calc_post_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_post_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  PyObject *__pyx_v_total_prob = 0;
  PyObject *__pyx_v_max_prob = 0;
  PyObject *__pyx_v_max_breakpoint = 0;
  PyObject *__pyx_v_first_win = 0;
  PyObject *__pyx_v_last_win = 0;
  PyObject *__pyx_v_breakpoint_start = 0;
  PyObject *__pyx_v_breakpoint_end = 0;
  PyObject *__pyx_v_breakpoint = NULL;
  PyObject *__pyx_v_snp_idx_win = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_snp_idx = NULL;
  PyObject *__pyx_v_d = NULL;
  int __pyx_v_anc;
  int __pyx_v_prev_admx_idx1;
  int __pyx_v_prev_admx_idx2;
  int __pyx_v_prev_admx_idx3;
  int __pyx_v_prev_admx_idx4;
  long __pyx_v_prev_ibd;
  PyObject *__pyx_v_pairIBD = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_post_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_post_probs", __pyx_f[0], 1844);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__calc_post_probs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_93calc_post_probs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":1844
 *         self.calc_top_level_ems_probs_inner()
 * 
 *     cpdef calc_post_probs(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int node_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_92calc_post_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_post_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_post_probs", __pyx_f[0], 1844);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_post_probs(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_post_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1845")'> 1845:         cdef int win_idx</pre>
<pre id='line1845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1846")'> 1846:         cdef int node_idx1</pre>
<pre id='line1846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1847")'> 1847:         cdef int node_idx2</pre>
<pre id='line1847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1848")'> 1848:         cdef int node_idx3</pre>
<pre id='line1848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1849")'> 1849:         cdef int node_idx4</pre>
<pre id='line1849' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1850")'> 1850:         cdef int admx_idx1</pre>
<pre id='line1850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1851")'> 1851:         cdef int admx_idx2</pre>
<pre id='line1851' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1852")'> 1852:         cdef int admx_idx3</pre>
<pre id='line1852' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1853")'> 1853:         cdef int admx_idx4</pre>
<pre id='line1853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1854")'> 1854:         cdef int ibd</pre>
<pre id='line1854' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1855")'> 1855:         cdef double before_prob</pre>
<pre id='line1855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1856")'> 1856:         cdef double after_prob</pre>
<pre id='line1856' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1857")'> 1857:         cdef total_prob</pre>
<pre id='line1857' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1858")'> 1858:         cdef max_prob</pre>
<pre id='line1858' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1859")'> 1859:         cdef max_breakpoint</pre>
<pre id='line1859' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1860")'> 1860:         cdef first_win</pre>
<pre id='line1860' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1861")'> 1861:         cdef last_win</pre>
<pre id='line1861' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1862")'> 1862:         cdef breakpoint_start</pre>
<pre id='line1862' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1863")'> 1863:         cdef breakpoint_end</pre>
<pre id='line1863' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1864")'> 1864: </pre>
<pre id='line1864' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1865")'> 1865:         if self._debug:</pre>
<pre id='line1865' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1865
 *         cdef breakpoint_end
 * 
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward emission\n")
 *             self._inner_probs_file.flush()
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1866")'> 1866:             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward emission\n")</pre>
<pre id='line1866' class='code' style='background-color: #FFFF57'>
    /* "LDModel.pyx":1866
 * 
 *         if self._debug:
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward emission\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file.flush()
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_73), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "LDModel.pyx":1866
 * 
 *         if self._debug:
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward emission\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._inner_probs_file.flush()
 * 
 */
  __pyx_k_tuple_73 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_73)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_73);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_72));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_73, 0, ((PyObject *)__pyx_kp_s_72));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_72));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_73));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1867")'> 1867:             self._inner_probs_file.flush()</pre>
<pre id='line1867' class='code' style='background-color: #FFFF73'>
    /* "LDModel.pyx":1867
 *         if self._debug:
 *             self._inner_probs_file.write("ind1 ind2 snp admx1 admx2 admx3 admx4 node1 node2 node3 node4 ibd forward emission\n")
 *             self._inner_probs_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(self.get_num_windows()):
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_inner_probs_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1868")'> 1868: </pre>
<pre id='line1868' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1869")'> 1869:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1869' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1869
 *             self._inner_probs_file.flush()
 * 
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 self._exact_ibd_starts[win_idx] = self.start_snp(win_idx)
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1870")'> 1870:             if self._ibs[win_idx]:</pre>
<pre id='line1870' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1870
 * 
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._exact_ibd_starts[win_idx] = self.start_snp(win_idx)
 *                 self._exact_ibd_ends[win_idx] = self.end_snp(win_idx)
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1871")'> 1871:                 self._exact_ibd_starts[win_idx] = self.start_snp(win_idx)</pre>
<pre id='line1871' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1871
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 *                 self._exact_ibd_starts[win_idx] = self.start_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._exact_ibd_ends[win_idx] = self.end_snp(win_idx)
 * 
 */
      (__pyx_v_self->_exact_ibd_starts[__pyx_v_win_idx]) = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_v_win_idx);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1872")'> 1872:                 self._exact_ibd_ends[win_idx] = self.end_snp(win_idx)</pre>
<pre id='line1872' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1872
 *             if self._ibs[win_idx]:
 *                 self._exact_ibd_starts[win_idx] = self.start_snp(win_idx)
 *                 self._exact_ibd_ends[win_idx] = self.end_snp(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(self.get_num_windows()):
 */
      (__pyx_v_self->_exact_ibd_ends[__pyx_v_win_idx]) = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_v_win_idx);
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1873")'> 1873: </pre>
<pre id='line1873' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1874")'> 1874:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line1874' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":1874
 *                 self._exact_ibd_ends[win_idx] = self.end_snp(win_idx)
 * 
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibd_segment_start[win_idx] or self._ibd_segment_end[win_idx]:
 * 
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1875")'> 1875:             if self._ibd_segment_start[win_idx] or self._ibd_segment_end[win_idx]:</pre>
<pre id='line1875' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":1875
 * 
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibd_segment_start[win_idx] or self._ibd_segment_end[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._ibd_segment_start[win_idx]:
 */
    if (!(__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
      __pyx_t_5 = (__pyx_v_self->_ibd_segment_end[__pyx_v_win_idx]);
    } else {
      __pyx_t_5 = (__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx]);
    }
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1876")'> 1876: </pre>
<pre id='line1876' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1877")'> 1877:                 if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1877' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1877
 *             if self._ibd_segment_start[win_idx] or self._ibd_segment_end[win_idx]:
 * 
 *                 if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     print "calculating post probs in start window: " + str(win_idx)
 *                 else:
 */
      if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1878")'> 1878:                     print "calculating post probs in start window: " + str(win_idx)</pre>
<pre id='line1878' class='code' style='background-color: #FFFF46'>
        /* "LDModel.pyx":1878
 * 
 *                 if self._ibd_segment_start[win_idx]:
 *                     print "calculating post probs in start window: " + str(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     print "calculating post probs in end window: " + str(win_idx)
 */
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_74), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L10;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1879")'> 1879:                 else:</pre>
<pre id='line1879' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1880")'> 1880:                     print "calculating post probs in end window: " + str(win_idx)</pre>
<pre id='line1880' class='code' style='background-color: #FFFF46'>
        /* "LDModel.pyx":1880
 *                     print "calculating post probs in start window: " + str(win_idx)
 *                 else:
 *                     print "calculating post probs in end window: " + str(win_idx)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx, True)
 */
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_75), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L10:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1881")'> 1881: </pre>
<pre id='line1881' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1882")'> 1882:                 self.emission_prob_ibd_admx_mem_alloc(win_idx, True)</pre>
<pre id='line1882' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1882
 *                     print "calculating post probs in end window: " + str(win_idx)
 * 
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_emission_probs_ibd_admx(win_idx, True)
 *                 self.scale_factors_mem_alloc(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1883")'> 1883:                 self.calc_emission_probs_ibd_admx(win_idx, True)</pre>
<pre id='line1883' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1883
 * 
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx, True)
 *                 self.calc_emission_probs_ibd_admx(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.scale_factors_mem_alloc(win_idx, True)
 *                 self.forward_probs_mem_alloc(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_emission_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1884")'> 1884:                 self.scale_factors_mem_alloc(win_idx, True)</pre>
<pre id='line1884' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1884
 *                 self.emission_prob_ibd_admx_mem_alloc(win_idx, True)
 *                 self.calc_emission_probs_ibd_admx(win_idx, True)
 *                 self.scale_factors_mem_alloc(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.forward_probs_mem_alloc(win_idx, True)
 *                 self.calc_forward_probs_ibd_admx(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1885")'> 1885:                 self.forward_probs_mem_alloc(win_idx, True)</pre>
<pre id='line1885' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1885
 *                 self.calc_emission_probs_ibd_admx(win_idx, True)
 *                 self.scale_factors_mem_alloc(win_idx, True)
 *                 self.forward_probs_mem_alloc(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_forward_probs_ibd_admx(win_idx, True)
 *                 self.backward_probs_mem_alloc(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1886")'> 1886:                 self.calc_forward_probs_ibd_admx(win_idx, True)</pre>
<pre id='line1886' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1886
 *                 self.scale_factors_mem_alloc(win_idx, True)
 *                 self.forward_probs_mem_alloc(win_idx, True)
 *                 self.calc_forward_probs_ibd_admx(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.backward_probs_mem_alloc(win_idx, True)
 *                 self.calc_backward_probs_ibd_admx(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_forward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1887")'> 1887:                 self.backward_probs_mem_alloc(win_idx, True)</pre>
<pre id='line1887' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1887
 *                 self.forward_probs_mem_alloc(win_idx, True)
 *                 self.calc_forward_probs_ibd_admx(win_idx, True)
 *                 self.backward_probs_mem_alloc(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.calc_backward_probs_ibd_admx(win_idx, True)
 * #                 if self._debug:
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->backward_probs_mem_alloc(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1888")'> 1888:                 self.calc_backward_probs_ibd_admx(win_idx, True)</pre>
<pre id='line1888' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":1888
 *                 self.calc_forward_probs_ibd_admx(win_idx, True)
 *                 self.backward_probs_mem_alloc(win_idx, True)
 *                 self.calc_backward_probs_ibd_admx(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                 if self._debug:
 * #                     self.print_inner_probs(win_idx, True)
 */
      __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_backward_probs_ibd_admx(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1889")'> 1889: #                 if self._debug:</pre>
<pre id='line1889' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1890")'> 1890: #                     self.print_inner_probs(win_idx, True)</pre>
<pre id='line1890' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1891")'> 1891:                 #self.backward_probs_mem_alloc(win_idx)</pre>
<pre id='line1891' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1892")'> 1892:                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)</pre>
<pre id='line1892' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1893")'> 1893:                 max_prob = -DBL_MAX</pre>
<pre id='line1893' class='code' style='background-color: #FFFF9f'>
      /* "LDModel.pyx":1893
 *                 #self.backward_probs_mem_alloc(win_idx)
 *                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)
 *                 max_prob = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 max_breakpoint = -1
 * 
 */
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((-DBL_MAX));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max_prob);
      __pyx_v_max_prob = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1894")'> 1894:                 max_breakpoint = -1</pre>
<pre id='line1894' class='code' style='background-color: #FFFFd4'>
      /* "LDModel.pyx":1894
 *                 #self.calc_backward_probs_ibd_admx(chr1,chr2,chr3,chr4,win_idx)
 *                 max_prob = -DBL_MAX
 *                 max_breakpoint = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._debug:
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max_breakpoint);
      __pyx_v_max_breakpoint = __pyx_int_neg_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1895")'> 1895: </pre>
<pre id='line1895' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1896")'> 1896:                 if self._debug:</pre>
<pre id='line1896' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1896
 *                 max_breakpoint = -1
 * 
 *                 if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._breakpoints_file.write(str(win_idx) + " ")
 * 
 */
      if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line1897")'> 1897:                     self._breakpoints_file.write(str(win_idx) + " ")</pre>
<pre id='line1897' class='code' style='background-color: #FFFF31'>
        /* "LDModel.pyx":1897
 * 
 *                 if self._debug:
 *                     self._breakpoints_file.write(str(win_idx) + " ")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._ibd_segment_start[win_idx]:
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_breakpoints_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L11;
      }
      __pyx_L11:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1898")'> 1898: </pre>
<pre id='line1898' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1899")'> 1899:                 if self._ibd_segment_start[win_idx]:</pre>
<pre id='line1899' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":1899
 *                     self._breakpoints_file.write(str(win_idx) + " ")
 * 
 *                 if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     first_win = max(0,win_idx-2)
 *                     last_win = win_idx
 */
      if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1900")'> 1900:                     first_win = max(0,win_idx-2)</pre>
<pre id='line1900' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":1900
 * 
 *                 if self._ibd_segment_start[win_idx]:
 *                     first_win = max(0,win_idx-2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     last_win = win_idx
 *                 else:
 */
        __pyx_t_7 = (__pyx_v_win_idx - 2);
        __pyx_t_8 = 0;
        if ((__pyx_t_7 > __pyx_t_8)) {
          __pyx_t_9 = __pyx_t_7;
        } else {
          __pyx_t_9 = __pyx_t_8;
        }
        __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_first_win);
        __pyx_v_first_win = __pyx_t_6;
        __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1901")'> 1901:                     last_win = win_idx</pre>
<pre id='line1901' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":1901
 *                 if self._ibd_segment_start[win_idx]:
 *                     first_win = max(0,win_idx-2)
 *                     last_win = win_idx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     first_win = win_idx
 */
        __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_win);
        __pyx_v_last_win = __pyx_t_6;
        __pyx_t_6 = 0;
        goto __pyx_L12;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1902")'> 1902:                 else:</pre>
<pre id='line1902' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1903")'> 1903:                     first_win = win_idx</pre>
<pre id='line1903' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":1903
 *                     last_win = win_idx
 *                 else:
 *                     first_win = win_idx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     last_win = min(win_idx+2,self.get_num_windows()-1)
 * #                 last_win = min(win_idx+1,self.get_num_windows())
 */
        __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_win_idx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_first_win);
        __pyx_v_first_win = __pyx_t_6;
        __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1904")'> 1904:                     last_win = min(win_idx+2,self.get_num_windows()-1)</pre>
<pre id='line1904' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":1904
 *                 else:
 *                     first_win = win_idx
 *                     last_win = min(win_idx+2,self.get_num_windows()-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                 last_win = min(win_idx+1,self.get_num_windows())
 * 
 */
        __pyx_t_9 = (((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) - 1);
        __pyx_t_7 = (__pyx_v_win_idx + 2);
        if ((__pyx_t_9 <code><</code> __pyx_t_7)) {
          __pyx_t_8 = __pyx_t_9;
        } else {
          __pyx_t_8 = __pyx_t_7;
        }
        __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_win);
        __pyx_v_last_win = __pyx_t_6;
        __pyx_t_6 = 0;
      }
      __pyx_L12:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1905")'> 1905: #                 last_win = min(win_idx+1,self.get_num_windows())</pre>
<pre id='line1905' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1906")'> 1906: </pre>
<pre id='line1906' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1907")'> 1907:                 breakpoint_start = self.start_snp(first_win)</pre>
<pre id='line1907' class='code' style='background-color: #FFFF62'>
      /* "LDModel.pyx":1907
 * #                 last_win = min(win_idx+1,self.get_num_windows())
 * 
 *                 breakpoint_start = self.start_snp(first_win)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 breakpoint_end = self.end_snp(last_win)
 *                 for breakpoint in range(breakpoint_start,breakpoint_end):
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_first_win);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint_start);
      __pyx_v_breakpoint_start = __pyx_t_6;
      __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1908")'> 1908:                 breakpoint_end = self.end_snp(last_win)</pre>
<pre id='line1908' class='code' style='background-color: #FFFF62'>
      /* "LDModel.pyx":1908
 * 
 *                 breakpoint_start = self.start_snp(first_win)
 *                 breakpoint_end = self.end_snp(last_win)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for breakpoint in range(breakpoint_start,breakpoint_end):
 * #                     print "breakpoint: " + str(breakpoint)
 */
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_last_win);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint_end);
      __pyx_v_breakpoint_end = __pyx_t_6;
      __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF21' onclick='toggleDiv("line1909")'> 1909:                 for breakpoint in range(breakpoint_start,breakpoint_end):</pre>
<pre id='line1909' class='code' style='background-color: #FFFF21'>
      /* "LDModel.pyx":1909
 *                 breakpoint_start = self.start_snp(first_win)
 *                 breakpoint_end = self.end_snp(last_win)
 *                 for breakpoint in range(breakpoint_start,breakpoint_end):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                     print "breakpoint: " + str(breakpoint)
 *                     for admx_idx1 in range(self.K):
 */
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint_start);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_breakpoint_start);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_breakpoint_start);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint_end);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_breakpoint_end);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_breakpoint_end);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_6 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_11 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_11 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_12 = Py_TYPE(__pyx_t_6)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (!__pyx_t_12 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) {
          if (__pyx_t_11 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_6)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_6, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_6, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_12 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {
          if (__pyx_t_11 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_6)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_6, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_2 = __pyx_t_12(__pyx_t_6);
          if (unlikely(!__pyx_t_2)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint);
        __pyx_v_breakpoint = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1910")'> 1910: #                     print "breakpoint: " + str(breakpoint)</pre>
<pre id='line1910' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1911")'> 1911:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1911' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1911
 *                 for breakpoint in range(breakpoint_start,breakpoint_end):
 * #                     print "breakpoint: " + str(breakpoint)
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1912")'> 1912:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1912' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1912
 * #                     print "breakpoint: " + str(breakpoint)
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1913")'> 1913:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1913' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1913
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1914")'> 1914:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line1914' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1914
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1915")'> 1915:                                     for ibd in range(2):</pre>
<pre id='line1915' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1915
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                  __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1916")'> 1916:                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1916' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1916
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
                  ((((((__pyx_v_self->_top_level_ems_prob[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1917")'> 1917:                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1917' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1917
 *                                     for ibd in range(2):
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 */
                  ((((((__pyx_v_self->_top_level_ems_prob[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1918")'> 1918:                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1918' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1918
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 * 
 */
                  ((((((__pyx_v_self->_top_level_forward_probs[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1919")'> 1919:                                         self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX</pre>
<pre id='line1919' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1919
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX
 *                                         self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #                     if breakpoint > self.start_snp(inner_win_idx):
 */
                  ((((((__pyx_v_self->_top_level_forward_probs[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (-DBL_MAX);
                }
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1920")'> 1920: </pre>
<pre id='line1920' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1921")'> 1921: #                     if breakpoint &gt; self.start_snp(inner_win_idx):</pre>
<pre id='line1921' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1922")'> 1922: #                                                 for snp_idx in range(self.start_snp(inner_win_idx), min(self.end_snp(inner_win_idx), breakpoint)):</pre>
<pre id='line1922' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1923")'> 1923: </pre>
<pre id='line1923' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1924")'> 1924: #                     for inner_win_idx in range(first_win,last_win+1):</pre>
<pre id='line1924' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1925")'> 1925:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1925' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1925
 * 
 * #                     for inner_win_idx in range(first_win,last_win+1):
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1926")'> 1926:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1926' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1926
 * #                     for inner_win_idx in range(first_win,last_win+1):
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1927")'> 1927:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1927' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1927
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1928")'> 1928:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line1928' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1928
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1
 *                                     snp_idx_win = 0
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1929")'> 1929:                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1</pre>
<pre id='line1929' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1929
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
                if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
                  __pyx_t_8 = 0;
                } else {
                  __pyx_t_8 = 1;
                }
                __pyx_v_ibd = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1930")'> 1930:                                     snp_idx_win = 0</pre>
<pre id='line1930' class='code' style='background-color: #FFFFd4'>
                /* "LDModel.pyx":1930
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1
 *                                     snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     for snp_idx in range(self.start_snp(first_win), breakpoint):
 */
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
                __pyx_v_snp_idx_win = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1931")'> 1931:                                     self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1931' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1931
 *                                     ibd = 0 if self._ibd_segment_start[win_idx] else 1
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for snp_idx in range(self.start_snp(first_win), breakpoint):
 * #                                         if ibd == 1 and self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 */
                ((((((__pyx_v_self->_top_level_ems_prob[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line1932")'> 1932:                                     for snp_idx in range(self.start_snp(first_win), breakpoint):</pre>
<pre id='line1932' class='code' style='background-color: #FFFF1c'>
                /* "LDModel.pyx":1932
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     for snp_idx in range(self.start_snp(first_win), breakpoint):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                         if ibd == 1 and self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                             print "scale 0 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))
 */
                __pyx_t_20 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_first_win);<span class='error_goto'> if (unlikely((__pyx_t_20 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_20));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_breakpoint);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_breakpoint);
                __pyx_t_2 = 0;
                __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
                if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
                  __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_21 = 0;
                  __pyx_t_22 = NULL;
                } else {
                  __pyx_t_21 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  __pyx_t_22 = Py_TYPE(__pyx_t_1)->tp_iternext;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                for (;;) {
                  if (!__pyx_t_22 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
                    if (__pyx_t_21 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_21); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_21++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #else
                    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_21); __pyx_t_21++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #endif
                  } else if (!__pyx_t_22 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                    if (__pyx_t_21 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_21); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_21++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #else
                    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_21); __pyx_t_21++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #endif
                  } else {
                    __pyx_t_2 = __pyx_t_22(__pyx_t_1);
                    if (unlikely(!__pyx_t_2)) {
                      if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                        if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                        else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      }
                      break;
                    }
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  }
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx);
                  __pyx_v_snp_idx = __pyx_t_2;
                  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1933")'> 1933: #                                         if ibd == 1 and self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1:</pre>
<pre id='line1933' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1934")'> 1934: #                                             print "scale 0 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))</pre>
<pre id='line1934' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1935")'> 1935:                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line1935' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1935
 * #                                         if ibd == 1 and self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                             print "scale 0 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  ((((((__pyx_v_self->_top_level_ems_prob[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (((((((__pyx_v_self->_top_level_ems_prob[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) - log(((((((__pyx_v_self->_scale_factor[__pyx_t_23])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1936")'> 1936:                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \</pre>
<pre id='line1936' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1937")'> 1937:                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1937' class='code' style='background-color: #FFFF7f'>
                  /* "LDModel.pyx":1937
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         snp_idx_win += 1
 * #                                     print "ems 0 : " + str(self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_23 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line1938")'> 1938:                                         snp_idx_win += 1</pre>
<pre id='line1938' class='code' style='background-color: #FFFF96'>
                  /* "LDModel.pyx":1938
 *                                         self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                                         snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                     print "ems 0 : " + str(self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * #                                     print " ems_prob 0: " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_snp_idx_win, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1938; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_snp_idx_win);
                  __pyx_v_snp_idx_win = __pyx_t_2;
                  __pyx_t_2 = 0;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1939")'> 1939: #                                     print "ems 0 : " + str(self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1939' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1940")'> 1940: #                                     print " ems_prob 0: " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1940' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1941")'> 1941: #                                     self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = exp(self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1941' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1942")'> 1942: #                                     before_prob = logsumexp(before_prob,self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))</pre>
<pre id='line1942' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1943")'> 1943: </pre>
<pre id='line1943' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1944")'> 1944:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1944' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1944
 * #                                     before_prob = logsumexp(before_prob,self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1945")'> 1945:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1945' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1945
 * 
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1946")'> 1946:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1946' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1946
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1947")'> 1947:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line1947' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1947
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1
 *                                     snp_idx_win = 0
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1948")'> 1948:                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1</pre>
<pre id='line1948' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1948
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 */
                if ((__pyx_v_self->_ibd_segment_end[__pyx_v_win_idx])) {
                  __pyx_t_8 = 0;
                } else {
                  __pyx_t_8 = 1;
                }
                __pyx_v_ibd = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1949")'> 1949:                                     snp_idx_win = 0</pre>
<pre id='line1949' class='code' style='background-color: #FFFFd4'>
                /* "LDModel.pyx":1949
 *                                 for admx_idx4 in range(self.K):
 *                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1
 *                                     snp_idx_win = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     for snp_idx in range(breakpoint, self.end_snp(last_win)):
 */
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
                __pyx_v_snp_idx_win = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1950")'> 1950:                                     self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0</pre>
<pre id='line1950' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1950
 *                                     ibd = 0 if self._ibd_segment_end[win_idx] else 1
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for snp_idx in range(breakpoint, self.end_snp(last_win)):
 * #                                         if ibd == 1 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 */
                ((((((__pyx_v_self->_top_level_ems_prob[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line1951")'> 1951:                                     for snp_idx in range(breakpoint, self.end_snp(last_win)):</pre>
<pre id='line1951' class='code' style='background-color: #FFFF1c'>
                /* "LDModel.pyx":1951
 *                                     snp_idx_win = 0
 *                                     self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0
 *                                     for snp_idx in range(breakpoint, self.end_snp(last_win)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                         if ibd == 1 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                             print "scale 1 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))
 */
                __pyx_t_20 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_last_win);<span class='error_goto'> if (unlikely((__pyx_t_20 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_snp(__pyx_v_self, __pyx_t_20));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_breakpoint);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_breakpoint);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
                if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                  __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_21 = 0;
                  __pyx_t_22 = NULL;
                } else {
                  __pyx_t_21 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  __pyx_t_22 = Py_TYPE(__pyx_t_2)->tp_iternext;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                for (;;) {
                  if (!__pyx_t_22 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
                    if (__pyx_t_21 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_21); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_21++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #else
                    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_21); __pyx_t_21++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #endif
                  } else if (!__pyx_t_22 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
                    if (__pyx_t_21 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_21); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_21++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #else
                    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_21); __pyx_t_21++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                    #endif
                  } else {
                    __pyx_t_1 = __pyx_t_22(__pyx_t_2);
                    if (unlikely(!__pyx_t_1)) {
                      if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                        if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                        else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                      }
                      break;
                    }
                    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  }
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx);
                  __pyx_v_snp_idx = __pyx_t_1;
                  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1952")'> 1952: #                                         if ibd == 1 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] &lt; 1:</pre>
<pre id='line1952' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1953")'> 1953: #                                             print "scale 1 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))</pre>
<pre id='line1953' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1954")'> 1954:                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line1954' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1954
 * #                                         if ibd == 1 and self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] <code><</code> 1:
 * #                                             print "scale 1 : " + str(snp_idx) + " " + str(ibd) + " " + str(log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]))
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  ((((((__pyx_v_self->_top_level_ems_prob[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = (((((((__pyx_v_self->_top_level_ems_prob[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) - log(((((((__pyx_v_self->_backward_scale_factor[__pyx_t_23])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1955")'> 1955:                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \</pre>
<pre id='line1955' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1956")'> 1956:                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1956' class='code' style='background-color: #FFFF7f'>
                  /* "LDModel.pyx":1956
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         snp_idx_win += 1
 * #                                     print "ems 1 : " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_23 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_snp_idx_win);<span class='error_goto'> if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line1957")'> 1957:                                         snp_idx_win += 1</pre>
<pre id='line1957' class='code' style='background-color: #FFFF96'>
                  /* "LDModel.pyx":1957
 *                                         self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] - \
 *                                         log(self._backward_scale_factor[snp_idx_win][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                                         snp_idx_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                     print "ems 1 : " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * #                                     print " ems_prob 1: " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
                  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_snp_idx_win, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_snp_idx_win);
                  __pyx_v_snp_idx_win = __pyx_t_1;
                  __pyx_t_1 = 0;
                }
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1958")'> 1958: #                                     print "ems 1 : " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1958' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1959")'> 1959: #                                     print " ems_prob 1: " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1959' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1960")'> 1960: </pre>
<pre id='line1960' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1961")'> 1961:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1961' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1961
 * #                                     print " ems_prob 1: " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1962")'> 1962:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1962' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1962
 * 
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1963")'> 1963:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1963' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1963
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1964")'> 1964:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line1964' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1964
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1965")'> 1965:                                     for ibd in range(2):</pre>
<pre id='line1965' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1965
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         logsumexp(self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 */
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                  __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1966")'> 1966:                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line1966' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1966
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         logsumexp(self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 *                                                               self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \
 */
                  ((((((__pyx_v_self->_top_level_forward_probs[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = logsumexp(((((((__pyx_v_self->_top_level_forward_probs[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]), ((((((((((__pyx_v_self->_top_level_ems_prob[0])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx1]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx2]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx3]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx4]))));
                }
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1967")'> 1967:                                         logsumexp(self._top_level_forward_probs[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\</pre>
<pre id='line1967' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1968")'> 1968:                                                               self._top_level_ems_prob[0][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \</pre>
<pre id='line1968' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1969")'> 1969:                                                               log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))</pre>
<pre id='line1969' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1970")'> 1970: </pre>
<pre id='line1970' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1971")'> 1971:                     d = self._genetic_dist[breakpoint] - self._genetic_dist[self.start_snp(first_win)]</pre>
<pre id='line1971' class='code' style='background-color: #FFFF46'>
        /* "LDModel.pyx":1971
 *                                                               log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 *                     d = self._genetic_dist[breakpoint] - self._genetic_dist[self.start_snp(first_win)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for anc in range(self.K):
 *                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)
 */
        __pyx_t_21 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_breakpoint);<span class='error_goto'> if (unlikely((__pyx_t_21 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_first_win);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_self->_genetic_dist[__pyx_t_21]) - (__pyx_v_self->_genetic_dist[((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_snp(__pyx_v_self, __pyx_t_10)])));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
        __pyx_v_d = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1972")'> 1972:                     for anc in range(self.K):</pre>
<pre id='line1972' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1972
 * 
 *                     d = self._genetic_dist[breakpoint] - self._genetic_dist[self.start_snp(first_win)]
 *                     for anc in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)
 *                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_anc = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line1973")'> 1973:                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)</pre>
<pre id='line1973' class='code' style='background-color: #FFFF4f'>
          /* "LDModel.pyx":1973
 *                     d = self._genetic_dist[breakpoint] - self._genetic_dist[self.start_snp(first_win)]
 *                     for anc in range(self.K):
 *                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)
 *                         self._s[anc][0][1][0] = 1 - self._s[anc][0][1][1]
 */
          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((-(__pyx_v_self->_t_1_0[__pyx_v_anc])));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_d);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          ((((__pyx_v_self->_s[__pyx_v_anc])[0])[1])[1]) = exp(__pyx_t_24);
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line1974")'> 1974:                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)</pre>
<pre id='line1974' class='code' style='background-color: #FFFF4f'>
          /* "LDModel.pyx":1974
 *                     for anc in range(self.K):
 *                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)
 *                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._s[anc][0][1][0] = 1 - self._s[anc][0][1][1]
 *                         self._s[anc][0][0][1] = 1 - self._s[anc][0][0][0]
 */
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((-(__pyx_v_self->_t_0_1[__pyx_v_anc])));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          ((((__pyx_v_self->_s[__pyx_v_anc])[0])[0])[0]) = exp(__pyx_t_24);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1975")'> 1975:                         self._s[anc][0][1][0] = 1 - self._s[anc][0][1][1]</pre>
<pre id='line1975' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1975
 *                         self._s[anc][0][1][1] = exp(-self._t_1_0[anc] * d)
 *                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)
 *                         self._s[anc][0][1][0] = 1 - self._s[anc][0][1][1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._s[anc][0][0][1] = 1 - self._s[anc][0][0][0]
 * 
 */
          ((((__pyx_v_self->_s[__pyx_v_anc])[0])[1])[0]) = (1.0 - ((((__pyx_v_self->_s[__pyx_v_anc])[0])[1])[1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1976")'> 1976:                         self._s[anc][0][0][1] = 1 - self._s[anc][0][0][0]</pre>
<pre id='line1976' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1976
 *                         self._s[anc][0][0][0] = exp(-self._t_0_1[anc] * d)
 *                         self._s[anc][0][1][0] = 1 - self._s[anc][0][1][1]
 *                         self._s[anc][0][0][1] = 1 - self._s[anc][0][0][0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     for admx_idx1 in range(self.K):
 */
          ((((__pyx_v_self->_s[__pyx_v_anc])[0])[0])[1]) = (1.0 - ((((__pyx_v_self->_s[__pyx_v_anc])[0])[0])[0]));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1977")'> 1977: </pre>
<pre id='line1977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1978")'> 1978:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1978' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1978
 *                         self._s[anc][0][0][1] = 1 - self._s[anc][0][0][0]
 * 
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1979")'> 1979:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1979' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1979
 * 
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1980")'> 1980:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1980' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1980
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1981")'> 1981:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line1981' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":1981
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1982")'> 1982:                                     for ibd in range(2):</pre>
<pre id='line1982' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":1982
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):
 */
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                  __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1983")'> 1983:                                         for prev_admx_idx1 in range(self.K):</pre>
<pre id='line1983' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":1983
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):
 */
                  __pyx_t_25 = __pyx_v_self->K;
                  for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> __pyx_t_25; __pyx_t_26+=1) {
                    __pyx_v_prev_admx_idx1 = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1984")'> 1984:                                             for prev_admx_idx2 in range(self.K):</pre>
<pre id='line1984' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":1984
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):
 */
                    __pyx_t_27 = __pyx_v_self->K;
                    for (__pyx_t_28 = 0; __pyx_t_28 <code><</code> __pyx_t_27; __pyx_t_28+=1) {
                      __pyx_v_prev_admx_idx2 = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1985")'> 1985:                                                 for prev_admx_idx3 in range(self.K):</pre>
<pre id='line1985' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":1985
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):
 */
                      __pyx_t_29 = __pyx_v_self->K;
                      for (__pyx_t_30 = 0; __pyx_t_30 <code><</code> __pyx_t_29; __pyx_t_30+=1) {
                        __pyx_v_prev_admx_idx3 = __pyx_t_30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1986")'> 1986:                                                     for prev_admx_idx4 in range(self.K):</pre>
<pre id='line1986' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":1986
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         for prev_ibd in range(2):
 *                                                             self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 */
                        __pyx_t_31 = __pyx_v_self->K;
                        for (__pyx_t_32 = 0; __pyx_t_32 <code><</code> __pyx_t_31; __pyx_t_32+=1) {
                          __pyx_v_prev_admx_idx4 = __pyx_t_32;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1987")'> 1987:                                                         for prev_ibd in range(2):</pre>
<pre id='line1987' class='code' style='background-color: #FFFFff'>
                          /* "LDModel.pyx":1987
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                             self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                                             logsumexp(self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], \
 */
                          for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> 2; __pyx_t_8+=1) {
                            __pyx_v_prev_ibd = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1988")'> 1988:                                                             self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line1988' class='code' style='background-color: #FFFFff'>
                            /* "LDModel.pyx":1988
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):
 *                                                             self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                             logsumexp(self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], \
 *                                                                       self._top_level_forward_probs[0][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + \
 */
                            ((((((__pyx_v_self->_top_level_forward_probs[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = logsumexp(((((((__pyx_v_self->_top_level_forward_probs[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]), (((((((((((__pyx_v_self->_top_level_forward_probs[0])[__pyx_v_prev_admx_idx1])[__pyx_v_prev_admx_idx2])[__pyx_v_prev_admx_idx3])[__pyx_v_prev_admx_idx4])[__pyx_v_prev_ibd]) + ((((((__pyx_v_self->_top_level_ems_prob[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx1]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx2]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx3]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx4]))));
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1989")'> 1989:                                                             logsumexp(self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], \</pre>
<pre id='line1989' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1990")'> 1990:                                                                       self._top_level_forward_probs[0][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + \</pre>
<pre id='line1990' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1991")'> 1991:                                                                       self._top_level_ems_prob[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \</pre>
<pre id='line1991' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1992")'> 1992:                                                                       log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))</pre>
<pre id='line1992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1993")'> 1993: #                                         print str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line1993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1994")'> 1994: </pre>
<pre id='line1994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1995")'> 1995:                     #calc_top_level_backward_probs(first_win,last_win+1)</pre>
<pre id='line1995' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1996")'> 1996:                     total_prob = -DBL_MAX</pre>
<pre id='line1996' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":1996
 * 
 *                     #calc_top_level_backward_probs(first_win,last_win+1)
 *                     total_prob = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 */
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((-DBL_MAX));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1996; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_prob);
        __pyx_v_total_prob = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1997")'> 1997:                     for admx_idx1 in range(self.K):</pre>
<pre id='line1997' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":1997
 *                     #calc_top_level_backward_probs(first_win,last_win+1)
 *                     total_prob = -DBL_MAX
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_10 = __pyx_v_self->K;
        for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_10; __pyx_t_13+=1) {
          __pyx_v_admx_idx1 = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1998")'> 1998:                         for admx_idx2 in range(self.K):</pre>
<pre id='line1998' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":1998
 *                     total_prob = -DBL_MAX
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_14 = __pyx_v_self->K;
          for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_admx_idx2 = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1999")'> 1999:                             for admx_idx3 in range(self.K):</pre>
<pre id='line1999' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":1999
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_16 = __pyx_v_self->K;
            for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
              __pyx_v_admx_idx3 = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2000")'> 2000:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line2000' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2000
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 */
              __pyx_t_18 = __pyx_v_self->K;
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> __pyx_t_18; __pyx_t_19+=1) {
                __pyx_v_admx_idx4 = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2001")'> 2001:                                     for ibd in range(2):</pre>
<pre id='line2001' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2001
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                     if self._debug:
 */
                for (__pyx_t_20 = 0; __pyx_t_20 <code><</code> 2; __pyx_t_20+=1) {
                  __pyx_v_ibd = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line2002")'> 2002:                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2002' class='code' style='background-color: #FFFF62'>
                  /* "LDModel.pyx":2002
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if self._debug:
 *                         self._breakpoints_file.write(str(total_prob) + "\n")
 */
                  __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_total_prob);<span class='error_goto'> if (unlikely((__pyx_t_24 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(logsumexp(__pyx_t_24, ((((((__pyx_v_self->_top_level_forward_probs[1])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_total_prob);
                  __pyx_v_total_prob = __pyx_t_2;
                  __pyx_t_2 = 0;
                }
              }
            }
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2003")'> 2003:                     if self._debug:</pre>
<pre id='line2003' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2003
 *                                     for ibd in range(2):
 *                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                     if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._breakpoints_file.write(str(total_prob) + "\n")
 *                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)
 */
        if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line2004")'> 2004:                         self._breakpoints_file.write(str(total_prob) + "\n")</pre>
<pre id='line2004' class='code' style='background-color: #FFFF35'>
          /* "LDModel.pyx":2004
 *                                         total_prob = logsumexp(total_prob,self._top_level_forward_probs[1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 *                     if self._debug:
 *                         self._breakpoints_file.write(str(total_prob) + "\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)
 *                     if total_prob > max_prob:
 */
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_breakpoints_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_total_prob);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_total_prob);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_total_prob);
          __pyx_t_33 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
          __pyx_t_33 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_33, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_33), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_33)); __pyx_t_33 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L87;
        }
        __pyx_L87:;
</pre><pre class='line' style='background-color: #FFFF0a' onclick='toggleDiv("line2005")'> 2005:                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)</pre>
<pre id='line2005' class='code' style='background-color: #FFFF0a'>
        /* "LDModel.pyx":2005
 *                     if self._debug:
 *                         self._breakpoints_file.write(str(total_prob) + "\n")
 *                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if total_prob > max_prob:
 *                         max_prob = total_prob
 */
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_breakpoint);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_breakpoint);
        __pyx_t_33 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_76), __pyx_t_33);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_77));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_forward_probs[1])[0])[0])[0])[0])[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_78));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_forward_probs[1])[0])[0])[0])[0])[1]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_33 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_33, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_33), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_33)); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, ((PyObject *)__pyx_kp_s_79));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[0])[0])[0])[0])[0])[0]));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_33);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_33);
        __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_33);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_80));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[0])[0])[0])[0])[0])[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_81));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[1])[0])[0])[0])[0])[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_33 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_33, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_33), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_33)); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, ((PyObject *)__pyx_kp_s_82));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyFloat_FromDouble</span>(((((((__pyx_v_self->_top_level_ems_prob[1])[0])[0])[0])[0])[1]));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_33);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_33);
        __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_33);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_83));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_total_prob);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_total_prob);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_total_prob);
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_33, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2006")'> 2006:                     if total_prob &gt; max_prob:</pre>
<pre id='line2006' class='code' style='background-color: #FFFF79'>
        /* "LDModel.pyx":2006
 *                         self._breakpoints_file.write(str(total_prob) + "\n")
 *                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)
 *                     if total_prob > max_prob:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         max_prob = total_prob
 *                         max_breakpoint = breakpoint
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_total_prob, __pyx_v_max_prob, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2007")'> 2007:                         max_prob = total_prob</pre>
<pre id='line2007' class='code' style='background-color: #FFFFd4'>
          /* "LDModel.pyx":2007
 *                     print "breakpoint: " + str(breakpoint) + " no ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][0]) +  " ibd prob:" + str(self._top_level_forward_probs[1][0][0][0][0][1]) + " no ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][0]) +  " ibd ems 0:" + str(self._top_level_ems_prob[0][0][0][0][0][1]) +" no ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][0]) +  " ibd ems 1:" + str(self._top_level_ems_prob[1][0][0][0][0][1]) + " total prob: " + str(total_prob)
 *                     if total_prob > max_prob:
 *                         max_prob = total_prob             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         max_breakpoint = breakpoint
 * 
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_total_prob);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_max_prob);
          __pyx_v_max_prob = __pyx_v_total_prob;
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2008")'> 2008:                         max_breakpoint = breakpoint</pre>
<pre id='line2008' class='code' style='background-color: #FFFFc4'>
          /* "LDModel.pyx":2008
 *                     if total_prob > max_prob:
 *                         max_prob = total_prob
 *                         max_breakpoint = breakpoint             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._debug:
 */
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_breakpoint);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_max_breakpoint);
          __pyx_v_max_breakpoint = __pyx_v_breakpoint;
          goto __pyx_L88;
        }
        __pyx_L88:;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2009")'> 2009: </pre>
<pre id='line2009' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2010")'> 2010:                 if self._debug:</pre>
<pre id='line2010' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2010
 *                         max_breakpoint = breakpoint
 * 
 *                 if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._breakpoints_file.write("\n")
 *                     self._breakpoints_file.flush()
 */
      if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line2011")'> 2011:                     self._breakpoints_file.write("\n")</pre>
<pre id='line2011' class='code' style='background-color: #FFFF57'>
        /* "LDModel.pyx":2011
 * 
 *                 if self._debug:
 *                     self._breakpoints_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._breakpoints_file.flush()
 * 
 */
        __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_breakpoints_file, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2011; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_84), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2011; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  /* "LDModel.pyx":2011
 * 
 *                 if self._debug:
 *                     self._breakpoints_file.write("\n")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._breakpoints_file.flush()
 * 
 */
  __pyx_k_tuple_84 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_84)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2011; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_84);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_84, 0, ((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_84));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line2012")'> 2012:                     self._breakpoints_file.flush()</pre>
<pre id='line2012' class='code' style='background-color: #FFFF73'>
        /* "LDModel.pyx":2012
 *                 if self._debug:
 *                     self._breakpoints_file.write("\n")
 *                     self._breakpoints_file.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if self._ibs[win_idx]:
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_self->_breakpoints_file, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L89;
      }
      __pyx_L89:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2013")'> 2013: </pre>
<pre id='line2013' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2014")'> 2014:                 if self._ibs[win_idx]:</pre>
<pre id='line2014' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2014
 *                     self._breakpoints_file.flush()
 * 
 *                 if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if self._ibd_segment_start[win_idx]:
 *                         self._exact_ibd_starts[win_idx] = max_breakpoint
 */
      if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2015")'> 2015:                     if self._ibd_segment_start[win_idx]:</pre>
<pre id='line2015' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2015
 * 
 *                 if self._ibs[win_idx]:
 *                     if self._ibd_segment_start[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         self._exact_ibd_starts[win_idx] = max_breakpoint
 * #                         if max_breakpoint <code><</code>= self.end_snp(win_idx):
 */
        if ((__pyx_v_self->_ibd_segment_start[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line2016")'> 2016:                         self._exact_ibd_starts[win_idx] = max_breakpoint</pre>
<pre id='line2016' class='code' style='background-color: #FFFF7f'>
          /* "LDModel.pyx":2016
 *                 if self._ibs[win_idx]:
 *                     if self._ibd_segment_start[win_idx]:
 *                         self._exact_ibd_starts[win_idx] = max_breakpoint             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                         if max_breakpoint <code><</code>= self.end_snp(win_idx):
 * #
 */
          __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_max_breakpoint);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          (__pyx_v_self->_exact_ibd_starts[__pyx_v_win_idx]) = __pyx_t_10;
          goto __pyx_L91;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2017")'> 2017: #                         if max_breakpoint &lt;= self.end_snp(win_idx):</pre>
<pre id='line2017' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2018")'> 2018: #</pre>
<pre id='line2018' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2019")'> 2019: #                         else:</pre>
<pre id='line2019' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2020")'> 2020: #                             self._exact_ibd_starts[win_idx+1] = max_breakpoint</pre>
<pre id='line2020' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2021")'> 2021:                     else:</pre>
<pre id='line2021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line2022")'> 2022:                         self._exact_ibd_ends[win_idx] = max_breakpoint</pre>
<pre id='line2022' class='code' style='background-color: #FFFF7f'>
          /* "LDModel.pyx":2022
 * #                             self._exact_ibd_starts[win_idx+1] = max_breakpoint
 *                     else:
 *                         self._exact_ibd_ends[win_idx] = max_breakpoint             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                         if max_breakpoint >= self.start_snp(win_idx):
 * #
 */
          __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_max_breakpoint);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          (__pyx_v_self->_exact_ibd_ends[__pyx_v_win_idx]) = __pyx_t_10;
        }
        __pyx_L91:;
        goto __pyx_L90;
      }
      __pyx_L90:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2023")'> 2023: #                         if max_breakpoint &gt;= self.start_snp(win_idx):</pre>
<pre id='line2023' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2024")'> 2024: #</pre>
<pre id='line2024' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2025")'> 2025: #                         elif max_breakpoint &gt; self._exact_ibd_starts[win_idx-1]:</pre>
<pre id='line2025' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2026")'> 2026: #                             self._exact_ibd_ends[win_idx-1] = max_breakpoint</pre>
<pre id='line2026' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2027")'> 2027: </pre>
<pre id='line2027' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2028")'> 2028:                 self.emission_prob_ibd_admx_mem_free(win_idx, True)</pre>
<pre id='line2028' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":2028
 * #                             self._exact_ibd_ends[win_idx-1] = max_breakpoint
 * 
 *                 self.emission_prob_ibd_admx_mem_free(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.forward_probs_mem_free(win_idx, True)
 *                 self.scale_factors_mem_free(win_idx, True)
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->emission_prob_ibd_admx_mem_free(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2028; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2029")'> 2029:                 self.forward_probs_mem_free(win_idx, True)</pre>
<pre id='line2029' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":2029
 * 
 *                 self.emission_prob_ibd_admx_mem_free(win_idx, True)
 *                 self.forward_probs_mem_free(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.scale_factors_mem_free(win_idx, True)
 * 
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->forward_probs_mem_free(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2030")'> 2030:                 self.scale_factors_mem_free(win_idx, True)</pre>
<pre id='line2030' class='code' style='background-color: #FFFFe7'>
      /* "LDModel.pyx":2030
 *                 self.emission_prob_ibd_admx_mem_free(win_idx, True)
 *                 self.forward_probs_mem_free(win_idx, True)
 *                 self.scale_factors_mem_free(win_idx, True)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         pairIBD = cPairIBD()
 */
      __pyx_t_6 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->scale_factors_mem_free(__pyx_v_self, __pyx_v_win_idx, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2030; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L9;
    }
    __pyx_L9:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2031")'> 2031: </pre>
<pre id='line2031' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2032")'> 2032:         pairIBD = cPairIBD()</pre>
<pre id='line2032' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":2032
 *                 self.scale_factors_mem_free(win_idx, True)
 * 
 *         pairIBD = cPairIBD()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__cPairIBD);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_pairIBD = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2033")'> 2033:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line2033' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2033
 * 
 *         pairIBD = cPairIBD()
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 if self._lod_scores[win_idx] > self._min_score:
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2034")'> 2034:             if self._ibs[win_idx]:</pre>
<pre id='line2034' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":2034
 *         pairIBD = cPairIBD()
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._lod_scores[win_idx] > self._min_score:
 *                     pairIBD.add_interval(self._exact_ibd_starts[win_idx],self._exact_ibd_ends[win_idx],self._lod_scores[win_idx])
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2035")'> 2035:                 if self._lod_scores[win_idx] &gt; self._min_score:</pre>
<pre id='line2035' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2035
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 *                 if self._lod_scores[win_idx] > self._min_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     pairIBD.add_interval(self._exact_ibd_starts[win_idx],self._exact_ibd_ends[win_idx],self._lod_scores[win_idx])
 * 
 */
      __pyx_t_5 = ((__pyx_v_self->_lod_scores[__pyx_v_win_idx]) > __pyx_v_self->_min_score);
      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line2036")'> 2036:                     pairIBD.add_interval(self._exact_ibd_starts[win_idx],self._exact_ibd_ends[win_idx],self._lod_scores[win_idx])</pre>
<pre id='line2036' class='code' style='background-color: #FFFF37'>
        /* "LDModel.pyx":2036
 *             if self._ibs[win_idx]:
 *                 if self._lod_scores[win_idx] > self._min_score:
 *                     pairIBD.add_interval(self._exact_ibd_starts[win_idx],self._exact_ibd_ends[win_idx],self._lod_scores[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return (pairIBD)
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_pairIBD, __pyx_n_s__add_interval);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_exact_ibd_starts[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_exact_ibd_ends[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_33 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_lod_scores[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        __pyx_t_34 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_34);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_34, 0, __pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_34, 1, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_34, 2, __pyx_t_33);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_33);
        __pyx_t_6 = 0;
        __pyx_t_2 = 0;
        __pyx_t_33 = 0;
        __pyx_t_33 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_34), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_33);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_34)); __pyx_t_34 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_33); __pyx_t_33 = 0;
        goto __pyx_L95;
      }
      __pyx_L95:;
      goto __pyx_L94;
    }
    __pyx_L94:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2037")'> 2037: </pre>
<pre id='line2037' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line2038")'> 2038:         return (pairIBD)</pre>
<pre id='line2038' class='code' style='background-color: #FFFF46'>
  /* "LDModel.pyx":2038
 *                     pairIBD.add_interval(self._exact_ibd_starts[win_idx],self._exact_ibd_ends[win_idx],self._lod_scores[win_idx])
 * 
 *         return (pairIBD)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_top_level_viterbi(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pairIBD);
  __pyx_r = __pyx_v_pairIBD;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_33);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_34);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_post_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_prob);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max_prob);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max_breakpoint);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_first_win);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_win);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint_start);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint_end);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_breakpoint);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx_win);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_snp_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pairIBD);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_93calc_post_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_93calc_post_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_post_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_92calc_post_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2039")'> 2039: </pre>
<pre id='line2039' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line2040")'> 2040:     cpdef calc_top_level_viterbi(self):</pre>
<pre id='line2040' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":2040
 *         return (pairIBD)
 * 
 *     cpdef calc_top_level_viterbi(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_95calc_top_level_viterbi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_top_level_viterbi(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  CYTHON_UNUSED int __pyx_v_win_idx;
  CYTHON_UNUSED bool __pyx_v_first_ibs_window;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_viterbi", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_viterbi", __pyx_f[0], 2040);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_85);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_95calc_top_level_viterbi)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2040
 *         return (pairIBD)
 * 
 *     cpdef calc_top_level_viterbi(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_94calc_top_level_viterbi(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_viterbi", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_viterbi", __pyx_f[0], 2040);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_viterbi(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_viterbi", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2041")'> 2041:         cdef int win_idx</pre>
<pre id='line2041' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2042")'> 2042:         cdef int admx_idx1</pre>
<pre id='line2042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2043")'> 2043:         cdef int admx_idx2</pre>
<pre id='line2043' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2044")'> 2044:         cdef int admx_idx3</pre>
<pre id='line2044' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2045")'> 2045:         cdef int admx_idx4</pre>
<pre id='line2045' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2046")'> 2046:         cdef int ibd</pre>
<pre id='line2046' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2047")'> 2047:         cdef int prev_admx_idx1</pre>
<pre id='line2047' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2048")'> 2048:         cdef int prev_admx_idx2</pre>
<pre id='line2048' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2049")'> 2049:         cdef int prev_admx_idx3</pre>
<pre id='line2049' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2050")'> 2050:         cdef int prev_admx_idx4</pre>
<pre id='line2050' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2051")'> 2051:         cdef int prev_ibd</pre>
<pre id='line2051' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2052")'> 2052:         cdef bool first_ibs_window = False</pre>
<pre id='line2052' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2052
 *         cdef int prev_admx_idx4
 *         cdef int prev_ibd
 *         cdef bool first_ibs_window = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(self.get_num_windows()-1):
 */
  __pyx_v_first_ibs_window = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2053")'> 2053: </pre>
<pre id='line2053' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line2054")'> 2054:         for win_idx in range(self.get_num_windows()-1):</pre>
<pre id='line2054' class='code' style='background-color: #FFFF86'>
  /* "LDModel.pyx":2054
 *         cdef bool first_ibs_window = False
 * 
 *         for win_idx in range(self.get_num_windows()-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pass
 * #             if self._ibs[win_idx]:
 */
  __pyx_t_3 = (((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0) - 1);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_viterbi", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_95calc_top_level_viterbi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_95calc_top_level_viterbi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_viterbi (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_94calc_top_level_viterbi(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2055")'> 2055:             pass</pre>
<pre id='line2055' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2056")'> 2056: #             if self._ibs[win_idx]:</pre>
<pre id='line2056' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2057")'> 2057: #                 #print "calculating top level forward probs for window: " + str(win_idx)</pre>
<pre id='line2057' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2058")'> 2058: #</pre>
<pre id='line2058' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2059")'> 2059: #                 if win_idx == 0 or (win_idx &gt; 0 and self._ibs[win_idx] and not self._ibs[win_idx-1]):</pre>
<pre id='line2059' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2060")'> 2060: #                     for admx_idx1 in range(self.K):</pre>
<pre id='line2060' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2061")'> 2061: #                         for admx_idx2 in range(self.K):</pre>
<pre id='line2061' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2062")'> 2062: #                             for admx_idx3 in range(self.K):</pre>
<pre id='line2062' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2063")'> 2063: #                                 for admx_idx4 in range(self.K):</pre>
<pre id='line2063' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2064")'> 2064: #                                     for ibd in range(2):</pre>
<pre id='line2064' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2065")'> 2065: #                                         self._top_level_backtrack[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += \</pre>
<pre id='line2065' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2066")'> 2066: #                                         self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] * \</pre>
<pre id='line2066' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2067")'> 2067: #                                         self._alphas[admx_idx1] * self._alphas[admx_idx2] * self._alphas[admx_idx3] * self._alphas[admx_idx4] * self._ibd_prior[admx_idx1][ibd]</pre>
<pre id='line2067' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2068")'> 2068: #</pre>
<pre id='line2068' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2069")'> 2069: #                 sum = 0</pre>
<pre id='line2069' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2070")'> 2070: #                 for admx_idx1 in range(self.K):</pre>
<pre id='line2070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2071")'> 2071: #                     for admx_idx2 in range(self.K):</pre>
<pre id='line2071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2072")'> 2072: #                         for admx_idx3 in range(self.K):</pre>
<pre id='line2072' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2073")'> 2073: #                             for admx_idx4 in range(self.K):</pre>
<pre id='line2073' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2074")'> 2074: #                                 for ibd in range(2):</pre>
<pre id='line2074' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2075")'> 2075: #                                     for prev_admx_idx1 in range(self.K):</pre>
<pre id='line2075' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2076")'> 2076: #                                         for prev_admx_idx2 in range(self.K):</pre>
<pre id='line2076' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2077")'> 2077: #                                             for prev_admx_idx3 in range(self.K):</pre>
<pre id='line2077' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2078")'> 2078: #                                                 for prev_admx_idx4 in range(self.K):</pre>
<pre id='line2078' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2079")'> 2079: #                                                     for prev_ibd in range(2):</pre>
<pre id='line2079' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2080")'> 2080: #                                                         self._top_level_backtrack[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += \</pre>
<pre id='line2080' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2081")'> 2081: #                                                         self._top_level_backtrack[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] * \</pre>
<pre id='line2081' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2082")'> 2082: #                                                         self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] * \</pre>
<pre id='line2082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2083")'> 2083: #                                                         self._s[admx_idx1][win_idx][prev_ibd][ibd] * \</pre>
<pre id='line2083' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2084")'> 2084: #                                                         self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4] * \</pre>
<pre id='line2084' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2085")'> 2085: #                                                         self._alphas[admx_idx1] * self._alphas[admx_idx2] * self._alphas[admx_idx3] * self._alphas[admx_idx4]</pre>
<pre id='line2085' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2086")'> 2086: #                                     sum += self._top_level_backtrack[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]</pre>
<pre id='line2086' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2087")'> 2087: #                                     if False: #ibd == 0:</pre>
<pre id='line2087' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2088")'> 2088: #                                         print str(win_idx) + " top level ems probs " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2088' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2089")'> 2089: #                                         print str(win_idx) + " top level ibd prior and alphas: " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._ibd_prior[0]) + " " + str(self._alphas[admx_idx1]) + " " + str(self._alphas[admx_idx2]) + " " + str(self._alphas[admx_idx3]) + " "  + str(self._alphas[admx_idx4])</pre>
<pre id='line2089' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2090")'> 2090: #                                         print str(win_idx) + " top level ibd trans: " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._s[admx_idx1][win_idx][0][0]) + " " + str(self._s[admx_idx1][win_idx][0][1]) + " " + str(self._s[admx_idx1][win_idx][1][0]) + " " + str(self._s[admx_idx1][win_idx][1][1])</pre>
<pre id='line2090' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2091")'> 2091: #                                         for prev_admx_idx1 in range(self.K):</pre>
<pre id='line2091' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2092")'> 2092: #                                             for prev_admx_idx2 in range(self.K):</pre>
<pre id='line2092' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2093")'> 2093: #                                                 for prev_admx_idx3 in range(self.K):</pre>
<pre id='line2093' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2094")'> 2094: #                                                     for prev_admx_idx4 in range(self.K):</pre>
<pre id='line2094' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2095")'> 2095: #                                                         print str(win_idx) + " top level anc trans: " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + ": " + str(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4])</pre>
<pre id='line2095' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2096")'> 2096: #                                         print str(win_idx) + " top level viterbi probs " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2096' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2097")'> 2097: </pre>
<pre id='line2097' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line2098")'> 2098:     cpdef calc_top_level_forward_probs(self, int start_window, int end_window):</pre>
<pre id='line2098' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":2098
 * #                                         print str(win_idx) + " top level viterbi probs " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *     cpdef calc_top_level_forward_probs(self, int start_window, int end_window):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_97calc_top_level_forward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_top_level_forward_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_start_window, int __pyx_v_end_window, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  int __pyx_v_prev_admx_idx1;
  int __pyx_v_prev_admx_idx2;
  int __pyx_v_prev_admx_idx3;
  int __pyx_v_prev_admx_idx4;
  int __pyx_v_prev_ibd;
  CYTHON_UNUSED bool __pyx_v_first_ibs_window;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_forward_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_forward_probs", __pyx_f[0], 2098);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_86);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_97calc_top_level_forward_probs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_start_window);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_end_window);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2098
 * #                                         print str(win_idx) + " top level viterbi probs " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *     cpdef calc_top_level_forward_probs(self, int start_window, int end_window):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_96calc_top_level_forward_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_start_window, int __pyx_v_end_window) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_forward_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_forward_probs", __pyx_f[0], 2098);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_forward_probs(__pyx_v_self, __pyx_v_start_window, __pyx_v_end_window, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_forward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2099")'> 2099:         cdef int win_idx</pre>
<pre id='line2099' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2100")'> 2100:         cdef int admx_idx1</pre>
<pre id='line2100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2101")'> 2101:         cdef int admx_idx2</pre>
<pre id='line2101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2102")'> 2102:         cdef int admx_idx3</pre>
<pre id='line2102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2103")'> 2103:         cdef int admx_idx4</pre>
<pre id='line2103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2104")'> 2104:         cdef int ibd</pre>
<pre id='line2104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2105")'> 2105:         cdef int prev_admx_idx1</pre>
<pre id='line2105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2106")'> 2106:         cdef int prev_admx_idx2</pre>
<pre id='line2106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2107")'> 2107:         cdef int prev_admx_idx3</pre>
<pre id='line2107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2108")'> 2108:         cdef int prev_admx_idx4</pre>
<pre id='line2108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2109")'> 2109:         cdef int prev_ibd</pre>
<pre id='line2109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2110")'> 2110:         cdef bool first_ibs_window = False</pre>
<pre id='line2110' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2110
 *         cdef int prev_admx_idx4
 *         cdef int prev_ibd
 *         cdef bool first_ibs_window = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for win_idx in range(start_window, end_window):
 */
  __pyx_v_first_ibs_window = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2111")'> 2111: </pre>
<pre id='line2111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2112")'> 2112:         for win_idx in range(start_window, end_window):</pre>
<pre id='line2112' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2112
 *         cdef bool first_ibs_window = False
 * 
 *         for win_idx in range(start_window, end_window):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 if win_idx == start_window or (win_idx > start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):
 */
  __pyx_t_5 = __pyx_v_end_window;
  for (__pyx_t_6 = __pyx_v_start_window; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_win_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2113")'> 2113:             if self._ibs[win_idx]:</pre>
<pre id='line2113' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":2113
 * 
 *         for win_idx in range(start_window, end_window):
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if win_idx == start_window or (win_idx > start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):
 *                     for admx_idx1 in range(self.K):
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2114")'> 2114:                 if win_idx == start_window or (win_idx &gt; start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):</pre>
<pre id='line2114' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2114
 *         for win_idx in range(start_window, end_window):
 *             if self._ibs[win_idx]:
 *                 if win_idx == start_window or (win_idx > start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 */
      __pyx_t_7 = (__pyx_v_win_idx == __pyx_v_start_window);
      if (!__pyx_t_7) {
        __pyx_t_8 = (__pyx_v_win_idx > __pyx_v_start_window);
        if (__pyx_t_8) {
          if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
            __pyx_t_9 = (!(__pyx_v_self->_ibs[(__pyx_v_win_idx - 1)]));
            __pyx_t_10 = __pyx_t_9;
          } else {
            __pyx_t_10 = (__pyx_v_self->_ibs[__pyx_v_win_idx]);
          }
          __pyx_t_9 = __pyx_t_10;
        } else {
          __pyx_t_9 = __pyx_t_8;
        }
        __pyx_t_8 = __pyx_t_9;
      } else {
        __pyx_t_8 = __pyx_t_7;
      }
      if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2115")'> 2115:                     for admx_idx1 in range(self.K):</pre>
<pre id='line2115' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2115
 *             if self._ibs[win_idx]:
 *                 if win_idx == start_window or (win_idx > start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_11 = __pyx_v_self->K;
        for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
          __pyx_v_admx_idx1 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2116")'> 2116:                         for admx_idx2 in range(self.K):</pre>
<pre id='line2116' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2116
 *                 if win_idx == start_window or (win_idx > start_window and self._ibs[win_idx] and not self._ibs[win_idx-1]):
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_13 = __pyx_v_self->K;
          for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
            __pyx_v_admx_idx2 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2117")'> 2117:                             for admx_idx3 in range(self.K):</pre>
<pre id='line2117' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":2117
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_15 = __pyx_v_self->K;
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
              __pyx_v_admx_idx3 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2118")'> 2118:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line2118' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2118
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 */
              __pyx_t_17 = __pyx_v_self->K;
              for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                __pyx_v_admx_idx4 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2119")'> 2119:                                     for ibd in range(2):</pre>
<pre id='line2119' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2119
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \
 *                                         logsumexp(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 */
                for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> 2; __pyx_t_19+=1) {
                  __pyx_v_ibd = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2120")'> 2120:                                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line2120' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2120
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         logsumexp(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 *                                                               self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \
 */
                  ((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = logsumexp(((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]), ((((((((((__pyx_v_self->_top_level_ems_prob[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx1]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx2]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx3]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx4]))));
                }
              }
            }
          }
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2121")'> 2121:                                         logsumexp(self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\</pre>
<pre id='line2121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2122")'> 2122:                                                               self._top_level_ems_prob[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \</pre>
<pre id='line2122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2123")'> 2123:                                                               log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))</pre>
<pre id='line2123' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2124")'> 2124: </pre>
<pre id='line2124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2125")'> 2125:                 if win_idx &lt; end_window - 1:</pre>
<pre id='line2125' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2125
 *                                                               log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 *                 if win_idx <code><</code> end_window - 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 */
      __pyx_t_8 = (__pyx_v_win_idx <code><</code> (__pyx_v_end_window - 1));
      if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2126")'> 2126:                     for admx_idx1 in range(self.K):</pre>
<pre id='line2126' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2126
 * 
 *                 if win_idx <code><</code> end_window - 1:
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_11 = __pyx_v_self->K;
        for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
          __pyx_v_admx_idx1 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2127")'> 2127:                         for admx_idx2 in range(self.K):</pre>
<pre id='line2127' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2127
 *                 if win_idx <code><</code> end_window - 1:
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_13 = __pyx_v_self->K;
          for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
            __pyx_v_admx_idx2 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2128")'> 2128:                             for admx_idx3 in range(self.K):</pre>
<pre id='line2128' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":2128
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_15 = __pyx_v_self->K;
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
              __pyx_v_admx_idx3 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2129")'> 2129:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line2129' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2129
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):
 */
              __pyx_t_17 = __pyx_v_self->K;
              for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                __pyx_v_admx_idx4 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2130")'> 2130:                                     for ibd in range(2):</pre>
<pre id='line2130' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2130
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):
 */
                for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> 2; __pyx_t_19+=1) {
                  __pyx_v_ibd = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2131")'> 2131:                                         for prev_admx_idx1 in range(self.K):</pre>
<pre id='line2131' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2131
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):
 */
                  __pyx_t_20 = __pyx_v_self->K;
                  for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                    __pyx_v_prev_admx_idx1 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2132")'> 2132:                                             for prev_admx_idx2 in range(self.K):</pre>
<pre id='line2132' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":2132
 *                                     for ibd in range(2):
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):
 */
                    __pyx_t_22 = __pyx_v_self->K;
                    for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                      __pyx_v_prev_admx_idx2 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2133")'> 2133:                                                 for prev_admx_idx3 in range(self.K):</pre>
<pre id='line2133' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":2133
 *                                         for prev_admx_idx1 in range(self.K):
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):
 */
                      __pyx_t_24 = __pyx_v_self->K;
                      for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
                        __pyx_v_prev_admx_idx3 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2134")'> 2134:                                                     for prev_admx_idx4 in range(self.K):</pre>
<pre id='line2134' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":2134
 *                                             for prev_admx_idx2 in range(self.K):
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         for prev_ibd in range(2):
 *                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 */
                        __pyx_t_26 = __pyx_v_self->K;
                        for (__pyx_t_27 = 0; __pyx_t_27 <code><</code> __pyx_t_26; __pyx_t_27+=1) {
                          __pyx_v_prev_admx_idx4 = __pyx_t_27;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2135")'> 2135:                                                         for prev_ibd in range(2):</pre>
<pre id='line2135' class='code' style='background-color: #FFFFff'>
                          /* "LDModel.pyx":2135
 *                                                 for prev_admx_idx3 in range(self.K):
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 */
                          for (__pyx_t_28 = 0; __pyx_t_28 <code><</code> 2; __pyx_t_28+=1) {
                            __pyx_v_prev_ibd = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line2136")'> 2136:                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))</pre>
<pre id='line2136' class='code' style='background-color: #FFFF23'>
                            /* "LDModel.pyx":2136
 *                                                     for prev_admx_idx4 in range(self.K):
 *                                                         for prev_ibd in range(2):
 *                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef calc_top_level_backward_probs(self, int start_window, int end_window):
 */
                            ((((((__pyx_v_self->_top_level_forward_probs[(__pyx_v_win_idx + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = logsumexp(((((((__pyx_v_self->_top_level_forward_probs[(__pyx_v_win_idx + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]), (((((((((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_prev_admx_idx1])[__pyx_v_prev_admx_idx2])[__pyx_v_prev_admx_idx3])[__pyx_v_prev_admx_idx4])[__pyx_v_prev_ibd]) + ((((((__pyx_v_self->_top_level_ems_prob[(__pyx_v_win_idx + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd])) + log(((((__pyx_v_self->_s[__pyx_v_admx_idx1])[__pyx_v_win_idx])[__pyx_v_prev_ibd])[__pyx_v_ibd]))) + log((((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_prev_admx_idx1])[__pyx_v_prev_admx_idx2])[__pyx_v_prev_admx_idx3])[__pyx_v_prev_admx_idx4])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx1]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx2]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx3]))) + log((__pyx_v_self->_alphas[__pyx_v_admx_idx4]))));
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
        goto __pyx_L17;
      }
      __pyx_L17:;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_forward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_97calc_top_level_forward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_97calc_top_level_forward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start_window;
  int __pyx_v_end_window;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_forward_probs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__start_window,&__pyx_n_s__end_window,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__start_window)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__end_window)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_forward_probs", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_top_level_forward_probs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_start_window = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start_window == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end_window = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end_window == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_forward_probs", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_forward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_96calc_top_level_forward_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_start_window, __pyx_v_end_window);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2137")'> 2137: </pre>
<pre id='line2137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line2138")'> 2138:     cpdef calc_top_level_backward_probs(self, int start_window, int end_window):</pre>
<pre id='line2138' class='code' style='background-color: #FFFF30'>
/* "LDModel.pyx":2138
 *                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 *     cpdef calc_top_level_backward_probs(self, int start_window, int end_window):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_99calc_top_level_backward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_calc_top_level_backward_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_start_window, int __pyx_v_end_window, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  int __pyx_v_nxt_admx_idx1;
  int __pyx_v_nxt_admx_idx2;
  int __pyx_v_nxt_admx_idx3;
  int __pyx_v_nxt_admx_idx4;
  int __pyx_v_nxt_ibd;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_backward_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_backward_probs", __pyx_f[0], 2138);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_87);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_99calc_top_level_backward_probs)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_start_window);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_end_window);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2138
 *                                                             self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = logsumexp(self._top_level_forward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd], self._top_level_forward_probs[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][prev_ibd] + self._top_level_ems_prob[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + log(self._s[admx_idx1][win_idx][prev_ibd][ibd]) + log(self._anc_trans[win_idx][prev_admx_idx1][prev_admx_idx2][prev_admx_idx3][prev_admx_idx4][admx_idx1][admx_idx2][admx_idx3][admx_idx4]) + log(self._alphas[admx_idx1]) + log(self._alphas[admx_idx2]) + log(self._alphas[admx_idx3]) + log(self._alphas[admx_idx4]))
 * 
 *     cpdef calc_top_level_backward_probs(self, int start_window, int end_window):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_98calc_top_level_backward_probs(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_start_window, int __pyx_v_end_window) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_backward_probs", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("calc_top_level_backward_probs", __pyx_f[0], 2138);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->calc_top_level_backward_probs(__pyx_v_self, __pyx_v_start_window, __pyx_v_end_window, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_backward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2139")'> 2139:         cdef int win_idx</pre>
<pre id='line2139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2140")'> 2140:         cdef int admx_idx1</pre>
<pre id='line2140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2141")'> 2141:         cdef int admx_idx2</pre>
<pre id='line2141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2142")'> 2142:         cdef int admx_idx3</pre>
<pre id='line2142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2143")'> 2143:         cdef int admx_idx4</pre>
<pre id='line2143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2144")'> 2144:         cdef int ibd</pre>
<pre id='line2144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2145")'> 2145:         cdef int nxt_admx_idx1</pre>
<pre id='line2145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2146")'> 2146:         cdef int nxt_admx_idx2</pre>
<pre id='line2146' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2147")'> 2147:         cdef int nxt_admx_idx3</pre>
<pre id='line2147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2148")'> 2148:         cdef int nxt_admx_idx4</pre>
<pre id='line2148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2149")'> 2149:         cdef int nxt_ibd</pre>
<pre id='line2149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2150")'> 2150: </pre>
<pre id='line2150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2151")'> 2151:         #for win_idx in reversed(range(self.get_num_windows()-1)):</pre>
<pre id='line2151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2152")'> 2152:         for win_idx in reversed(range(start_window, end_window-1)):</pre>
<pre id='line2152' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2152
 * 
 *         #for win_idx in reversed(range(self.get_num_windows()-1)):
 *         for win_idx in reversed(range(start_window, end_window-1)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx+1]:
 *                 #print "calculating top level forward probs for window: " + str(win_idx)
 */
  __pyx_t_5 = __pyx_v_start_window;
  for (__pyx_t_6 = (__pyx_v_end_window - 1)-1; __pyx_t_6 >= __pyx_t_5; __pyx_t_6-=1) {
    __pyx_v_win_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2153")'> 2153:             if self._ibs[win_idx+1]:</pre>
<pre id='line2153' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":2153
 *         #for win_idx in reversed(range(self.get_num_windows()-1)):
 *         for win_idx in reversed(range(start_window, end_window-1)):
 *             if self._ibs[win_idx+1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #print "calculating top level forward probs for window: " + str(win_idx)
 * 
 */
    __pyx_t_7 = (__pyx_v_self->_ibs[(__pyx_v_win_idx + 1)]);
    if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2154")'> 2154:                 #print "calculating top level forward probs for window: " + str(win_idx)</pre>
<pre id='line2154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2155")'> 2155: </pre>
<pre id='line2155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2156")'> 2156:                 if win_idx == end_window-2 or (self._ibs[win_idx+1] and not self._ibs[win_idx+2]):</pre>
<pre id='line2156' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2156
 *                 #print "calculating top level forward probs for window: " + str(win_idx)
 * 
 *                 if win_idx == end_window-2 or (self._ibs[win_idx+1] and not self._ibs[win_idx+2]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 */
      __pyx_t_8 = (__pyx_v_win_idx == (__pyx_v_end_window - 2));
      if (!__pyx_t_8) {
        if ((__pyx_v_self->_ibs[(__pyx_v_win_idx + 1)])) {
          __pyx_t_9 = (!(__pyx_v_self->_ibs[(__pyx_v_win_idx + 2)]));
          __pyx_t_10 = __pyx_t_9;
        } else {
          __pyx_t_10 = (__pyx_v_self->_ibs[(__pyx_v_win_idx + 1)]);
        }
        __pyx_t_9 = __pyx_t_10;
      } else {
        __pyx_t_9 = __pyx_t_8;
      }
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2157")'> 2157:                     for admx_idx1 in range(self.K):</pre>
<pre id='line2157' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2157
 * 
 *                 if win_idx == end_window-2 or (self._ibs[win_idx+1] and not self._ibs[win_idx+2]):
 *                     for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 */
        __pyx_t_11 = __pyx_v_self->K;
        for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
          __pyx_v_admx_idx1 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2158")'> 2158:                         for admx_idx2 in range(self.K):</pre>
<pre id='line2158' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2158
 *                 if win_idx == end_window-2 or (self._ibs[win_idx+1] and not self._ibs[win_idx+2]):
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 */
          __pyx_t_13 = __pyx_v_self->K;
          for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
            __pyx_v_admx_idx2 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2159")'> 2159:                             for admx_idx3 in range(self.K):</pre>
<pre id='line2159' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":2159
 *                     for admx_idx1 in range(self.K):
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):
 */
            __pyx_t_15 = __pyx_v_self->K;
            for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
              __pyx_v_admx_idx3 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2160")'> 2160:                                 for admx_idx4 in range(self.K):</pre>
<pre id='line2160' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2160
 *                         for admx_idx2 in range(self.K):
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for ibd in range(2):
 * #                                         print str(win_idx+1) + " top level backward probs before scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(1)
 */
              __pyx_t_17 = __pyx_v_self->K;
              for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
                __pyx_v_admx_idx4 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2161")'> 2161:                                     for ibd in range(2):</pre>
<pre id='line2161' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2161
 *                             for admx_idx3 in range(self.K):
 *                                 for admx_idx4 in range(self.K):
 *                                     for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                         print str(win_idx+1) + " top level backward probs before scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(1)
 *                                         self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0 #self._top_level_scale_factor[win_idx+1]
 */
                for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> 2; __pyx_t_19+=1) {
                  __pyx_v_ibd = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2162")'> 2162: #                                         print str(win_idx+1) + " top level backward probs before scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(1)</pre>
<pre id='line2162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2163")'> 2163:                                         self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0 #self._top_level_scale_factor[win_idx+1]</pre>
<pre id='line2163' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2163
 *                                     for ibd in range(2):
 * #                                         print str(win_idx+1) + " top level backward probs before scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(1)
 *                                         self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0 #self._top_level_scale_factor[win_idx+1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                         print str(win_idx+1) + " top level backward probs after scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 */
                  ((((((__pyx_v_self->_top_level_backward_probs[(__pyx_v_win_idx + 1)])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = 0.0;
                }
              }
            }
          }
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2164")'> 2164: #                                         print str(win_idx+1) + " top level backward probs after scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2165")'> 2165: </pre>
<pre id='line2165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2166")'> 2166:                 for admx_idx1 in range(self.K):</pre>
<pre id='line2166' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2166
 * #                                         print str(win_idx+1) + " top level backward probs after scaling " + str(win_idx+1) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx+1][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 */
      __pyx_t_11 = __pyx_v_self->K;
      for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
        __pyx_v_admx_idx1 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2167")'> 2167:                     for admx_idx2 in range(self.K):</pre>
<pre id='line2167' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2167
 * 
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 */
        __pyx_t_13 = __pyx_v_self->K;
        for (__pyx_t_14 = 0; __pyx_t_14 <code><</code> __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_admx_idx2 = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2168")'> 2168:                         for admx_idx3 in range(self.K):</pre>
<pre id='line2168' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2168
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 */
          __pyx_t_15 = __pyx_v_self->K;
          for (__pyx_t_16 = 0; __pyx_t_16 <code><</code> __pyx_t_15; __pyx_t_16+=1) {
            __pyx_v_admx_idx3 = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2169")'> 2169:                             for admx_idx4 in range(self.K):</pre>
<pre id='line2169' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":2169
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 *                                     for nxt_admx_idx1 in range(self.K):
 */
            __pyx_t_17 = __pyx_v_self->K;
            for (__pyx_t_18 = 0; __pyx_t_18 <code><</code> __pyx_t_17; __pyx_t_18+=1) {
              __pyx_v_admx_idx4 = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2170")'> 2170:                                 for ibd in range(2):</pre>
<pre id='line2170' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2170
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     for nxt_admx_idx1 in range(self.K):
 *                                         for nxt_admx_idx2 in range(self.K):
 */
              for (__pyx_t_19 = 0; __pyx_t_19 <code><</code> 2; __pyx_t_19+=1) {
                __pyx_v_ibd = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2171")'> 2171:                                     for nxt_admx_idx1 in range(self.K):</pre>
<pre id='line2171' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2171
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 *                                     for nxt_admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         for nxt_admx_idx2 in range(self.K):
 *                                             for nxt_admx_idx3 in range(self.K):
 */
                __pyx_t_20 = __pyx_v_self->K;
                for (__pyx_t_21 = 0; __pyx_t_21 <code><</code> __pyx_t_20; __pyx_t_21+=1) {
                  __pyx_v_nxt_admx_idx1 = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2172")'> 2172:                                         for nxt_admx_idx2 in range(self.K):</pre>
<pre id='line2172' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2172
 *                                 for ibd in range(2):
 *                                     for nxt_admx_idx1 in range(self.K):
 *                                         for nxt_admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                             for nxt_admx_idx3 in range(self.K):
 *                                                 for nxt_admx_idx4 in range(self.K):
 */
                  __pyx_t_22 = __pyx_v_self->K;
                  for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_22; __pyx_t_23+=1) {
                    __pyx_v_nxt_admx_idx2 = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2173")'> 2173:                                             for nxt_admx_idx3 in range(self.K):</pre>
<pre id='line2173' class='code' style='background-color: #FFFFff'>
                    /* "LDModel.pyx":2173
 *                                     for nxt_admx_idx1 in range(self.K):
 *                                         for nxt_admx_idx2 in range(self.K):
 *                                             for nxt_admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                 for nxt_admx_idx4 in range(self.K):
 *                                                     for nxt_ibd in range(2):
 */
                    __pyx_t_24 = __pyx_v_self->K;
                    for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
                      __pyx_v_nxt_admx_idx3 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2174")'> 2174:                                                 for nxt_admx_idx4 in range(self.K):</pre>
<pre id='line2174' class='code' style='background-color: #FFFFff'>
                      /* "LDModel.pyx":2174
 *                                         for nxt_admx_idx2 in range(self.K):
 *                                             for nxt_admx_idx3 in range(self.K):
 *                                                 for nxt_admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                     for nxt_ibd in range(2):
 *                                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] =\
 */
                      __pyx_t_26 = __pyx_v_self->K;
                      for (__pyx_t_27 = 0; __pyx_t_27 <code><</code> __pyx_t_26; __pyx_t_27+=1) {
                        __pyx_v_nxt_admx_idx4 = __pyx_t_27;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2175")'> 2175:                                                     for nxt_ibd in range(2):</pre>
<pre id='line2175' class='code' style='background-color: #FFFFff'>
                        /* "LDModel.pyx":2175
 *                                             for nxt_admx_idx3 in range(self.K):
 *                                                 for nxt_admx_idx4 in range(self.K):
 *                                                     for nxt_ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] =\
 *                                                         logsumexp(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 */
                        for (__pyx_t_28 = 0; __pyx_t_28 <code><</code> 2; __pyx_t_28+=1) {
                          __pyx_v_nxt_ibd = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line2176")'> 2176:                                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] =\</pre>
<pre id='line2176' class='code' style='background-color: #FFFF23'>
                          /* "LDModel.pyx":2176
 *                                                 for nxt_admx_idx4 in range(self.K):
 *                                                     for nxt_ibd in range(2):
 *                                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] =\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                                         logsumexp(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\
 *                                                         self._top_level_backward_probs[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd] + \
 */
                          ((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) = logsumexp(((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]), (((((((((((((__pyx_v_self->_top_level_backward_probs[(__pyx_v_win_idx + 1)])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4])[__pyx_v_nxt_ibd]) + ((((((__pyx_v_self->_top_level_ems_prob[(__pyx_v_win_idx + 1)])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4])[__pyx_v_nxt_ibd])) + log(((((__pyx_v_self->_s[__pyx_v_admx_idx1])[__pyx_v_win_idx])[__pyx_v_ibd])[__pyx_v_nxt_ibd]))) + log((((((((((__pyx_v_self->_anc_trans[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_nxt_admx_idx1])[__pyx_v_nxt_admx_idx2])[__pyx_v_nxt_admx_idx3])[__pyx_v_nxt_admx_idx4]))) + log((__pyx_v_self->_alphas[__pyx_v_nxt_admx_idx1]))) + log((__pyx_v_self->_alphas[__pyx_v_nxt_admx_idx2]))) + log((__pyx_v_self->_alphas[__pyx_v_nxt_admx_idx3]))) + log((__pyx_v_self->_alphas[__pyx_v_nxt_admx_idx4]))));
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_backward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_99calc_top_level_backward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_99calc_top_level_backward_probs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start_window;
  int __pyx_v_end_window;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_top_level_backward_probs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__start_window,&__pyx_n_s__end_window,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__start_window)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__end_window)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_backward_probs", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_top_level_backward_probs") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_start_window = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start_window == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end_window = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end_window == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_top_level_backward_probs", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2138; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.calc_top_level_backward_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_98calc_top_level_backward_probs(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), __pyx_v_start_window, __pyx_v_end_window);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2177")'> 2177:                                                         logsumexp(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd],\</pre>
<pre id='line2177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2178")'> 2178:                                                         self._top_level_backward_probs[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd] + \</pre>
<pre id='line2178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2179")'> 2179:                                                         self._top_level_ems_prob[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd] + \</pre>
<pre id='line2179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2180")'> 2180:                                                         log(self._s[admx_idx1][win_idx][ibd][nxt_ibd]) + \</pre>
<pre id='line2180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2181")'> 2181:                                                         log(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4]) + \</pre>
<pre id='line2181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2182")'> 2182:                                                         log(self._alphas[nxt_admx_idx1]) + log(self._alphas[nxt_admx_idx2]) + log(self._alphas[nxt_admx_idx3]) + \</pre>
<pre id='line2182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2183")'> 2183:                                                         log(self._alphas[nxt_admx_idx4]))</pre>
<pre id='line2183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2184")'> 2184: #                                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] += \</pre>
<pre id='line2184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2185")'> 2185: #                                                         self._top_level_backward_probs[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd] * \</pre>
<pre id='line2185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2186")'> 2186: #                                                         self._top_level_ems_prob[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd] * \</pre>
<pre id='line2186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2187")'> 2187: #                                                         self._s[admx_idx1][win_idx][ibd][nxt_ibd] * \</pre>
<pre id='line2187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2188")'> 2188: #                                                         self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4] * \</pre>
<pre id='line2188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2189")'> 2189: #                                                         self._alphas[nxt_admx_idx1] * self._alphas[nxt_admx_idx2] * self._alphas[nxt_admx_idx3] * self._alphas[nxt_admx_idx4]</pre>
<pre id='line2189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2190")'> 2190: </pre>
<pre id='line2190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2191")'> 2191: #                                     print str(win_idx) + " top level backward probs before scaling " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2192")'> 2192: #                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = \</pre>
<pre id='line2192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2193")'> 2193: #                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] * \</pre>
<pre id='line2193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2194")'> 2194: #                                     self._top_level_scale_factor[win_idx+1]</pre>
<pre id='line2194' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2195")'> 2195: #                                     if not c_isfinite(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd]):</pre>
<pre id='line2195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2196")'> 2196: #                                         self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] = 0.0</pre>
<pre id='line2196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2197")'> 2197: #                                     print str(win_idx) + " top level backward probs after scaling " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2198")'> 2198:                                                         #print "&gt;backward " + str(win_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(nxt_admx_idx1) + " " + str(nxt_admx_idx2) + " " + str(nxt_admx_idx3) + " " + str(nxt_admx_idx4) + " " + str(nxt_ibd) + " ems_prob: " + str(self._top_level_ems_prob[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd])</pre>
<pre id='line2198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2199")'> 2199:                                                         #print "&gt;backward " + str(win_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(nxt_admx_idx1) + " " + str(nxt_admx_idx2) + " " + str(nxt_admx_idx3) + " " + str(nxt_admx_idx4) + " " + str(nxt_ibd) + " _s: " + str(self._s[win_idx][ibd][nxt_ibd])</pre>
<pre id='line2199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2200")'> 2200:                                                         #print "&gt;backward " + str(win_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(nxt_admx_idx1) + " " + str(nxt_admx_idx2) + " " + str(nxt_admx_idx3) + " " + str(nxt_admx_idx4) + " " + str(nxt_ibd) + " _anc_trans: " + str(self._anc_trans[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4])</pre>
<pre id='line2200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2201")'> 2201:                                                         #print "&gt;backward " + str(win_idx) + " " + str(admx_idx1) + " " + str(admx_idx2) + " " + str(admx_idx3) + " " + str(admx_idx4) + " " + str(ibd) + " " + str(nxt_admx_idx1) + " " + str(nxt_admx_idx2) + " " + str(nxt_admx_idx3) + " " + str(nxt_admx_idx4) + " " + str(nxt_ibd) + " _backward prob i+1: " + str(self._top_level_backward_probs[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd])</pre>
<pre id='line2201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2202")'> 2202:                                                         #print "yyyyyyyyyyyyyyyyyyyy " + str(win_idx) + " " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + str(self._top_level_backward_probs[win_idx+1][nxt_admx_idx1][nxt_admx_idx2][nxt_admx_idx3][nxt_admx_idx4][nxt_ibd])</pre>
<pre id='line2202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2203")'> 2203:                                     #if ibd == 0:</pre>
<pre id='line2203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2204")'> 2204:                                     #    print "back top level params: " + str(self._ibd_prior[ibd]) + " " + str(self._alphas[admx_idx1]) + " " + str(self._alphas[admx_idx2]) + " " + str(self._alphas[admx_idx3]) + " "  + str(self._alphas[admx_idx4])</pre>
<pre id='line2204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2205")'> 2205:                                     #    print "back top level forward probs " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])</pre>
<pre id='line2205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2206")'> 2206: </pre>
<pre id='line2206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line2207")'> 2207:     cpdef posterior_top_level_decoding(self):</pre>
<pre id='line2207' class='code' style='background-color: #FFFF48'>
/* "LDModel.pyx":2207
 *                                     #    print "back top level forward probs " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *     cpdef posterior_top_level_decoding(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_101posterior_top_level_decoding(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_posterior_top_level_decoding(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_win_idx;
  int __pyx_v_admx_idx1;
  int __pyx_v_admx_idx2;
  int __pyx_v_admx_idx3;
  int __pyx_v_admx_idx4;
  int __pyx_v_ibd;
  double __pyx_v_curr_gamma;
  PyObject *__pyx_v_ibd_probs = NULL;
  PyObject *__pyx_v_non_ibd_probs = NULL;
  PyObject *__pyx_v_pairIBD = NULL;
  double __pyx_v_curr_ibd_prob;
  double __pyx_v_curr_non_ibd_prob;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("posterior_top_level_decoding", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("posterior_top_level_decoding", __pyx_f[0], 2207);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_88);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_101posterior_top_level_decoding)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2207
 *                                     #    print "back top level forward probs " + str(admx_idx1) + " " +  str(admx_idx2) + " " +  str(admx_idx3) + " " +  str(admx_idx4) + " " +  str(ibd) + ": " + str(self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd])
 * 
 *     cpdef posterior_top_level_decoding(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int win_idx
 *         cdef int admx_idx1
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_100posterior_top_level_decoding(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("posterior_top_level_decoding", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("posterior_top_level_decoding", __pyx_f[0], 2207);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->posterior_top_level_decoding(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.posterior_top_level_decoding", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2208")'> 2208:         cdef int win_idx</pre>
<pre id='line2208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2209")'> 2209:         cdef int admx_idx1</pre>
<pre id='line2209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2210")'> 2210:         cdef int admx_idx2</pre>
<pre id='line2210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2211")'> 2211:         cdef int admx_idx3</pre>
<pre id='line2211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2212")'> 2212:         cdef int admx_idx4</pre>
<pre id='line2212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2213")'> 2213:         cdef int ibd</pre>
<pre id='line2213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2214")'> 2214:         cdef double curr_gamma</pre>
<pre id='line2214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2215")'> 2215: </pre>
<pre id='line2215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2216")'> 2216: #         anc_pairs = list(combinations_with_replacement(range(self.K),2))</pre>
<pre id='line2216' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2217")'> 2217: #         curr_anc1 = [0]*len(anc_pairs)</pre>
<pre id='line2217' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2218")'> 2218: #         curr_anc2 = [0]*len(anc_pairs)</pre>
<pre id='line2218' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2219")'> 2219: </pre>
<pre id='line2219' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2220")'> 2220:         ibd_probs = []</pre>
<pre id='line2220' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":2220
 * #         curr_anc2 = [0]*len(anc_pairs)
 * 
 *         ibd_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         non_ibd_probs = []
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_ibd_probs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2221")'> 2221:         non_ibd_probs = []</pre>
<pre id='line2221' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":2221
 * 
 *         ibd_probs = []
 *         non_ibd_probs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         pairIBD = cPairIBD()
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_non_ibd_probs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2222")'> 2222: </pre>
<pre id='line2222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2223")'> 2223:         pairIBD = cPairIBD()</pre>
<pre id='line2223' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":2223
 *         non_ibd_probs = []
 * 
 *         pairIBD = cPairIBD()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__cPairIBD);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pairIBD = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2224")'> 2224:         for win_idx in range(self.get_num_windows()):</pre>
<pre id='line2224' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2224
 * 
 *         pairIBD = cPairIBD()
 *         for win_idx in range(self.get_num_windows()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._ibs[win_idx]:
 *                 curr_ibd_prob = -DBL_MAX
 */
  __pyx_t_3 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 0);
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_win_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2225")'> 2225:             if self._ibs[win_idx]:</pre>
<pre id='line2225' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":2225
 *         pairIBD = cPairIBD()
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 curr_ibd_prob = -DBL_MAX
 *                 curr_non_ibd_prob = -DBL_MAX
 */
    if ((__pyx_v_self->_ibs[__pyx_v_win_idx])) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2226")'> 2226:                 curr_ibd_prob = -DBL_MAX</pre>
<pre id='line2226' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2226
 *         for win_idx in range(self.get_num_windows()):
 *             if self._ibs[win_idx]:
 *                 curr_ibd_prob = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 curr_non_ibd_prob = -DBL_MAX
 *                 for admx_idx1 in range(self.K):
 */
      __pyx_v_curr_ibd_prob = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2227")'> 2227:                 curr_non_ibd_prob = -DBL_MAX</pre>
<pre id='line2227' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2227
 *             if self._ibs[win_idx]:
 *                 curr_ibd_prob = -DBL_MAX
 *                 curr_non_ibd_prob = -DBL_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 */
      __pyx_v_curr_non_ibd_prob = (-DBL_MAX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2228")'> 2228:                 for admx_idx1 in range(self.K):</pre>
<pre id='line2228' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2228
 *                 curr_ibd_prob = -DBL_MAX
 *                 curr_non_ibd_prob = -DBL_MAX
 *                 for admx_idx1 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 */
      __pyx_t_5 = __pyx_v_self->K;
      for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
        __pyx_v_admx_idx1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2229")'> 2229:                     for admx_idx2 in range(self.K):</pre>
<pre id='line2229' class='code' style='background-color: #FFFFff'>
        /* "LDModel.pyx":2229
 *                 curr_non_ibd_prob = -DBL_MAX
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 */
        __pyx_t_7 = __pyx_v_self->K;
        for (__pyx_t_8 = 0; __pyx_t_8 <code><</code> __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_admx_idx2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2230")'> 2230:                         for admx_idx3 in range(self.K):</pre>
<pre id='line2230' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2230
 *                 for admx_idx1 in range(self.K):
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):
 */
          __pyx_t_9 = __pyx_v_self->K;
          for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
            __pyx_v_admx_idx3 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2231")'> 2231:                             for admx_idx4 in range(self.K):</pre>
<pre id='line2231' class='code' style='background-color: #FFFFff'>
            /* "LDModel.pyx":2231
 *                     for admx_idx2 in range(self.K):
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 for ibd in range(2):
 * #                                     if self._top_level_scale_factor[win_idx] == 0:
 */
            __pyx_t_11 = __pyx_v_self->K;
            for (__pyx_t_12 = 0; __pyx_t_12 <code><</code> __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_admx_idx4 = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2232")'> 2232:                                 for ibd in range(2):</pre>
<pre id='line2232' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2232
 *                         for admx_idx3 in range(self.K):
 *                             for admx_idx4 in range(self.K):
 *                                 for ibd in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                                     if self._top_level_scale_factor[win_idx] == 0:
 * #                                         print "top level scare factor is zero, in win_idx: " + str(win_idx) + " ibd: " + str(ibd)
 */
              for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> 2; __pyx_t_13+=1) {
                __pyx_v_ibd = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2233")'> 2233: #                                     if self._top_level_scale_factor[win_idx] == 0:</pre>
<pre id='line2233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2234")'> 2234: #                                         print "top level scare factor is zero, in win_idx: " + str(win_idx) + " ibd: " + str(ibd)</pre>
<pre id='line2234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2235")'> 2235:                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \</pre>
<pre id='line2235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2236")'> 2236:                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])</pre>
<pre id='line2236' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2236
 * #                                         print "top level scare factor is zero, in win_idx: " + str(win_idx) + " ibd: " + str(ibd)
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     if ibd == 0:
 *                                         #curr_non_ibd_prob += curr_gamma
 */
                __pyx_v_curr_gamma = (((((((__pyx_v_self->_top_level_forward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]) + ((((((__pyx_v_self->_top_level_backward_probs[__pyx_v_win_idx])[__pyx_v_admx_idx1])[__pyx_v_admx_idx2])[__pyx_v_admx_idx3])[__pyx_v_admx_idx4])[__pyx_v_ibd]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2237")'> 2237:                                     if ibd == 0:</pre>
<pre id='line2237' class='code' style='background-color: #FFFFff'>
                /* "LDModel.pyx":2237
 *                                     curr_gamma = self._top_level_forward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] + \
 *                                     self._top_level_backward_probs[win_idx][admx_idx1][admx_idx2][admx_idx3][admx_idx4][ibd] #* (1.0/self._top_level_scale_factor[win_idx])
 *                                     if ibd == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         #curr_non_ibd_prob += curr_gamma
 *                                         curr_non_ibd_prob = logsumexp(curr_non_ibd_prob,curr_gamma)
 */
                __pyx_t_14 = (__pyx_v_ibd == 0);
                if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2238")'> 2238:                                         #curr_non_ibd_prob += curr_gamma</pre>
<pre id='line2238' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2239")'> 2239:                                         curr_non_ibd_prob = logsumexp(curr_non_ibd_prob,curr_gamma)</pre>
<pre id='line2239' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2239
 *                                     if ibd == 0:
 *                                         #curr_non_ibd_prob += curr_gamma
 *                                         curr_non_ibd_prob = logsumexp(curr_non_ibd_prob,curr_gamma)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     else:
 * #                                         curr_ibd_prob += curr_gamma
 */
                  __pyx_v_curr_non_ibd_prob = logsumexp(__pyx_v_curr_non_ibd_prob, __pyx_v_curr_gamma);
                  goto __pyx_L16;
                }
                /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2240")'> 2240:                                     else:</pre>
<pre id='line2240' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2241")'> 2241: #                                         curr_ibd_prob += curr_gamma</pre>
<pre id='line2241' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2242")'> 2242:                                         curr_ibd_prob = logsumexp(curr_ibd_prob,curr_gamma)</pre>
<pre id='line2242' class='code' style='background-color: #FFFFff'>
                  /* "LDModel.pyx":2242
 *                                     else:
 * #                                         curr_ibd_prob += curr_gamma
 *                                         curr_ibd_prob = logsumexp(curr_ibd_prob,curr_gamma)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                 curr_tot = curr_non_ibd_prob + curr_ibd_prob
 * #                 if curr_tot > 0:
 */
                  __pyx_v_curr_ibd_prob = logsumexp(__pyx_v_curr_ibd_prob, __pyx_v_curr_gamma);
                }
                __pyx_L16:;
              }
            }
          }
        }
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2243")'> 2243: #                 curr_tot = curr_non_ibd_prob + curr_ibd_prob</pre>
<pre id='line2243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2244")'> 2244: #                 if curr_tot &gt; 0:</pre>
<pre id='line2244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2245")'> 2245: #                     curr_non_ibd_prob = curr_non_ibd_prob / curr_tot</pre>
<pre id='line2245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2246")'> 2246: #                     curr_ibd_prob = curr_ibd_prob / curr_tot</pre>
<pre id='line2246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2247")'> 2247: #                                     curr_anc1[anc_pairs.index(min(admx_idx1,admx_idx2),max(admx_idx1,admx_idx2))] += curr_gamma</pre>
<pre id='line2247' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2248")'> 2248: #                                     curr_anc2[anc_pairs.index(min(admx_idx3,admx_idx4),max(admx_idx3,admx_idx4))] += curr_gamma</pre>
<pre id='line2248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2249")'> 2249: #                 #if curr_ibd_prob &gt; curr_non_ibd_prob:</pre>
<pre id='line2249' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2250")'> 2250: #                 i += '1'</pre>
<pre id='line2250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2251")'> 2251: #                 #else:</pre>
<pre id='line2251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2252")'> 2252: #                 #    i += '0'</pre>
<pre id='line2252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2253")'> 2253: #</pre>
<pre id='line2253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2254")'> 2254: # #                 (curr_a1,curr_a2) = anc_pairs[curr_anc1.index(max(curr_anc1))]</pre>
<pre id='line2254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2255")'> 2255: # #                 (curr_a3,curr_a4) = anc_pairs[curr_anc2.index(max(curr_anc2))]</pre>
<pre id='line2255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2256")'> 2256: #                 a1 += '0' #str(curr_a1)</pre>
<pre id='line2256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2257")'> 2257: #                 a2 += '0' #str(curr_a2)</pre>
<pre id='line2257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2258")'> 2258: #                 a3 += '0' #str(curr_a3)</pre>
<pre id='line2258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2259")'> 2259: #                 a4 += '0' #str(curr_a4)</pre>
<pre id='line2259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2260")'> 2260: </pre>
<pre id='line2260' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2261")'> 2261:                 self._ibd_probs[win_idx] = curr_ibd_prob</pre>
<pre id='line2261' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2261
 * #                 a4 += '0' #str(curr_a4)
 * 
 *                 self._ibd_probs[win_idx] = curr_ibd_prob             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._no_ibd_probs[win_idx] = curr_non_ibd_prob
 *                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])
 */
      (__pyx_v_self->_ibd_probs[__pyx_v_win_idx]) = __pyx_v_curr_ibd_prob;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2262")'> 2262:                 self._no_ibd_probs[win_idx] = curr_non_ibd_prob</pre>
<pre id='line2262' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2262
 * 
 *                 self._ibd_probs[win_idx] = curr_ibd_prob
 *                 self._no_ibd_probs[win_idx] = curr_non_ibd_prob             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])
 *                 if self._lod_scores[win_idx] > self._min_score:
 */
      (__pyx_v_self->_no_ibd_probs[__pyx_v_win_idx]) = __pyx_v_curr_non_ibd_prob;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2263")'> 2263:                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])</pre>
<pre id='line2263' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2263
 *                 self._ibd_probs[win_idx] = curr_ibd_prob
 *                 self._no_ibd_probs[win_idx] = curr_non_ibd_prob
 *                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._lod_scores[win_idx] > self._min_score:
 *                     pairIBD.add_interval(win_idx*self._win_size,(win_idx+1)*self._win_size,self._lod_scores[win_idx])
 */
      (__pyx_v_self->_lod_scores[__pyx_v_win_idx]) = (2.0 * ((__pyx_v_self->_ibd_probs[__pyx_v_win_idx]) - (__pyx_v_self->_no_ibd_probs[__pyx_v_win_idx])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2264")'> 2264:                 if self._lod_scores[win_idx] &gt; self._min_score:</pre>
<pre id='line2264' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2264
 *                 self._no_ibd_probs[win_idx] = curr_non_ibd_prob
 *                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])
 *                 if self._lod_scores[win_idx] > self._min_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     pairIBD.add_interval(win_idx*self._win_size,(win_idx+1)*self._win_size,self._lod_scores[win_idx])
 *             else:
 */
      __pyx_t_14 = ((__pyx_v_self->_lod_scores[__pyx_v_win_idx]) > __pyx_v_self->_min_score);
      if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line2265")'> 2265:                     pairIBD.add_interval(win_idx*self._win_size,(win_idx+1)*self._win_size,self._lod_scores[win_idx])</pre>
<pre id='line2265' class='code' style='background-color: #FFFF37'>
        /* "LDModel.pyx":2265
 *                 self._lod_scores[win_idx] = 2*(self._ibd_probs[win_idx] - self._no_ibd_probs[win_idx])
 *                 if self._lod_scores[win_idx] > self._min_score:
 *                     pairIBD.add_interval(win_idx*self._win_size,(win_idx+1)*self._win_size,self._lod_scores[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 self._ibd_probs[win_idx] = -1
 */
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_pairIBD, __pyx_n_s__add_interval);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_win_idx * __pyx_v_self->_win_size));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_win_idx + 1) * __pyx_v_self->_win_size));<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
        __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_lod_scores[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_t_15);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_t_16);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_16);
        __pyx_t_1 = 0;
        __pyx_t_15 = 0;
        __pyx_t_16 = 0;
        __pyx_t_16 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        goto __pyx_L17;
      }
      __pyx_L17:;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2266")'> 2266:             else:</pre>
<pre id='line2266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2267")'> 2267:                 self._ibd_probs[win_idx] = -1</pre>
<pre id='line2267' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2267
 *                     pairIBD.add_interval(win_idx*self._win_size,(win_idx+1)*self._win_size,self._lod_scores[win_idx])
 *             else:
 *                 self._ibd_probs[win_idx] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._no_ibd_probs[win_idx] = -1
 * 
 */
      (__pyx_v_self->_ibd_probs[__pyx_v_win_idx]) = -1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2268")'> 2268:                 self._no_ibd_probs[win_idx] = -1</pre>
<pre id='line2268' class='code' style='background-color: #FFFFff'>
      /* "LDModel.pyx":2268
 *             else:
 *                 self._ibd_probs[win_idx] = -1
 *                 self._no_ibd_probs[win_idx] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             ibd_probs.append(self._ibd_probs[win_idx])
 */
      (__pyx_v_self->_no_ibd_probs[__pyx_v_win_idx]) = -1.0;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2269")'> 2269: </pre>
<pre id='line2269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2270")'> 2270:             ibd_probs.append(self._ibd_probs[win_idx])</pre>
<pre id='line2270' class='code' style='background-color: #FFFF79'>
    /* "LDModel.pyx":2270
 *                 self._no_ibd_probs[win_idx] = -1
 * 
 *             ibd_probs.append(self._ibd_probs[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             non_ibd_probs.append(self._no_ibd_probs[win_idx])
 * 
 */
    __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_ibd_probs[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
    __pyx_t_18 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_ibd_probs, __pyx_t_16);<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2271")'> 2271:             non_ibd_probs.append(self._no_ibd_probs[win_idx])</pre>
<pre id='line2271' class='code' style='background-color: #FFFF79'>
    /* "LDModel.pyx":2271
 * 
 *             ibd_probs.append(self._ibd_probs[win_idx])
 *             non_ibd_probs.append(self._no_ibd_probs[win_idx])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         a1_filt = ''
 */
    __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_no_ibd_probs[__pyx_v_win_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
    __pyx_t_18 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_non_ibd_probs, __pyx_t_16);<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2272")'> 2272: </pre>
<pre id='line2272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2273")'> 2273: #         a1_filt = ''</pre>
<pre id='line2273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2274")'> 2274: #         a2_filt = ''</pre>
<pre id='line2274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2275")'> 2275: #         a3_filt = ''</pre>
<pre id='line2275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2276")'> 2276: #         a4_filt = ''</pre>
<pre id='line2276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2277")'> 2277: #         i_filt = ''</pre>
<pre id='line2277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2278")'> 2278: #         for ind in range(len(i)):</pre>
<pre id='line2278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2279")'> 2279: #             start = max(0,ind-3)</pre>
<pre id='line2279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2280")'> 2280: #             end = min(ind+4,len(i))</pre>
<pre id='line2280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2281")'> 2281: #             a1_filt += str(int(np.median([int(x) for x in a1[start:end]])))</pre>
<pre id='line2281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2282")'> 2282: #             a2_filt += str(int(np.median([int(x) for x in a2[start:end]])))</pre>
<pre id='line2282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2283")'> 2283: #             a3_filt += str(int(np.median([int(x) for x in a3[start:end]])))</pre>
<pre id='line2283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2284")'> 2284: #             a4_filt += str(int(np.median([int(x) for x in a4[start:end]])))</pre>
<pre id='line2284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2285")'> 2285: #             i_filt += str(int(np.median([int(x) for x in i[start:end]])))</pre>
<pre id='line2285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2286")'> 2286: </pre>
<pre id='line2286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2287")'> 2287:         #pairIBD.merge_intervals()</pre>
<pre id='line2287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2288")'> 2288:         if self._debug:</pre>
<pre id='line2288' class='code' style='background-color: #FFFFff'>
  /* "LDModel.pyx":2288
 * 
 *         #pairIBD.merge_intervals()
 *         if self._debug:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.top_level_print()
 * 
 */
  if (__pyx_v_self->_debug) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2289")'> 2289:             self.top_level_print()</pre>
<pre id='line2289' class='code' style='background-color: #FFFFe7'>
    /* "LDModel.pyx":2289
 *         #pairIBD.merge_intervals()
 *         if self._debug:
 *             self.top_level_print()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return (pairIBD,ibd_probs,non_ibd_probs)
 */
    __pyx_t_16 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->top_level_print(__pyx_v_self, 0);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    goto __pyx_L18;
  }
  __pyx_L18:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2290")'> 2290: </pre>
<pre id='line2290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line2291")'> 2291:         return (pairIBD,ibd_probs,non_ibd_probs)</pre>
<pre id='line2291' class='code' style='background-color: #FFFF44'>
  /* "LDModel.pyx":2291
 *             self.top_level_print()
 * 
 *         return (pairIBD,ibd_probs,non_ibd_probs)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int start_snp(self, int win_idx):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pairIBD);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_v_pairIBD);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_pairIBD);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_ibd_probs));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, ((PyObject *)__pyx_v_ibd_probs));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_ibd_probs));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_non_ibd_probs));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, ((PyObject *)__pyx_v_non_ibd_probs));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_non_ibd_probs));
  __pyx_r = ((PyObject *)__pyx_t_16);
  __pyx_t_16 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.posterior_top_level_decoding", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ibd_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_ibd_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pairIBD);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_101posterior_top_level_decoding(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_101posterior_top_level_decoding(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("posterior_top_level_decoding (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_100posterior_top_level_decoding(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2292")'> 2292: </pre>
<pre id='line2292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2293")'> 2293:     cdef int start_snp(self, int win_idx):</pre>
<pre id='line2293' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":2293
 *         return (pairIBD,ibd_probs,non_ibd_probs)
 * 
 *     cdef int start_snp(self, int win_idx):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return max(0,win_idx * self._win_size)
 * 
 */

static int __pyx_f_7LDModel_7LDModel_start_snp(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx) {
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("start_snp", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("start_snp", __pyx_f[0], 2293);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2294")'> 2294:         return max(0,win_idx * self._win_size)</pre>
<pre id='line2294' class='code' style='background-color: #FFFFc4'>
  /* "LDModel.pyx":2294
 * 
 *     cdef int start_snp(self, int win_idx):
 *         return max(0,win_idx * self._win_size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int end_snp(self, int win_idx):
 */
  __pyx_t_1 = (__pyx_v_win_idx * __pyx_v_self->_win_size);
  __pyx_t_2 = 0;
  if ((__pyx_t_1 > __pyx_t_2)) {
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_3 = __pyx_t_2;
  }
  __pyx_r = __pyx_t_3;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2295")'> 2295: </pre>
<pre id='line2295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2296")'> 2296:     cdef int end_snp(self, int win_idx):</pre>
<pre id='line2296' class='code' style='background-color: #FFFFd4'>
/* "LDModel.pyx":2296
 *         return max(0,win_idx * self._win_size)
 * 
 *     cdef int end_snp(self, int win_idx):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return min((win_idx + 1) * self._win_size, self._snp_num)
 * 
 */

static int __pyx_f_7LDModel_7LDModel_end_snp(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_win_idx) {
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("end_snp", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("end_snp", __pyx_f[0], 2296);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2297")'> 2297:         return min((win_idx + 1) * self._win_size, self._snp_num)</pre>
<pre id='line2297' class='code' style='background-color: #FFFFc4'>
  /* "LDModel.pyx":2297
 * 
 *     cdef int end_snp(self, int win_idx):
 *         return min((win_idx + 1) * self._win_size, self._snp_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef int start_position(self):
 */
  __pyx_t_1 = __pyx_v_self->_snp_num;
  __pyx_t_2 = ((__pyx_v_win_idx + 1) * __pyx_v_self->_win_size);
  if ((__pyx_t_1 <code><</code> __pyx_t_2)) {
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_3 = __pyx_t_2;
  }
  __pyx_r = __pyx_t_3;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2298")'> 2298: </pre>
<pre id='line2298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line2299")'> 2299:     cpdef int start_position(self):</pre>
<pre id='line2299' class='code' style='background-color: #FFFF33'>
/* "LDModel.pyx":2299
 *         return min((win_idx + 1) * self._win_size, self._snp_num)
 * 
 *     cpdef int start_position(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[0]
 * 
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_103start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_7LDModel_7LDModel_start_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("start_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("start_position", __pyx_f[0], 2299);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__start_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_103start_position)) {
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2299
 *         return min((win_idx + 1) * self._win_size, self._snp_num)
 * 
 *     cpdef int start_position(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[0]
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_102start_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("start_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("start_position", __pyx_f[0], 2299);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->start_position(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.start_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2300")'> 2300:         return self._position[0]</pre>
<pre id='line2300' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":2300
 * 
 *     cpdef int start_position(self):
 *         return self._position[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef int end_position(self):
 */
  __pyx_r = (__pyx_v_self->_position[0]);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("LDModel.LDModel.start_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_103start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_103start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("start_position (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_102start_position(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2301")'> 2301: </pre>
<pre id='line2301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line2302")'> 2302:     cpdef int end_position(self):</pre>
<pre id='line2302' class='code' style='background-color: #FFFF33'>
/* "LDModel.pyx":2302
 *         return self._position[0]
 * 
 *     cpdef int end_position(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[self._snp_num-1]
 * 
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_105end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_7LDModel_7LDModel_end_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("end_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("end_position", __pyx_f[0], 2302);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__end_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_105end_position)) {
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2302
 *         return self._position[0]
 * 
 *     cpdef int end_position(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[self._snp_num-1]
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_104end_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("end_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("end_position", __pyx_f[0], 2302);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->end_position(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.end_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2303")'> 2303:         return self._position[self._snp_num-1]</pre>
<pre id='line2303' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":2303
 * 
 *     cpdef int end_position(self):
 *         return self._position[self._snp_num-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef int get_position(self, int snp_num):
 */
  __pyx_r = (__pyx_v_self->_position[(__pyx_v_self->_snp_num - 1)]);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("LDModel.LDModel.end_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_105end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_105end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("end_position (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_104end_position(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2304")'> 2304: </pre>
<pre id='line2304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line2305")'> 2305:     cpdef int get_position(self, int snp_num):</pre>
<pre id='line2305' class='code' style='background-color: #FFFF29'>
/* "LDModel.pyx":2305
 *         return self._position[self._snp_num-1]
 * 
 *     cpdef int get_position(self, int snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[snp_num]
 * 
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_107get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num); /*proto*/
static int __pyx_f_7LDModel_7LDModel_get_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_snp_num, int __pyx_skip_dispatch) {
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_position", __pyx_f[0], 2305);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__get_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_107get_position)) {
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_4;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2305
 *         return self._position[self._snp_num-1]
 * 
 *     cpdef int get_position(self, int snp_num):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._position[snp_num]
 * 
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_106get_position(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_v_snp_num) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_position", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_position", __pyx_f[0], 2305);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_position(__pyx_v_self, __pyx_v_snp_num, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line2306")'> 2306:         return self._position[snp_num]</pre>
<pre id='line2306' class='code' style='background-color: #FFFF4f'>
  /* "LDModel.pyx":2306
 * 
 *     cpdef int get_position(self, int snp_num):
 *         return self._position[snp_num]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef int get_num_windows(self):
 */
  __pyx_r = (__pyx_v_self->_position[__pyx_v_snp_num]);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_107get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_107get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num) {
  int __pyx_v_snp_num;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_position (wrapper)", 0);
  assert(__pyx_arg_snp_num); {
    __pyx_v_snp_num = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_snp_num);<span class='error_goto'> if (unlikely((__pyx_v_snp_num == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7LDModel_7LDModel_106get_position(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((int)__pyx_v_snp_num));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2307")'> 2307: </pre>
<pre id='line2307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line2308")'> 2308:     cpdef int get_num_windows(self):</pre>
<pre id='line2308' class='code' style='background-color: #FFFF33'>
/* "LDModel.pyx":2308
 *         return self._position[snp_num]
 * 
 *     cpdef int get_num_windows(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int num_win
 *         num_win = int(self._snp_num / self._win_size)
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_109get_num_windows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_7LDModel_7LDModel_get_num_windows(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_num_win;
  int __pyx_r;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_num_windows", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_num_windows", __pyx_f[0], 2308);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__get_num_windows);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_109get_num_windows)) {
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2308
 *         return self._position[snp_num]
 * 
 *     cpdef int get_num_windows(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int num_win
 *         num_win = int(self._snp_num / self._win_size)
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_108get_num_windows(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_num_windows", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("get_num_windows", __pyx_f[0], 2308);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->get_num_windows(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.get_num_windows", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2309")'> 2309:         cdef int num_win</pre>
<pre id='line2309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2310")'> 2310:         num_win = int(self._snp_num / self._win_size)</pre>
<pre id='line2310' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":2310
 *     cpdef int get_num_windows(self):
 *         cdef int num_win
 *         num_win = int(self._snp_num / self._win_size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._snp_num % self._win_size > 0:
 *             num_win += 1
 */
  if (unlikely(__pyx_v_self->_win_size == 0)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_num_win = ((int)(((double)__pyx_v_self->_snp_num) / ((double)__pyx_v_self->_win_size)));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2311")'> 2311:         if self._snp_num % self._win_size &gt; 0:</pre>
<pre id='line2311' class='code' style='background-color: #FFFFaa'>
  /* "LDModel.pyx":2311
 *         cdef int num_win
 *         num_win = int(self._snp_num / self._win_size)
 *         if self._snp_num % self._win_size > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             num_win += 1
 *         return num_win
 */
  if (unlikely(__pyx_v_self->_win_size == 0)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_4 = (__Pyx_mod_int(__pyx_v_self->_snp_num, __pyx_v_self->_win_size) > 0);
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2312")'> 2312:             num_win += 1</pre>
<pre id='line2312' class='code' style='background-color: #FFFFff'>
    /* "LDModel.pyx":2312
 *         num_win = int(self._snp_num / self._win_size)
 *         if self._snp_num % self._win_size > 0:
 *             num_win += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return num_win
 * 
 */
    __pyx_v_num_win = (__pyx_v_num_win + 1);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2313")'> 2313:         return num_win</pre>
<pre id='line2313' class='code' style='background-color: #FFFF8d'>
  /* "LDModel.pyx":2313
 *         if self._snp_num % self._win_size > 0:
 *             num_win += 1
 *         return num_win             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef generate_composite_individuals(self, num_inds):
 */
  __pyx_r = __pyx_v_num_win;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("LDModel.LDModel.get_num_windows", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(Py_None);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_109get_num_windows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_109get_num_windows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_num_windows (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_108get_num_windows(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2314")'> 2314: </pre>
<pre id='line2314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line2315")'> 2315:     cpdef generate_composite_individuals(self, num_inds):</pre>
<pre id='line2315' class='code' style='background-color: #FFFF39'>
/* "LDModel.pyx":2315
 *         return num_win
 * 
 *     cpdef generate_composite_individuals(self, num_inds):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         new_haplos = <code><</code>char **> malloc(2 * num_inds * sizeof(char *))
 */

static PyObject *__pyx_pw_7LDModel_7LDModel_111generate_composite_individuals(PyObject *__pyx_v_self, PyObject *__pyx_v_num_inds); /*proto*/
static PyObject *__pyx_f_7LDModel_7LDModel_generate_composite_individuals(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_num_inds, int __pyx_skip_dispatch) {
  char **__pyx_v_new_haplos;
  PyObject *__pyx_v_hap_idx = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_end = NULL;
  PyObject *__pyx_v_length = NULL;
  PyObject *__pyx_v_same_j = NULL;
  PyObject *__pyx_v_last_j = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_composite_individuals", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("generate_composite_individuals", __pyx_f[0], 2315);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_89);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_7LDModel_7LDModel_111generate_composite_individuals)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_inds);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_num_inds);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_num_inds);
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "LDModel.pyx":2315
 *         return num_win
 * 
 *     cpdef generate_composite_individuals(self, num_inds):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         new_haplos = <code><</code>char **> malloc(2 * num_inds * sizeof(char *))
 */

static PyObject *__pyx_pf_7LDModel_7LDModel_110generate_composite_individuals(struct __pyx_obj_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_num_inds) {
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_composite_individuals", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("generate_composite_individuals", __pyx_f[0], 2315);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_7LDModel_LDModel *)__pyx_v_self->__pyx_vtab)->generate_composite_individuals(__pyx_v_self, __pyx_v_num_inds, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_composite_individuals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getbuffer__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5numpy_7ndarray___getbuffer__(((PyArrayObject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info), ((int)__pyx_v_flags));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2316")'> 2316: </pre>
<pre id='line2316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line2317")'> 2317:         new_haplos = &lt;char **&gt; malloc(2 * num_inds * sizeof(char *))</pre>
<pre id='line2317' class='code' style='background-color: #FFFF43'>
  /* "LDModel.pyx":2317
 *     cpdef generate_composite_individuals(self, num_inds):
 * 
 *         new_haplos = <code><</code>char **> malloc(2 * num_inds * sizeof(char *))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for hap_idx in range(2 * num_inds):
 *             new_haplos[hap_idx] = <code><</code>char *> malloc(self._snp_num * sizeof(char))
 */
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_v_num_inds);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((sizeof(char *)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_new_haplos = ((char **)malloc(__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line2318")'> 2318:         for hap_idx in range(2 * num_inds):</pre>
<pre id='line2318' class='code' style='background-color: #FFFF20'>
  /* "LDModel.pyx":2318
 * 
 *         new_haplos = <code><</code>char **> malloc(2 * num_inds * sizeof(char *))
 *         for hap_idx in range(2 * num_inds):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             new_haplos[hap_idx] = <code><</code>char *> malloc(self._snp_num * sizeof(char))
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_v_num_inds);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap_idx);
    __pyx_v_hap_idx = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2319")'> 2319:             new_haplos[hap_idx] = &lt;char *&gt; malloc(self._snp_num * sizeof(char))</pre>
<pre id='line2319' class='code' style='background-color: #FFFF79'>
    /* "LDModel.pyx":2319
 *         new_haplos = <code><</code>char **> malloc(2 * num_inds * sizeof(char *))
 *         for hap_idx in range(2 * num_inds):
 *             new_haplos[hap_idx] = <code><</code>char *> malloc(self._snp_num * sizeof(char))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for i in range(num_inds*2):
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_hap_idx);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    (__pyx_v_new_haplos[__pyx_t_7]) = ((char *)malloc((__pyx_v_self->_snp_num * (sizeof(char)))));
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2320")'> 2320: </pre>
<pre id='line2320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line2321")'> 2321:         for i in range(num_inds*2):</pre>
<pre id='line2321' class='code' style='background-color: #FFFF20'>
  /* "LDModel.pyx":2321
 *             new_haplos[hap_idx] = <code><</code>char *> malloc(self._snp_num * sizeof(char))
 * 
 *         for i in range(num_inds*2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "composing individual " + str(i)
 *             print "first position: " + str(self._position[0])
 */
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_num_inds, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line2322")'> 2322:             print "composing individual " + str(i)</pre>
<pre id='line2322' class='code' style='background-color: #FFFF4f'>
    /* "LDModel.pyx":2322
 * 
 *         for i in range(num_inds*2):
 *             print "composing individual " + str(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "first position: " + str(self._position[0])
 *             print "last position: " + str(self._position[self._snp_num-1])
 */
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_90), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line2323")'> 2323:             print "first position: " + str(self._position[0])</pre>
<pre id='line2323' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":2323
 *         for i in range(num_inds*2):
 *             print "composing individual " + str(i)
 *             print "first position: " + str(self._position[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print "last position: " + str(self._position[self._snp_num-1])
 *             start = 0
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_91), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line2324")'> 2324:             print "last position: " + str(self._position[self._snp_num-1])</pre>
<pre id='line2324' class='code' style='background-color: #FFFF46'>
    /* "LDModel.pyx":2324
 *             print "composing individual " + str(i)
 *             print "first position: " + str(self._position[0])
 *             print "last position: " + str(self._position[self._snp_num-1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start = 0
 *             end = 0
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_position[(__pyx_v_self->_snp_num - 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_92), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2325")'> 2325:             start = 0</pre>
<pre id='line2325' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":2325
 *             print "first position: " + str(self._position[0])
 *             print "last position: " + str(self._position[self._snp_num-1])
 *             start = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end = 0
 *             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start);
    __pyx_v_start = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2326")'> 2326:             end = 0</pre>
<pre id='line2326' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":2326
 *             print "last position: " + str(self._position[self._snp_num-1])
 *             start = 0
 *             end = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)
 *             same_j = 0
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end);
    __pyx_v_end = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line2327")'> 2327:             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)</pre>
<pre id='line2327' class='code' style='background-color: #FFFF4d'>
    /* "LDModel.pyx":2327
 *             start = 0
 *             end = 0
 *             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             same_j = 0
 *             last_j = -1
 */
    __pyx_t_8 = (200 * ((__pyx_v_self->_position[(__pyx_v_self->_snp_num - 1)]) - (__pyx_v_self->_position[0])));
    if (unlikely(__pyx_v_self->_snp_num == 0)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_t_8) / ((double)__pyx_v_self->_snp_num)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_length);
    __pyx_v_length = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2328")'> 2328:             same_j = 0</pre>
<pre id='line2328' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":2328
 *             end = 0
 *             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)
 *             same_j = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             last_j = -1
 *             while end <code><</code> self._snp_num - 1:
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_same_j);
    __pyx_v_same_j = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2329")'> 2329:             last_j = -1</pre>
<pre id='line2329' class='code' style='background-color: #FFFFd4'>
    /* "LDModel.pyx":2329
 *             length = int(200 * (self._position[self._snp_num-1] - self._position[0]) / self._snp_num)
 *             same_j = 0
 *             last_j = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             while end <code><</code> self._snp_num - 1:
 *                 stdout.write("%d," % start)
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_j);
    __pyx_v_last_j = __pyx_int_neg_1;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line2330")'> 2330:             while end &lt; self._snp_num - 1:</pre>
<pre id='line2330' class='code' style='background-color: #FFFF5e'>
    /* "LDModel.pyx":2330
 *             same_j = 0
 *             last_j = -1
 *             while end <code><</code> self._snp_num - 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 stdout.write("%d," % start)
 *                 stdout.flush()
 */
    while (1) {
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->_snp_num - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_end, __pyx_t_3, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (!__pyx_t_9) break;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line2331")'> 2331:                 stdout.write("%d," % start)</pre>
<pre id='line2331' class='code' style='background-color: #FFFF44'>
      /* "LDModel.pyx":2331
 *             last_j = -1
 *             while end <code><</code> self._snp_num - 1:
 *                 stdout.write("%d," % start)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 stdout.flush()
 *                 start = end
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__stdout);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_93), __pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_t_1));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2332")'> 2332:                 stdout.flush()</pre>
<pre id='line2332' class='code' style='background-color: #FFFF66'>
      /* "LDModel.pyx":2332
 *             while end <code><</code> self._snp_num - 1:
 *                 stdout.write("%d," % start)
 *                 stdout.flush()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 start = end
 *                 end = min(self._snp_num-1,start+length)
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__stdout);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__flush);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2333")'> 2333:                 start = end</pre>
<pre id='line2333' class='code' style='background-color: #FFFFd4'>
      /* "LDModel.pyx":2333
 *                 stdout.write("%d," % start)
 *                 stdout.flush()
 *                 start = end             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 end = min(self._snp_num-1,start+length)
 *                 #dists_c = [abs(x-self._genetic_dist[start]-length) for x in self._genetic_dist]
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_start);
      __pyx_v_start = __pyx_v_end;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line2334")'> 2334:                 end = min(self._snp_num-1,start+length)</pre>
<pre id='line2334' class='code' style='background-color: #FFFF3c'>
      /* "LDModel.pyx":2334
 *                 stdout.flush()
 *                 start = end
 *                 end = min(self._snp_num-1,start+length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #dists_c = [abs(x-self._genetic_dist[start]-length) for x in self._genetic_dist]
 *                 #end = dists_c.index(min(dists_c))
 */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_start, __pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_8 = (__pyx_v_self->_snp_num - 1);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (__pyx_t_9) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_10 = __pyx_t_1;
      } else {
        __pyx_t_11 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_10 = __pyx_t_11;
        __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __pyx_t_10;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_end);
      __pyx_v_end = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2335")'> 2335:                 #dists_c = [abs(x-self._genetic_dist[start]-length) for x in self._genetic_dist]</pre>
<pre id='line2335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2336")'> 2336:                 #end = dists_c.index(min(dists_c))</pre>
<pre id='line2336' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line2337")'> 2337:                 j = random.randint(0, self._nr_haplos)</pre>
<pre id='line2337' class='code' style='background-color: #FFFF41'>
      /* "LDModel.pyx":2337
 *                 #dists_c = [abs(x-self._genetic_dist[start]-length) for x in self._genetic_dist]
 *                 #end = dists_c.index(min(dists_c))
 *                 j = random.randint(0, self._nr_haplos)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if last_j == j:
 *                     same_j+=1
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__randint);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_int_0);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, ((PyObject *)__pyx_t_11), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
      __pyx_v_j = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2338")'> 2338:                 if last_j == j:</pre>
<pre id='line2338' class='code' style='background-color: #FFFF79'>
      /* "LDModel.pyx":2338
 *                 #end = dists_c.index(min(dists_c))
 *                 j = random.randint(0, self._nr_haplos)
 *                 if last_j == j:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     same_j+=1
 *                     if same_j >= 8:
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_last_j, __pyx_v_j, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line2339")'> 2339:                     same_j+=1</pre>
<pre id='line2339' class='code' style='background-color: #FFFF9f'>
        /* "LDModel.pyx":2339
 *                 j = random.randint(0, self._nr_haplos)
 *                 if last_j == j:
 *                     same_j+=1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if same_j >= 8:
 *                         while True:
 */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_same_j, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_same_j);
        __pyx_v_same_j = __pyx_t_1;
        __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2340")'> 2340:                     if same_j &gt;= 8:</pre>
<pre id='line2340' class='code' style='background-color: #FFFF79'>
        /* "LDModel.pyx":2340
 *                 if last_j == j:
 *                     same_j+=1
 *                     if same_j >= 8:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         while True:
 *                             j = random.randint(0, self._nr_haplos)
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_same_j, __pyx_int_8, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2341")'> 2341:                         while True:</pre>
<pre id='line2341' class='code' style='background-color: #FFFFff'>
          /* "LDModel.pyx":2341
 *                     same_j+=1
 *                     if same_j >= 8:
 *                         while True:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             j = random.randint(0, self._nr_haplos)
 *                             if last_j != j:
 */
          while (1) {
            if (!1) break;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line2342")'> 2342:                             j = random.randint(0, self._nr_haplos)</pre>
<pre id='line2342' class='code' style='background-color: #FFFF41'>
            /* "LDModel.pyx":2342
 *                     if same_j >= 8:
 *                         while True:
 *                             j = random.randint(0, self._nr_haplos)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if last_j != j:
 *                                 same_j = 0
 */
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_11 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__randint);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_nr_haplos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_0);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            __pyx_t_1 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_11, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_j);
            __pyx_v_j = __pyx_t_1;
            __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2343")'> 2343:                             if last_j != j:</pre>
<pre id='line2343' class='code' style='background-color: #FFFF79'>
            /* "LDModel.pyx":2343
 *                         while True:
 *                             j = random.randint(0, self._nr_haplos)
 *                             if last_j != j:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 same_j = 0
 *                                 break
 */
            __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_last_j, __pyx_v_j, Py_NE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2344")'> 2344:                                 same_j = 0</pre>
<pre id='line2344' class='code' style='background-color: #FFFFd4'>
              /* "LDModel.pyx":2344
 *                             j = random.randint(0, self._nr_haplos)
 *                             if last_j != j:
 *                                 same_j = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 break
 *                 else:
 */
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_same_j);
              __pyx_v_same_j = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2345")'> 2345:                                 break</pre>
<pre id='line2345' class='code' style='background-color: #FFFFff'>
              /* "LDModel.pyx":2345
 *                             if last_j != j:
 *                                 same_j = 0
 *                                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     same_j = 0
 */
              goto __pyx_L12_break;
              goto __pyx_L13;
            }
            __pyx_L13:;
          }
          __pyx_L12_break:;
          goto __pyx_L10;
        }
        __pyx_L10:;
        goto __pyx_L9;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2346")'> 2346:                 else:</pre>
<pre id='line2346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2347")'> 2347:                     same_j = 0</pre>
<pre id='line2347' class='code' style='background-color: #FFFFd4'>
        /* "LDModel.pyx":2347
 *                                 break
 *                 else:
 *                     same_j = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 last_j = j
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_same_j);
        __pyx_v_same_j = __pyx_int_0;
      }
      __pyx_L9:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2348")'> 2348: </pre>
<pre id='line2348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2349")'> 2349:                 last_j = j</pre>
<pre id='line2349' class='code' style='background-color: #FFFFc4'>
      /* "LDModel.pyx":2349
 *                     same_j = 0
 * 
 *                 last_j = j             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 #strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)
 *                 #new_haplos[i][start:end] = self._haplos[j][start:end]
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_last_j);
      __pyx_v_last_j = __pyx_v_j;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2350")'> 2350:                 #strncpy(self._haplos[hap_idx], line_trunc,self._snp_num)</pre>
<pre id='line2350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2351")'> 2351:                 #new_haplos[i][start:end] = self._haplos[j][start:end]</pre>
<pre id='line2351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2352")'> 2352: </pre>
<pre id='line2352' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line2353")'> 2353:         self._haplos = new_haplos</pre>
<pre id='line2353' class='code' style='background-color: #FFFF55'>
  /* "LDModel.pyx":2353
 *                 #new_haplos[i][start:end] = self._haplos[j][start:end]
 * 
 *         self._haplos = new_haplos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_haplos = __pyx_v_new_haplos;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("LDModel.LDModel.generate_composite_individuals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hap_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_length);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_same_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7LDModel_7LDModel_111generate_composite_individuals(PyObject *__pyx_v_self, PyObject *__pyx_v_num_inds); /*proto*/
static PyObject *__pyx_pw_7LDModel_7LDModel_111generate_composite_individuals(PyObject *__pyx_v_self, PyObject *__pyx_v_num_inds) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_composite_individuals (wrapper)", 0);
  __pyx_r = __pyx_pf_7LDModel_7LDModel_110generate_composite_individuals(((struct __pyx_obj_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_num_inds));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2354")'> 2354: </pre>
<pre id='line2354' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2355")'> 2355: </pre>
<pre id='line2355' class='code' style='background-color: #FFFFff'></pre></body></html>
