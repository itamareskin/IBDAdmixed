<!DOCTYPE html>
<!-- Generated by Cython 0.20.1 on Tue May 20 22:49:53 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display != 'block') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.20.1 on Tue May 20 22:49:53 2014
<p>Raw output: <a href="LDModel.cpp">LDModel.cpp</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #cython: boundscheck=False</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: #cython: cdivision=True</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: #cython.wraparound=False</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: #cython.nonecheck=False</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: </pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: from __future__ import division</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line7")'> 7: import random</pre>
<pre id='line7' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_random, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_random, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line8")'> 8: import os</pre>
<pre id='line8' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_os, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line9")'> 9: import math</pre>
<pre id='line9' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_math, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_math, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: from libc.stdlib cimport malloc, free</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line11")'> 11: from itertools import islice, combinations_with_replacement</pre>
<pre id='line11' class='code' style='background-color: #FFFF41'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_islice);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_islice);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_islice);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_combinations_with_replacement);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_combinations_with_replacement);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_combinations_with_replacement);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_islice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_islice, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_combinations_with_replacement);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_combinations_with_replacement, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: from libc.math cimport exp, log</pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: from libc.float cimport DBL_MIN, DBL_MAX</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: from libc.limits cimport ULONG_MAX,LONG_MIN</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15: from libcpp cimport bool</pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line16")'> 16: from sys import stdout</pre>
<pre id='line16' class='code' style='background-color: #FFFF57'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_stdout);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_stdout);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_stdout);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_stdout);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_stdout, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line17")'> 17: import numpy as np</pre>
<pre id='line17' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: cimport numpy as np</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: </pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: cdef extern from "string.h":</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21:     char *strncpy(char *dest, char *src, size_t n)</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22:     int strlen(char *s)</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: </pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: cdef extern from "structs.h":</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     int c_isfinite(double x)</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26: </pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27:     cdef struct struct_state:</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:         double prob_em[2]</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29:         int out_trans_num</pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30:         int in_trans_num</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:         bool likely_allele</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32: </pre>
<pre id='line32' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33:     ctypedef struct_state state</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: </pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:     state create_state(double allele_0_prob, double allele_1_prob, int out_trans_num, int in_trans_num)</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36: </pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37:     cdef struct struct_transition:</pre>
<pre id='line37' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:         double prob</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39:         int next_node</pre>
<pre id='line39' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40: </pre>
<pre id='line40' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:     ctypedef struct_transition transition</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42: </pre>
<pre id='line42' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:     transition create_transition(double prob, int next_node)</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44: </pre>
<pre id='line44' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:     cdef struct struct_gen_map_entry:</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46:         double recomb_rate</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:         double genetic_dist</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48: </pre>
<pre id='line48' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49:     ctypedef struct_gen_map_entry gen_map_entry</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50: </pre>
<pre id='line50' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51:     gen_map_entry create_gen_map_entry(int position, double recomb_rate, double genetic_dist)</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: </pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:     bool get_likely_allele(state s)</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: </pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:     double logsumexp(double first, double second)</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56: </pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line57")'> 57: cdef read_until_blank_line(file_name, first_line = None):</pre>
<pre id='line57' class='code' style='background-color: #FFFF8d'>static PyObject *__pyx_f_3IBD_7LDModel_read_until_blank_line(PyObject *__pyx_v_file_name, struct __pyx_opt_args_3IBD_7LDModel_read_until_blank_line *__pyx_optional_args) {
  PyObject *__pyx_v_first_line = ((PyObject *)Py_None);
  long __pyx_v_buffer_size;
  PyObject *__pyx_v_blank_line = NULL;
  PyObject *__pyx_v_lines = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("read_until_blank_line", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_first_line = __pyx_optional_args-&gt;first_line;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.read_until_blank_line", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blank_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_3IBD_7LDModel_read_until_blank_line {
  int __pyx_n;
  PyObject *first_line;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58:         buffer_size = 100</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'>  __pyx_v_buffer_size = 100;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line59")'> 59:         blank_line = '\n'</pre>
<pre id='line59' class='code' style='background-color: #FFFFe7'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
  __pyx_v_blank_line = __pyx_kp_s_;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60:         # read a buffer_size of lines from the file</pre>
<pre id='line60' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line61")'> 61:         if first_line == None:</pre>
<pre id='line61' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_first_line, Py_None, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line62")'> 62:             lines = list(islice(file_name, buffer_size))</pre>
<pre id='line62' class='code' style='background-color: #FFFF48'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_islice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_file_name);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyList_Type))), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_lines = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:         else:</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line64")'> 64:             lines = list(islice(file_name, first_line, buffer_size))</pre>
<pre id='line64' class='code' style='background-color: #FFFF44'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_islice);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_file_name);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_first_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_first_line);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_first_line);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyList_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_lines = ((PyObject*)__pyx_t_4);
    __pyx_t_4 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65:         # read some more lines until a blank line is reached</pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66:         while True:</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'>  while (1) {
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line67")'> 67:             line = list(islice(file_name, 1))</pre>
<pre id='line67' class='code' style='background-color: #FFFF48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_islice);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_file_name);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyList_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_line, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line68")'> 68:             if not line:</pre>
<pre id='line68' class='code' style='background-color: #FFFFe7'>    __pyx_t_2 = (__pyx_v_line != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_line) != 0);
    __pyx_t_5 = ((!__pyx_t_2) != 0);
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line69")'> 69:                 lines += [blank_line]</pre>
<pre id='line69' class='code' style='background-color: #FFFF6a'>      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_blank_line);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_blank_line);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_lines, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_lines, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:                 break</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'>      goto __pyx_L5_break;
    }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line71")'> 71:             lines += line</pre>
<pre id='line71' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_lines, __pyx_v_line);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_lines, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line72")'> 72:             if line == [blank_line]:</pre>
<pre id='line72' class='code' style='background-color: #FFFF62'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_blank_line);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_blank_line);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_line, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73:                 break</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'>      goto __pyx_L5_break;
    }
  }
  __pyx_L5_break:;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line74")'> 74:         return lines</pre>
<pre id='line74' class='code' style='background-color: #FFFFd4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lines);
  __pyx_r = __pyx_v_lines;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75: </pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76: cdef class LDModel(object):</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'>struct __pyx_vtabstruct_3IBD_7LDModel_LDModel {
  int (*start_position)(struct __pyx_obj_3IBD_7LDModel_LDModel *, int __pyx_skip_dispatch);
  int (*end_position)(struct __pyx_obj_3IBD_7LDModel_LDModel *, int __pyx_skip_dispatch);
  int (*get_position)(struct __pyx_obj_3IBD_7LDModel_LDModel *, int, int __pyx_skip_dispatch);
  bool *(*generate_random_hap)(struct __pyx_obj_3IBD_7LDModel_LDModel *, int);
};
static struct __pyx_vtabstruct_3IBD_7LDModel_LDModel *__pyx_vtabptr_3IBD_7LDModel_LDModel;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:     '''</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:     Hidden Markov Model for a single ancestral population</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79:     '''</pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80: </pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line81")'> 81:     def __cinit__(self, map_file_name, beagle_file_name, int anc=0, int max_snp_num=1000000000, double eps = 1e-4):</pre>
<pre id='line81' class='code' style='background-color: #FFFF22'>/* Python wrapper */
static int __pyx_pw_3IBD_7LDModel_7LDModel_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_3IBD_7LDModel_7LDModel_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_map_file_name = 0;
  PyObject *__pyx_v_beagle_file_name = 0;
  int __pyx_v_anc;
  int __pyx_v_max_snp_num;
  double __pyx_v_eps;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_map_file_name,&amp;__pyx_n_s_beagle_file_name,&amp;__pyx_n_s_anc,&amp;__pyx_n_s_max_snp_num,&amp;__pyx_n_s_eps,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_map_file_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_beagle_file_name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_anc);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_snp_num);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_eps);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_map_file_name = values[0];
    __pyx_v_beagle_file_name = values[1];
    if (values[2]) {
      __pyx_v_anc = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_anc == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_anc = ((int)0);
    }
    if (values[3]) {
      __pyx_v_max_snp_num = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_max_snp_num == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_max_snp_num = ((int)1000000000);
    }
    if (values[4]) {
      __pyx_v_eps = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_eps == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_eps = ((double)1e-4);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel___cinit__(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self), __pyx_v_map_file_name, __pyx_v_beagle_file_name, __pyx_v_anc, __pyx_v_max_snp_num, __pyx_v_eps);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_3IBD_7LDModel_7LDModel___cinit__(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_map_file_name, PyObject *__pyx_v_beagle_file_name, int __pyx_v_anc, int __pyx_v_max_snp_num, double __pyx_v_eps) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: </pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line83")'> 83:         self._gm = GeneticMap(map_file_name, max_snp_num)</pre>
<pre id='line83' class='code' style='background-color: #FFFF6a'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_max_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_map_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_map_file_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_map_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_3IBD_10GeneticMap_GeneticMap)), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_gm);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_gm));
  __pyx_v_self-&gt;_gm = ((struct __pyx_obj_3IBD_10GeneticMap_GeneticMap *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84:         self._snp_num = self._gm._snp_num</pre>
<pre id='line84' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_self-&gt;_gm-&gt;_snp_num;
  __pyx_v_self-&gt;_snp_num = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85: </pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line86")'> 86:         print "genetic map created"</pre>
<pre id='line86' class='code' style='background-color: #FFFFd4'>  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_genetic_map_created) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87:         self._anc = anc</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_anc = __pyx_v_anc;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:         self.eps = eps</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;eps = __pyx_v_eps;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:         # allocate memory</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:         self._snp_ids = &lt;char **&gt; malloc(self._snp_num * sizeof(char *))</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_snp_ids = ((char **)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(char *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:         self._states = &lt;state **&gt; malloc(self._snp_num * sizeof(state *))</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_states = ((state **)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(state *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:         self._layer_state_nums = &lt;int *&gt; malloc(self._snp_num * sizeof(int))</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_layer_state_nums = ((int *)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(int)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94:         self._trans = &lt;double ***&gt; malloc((self._snp_num-1) * sizeof(double **))</pre>
<pre id='line94' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_trans = ((double ***)malloc(((__pyx_v_self-&gt;_snp_num - 1) * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:         self._trans_idx = &lt;int ***&gt; malloc((self._snp_num-1) * sizeof(int **))</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_trans_idx = ((int ***)malloc(((__pyx_v_self-&gt;_snp_num - 1) * (sizeof(int **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:         self._back_trans = &lt;double ***&gt; malloc((self._snp_num) * sizeof(double **))</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_back_trans = ((double ***)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(double **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:         self._back_trans_idx = &lt;int ***&gt; malloc((self._snp_num) * sizeof(int **))</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;_back_trans_idx = ((int ***)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(int **)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98: </pre>
<pre id='line98' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line99")'> 99:         self.read_from_bgl_file(beagle_file_name)</pre>
<pre id='line99' class='code' style='background-color: #FFFF6a'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_read_from_bgl_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_beagle_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_beagle_file_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_beagle_file_name);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100: </pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101: </pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line102")'> 102:     def read_from_bgl_file(self, file_name):</pre>
<pre id='line102' class='code' style='background-color: #FFFF4b'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_3read_from_bgl_file(PyObject *__pyx_v_self, PyObject *__pyx_v_file_name); /*proto*/
static char __pyx_doc_3IBD_7LDModel_7LDModel_2read_from_bgl_file[] = " \n        read the model from a beagle model file (.dag file)\n        ";
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_3read_from_bgl_file(PyObject *__pyx_v_self, PyObject *__pyx_v_file_name) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("read_from_bgl_file (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_2read_from_bgl_file(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_file_name));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_2read_from_bgl_file(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, PyObject *__pyx_v_file_name) {
  PyObject *__pyx_v_model_file = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_node = NULL;
  PyObject *__pyx_v_curr_allele = NULL;
  PyObject *__pyx_v_blank_line = NULL;
  PyObject *__pyx_v_layer = NULL;
  PyObject *__pyx_v_nodes = NULL;
  PyObject *__pyx_v_nodes_prev = NULL;
  PyObject *__pyx_v_nodes_curr = NULL;
  int __pyx_v_first_read;
  int __pyx_v_done;
  PyObject *__pyx_v_lines = NULL;
  Py_ssize_t __pyx_v_j;
  PyObject *__pyx_v_total_parent_count = NULL;
  PyObject *__pyx_v_edges_num = NULL;
  Py_ssize_t __pyx_v_k;
  double __pyx_v_error_eps;
  PyObject *__pyx_v_edge_idx = NULL;
  PyObject *__pyx_v_sum_back_trans = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("read_from_bgl_file", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_model_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_curr_allele);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blank_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes_prev);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes_curr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lines);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_parent_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges_num);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum_back_trans);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:         '''</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:         read the model from a beagle model file (.dag file)</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:         '''</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106: </pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line107")'> 107:         if not os.path.exists(file_name):</pre>
<pre id='line107' class='code' style='background-color: #FFFF4f'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_exists);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = ((!__pyx_t_4) != 0);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line108")'> 108:             print "the file: " + file_name + " does not exist!"</pre>
<pre id='line108' class='code' style='background-color: #FFFF6a'>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_the_file, __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_kp_s_does_not_exist);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line109")'> 109:             return</pre>
<pre id='line109' class='code' style='background-color: #FFFFd4'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110: </pre>
<pre id='line110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line111")'> 111:         print "reading from bgl model file: " + file_name</pre>
<pre id='line111' class='code' style='background-color: #FFFF8d'>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_reading_from_bgl_model_file, __pyx_v_file_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112: </pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113:         # identify allele coding</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line114")'> 114:         with open(file_name) as model_file:</pre>
<pre id='line114' class='code' style='background-color: #FFFF27'>  /*with:*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_file_name);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_open, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_3, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_3, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L4_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    /*try:*/ {
      {
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          __pyx_v_model_file = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_3, &amp;__pyx_t_1, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_12, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_13)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (__pyx_t_5 &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          __pyx_t_4 = ((!(__pyx_t_5 != 0)) != 0);
          if (__pyx_t_4) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);
            __pyx_t_3 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L9_exception_handled;
        }
        __pyx_L10_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L9_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L15_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_6) {
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__5, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_9)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
    goto __pyx_L26;
    __pyx_L4_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L26:;
  }
/* … */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line115")'> 115:             model_file.readline()</pre>
<pre id='line115' class='code' style='background-color: #FFFF9f'>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_file, __pyx_n_s_readline);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line116")'> 116:             model_file.readline()</pre>
<pre id='line116' class='code' style='background-color: #FFFF9f'>          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_file, __pyx_n_s_readline);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line117")'> 117:             line = model_file.readline()</pre>
<pre id='line117' class='code' style='background-color: #FFFFaa'>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_file, __pyx_n_s_readline);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_v_line = __pyx_t_3;
          __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line118")'> 118:             node = line.split("\t")</pre>
<pre id='line118' class='code' style='background-color: #FFFF7f'>          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_v_node = __pyx_t_1;
          __pyx_t_1 = 0;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line119")'> 119:             self._allele_0 = int(node[4])</pre>
<pre id='line119' class='code' style='background-color: #FFFF79'>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_node, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_v_self-&gt;_allele_0 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:             while True:</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'>          while (1) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line121")'> 121:                 line = model_file.readline()</pre>
<pre id='line121' class='code' style='background-color: #FFFF9f'>            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_file, __pyx_n_s_readline);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_line, __pyx_t_1);
            __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line122")'> 122:                 if len(line) &gt; 0:</pre>
<pre id='line122' class='code' style='background-color: #FFFFaa'>            __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_line);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
            __pyx_t_5 = ((__pyx_t_11 &gt; 0) != 0);
            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line123")'> 123:                     node = line.split("\t")</pre>
<pre id='line123' class='code' style='background-color: #FFFF79'>              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_node, __pyx_t_3);
              __pyx_t_3 = 0;
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line124")'> 124:                     if len(node) &gt; 4:</pre>
<pre id='line124' class='code' style='background-color: #FFFFaa'>              __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_node);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
              __pyx_t_5 = ((__pyx_t_11 &gt; 4) != 0);
              if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line125")'> 125:                         curr_allele = node[4]</pre>
<pre id='line125' class='code' style='background-color: #FFFFc4'>                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_node, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>;
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_curr_allele, __pyx_t_3);
                __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line126")'> 126:                         if int(curr_allele) != self._allele_0:</pre>
<pre id='line126' class='code' style='background-color: #FFFF5e'>                __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_v_curr_allele);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_self-&gt;_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line127")'> 127:                             if int(curr_allele) &gt; self._allele_0:</pre>
<pre id='line127' class='code' style='background-color: #FFFF5e'>                  __pyx_t_2 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_v_curr_allele);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_self-&gt;_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line128")'> 128:                                 self._allele_1 = int(curr_allele)</pre>
<pre id='line128' class='code' style='background-color: #FFFF8d'>                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_v_curr_allele);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_v_self-&gt;_allele_1 = __pyx_t_10;
                    goto __pyx_L22;
                  }
                  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:                             else:</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:                                 self._allele_1 = self._allele_0</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'>                    __pyx_t_10 = __pyx_v_self-&gt;_allele_0;
                    __pyx_v_self-&gt;_allele_1 = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line131")'> 131:                                 self._allele_0 = int(curr_allele)</pre>
<pre id='line131' class='code' style='background-color: #FFFF8d'>                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_v_curr_allele);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_10 == (char)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_v_self-&gt;_allele_0 = __pyx_t_10;
                  }
                  __pyx_L22:;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line132")'> 132:                             break;</pre>
<pre id='line132' class='code' style='background-color: #FFFF9f'>                  goto __pyx_L18_break;
                }
                goto __pyx_L20;
              }
              __pyx_L20:;
              goto __pyx_L19;
            }
            __pyx_L19:;
          }
          __pyx_L18_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L15_try_end;
        __pyx_L8_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133: </pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line134")'> 134:         print "allele 0 symbol: " + str(self._allele_0) + "  allele 1 symbol: " + str(self._allele_1)</pre>
<pre id='line134' class='code' style='background-color: #FFFF2f'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_self-&gt;_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_allele_0_symbol, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s_allele_1_symbol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_self-&gt;_allele_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135: </pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line136")'> 136:         with open(file_name) as model_file:</pre>
<pre id='line136' class='code' style='background-color: #FFFF26'>  /*with:*/ {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file_name);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_file_name);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_file_name);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_open, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L27_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L27_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    /*try:*/ {
      {
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_model_file, __pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.read_from_bgl_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_3, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_21 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_21, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
          if (unlikely(!__pyx_t_13)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (__pyx_t_4 &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          __pyx_t_5 = ((!(__pyx_t_4 != 0)) != 0);
          if (__pyx_t_5) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);
            __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L33_except_error;}</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L32_exception_handled;
        }
        __pyx_L33_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L32_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        __pyx_L38_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_6) {
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__8, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_7)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        goto __pyx_L30;
      }
      __pyx_L30:;
    }
    goto __pyx_L84;
    __pyx_L27_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L84:;
  }
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137: </pre>
<pre id='line137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line138")'> 138:             blank_line = '\n'</pre>
<pre id='line138' class='code' style='background-color: #FFFFe7'>          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
          __pyx_v_blank_line = __pyx_kp_s_;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line139")'> 139:             layer = 0</pre>
<pre id='line139' class='code' style='background-color: #FFFFe7'>          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          __pyx_v_layer = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line140")'> 140:             nodes = []</pre>
<pre id='line140' class='code' style='background-color: #FFFFaa'>          __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_v_nodes = ((PyObject*)__pyx_t_2);
          __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line141")'> 141:             nodes_prev = []</pre>
<pre id='line141' class='code' style='background-color: #FFFFaa'>          __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_v_nodes_prev = ((PyObject*)__pyx_t_2);
          __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line142")'> 142:             nodes_curr = []</pre>
<pre id='line142' class='code' style='background-color: #FFFFaa'>          __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_v_nodes_curr = ((PyObject*)__pyx_t_2);
          __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:             first_read = True</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'>          __pyx_v_first_read = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144:             done = False</pre>
<pre id='line144' class='code' style='background-color: #FFFFff'>          __pyx_v_done = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145: </pre>
<pre id='line145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:             while True:</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'>          while (1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147: </pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:                 if done:</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'>            __pyx_t_4 = (__pyx_v_done != 0);
            if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:                     break</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>              goto __pyx_L41_break;
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150:                 # read next buffer_size lines from the file</pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:                 if first_read:</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'>            __pyx_t_4 = (__pyx_v_first_read != 0);
            if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line152")'> 152:                     lines = read_until_blank_line(model_file,2)</pre>
<pre id='line152' class='code' style='background-color: #FFFFe7'>              __pyx_t_14.__pyx_n = 1;
              __pyx_t_14.first_line = __pyx_int_2;
              __pyx_t_2 = __pyx_f_3IBD_7LDModel_read_until_blank_line(__pyx_v_model_file, &amp;__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_lines, __pyx_t_2);
              __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153:                     first_read = False</pre>
<pre id='line153' class='code' style='background-color: #FFFFff'>              __pyx_v_first_read = 0;
              goto __pyx_L43;
            }
            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:                 else:</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line155")'> 155:                     lines = read_until_blank_line(model_file)</pre>
<pre id='line155' class='code' style='background-color: #FFFFe7'>              __pyx_t_2 = __pyx_f_3IBD_7LDModel_read_until_blank_line(__pyx_v_model_file, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_lines, __pyx_t_2);
              __pyx_t_2 = 0;
            }
            __pyx_L43:;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line156")'> 156:                 if lines == [blank_line]:</pre>
<pre id='line156' class='code' style='background-color: #FFFF62'>            __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blank_line);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_blank_line);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_blank_line);
            __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_lines, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157:                     break</pre>
<pre id='line157' class='code' style='background-color: #FFFFff'>              goto __pyx_L41_break;
            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158: </pre>
<pre id='line158' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line159")'> 159:                 for line in lines:</pre>
<pre id='line159' class='code' style='background-color: #FFFF2a'>            if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_lines) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_lines)) {
              __pyx_t_1 = __pyx_v_lines; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_11 = 0;
              __pyx_t_15 = NULL;
            } else {
              __pyx_t_11 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_lines);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              __pyx_t_15 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
            }
            for (;;) {
              if (!__pyx_t_15 &amp;&amp; <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
                if (__pyx_t_11 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #else
                __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #endif
              } else if (!__pyx_t_15 &amp;&amp; <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
                if (__pyx_t_11 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #else
                __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                #endif
              } else {
                __pyx_t_2 = __pyx_t_15(__pyx_t_1);
                if (unlikely(!__pyx_t_2)) {
                  PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                    else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  }
                  break;
                }
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              }
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_line, __pyx_t_2);
              __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line160")'> 160:                     if line != blank_line: # split next line</pre>
<pre id='line160' class='code' style='background-color: #FFFF8d'>              __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_line, __pyx_v_blank_line, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line161")'> 161:                         node = line.split("\t")</pre>
<pre id='line161' class='code' style='background-color: #FFFF79'>                __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_node, __pyx_t_3);
                __pyx_t_3 = 0;
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line162")'> 162:                         nodes.append(node[:6])</pre>
<pre id='line162' class='code' style='background-color: #FFFF7f'>                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_node, 0, 6, NULL, NULL, &amp;__pyx_slice__7, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_nodes, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                goto __pyx_L47;
              }
              /*else*/ {
/* … */
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163:                     else: # an entire level has been read</pre>
<pre id='line163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line164")'> 164:                         nodes_prev = nodes_curr</pre>
<pre id='line164' class='code' style='background-color: #FFFFd4'>                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes_curr);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nodes_prev, __pyx_v_nodes_curr);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line165")'> 165:                         nodes_curr = nodes</pre>
<pre id='line165' class='code' style='background-color: #FFFFd4'>                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nodes_curr, __pyx_v_nodes);
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line166")'> 166:                         nodes = []</pre>
<pre id='line166' class='code' style='background-color: #FFFF9f'>                __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nodes, ((PyObject*)__pyx_t_3));
                __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167: </pre>
<pre id='line167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line168")'> 168:                         # allocate memory for transition probabilities</pre>
<pre id='line168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line169")'> 169:                         if layer == 0:</pre>
<pre id='line169' class='code' style='background-color: #FFFF8d'>                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line170")'> 170:                             self._pi = &lt;double *&gt; malloc(len(nodes_curr) * sizeof(double))</pre>
<pre id='line170' class='code' style='background-color: #FFFFe7'>                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_v_self-&gt;_pi = ((double *)malloc((__pyx_t_17 * (sizeof(double)))));
                  goto __pyx_L48;
                }
                __pyx_L48:;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line171")'> 171:                         if layer &gt; 0:</pre>
<pre id='line171' class='code' style='background-color: #FFFF8d'>                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line172")'> 172:                             self._trans[layer-1] = &lt;double **&gt; malloc(len(nodes_prev) * sizeof(double*))</pre>
<pre id='line172' class='code' style='background-color: #FFFF86'>                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_prev);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  (__pyx_v_self-&gt;_trans[__pyx_t_18]) = ((double **)malloc((__pyx_t_17 * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line173")'> 173:                             self._trans_idx[layer-1] = &lt;int **&gt; malloc(len(nodes_prev) * sizeof(int*))</pre>
<pre id='line173' class='code' style='background-color: #FFFF86'>                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_prev);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  (__pyx_v_self-&gt;_trans_idx[__pyx_t_18]) = ((int **)malloc((__pyx_t_17 * (sizeof(int *)))));
                  goto __pyx_L49;
                }
                __pyx_L49:;
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line174")'> 174:                         self._back_trans[layer] = &lt;double **&gt; malloc(len(nodes_curr) * sizeof(double*))</pre>
<pre id='line174' class='code' style='background-color: #FFFFc4'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self-&gt;_back_trans[__pyx_t_18]) = ((double **)malloc((__pyx_t_17 * (sizeof(double *)))));
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line175")'> 175:                         self._back_trans_idx[layer] = &lt;int **&gt; malloc(len(nodes_curr) * sizeof(int*))</pre>
<pre id='line175' class='code' style='background-color: #FFFFc4'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self-&gt;_back_trans_idx[__pyx_t_18]) = ((int **)malloc((__pyx_t_17 * (sizeof(int *)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176: </pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177:                         # set layer state nums and snp ids</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line178")'> 178:                         self._layer_state_nums[layer] = len(nodes_curr)</pre>
<pre id='line178' class='code' style='background-color: #FFFFc4'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self-&gt;_layer_state_nums[__pyx_t_18]) = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line179")'> 179:                         self._snp_ids[layer] = nodes_curr[0][1]</pre>
<pre id='line179' class='code' style='background-color: #FFFF8d'>                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_nodes_curr, 0), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_AsString</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((!__pyx_t_19) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self-&gt;_snp_ids[__pyx_t_17]) = __pyx_t_19;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180: </pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:                         # allocate memory for the states</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line182")'> 182:                         self._states[layer] = &lt;state *&gt; malloc(len(nodes_curr) * sizeof(state))</pre>
<pre id='line182' class='code' style='background-color: #FFFFc4'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                (__pyx_v_self-&gt;_states[__pyx_t_18]) = ((state *)malloc((__pyx_t_17 * (sizeof(state)))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183: </pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line184")'> 184:                         for j in range(len(nodes_curr)):</pre>
<pre id='line184' class='code' style='background-color: #FFFFe7'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
                  __pyx_v_j = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line185")'> 185:                             if layer == 0:</pre>
<pre id='line185' class='code' style='background-color: #FFFF8d'>                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line186")'> 186:                                 total_parent_count = sum([int(x[5]) for x in nodes_curr])</pre>
<pre id='line186' class='code' style='background-color: #FFFF3b'>                    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_2 = __pyx_v_nodes_curr; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_20 = 0;
                    for (;;) {
                      if (__pyx_t_20 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_20); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_20++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #else
                      __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_20); __pyx_t_20++;<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      #endif
                      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x, __pyx_t_12);
                      __pyx_t_12 = 0;
                      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                      __pyx_t_21 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_21))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
                    __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_sum, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_total_parent_count, __pyx_t_3);
                    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line187")'> 187:                                 self._pi[j] = int(nodes_curr[j][5]) / total_parent_count</pre>
<pre id='line187' class='code' style='background-color: #FFFF55'>                    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    (__pyx_v_self-&gt;_pi[__pyx_v_j]) = __pyx_t_22;
                    goto __pyx_L52;
                  }
                  __pyx_L52:;
                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188: </pre>
<pre id='line188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line189")'> 189:                         for j in range(len(nodes_curr)):</pre>
<pre id='line189' class='code' style='background-color: #FFFFe7'>                __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
                  __pyx_v_j = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190:                             # find how many edges go into this node from the previous layer</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line191")'> 191:                             edges_num = 0</pre>
<pre id='line191' class='code' style='background-color: #FFFFd4'>                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_edges_num, __pyx_int_0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line192")'> 192:                             for k in range(len(nodes_prev)):</pre>
<pre id='line192' class='code' style='background-color: #FFFFe7'>                  __pyx_t_20 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_prev);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_20; __pyx_t_23+=1) {
                    __pyx_v_k = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line193")'> 193:                                 if nodes_prev[k][3] == nodes_curr[j][2]:</pre>
<pre id='line193' class='code' style='background-color: #FFFF55'>                    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_prev, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_21, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line194")'> 194:                                     edges_num += 1</pre>
<pre id='line194' class='code' style='background-color: #FFFF9f'>                      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges_num, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edges_num, __pyx_t_2);
                      __pyx_t_2 = 0;
                      goto __pyx_L59;
                    }
                    __pyx_L59:;
                  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195:                             # create states and set emission probability</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196:                             error_eps = self.eps*1e-1</pre>
<pre id='line196' class='code' style='background-color: #FFFFff'>                  __pyx_v_error_eps = (__pyx_v_self-&gt;eps * 1e-1);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line197")'> 197:                             if int(nodes_curr[j][4]) == self._allele_0:</pre>
<pre id='line197' class='code' style='background-color: #FFFF4d'>                  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                  __pyx_t_2 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_self-&gt;_allele_0);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_21, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line198")'> 198:                                 self._states[layer][j] = create_state(1 - error_eps, error_eps, 0, edges_num)</pre>
<pre id='line198' class='code' style='background-color: #FFFFb6'>                    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_24 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    ((__pyx_v_self-&gt;_states[__pyx_t_20])[__pyx_v_j]) = create_state((1.0 - __pyx_v_error_eps), __pyx_v_error_eps, 0, __pyx_t_24);
                    goto __pyx_L60;
                  }
                  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:                             else:</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line200")'> 200:                                 self._states[layer][j] = create_state(error_eps, 1 - error_eps, 0, edges_num)</pre>
<pre id='line200' class='code' style='background-color: #FFFFb6'>                    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_24 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    ((__pyx_v_self-&gt;_states[__pyx_t_20])[__pyx_v_j]) = create_state(__pyx_v_error_eps, (1.0 - __pyx_v_error_eps), 0, __pyx_t_24);
                  }
                  __pyx_L60:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201: </pre>
<pre id='line201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line202")'> 202:                             if layer &gt; 0:</pre>
<pre id='line202' class='code' style='background-color: #FFFF8d'>                  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203:                                 # allocate memory for the edges</pre>
<pre id='line203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line204")'> 204:                                 self._back_trans[layer][j] = &lt;double *&gt; malloc(edges_num * sizeof(double))</pre>
<pre id='line204' class='code' style='background-color: #FFFF6e'>                    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((sizeof(double)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_21);<span class='error_goto'> if (unlikely((__pyx_t_25 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    ((__pyx_v_self-&gt;_back_trans[__pyx_t_20])[__pyx_v_j]) = ((double *)malloc(__pyx_t_25));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line205")'> 205:                                 self._back_trans_idx[layer][j] = &lt;int *&gt; malloc(edges_num * sizeof(int))</pre>
<pre id='line205' class='code' style='background-color: #FFFF6e'>                    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((sizeof(int)));<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_25 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    ((__pyx_v_self-&gt;_back_trans_idx[__pyx_t_20])[__pyx_v_j]) = ((int *)malloc(__pyx_t_25));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206:                                 # set the edges transition probabilities</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line207")'> 207:                                 edge_idx = 0</pre>
<pre id='line207' class='code' style='background-color: #FFFFd4'>                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_edge_idx, __pyx_int_0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line208")'> 208:                                 sum_back_trans = 0</pre>
<pre id='line208' class='code' style='background-color: #FFFFd4'>                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sum_back_trans, __pyx_int_0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line209")'> 209:                                 for k in range(len(nodes_prev)):</pre>
<pre id='line209' class='code' style='background-color: #FFFFe7'>                    __pyx_t_20 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_prev);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_20; __pyx_t_23+=1) {
                      __pyx_v_k = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line210")'> 210:                                     if nodes_prev[k][3] == nodes_curr[j][2]:</pre>
<pre id='line210' class='code' style='background-color: #FFFF55'>                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_prev, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_21, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line211")'> 211:                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[j][2]])</pre>
<pre id='line211' class='code' style='background-color: #FFFF2a'>                        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        __pyx_t_2 = __pyx_v_nodes_curr; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_26 = 0;
                        for (;;) {
                          if (__pyx_t_26 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
                          #if CYTHON_COMPILING_IN_CPYTHON
                          __pyx_t_21 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_26); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21); __pyx_t_26++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #else
                          __pyx_t_21 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_26); __pyx_t_26++;<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #endif
                          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x, __pyx_t_21);
                          __pyx_t_21 = 0;
                          __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                          __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_27 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                          __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_21, __pyx_t_27, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                          if (__pyx_t_4) {
                            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                            __pyx_t_27 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                            if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_27))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                            goto __pyx_L67;
                          }
                          __pyx_L67:;
                        }
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
                        __pyx_t_3 = 0;
                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_sum, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_total_parent_count, __pyx_t_3);
                        __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line212")'> 212:                                         self._back_trans[layer][j][edge_idx] = int(nodes_curr[j][5]) / total_parent_count</pre>
<pre id='line212' class='code' style='background-color: #FFFF4b'>                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                        __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                        __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_26 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        (((__pyx_v_self-&gt;_back_trans[__pyx_t_26])[__pyx_v_j])[__pyx_t_28]) = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line213")'> 213:                                         self._back_trans_idx[layer][j][edge_idx] = k</pre>
<pre id='line213' class='code' style='background-color: #FFFFb6'>                        __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_26 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        (((__pyx_v_self-&gt;_back_trans_idx[__pyx_t_28])[__pyx_v_j])[__pyx_t_26]) = __pyx_v_k;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line214")'> 214:                                         sum_back_trans += self._back_trans[layer][j][edge_idx]</pre>
<pre id='line214' class='code' style='background-color: #FFFF62'>                        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_layer);<span class='error_goto'> if (unlikely((__pyx_t_26 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_back_trans[__pyx_t_26])[__pyx_v_j])[__pyx_t_28]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_sum_back_trans, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sum_back_trans, __pyx_t_3);
                        __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line215")'> 215:                                         edge_idx += 1</pre>
<pre id='line215' class='code' style='background-color: #FFFF9f'>                        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edge_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edge_idx, __pyx_t_3);
                        __pyx_t_3 = 0;
                        goto __pyx_L64;
                      }
                      __pyx_L64:;
                    }
                    goto __pyx_L61;
                  }
                  __pyx_L61:;
                }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216: </pre>
<pre id='line216' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line217")'> 217:                         if layer &gt; 0:</pre>
<pre id='line217' class='code' style='background-color: #FFFF8d'>                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line218")'> 218:                             for j in range(len(nodes_prev)):</pre>
<pre id='line218' class='code' style='background-color: #FFFFe7'>                  __pyx_t_17 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_prev);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                  for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
                    __pyx_v_j = __pyx_t_18;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219:                                 # find how many edges go into this node from the previous layer</pre>
<pre id='line219' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line220")'> 220:                                 edges_num = 0</pre>
<pre id='line220' class='code' style='background-color: #FFFFd4'>                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_edges_num, __pyx_int_0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line221")'> 221:                                 for k in range(len(nodes_curr)):</pre>
<pre id='line221' class='code' style='background-color: #FFFFe7'>                    __pyx_t_20 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_20; __pyx_t_23+=1) {
                      __pyx_v_k = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line222")'> 222:                                     if nodes_prev[j][3] == nodes_curr[k][2]:</pre>
<pre id='line222' class='code' style='background-color: #FFFF55'>                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_prev, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_27 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_27, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line223")'> 223:                                         edges_num += 1</pre>
<pre id='line223' class='code' style='background-color: #FFFF9f'>                        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges_num, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edges_num, __pyx_t_3);
                        __pyx_t_3 = 0;
                        goto __pyx_L73;
                      }
                      __pyx_L73:;
                    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224: </pre>
<pre id='line224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225:                                 # set states</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line226")'> 226:                                 self._states[layer-1][j].out_trans_num = edges_num</pre>
<pre id='line226' class='code' style='background-color: #FFFF7f'>                    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_edges_num);<span class='error_goto'> if (unlikely((__pyx_t_24 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    ((__pyx_v_self-&gt;_states[__pyx_t_20])[__pyx_v_j]).out_trans_num = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:                                 # allocate memory for the edges</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line228")'> 228:                                 self._trans[layer-1][j] = &lt;double *&gt; malloc(edges_num * sizeof(double))</pre>
<pre id='line228' class='code' style='background-color: #FFFF57'>                    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((sizeof(double)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_27 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_27);<span class='error_goto'> if (unlikely((__pyx_t_25 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                    __pyx_t_27 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_27);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                    ((__pyx_v_self-&gt;_trans[__pyx_t_20])[__pyx_v_j]) = ((double *)malloc(__pyx_t_25));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line229")'> 229:                                 self._trans_idx[layer-1][j] = &lt;int *&gt; malloc(edges_num * sizeof(int))</pre>
<pre id='line229' class='code' style='background-color: #FFFF57'>                    __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((sizeof(int)));<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_edges_num, __pyx_t_27);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_25 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_20 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                    ((__pyx_v_self-&gt;_trans_idx[__pyx_t_20])[__pyx_v_j]) = ((int *)malloc(__pyx_t_25));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230:                                 # set the edges transition probabilities</pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line231")'> 231:                                 edge_idx = 0</pre>
<pre id='line231' class='code' style='background-color: #FFFFd4'>                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_edge_idx, __pyx_int_0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line232")'> 232:                                 for k in range(len(nodes_curr)):</pre>
<pre id='line232' class='code' style='background-color: #FFFFe7'>                    __pyx_t_20 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_nodes_curr);<span class='error_goto'> if (unlikely(__pyx_t_20 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                    for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_20; __pyx_t_23+=1) {
                      __pyx_v_k = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line233")'> 233:                                     if nodes_prev[j][3] == nodes_curr[k][2]:</pre>
<pre id='line233' class='code' style='background-color: #FFFF55'>                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_prev, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_27 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_27, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line234")'> 234:                                         total_parent_count = sum([int(x[5]) for x in nodes_curr if x[2] == nodes_curr[k][2]])</pre>
<pre id='line234' class='code' style='background-color: #FFFF2a'>                        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        __pyx_t_2 = __pyx_v_nodes_curr; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_28 = 0;
                        for (;;) {
                          if (__pyx_t_28 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
                          #if CYTHON_COMPILING_IN_CPYTHON
                          __pyx_t_27 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_28); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_27); __pyx_t_28++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #else
                          __pyx_t_27 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_28); __pyx_t_28++;<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          #endif
                          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x, __pyx_t_27);
                          __pyx_t_27 = 0;
                          __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_27 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
                          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                          __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                          __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_27, __pyx_t_21, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                          if (__pyx_t_4) {
                            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                            __pyx_t_21 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                            if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_21))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                            goto __pyx_L79;
                          }
                          __pyx_L79:;
                        }
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
                        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
                        __pyx_t_3 = 0;
                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_sum, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_total_parent_count, __pyx_t_3);
                        __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line235")'> 235:                                         self._trans[layer-1][j][edge_idx] = int(nodes_curr[k][5]) / total_parent_count</pre>
<pre id='line235' class='code' style='background-color: #FFFF3f'>                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_nodes_curr, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>;
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                        __pyx_t_3 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_v_total_parent_count);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                        __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_26 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        (((__pyx_v_self-&gt;_trans[__pyx_t_28])[__pyx_v_j])[__pyx_t_26]) = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line236")'> 236:                                         self._trans_idx[layer-1][j][edge_idx] = k</pre>
<pre id='line236' class='code' style='background-color: #FFFF7f'>                        __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_26 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                        __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_edge_idx);<span class='error_goto'> if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        (((__pyx_v_self-&gt;_trans_idx[__pyx_t_26])[__pyx_v_j])[__pyx_t_28]) = __pyx_v_k;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line237")'> 237:                                         edge_idx += 1</pre>
<pre id='line237' class='code' style='background-color: #FFFF9f'>                        __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edge_idx, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edge_idx, __pyx_t_2);
                        __pyx_t_2 = 0;
                        goto __pyx_L76;
                      }
                      __pyx_L76:;
                    }
                  }
                  goto __pyx_L68;
                }
                __pyx_L68:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238: </pre>
<pre id='line238' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line239")'> 239:                         layer += 1</pre>
<pre id='line239' class='code' style='background-color: #FFFF9f'>                __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_layer, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_layer, __pyx_t_2);
                __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line240")'> 240:                         if layer &gt;= self._snp_num:</pre>
<pre id='line240' class='code' style='background-color: #FFFF79'>                __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_layer, __pyx_t_2, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L31_error;}</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:                             done = True;</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'>                  __pyx_v_done = 1;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line242")'> 242:                             break</pre>
<pre id='line242' class='code' style='background-color: #FFFF7f'>                  goto __pyx_L46_break;
                }
              }
              __pyx_L47:;
            }
            __pyx_L46_break:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          }
          __pyx_L41_break:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L38_try_end;
        __pyx_L31_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line243")'> 243:         print "Finished reading beagle file."</pre>
<pre id='line243' class='code' style='background-color: #FFFFd4'>  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_Finished_reading_beagle_file) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line244")'> 244: </pre>
<pre id='line244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line245")'> 245:     def get_layer_node_nums(self, anc):</pre>
<pre id='line245' class='code' style='background-color: #FFFFb6'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_5get_layer_node_nums(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_5get_layer_node_nums(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_layer_node_nums (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_4get_layer_node_nums(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_4get_layer_node_nums(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_node_nums = NULL;
  int __pyx_v_layer;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_layer_node_nums", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_layer_node_nums", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node_nums);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line246")'> 246:         node_nums = []</pre>
<pre id='line246' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_node_nums = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line247")'> 247:         for layer in range(self._snp_num):</pre>
<pre id='line247' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line248")'> 248:             node_nums.append(self._layer_state_nums[layer])</pre>
<pre id='line248' class='code' style='background-color: #FFFFaa'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_self-&gt;_layer_state_nums[__pyx_v_layer]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_node_nums, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line249")'> 249:         return node_nums</pre>
<pre id='line249' class='code' style='background-color: #FFFFd4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_node_nums);
  __pyx_r = __pyx_v_node_nums;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250: </pre>
<pre id='line250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line251")'> 251:     def get_node_edges(self, anc):</pre>
<pre id='line251' class='code' style='background-color: #FFFF8d'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_7get_node_edges(PyObject *__pyx_v_self, PyObject *__pyx_v_anc); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_7get_node_edges(PyObject *__pyx_v_self, PyObject *__pyx_v_anc) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_edges (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_6get_node_edges(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self), ((PyObject *)__pyx_v_anc));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_6get_node_edges(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_anc) {
  PyObject *__pyx_v_edges = NULL;
  PyObject *__pyx_v_edge_weights = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_edges = NULL;
  PyObject *__pyx_v_layer_edge_weights = NULL;
  int __pyx_v_node;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_edges", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_node_edges", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edge_weights);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line252")'> 252:         edges = []</pre>
<pre id='line252' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_edges = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line253")'> 253:         edge_weights = []</pre>
<pre id='line253' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_edge_weights = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254:         for layer in range(self._snp_num-1):</pre>
<pre id='line254' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = (__pyx_v_self-&gt;_snp_num - 1);
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line255")'> 255:             layer_edges = []</pre>
<pre id='line255' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_edges, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line256")'> 256:             layer_edge_weights = []</pre>
<pre id='line256' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_edge_weights, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:             for node in range(self._layer_state_nums[layer]):</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_layer]);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_node = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line258")'> 258:                 layer_edges.append([self._trans_idx[layer][node][i] for i in xrange(self._states[layer][node].out_trans_num)])</pre>
<pre id='line258' class='code' style='background-color: #FFFF6e'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).out_trans_num;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((((__pyx_v_self-&gt;_trans_idx[__pyx_v_layer])[__pyx_v_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_edges, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line259")'> 259:                 layer_edge_weights.append([self._trans[layer][node][i] for i in xrange(self._states[layer][node].out_trans_num)])</pre>
<pre id='line259' class='code' style='background-color: #FFFF62'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).out_trans_num;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;
        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_trans[__pyx_v_layer])[__pyx_v_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_edge_weights, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line260")'> 260:             edges.append(layer_edges)</pre>
<pre id='line260' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_edges, __pyx_v_layer_edges);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line261")'> 261:             edge_weights.append(layer_edge_weights)</pre>
<pre id='line261' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_edge_weights, __pyx_v_layer_edge_weights);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line262")'> 262:         return (edges, edge_weights)</pre>
<pre id='line262' class='code' style='background-color: #FFFF7f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edges);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_edges);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edge_weights);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_edge_weights);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edge_weights);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263: </pre>
<pre id='line263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line264")'> 264:     def get_node_edges_back(self):</pre>
<pre id='line264' class='code' style='background-color: #FFFF8d'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_9get_node_edges_back(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_9get_node_edges_back(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_edges_back (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_8get_node_edges_back(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_8get_node_edges_back(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_edges = NULL;
  PyObject *__pyx_v_edge_weights = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_edges = NULL;
  PyObject *__pyx_v_layer_edge_weights = NULL;
  int __pyx_v_node;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_edges_back", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_node_edges_back", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edge_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_edge_weights);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line265")'> 265:         edges = []</pre>
<pre id='line265' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_edges = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line266")'> 266:         edge_weights = []</pre>
<pre id='line266' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_edge_weights = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267:         for layer in range(1,self._snp_num):</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line268")'> 268:             layer_edges = []</pre>
<pre id='line268' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_edges, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line269")'> 269:             layer_edge_weights = []</pre>
<pre id='line269' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_edge_weights, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270:             for node in range(self._layer_state_nums[layer]):</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_layer]);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_node = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line271")'> 271:                 layer_edges.append([self._back_trans_idx[layer][node][i] for i in xrange(self._states[layer][node].in_trans_num)])</pre>
<pre id='line271' class='code' style='background-color: #FFFF6e'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).in_trans_num;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((((__pyx_v_self-&gt;_back_trans_idx[__pyx_v_layer])[__pyx_v_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_edges, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line272")'> 272:                 layer_edge_weights.append([self._back_trans[layer][node][i] for i in xrange(self._states[layer][node].in_trans_num)])</pre>
<pre id='line272' class='code' style='background-color: #FFFF62'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).in_trans_num;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;
        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_back_trans[__pyx_v_layer])[__pyx_v_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_edge_weights, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line273")'> 273:             edges.append(layer_edges)</pre>
<pre id='line273' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_edges, __pyx_v_layer_edges);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line274")'> 274:             edge_weights.append(layer_edge_weights)</pre>
<pre id='line274' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_edge_weights, __pyx_v_layer_edge_weights);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line275")'> 275:         return (edges, edge_weights)</pre>
<pre id='line275' class='code' style='background-color: #FFFF7f'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edges);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_edges);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edge_weights);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_edge_weights);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edge_weights);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276: </pre>
<pre id='line276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line277")'> 277:     def get_node_ems_probs(self):</pre>
<pre id='line277' class='code' style='background-color: #FFFF96'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_11get_node_ems_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_11get_node_ems_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_ems_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_10get_node_ems_probs(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_10get_node_ems_probs(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_ems_probs = NULL;
  int __pyx_v_layer;
  PyObject *__pyx_v_layer_ems_probs = NULL;
  int __pyx_v_node;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_ems_probs", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_node_ems_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ems_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_ems_probs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line278")'> 278:         ems_probs = []</pre>
<pre id='line278' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ems_probs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279:         for layer in range(self._snp_num):</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line280")'> 280:             layer_ems_probs = []</pre>
<pre id='line280' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_ems_probs, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:             for node in range(self._layer_state_nums[layer]):</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_layer]);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_node = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line282")'> 282:                 layer_ems_probs.append((self._states[layer][node].prob_em[0],self._states[layer][node].prob_em[1]))</pre>
<pre id='line282' class='code' style='background-color: #FFFF55'>      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).prob_em[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).prob_em[1]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_1 = 0;
      __pyx_t_6 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_ems_probs, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line283")'> 283:             ems_probs.append(layer_ems_probs)</pre>
<pre id='line283' class='code' style='background-color: #FFFFd4'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_ems_probs, __pyx_v_layer_ems_probs);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line284")'> 284:         return ems_probs</pre>
<pre id='line284' class='code' style='background-color: #FFFFd4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ems_probs);
  __pyx_r = __pyx_v_ems_probs;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285: </pre>
<pre id='line285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line286")'> 286:     def get_trans_probs(self):</pre>
<pre id='line286' class='code' style='background-color: #FFFF9f'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_13get_trans_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_13get_trans_probs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_trans_probs (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_12get_trans_probs(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_12get_trans_probs(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_v_probs = NULL;
  long __pyx_v_layer;
  PyObject *__pyx_v_layer_probs = NULL;
  int __pyx_v_node;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_trans_probs", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_trans_probs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_probs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_layer_probs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line287")'> 287:         probs = []</pre>
<pre id='line287' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_probs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288:         for layer in range(self._snp_num-1):</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = (__pyx_v_self-&gt;_snp_num - 1);
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line289")'> 289:             layer_probs = []</pre>
<pre id='line289' class='code' style='background-color: #FFFF9f'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_layer_probs, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:             for node in range(self._layer_state_nums[layer]):</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_layer]);
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_node = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line291")'> 291:                 layer_probs.append([self._trans[layer][node][i] for i in xrange(self._states[layer][node].out_trans_num)])</pre>
<pre id='line291' class='code' style='background-color: #FFFF62'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_node]).out_trans_num;
      for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;
        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_trans[__pyx_v_layer])[__pyx_v_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_layer_probs, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line292")'> 292:             probs.append(layer_probs)</pre>
<pre id='line292' class='code' style='background-color: #FFFFd4'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_probs, __pyx_v_layer_probs);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line293")'> 293:         return probs</pre>
<pre id='line293' class='code' style='background-color: #FFFFd4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_probs);
  __pyx_r = __pyx_v_probs;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294: </pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line295")'> 295:     def print_emissions(self):</pre>
<pre id='line295' class='code' style='background-color: #FFFF96'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_15print_emissions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_15print_emissions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_emissions (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_14print_emissions(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_14print_emissions(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_emissions", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.print_emissions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line296")'> 296:         self._ems_file.write("snp node ems_prob0 ems_prob1\n")</pre>
<pre id='line296' class='code' style='background-color: #FFFF6a'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_ems_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_snp_node_ems_prob0_ems_prob1);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297:         for snp_idx in range(self._snp_num):</pre>
<pre id='line297' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_snp_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298:             for node_idx in range(self._layer_state_nums[snp_idx]):</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_snp_idx]);
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_node_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line299")'> 299:                 self._ems_file.write(str(snp_idx) + " " +</pre>
<pre id='line299' class='code' style='background-color: #FFFF33'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_ems_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
  }
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line300")'> 300:                               str(node_idx) + " " +</pre>
<pre id='line300' class='code' style='background-color: #FFFF4b'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line301")'> 301:                               str(self._states[snp_idx][node_idx].prob_em[0]) + " " +</pre>
<pre id='line301' class='code' style='background-color: #FFFF44'>      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_states[__pyx_v_snp_idx])[__pyx_v_node_idx]).prob_em[0]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line302")'> 302:                               str(self._states[snp_idx][node_idx].prob_em[1]) + "\n")</pre>
<pre id='line302' class='code' style='background-color: #FFFF55'>      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_states[__pyx_v_snp_idx])[__pyx_v_node_idx]).prob_em[1]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: </pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line304")'> 304:     def print_transitions(self):</pre>
<pre id='line304' class='code' style='background-color: #FFFF96'>/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_17print_transitions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_17print_transitions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_transitions (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_16print_transitions(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_16print_transitions(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  int __pyx_v_snp_idx;
  int __pyx_v_node_idx;
  int __pyx_v_nxt_node_idx;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_transitions", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.print_transitions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line305")'> 305:         self._trans_file.write("snp node next_node transition\n")</pre>
<pre id='line305' class='code' style='background-color: #FFFF6a'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_trans_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_snp_node_next_node_transition);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306:         for snp_idx in range(self._snp_num):</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_snp_idx = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307:             for node_idx in range(self._layer_state_nums[snp_idx]):</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = (__pyx_v_self-&gt;_layer_state_nums[__pyx_v_snp_idx]);
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_node_idx = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line308")'> 308:                 print str(snp_idx) + " " + str(node_idx) + " " + str(self._states[snp_idx][node_idx].out_trans_num)</pre>
<pre id='line308' class='code' style='background-color: #FFFF23'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((__pyx_v_self-&gt;_states[__pyx_v_snp_idx])[__pyx_v_node_idx]).out_trans_num);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:                 for nxt_node_idx in range(self._states[snp_idx][node_idx].out_trans_num):</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'>      __pyx_t_8 = ((__pyx_v_self-&gt;_states[__pyx_v_snp_idx])[__pyx_v_node_idx]).out_trans_num;
      for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
        __pyx_v_nxt_node_idx = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line310")'> 310:                     self._trans_file.write(str(snp_idx) + " " +</pre>
<pre id='line310' class='code' style='background-color: #FFFF33'>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_trans_file);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_write);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_snp_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line311")'> 311:                               str(node_idx) + " " +</pre>
<pre id='line311' class='code' style='background-color: #FFFF4b'>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line312")'> 312:                               str(nxt_node_idx) + " " +</pre>
<pre id='line312' class='code' style='background-color: #FFFF4b'>        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nxt_node_idx);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_kp_s__10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line313")'> 313:                               str(self._trans[snp_idx][node_idx][nxt_node_idx]) + "\n")</pre>
<pre id='line313' class='code' style='background-color: #FFFF55'>        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_trans[__pyx_v_snp_idx])[__pyx_v_node_idx])[__pyx_v_nxt_node_idx]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_kp_s_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line314")'> 314:         self._trans_file.flush()</pre>
<pre id='line314' class='code' style='background-color: #FFFF86'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_trans_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315: </pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line316")'> 316:     cpdef int start_position(self):</pre>
<pre id='line316' class='code' style='background-color: #FFFF57'>static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_19start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_3IBD_7LDModel_7LDModel_start_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("start_position", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_start_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_3IBD_7LDModel_7LDModel_19start_position)) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("IBD.LDModel.LDModel.start_position", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_19start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_19start_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("start_position (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_18start_position(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_18start_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("start_position", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((struct __pyx_vtabstruct_3IBD_7LDModel_LDModel *)__pyx_v_self-&gt;__pyx_vtab)-&gt;start_position(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.start_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317:         return self._gm._position[0]</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'>  __pyx_r = (__pyx_v_self-&gt;_gm-&gt;_position[0]);
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318: </pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line319")'> 319:     cpdef int end_position(self):</pre>
<pre id='line319' class='code' style='background-color: #FFFF57'>static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_21end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_3IBD_7LDModel_7LDModel_end_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("end_position", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_end_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_3IBD_7LDModel_7LDModel_21end_position)) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("IBD.LDModel.LDModel.end_position", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_21end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_21end_position(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("end_position (wrapper)", 0);
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_20end_position(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_20end_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("end_position", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((struct __pyx_vtabstruct_3IBD_7LDModel_LDModel *)__pyx_v_self-&gt;__pyx_vtab)-&gt;end_position(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.end_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320:         return self._gm._position[self._snp_num-1]</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'>  __pyx_r = (__pyx_v_self-&gt;_gm-&gt;_position[(__pyx_v_self-&gt;_snp_num - 1)]);
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321: </pre>
<pre id='line321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line322")'> 322:     cpdef int get_position(self, int snp_num):</pre>
<pre id='line322' class='code' style='background-color: #FFFF3b'>static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_23get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num); /*proto*/
static int __pyx_f_3IBD_7LDModel_7LDModel_get_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, int __pyx_v_snp_num, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_position", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_3IBD_7LDModel_7LDModel_23get_position)) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_snp_num);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_4;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("IBD.LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_23get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num); /*proto*/
static PyObject *__pyx_pw_3IBD_7LDModel_7LDModel_23get_position(PyObject *__pyx_v_self, PyObject *__pyx_arg_snp_num) {
  int __pyx_v_snp_num;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_position (wrapper)", 0);
  assert(__pyx_arg_snp_num); {
    __pyx_v_snp_num = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_arg_snp_num);<span class='error_goto'> if (unlikely((__pyx_v_snp_num == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3IBD_7LDModel_7LDModel_22get_position(((struct __pyx_obj_3IBD_7LDModel_LDModel *)__pyx_v_self), ((int)__pyx_v_snp_num));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3IBD_7LDModel_7LDModel_22get_position(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, int __pyx_v_snp_num) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_position", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((struct __pyx_vtabstruct_3IBD_7LDModel_LDModel *)__pyx_v_self-&gt;__pyx_vtab)-&gt;get_position(__pyx_v_self, __pyx_v_snp_num, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("IBD.LDModel.LDModel.get_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323:         return self._gm._position[snp_num]</pre>
<pre id='line323' class='code' style='background-color: #FFFFff'>  __pyx_r = (__pyx_v_self-&gt;_gm-&gt;_position[__pyx_v_snp_num]);
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324: </pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line325")'> 325:     cdef bool* generate_random_hap(self, int max_snp_num):</pre>
<pre id='line325' class='code' style='background-color: #FFFF96'>static bool *__pyx_f_3IBD_7LDModel_7LDModel_generate_random_hap(struct __pyx_obj_3IBD_7LDModel_LDModel *__pyx_v_self, int __pyx_v_max_snp_num) {
  CYTHON_UNUSED int __pyx_v_snp_num;
  bool *__pyx_v_hap;
  PyObject *__pyx_v_p = NULL;
  int __pyx_v_next_node;
  int __pyx_v_layer;
  PyObject *__pyx_v_t = NULL;
  int __pyx_v_i;
  bool *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_random_hap", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("IBD.LDModel.LDModel.generate_random_hap", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326:         cdef int snp_num = self._snp_num if self._snp_num &lt;= max_snp_num else max_snp_num</pre>
<pre id='line326' class='code' style='background-color: #FFFFff'>  if (((__pyx_v_self-&gt;_snp_num &lt;= __pyx_v_max_snp_num) != 0)) {
    __pyx_t_1 = __pyx_v_self-&gt;_snp_num;
  } else {
    __pyx_t_1 = __pyx_v_max_snp_num;
  }
  __pyx_v_snp_num = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327:         cdef bool* hap = &lt;bool *&gt; malloc(self._snp_num * sizeof(bool))</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'>  __pyx_v_hap = ((bool *)malloc((__pyx_v_self-&gt;_snp_num * (sizeof(bool)))));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line328")'> 328:         p = [self._pi[i] for i in xrange(self._layer_state_nums[0])]</pre>
<pre id='line328' class='code' style='background-color: #FFFF6e'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = (__pyx_v_self-&gt;_layer_state_nums[0]);
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;_pi[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_4))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_p = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line329")'> 329:         cdef int next_node = np.array(p).cumsum().searchsorted(np.random.sample(1))[0]</pre>
<pre id='line329' class='code' style='background-color: #FFFF26'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_p);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_p);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sample);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_next_node = __pyx_t_1;
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330:         for layer in range(self._snp_num):</pre>
<pre id='line330' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;_snp_num;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_layer = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331:             if self._states[layer][next_node].prob_em[0] &gt; 0.5:</pre>
<pre id='line331' class='code' style='background-color: #FFFFff'>    __pyx_t_6 = (((((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_next_node]).prob_em[0]) &gt; 0.5) != 0);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332:                 hap[layer] = False</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'>      (__pyx_v_hap[__pyx_v_layer]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333:             else:</pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line334")'> 334:                 hap[layer] = True</pre>
<pre id='line334' class='code' style='background-color: #FFFFff'>      (__pyx_v_hap[__pyx_v_layer]) = 1;
    }
    __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line335")'> 335:             if layer &lt; self._snp_num - 1:</pre>
<pre id='line335' class='code' style='background-color: #FFFFff'>    __pyx_t_6 = ((__pyx_v_layer &lt; (__pyx_v_self-&gt;_snp_num - 1)) != 0);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line336")'> 336:                 t = [self._trans[layer][next_node][i] for i in xrange(self._states[layer][next_node].out_trans_num)]</pre>
<pre id='line336' class='code' style='background-color: #FFFF6a'>      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = ((__pyx_v_self-&gt;_states[__pyx_v_layer])[__pyx_v_next_node]).out_trans_num;
      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_i = __pyx_t_8;
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_self-&gt;_trans[__pyx_v_layer])[__pyx_v_next_node])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_5, (PyObject*)__pyx_t_4))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line337")'> 337:                 next_node = self._trans_idx[layer][next_node][np.array(t).cumsum().searchsorted(np.random.sample(1))]</pre>
<pre id='line337' class='code' style='background-color: #FFFF27'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_t);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sample);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_next_node = (((__pyx_v_self-&gt;_trans_idx[__pyx_v_layer])[__pyx_v_next_node])[__pyx_t_9]);
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line338")'> 338:         return hap</pre>
<pre id='line338' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_hap;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line339")'> 339: </pre>
<pre id='line339' class='code' style='background-color: #FFFFff'></pre></body></html>
